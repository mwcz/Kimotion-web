!function(t){define("zepto",[],function(){return function(){var e=function(){function t(t){return null==t?String(t):X[q.call(t)]||"object"}function e(e){return"function"==t(e)}function r(t){return null!=t&&t==t.window}function n(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function i(e){return"object"==t(e)}function o(t){return i(t)&&!r(t)&&Object.getPrototypeOf(t)==Object.prototype}function a(t){return"number"==typeof t.length}function s(t){return R.call(t,function(t){return null!=t})}function h(t){return t.length>0?S.fn.concat.apply([],t):t}function u(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function c(t){return t in O?O[t]:O[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function l(t,e){return"number"!=typeof e||D[u(t)]?e:e+"px"}function p(t){var e,r;return L[t]||(e=P.createElement(t),P.body.appendChild(e),r=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==r&&(r="block"),L[t]=r),L[t]}function f(t){return"children"in t?A.call(t.children):S.map(t.childNodes,function(t){return 1==t.nodeType?t:void 0})}function d(t,e,r){for(w in e)r&&(o(e[w])||Q(e[w]))?(o(e[w])&&!o(t[w])&&(t[w]={}),Q(e[w])&&!Q(t[w])&&(t[w]=[]),d(t[w],e[w],r)):e[w]!==b&&(t[w]=e[w])}function m(t,e){return null==e?S(t):S(t).filter(e)}function g(t,r,n,i){return e(r)?r.call(t,n,i):r}function y(t,e,r){null==r?t.removeAttribute(e):t.setAttribute(e,r)}function v(t,e){var r=t.className||"",n=r&&r.baseVal!==b;return e===b?n?r.baseVal:r:void(n?r.baseVal=e:t.className=e)}function _(t){try{return t?"true"==t||("false"==t?!1:"null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?S.parseJSON(t):t):t}catch(e){return t}}function x(t,e){e(t);for(var r=0,n=t.childNodes.length;n>r;r++)x(t.childNodes[r],e)}var b,w,S,M,T,E,C=[],A=C.slice,R=C.filter,P=window.document,L={},O={},D={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},k=/^\s*<(\w+|!)[^>]*>/,F=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,N=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,I=/^(?:body|html)$/i,U=/([A-Z])/g,B=["val","css","html","text","data","width","height","offset"],V=["after","prepend","before","append"],G=P.createElement("table"),z=P.createElement("tr"),H={tr:P.createElement("tbody"),tbody:G,thead:G,tfoot:G,td:z,th:z,"*":P.createElement("div")},j=/complete|loaded|interactive/,W=/^[\w-]*$/,X={},q=X.toString,Y={},Z=P.createElement("div"),K={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},Q=Array.isArray||function(t){return t instanceof Array};return Y.matches=function(t,e){if(!e||!t||1!==t.nodeType)return!1;var r=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(r)return r.call(t,e);var n,i=t.parentNode,o=!i;return o&&(i=Z).appendChild(t),n=~Y.qsa(i,e).indexOf(t),o&&Z.removeChild(t),n},T=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},E=function(t){return R.call(t,function(e,r){return t.indexOf(e)==r})},Y.fragment=function(t,e,r){var n,i,a;return F.test(t)&&(n=S(P.createElement(RegExp.$1))),n||(t.replace&&(t=t.replace(N,"<$1></$2>")),e===b&&(e=k.test(t)&&RegExp.$1),e in H||(e="*"),a=H[e],a.innerHTML=""+t,n=S.each(A.call(a.childNodes),function(){a.removeChild(this)})),o(r)&&(i=S(n),S.each(r,function(t,e){B.indexOf(t)>-1?i[t](e):i.attr(t,e)})),n},Y.Z=function(t,e){return t=t||[],t.__proto__=S.fn,t.selector=e||"",t},Y.isZ=function(t){return t instanceof Y.Z},Y.init=function(t,r){var n;if(!t)return Y.Z();if("string"==typeof t)if(t=t.trim(),"<"==t[0]&&k.test(t))n=Y.fragment(t,RegExp.$1,r),t=null;else{if(r!==b)return S(r).find(t);n=Y.qsa(P,t)}else{if(e(t))return S(P).ready(t);if(Y.isZ(t))return t;if(Q(t))n=s(t);else if(i(t))n=[t],t=null;else if(k.test(t))n=Y.fragment(t.trim(),RegExp.$1,r),t=null;else{if(r!==b)return S(r).find(t);n=Y.qsa(P,t)}}return Y.Z(n,t)},S=function(t,e){return Y.init(t,e)},S.extend=function(t){var e,r=A.call(arguments,1);return"boolean"==typeof t&&(e=t,t=r.shift()),r.forEach(function(r){d(t,r,e)}),t},Y.qsa=function(t,e){var r,i="#"==e[0],o=!i&&"."==e[0],a=i||o?e.slice(1):e,s=W.test(a);return n(t)&&s&&i?(r=t.getElementById(a))?[r]:[]:1!==t.nodeType&&9!==t.nodeType?[]:A.call(s&&!i?o?t.getElementsByClassName(a):t.getElementsByTagName(e):t.querySelectorAll(e))},S.contains=P.documentElement.contains?function(t,e){return t!==e&&t.contains(e)}:function(t,e){for(;e&&(e=e.parentNode);)if(e===t)return!0;return!1},S.type=t,S.isFunction=e,S.isWindow=r,S.isArray=Q,S.isPlainObject=o,S.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},S.inArray=function(t,e,r){return C.indexOf.call(e,t,r)},S.camelCase=T,S.trim=function(t){return null==t?"":String.prototype.trim.call(t)},S.uuid=0,S.support={},S.expr={},S.map=function(t,e){var r,n,i,o=[];if(a(t))for(n=0;n<t.length;n++)r=e(t[n],n),null!=r&&o.push(r);else for(i in t)r=e(t[i],i),null!=r&&o.push(r);return h(o)},S.each=function(t,e){var r,n;if(a(t)){for(r=0;r<t.length;r++)if(e.call(t[r],r,t[r])===!1)return t}else for(n in t)if(e.call(t[n],n,t[n])===!1)return t;return t},S.grep=function(t,e){return R.call(t,e)},window.JSON&&(S.parseJSON=JSON.parse),S.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){X["[object "+e+"]"]=e.toLowerCase()}),S.fn={forEach:C.forEach,reduce:C.reduce,push:C.push,sort:C.sort,indexOf:C.indexOf,concat:C.concat,map:function(t){return S(S.map(this,function(e,r){return t.call(e,r,e)}))},slice:function(){return S(A.apply(this,arguments))},ready:function(t){return j.test(P.readyState)&&P.body?t(S):P.addEventListener("DOMContentLoaded",function(){t(S)},!1),this},get:function(t){return t===b?A.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){return C.every.call(this,function(e,r){return t.call(e,r,e)!==!1}),this},filter:function(t){return e(t)?this.not(this.not(t)):S(R.call(this,function(e){return Y.matches(e,t)}))},add:function(t,e){return S(E(this.concat(S(t,e))))},is:function(t){return this.length>0&&Y.matches(this[0],t)},not:function(t){var r=[];if(e(t)&&t.call!==b)this.each(function(e){t.call(this,e)||r.push(this)});else{var n="string"==typeof t?this.filter(t):a(t)&&e(t.item)?A.call(t):S(t);this.forEach(function(t){n.indexOf(t)<0&&r.push(t)})}return S(r)},has:function(t){return this.filter(function(){return i(t)?S.contains(this,t):S(this).find(t).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!i(t)?t:S(t)},last:function(){var t=this[this.length-1];return t&&!i(t)?t:S(t)},find:function(t){var e,r=this;return e=t?"object"==typeof t?S(t).filter(function(){var t=this;return C.some.call(r,function(e){return S.contains(e,t)})}):1==this.length?S(Y.qsa(this[0],t)):this.map(function(){return Y.qsa(this,t)}):S()},closest:function(t,e){var r=this[0],i=!1;for("object"==typeof t&&(i=S(t));r&&!(i?i.indexOf(r)>=0:Y.matches(r,t));)r=r!==e&&!n(r)&&r.parentNode;return S(r)},parents:function(t){for(var e=[],r=this;r.length>0;)r=S.map(r,function(t){return(t=t.parentNode)&&!n(t)&&e.indexOf(t)<0?(e.push(t),t):void 0});return m(e,t)},parent:function(t){return m(E(this.pluck("parentNode")),t)},children:function(t){return m(this.map(function(){return f(this)}),t)},contents:function(){return this.map(function(){return A.call(this.childNodes)})},siblings:function(t){return m(this.map(function(t,e){return R.call(f(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return S.map(this,function(e){return e[t]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=p(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var r=e(t);if(this[0]&&!r)var n=S(t).get(0),i=n.parentNode||this.length>1;return this.each(function(e){S(this).wrapAll(r?t.call(this,e):i?n.cloneNode(!0):n)})},wrapAll:function(t){if(this[0]){S(this[0]).before(t=S(t));for(var e;(e=t.children()).length;)t=e.first();S(t).append(this)}return this},wrapInner:function(t){var r=e(t);return this.each(function(e){var n=S(this),i=n.contents(),o=r?t.call(this,e):t;i.length?i.wrapAll(o):n.append(o)})},unwrap:function(){return this.parent().each(function(){S(this).replaceWith(S(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=S(this);(t===b?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(t){return S(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return S(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return 0 in arguments?this.each(function(e){var r=this.innerHTML;S(this).empty().append(g(this,t,e,r))}):0 in this?this[0].innerHTML:null},text:function(t){return 0 in arguments?this.each(function(e){var r=g(this,t,e,this.textContent);this.textContent=null==r?"":""+r}):0 in this?this[0].textContent:null},attr:function(t,e){var r;return"string"!=typeof t||1 in arguments?this.each(function(r){if(1===this.nodeType)if(i(t))for(w in t)y(this,w,t[w]);else y(this,t,g(this,e,r,this.getAttribute(t)))}):this.length&&1===this[0].nodeType?!(r=this[0].getAttribute(t))&&t in this[0]?this[0][t]:r:b},removeAttr:function(t){return this.each(function(){1===this.nodeType&&t.split(" ").forEach(function(t){y(this,t)},this)})},prop:function(t,e){return t=K[t]||t,1 in arguments?this.each(function(r){this[t]=g(this,e,r,this[t])}):this[0]&&this[0][t]},data:function(t,e){var r="data-"+t.replace(U,"-$1").toLowerCase(),n=1 in arguments?this.attr(r,e):this.attr(r);return null!==n?_(n):b},val:function(t){return 0 in arguments?this.each(function(e){this.value=g(this,t,e,this.value)}):this[0]&&(this[0].multiple?S(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(t){if(t)return this.each(function(e){var r=S(this),n=g(this,t,e,r.offset()),i=r.offsetParent().offset(),o={top:n.top-i.top,left:n.left-i.left};"static"==r.css("position")&&(o.position="relative"),r.css(o)});if(!this.length)return null;var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(e,r){if(arguments.length<2){var n,i=this[0];if(!i)return;if(n=getComputedStyle(i,""),"string"==typeof e)return i.style[T(e)]||n.getPropertyValue(e);if(Q(e)){var o={};return S.each(e,function(t,e){o[e]=i.style[T(e)]||n.getPropertyValue(e)}),o}}var a="";if("string"==t(e))r||0===r?a=u(e)+":"+l(e,r):this.each(function(){this.style.removeProperty(u(e))});else for(w in e)e[w]||0===e[w]?a+=u(w)+":"+l(w,e[w])+";":this.each(function(){this.style.removeProperty(u(w))});return this.each(function(){this.style.cssText+=";"+a})},index:function(t){return t?this.indexOf(S(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return t?C.some.call(this,function(t){return this.test(v(t))},c(t)):!1},addClass:function(t){return t?this.each(function(e){if("className"in this){M=[];var r=v(this),n=g(this,t,e,r);n.split(/\s+/g).forEach(function(t){S(this).hasClass(t)||M.push(t)},this),M.length&&v(this,r+(r?" ":"")+M.join(" "))}}):this},removeClass:function(t){return this.each(function(e){if("className"in this){if(t===b)return v(this,"");M=v(this),g(this,t,e,M).split(/\s+/g).forEach(function(t){M=M.replace(c(t)," ")}),v(this,M.trim())}})},toggleClass:function(t,e){return t?this.each(function(r){var n=S(this),i=g(this,t,r,v(this));i.split(/\s+/g).forEach(function(t){(e===b?!n.hasClass(t):e)?n.addClass(t):n.removeClass(t)})}):this},scrollTop:function(t){if(this.length){var e="scrollTop"in this[0];return t===b?e?this[0].scrollTop:this[0].pageYOffset:this.each(e?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var e="scrollLeft"in this[0];return t===b?e?this[0].scrollLeft:this[0].pageXOffset:this.each(e?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),r=this.offset(),n=I.test(e[0].nodeName)?{top:0,left:0}:e.offset();return r.top-=parseFloat(S(t).css("margin-top"))||0,r.left-=parseFloat(S(t).css("margin-left"))||0,n.top+=parseFloat(S(e[0]).css("border-top-width"))||0,n.left+=parseFloat(S(e[0]).css("border-left-width"))||0,{top:r.top-n.top,left:r.left-n.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||P.body;t&&!I.test(t.nodeName)&&"static"==S(t).css("position");)t=t.offsetParent;return t})}},S.fn.detach=S.fn.remove,["width","height"].forEach(function(t){var e=t.replace(/./,function(t){return t[0].toUpperCase()});S.fn[t]=function(i){var o,a=this[0];return i===b?r(a)?a["inner"+e]:n(a)?a.documentElement["scroll"+e]:(o=this.offset())&&o[t]:this.each(function(e){a=S(this),a.css(t,g(this,i,e,a[t]()))})}}),V.forEach(function(e,r){var n=r%2;S.fn[e]=function(){var e,i,o=S.map(arguments,function(r){return e=t(r),"object"==e||"array"==e||null==r?r:Y.fragment(r)}),a=this.length>1;return o.length<1?this:this.each(function(t,e){i=n?e:e.parentNode,e=0==r?e.nextSibling:1==r?e.firstChild:2==r?e:null;var s=S.contains(P.documentElement,i);o.forEach(function(t){if(a)t=t.cloneNode(!0);else if(!i)return S(t).remove();i.insertBefore(t,e),s&&x(t,function(t){null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src||window.eval.call(window,t.innerHTML)})})})},S.fn[n?e+"To":"insert"+(r?"Before":"After")]=function(t){return S(t)[e](this),this}}),Y.Z.prototype=S.fn,Y.uniq=E,Y.deserializeValue=_,S.zepto=Y,S}();return window.Zepto=e,void 0===window.$&&(window.$=e),function(t){function e(t){return t._zid||(t._zid=p++)}function r(t,r,o,a){if(r=n(r),r.ns)var s=i(r.ns);return(g[e(t)]||[]).filter(function(t){return!(!t||r.e&&t.e!=r.e||r.ns&&!s.test(t.ns)||o&&e(t.fn)!==e(o)||a&&t.sel!=a)})}function n(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function i(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function o(t,e){return t.del&&!v&&t.e in _||!!e}function a(t){return x[t]||v&&_[t]||t}function s(r,i,s,h,c,p,f){var d=e(r),m=g[d]||(g[d]=[]);i.split(/\s/).forEach(function(e){if("ready"==e)return t(document).ready(s);var i=n(e);i.fn=s,i.sel=c,i.e in x&&(s=function(e){var r=e.relatedTarget;return!r||r!==this&&!t.contains(this,r)?i.fn.apply(this,arguments):void 0}),i.del=p;var d=p||s;i.proxy=function(t){if(t=u(t),!t.isImmediatePropagationStopped()){t.data=h;var e=d.apply(r,t._args==l?[t]:[t].concat(t._args));return e===!1&&(t.preventDefault(),t.stopPropagation()),e}},i.i=m.length,m.push(i),"addEventListener"in r&&r.addEventListener(a(i.e),i.proxy,o(i,f))})}function h(t,n,i,s,h){var u=e(t);(n||"").split(/\s/).forEach(function(e){r(t,e,i,s).forEach(function(e){delete g[u][e.i],"removeEventListener"in t&&t.removeEventListener(a(e.e),e.proxy,o(e,h))})})}function u(e,r){return(r||!e.isDefaultPrevented)&&(r||(r=e),t.each(M,function(t,n){var i=r[t];e[t]=function(){return this[n]=b,i&&i.apply(r,arguments)},e[n]=w}),(r.defaultPrevented!==l?r.defaultPrevented:"returnValue"in r?r.returnValue===!1:r.getPreventDefault&&r.getPreventDefault())&&(e.isDefaultPrevented=b)),e}function c(t){var e,r={originalEvent:t};for(e in t)S.test(e)||t[e]===l||(r[e]=t[e]);return u(r,t)}var l,p=1,f=Array.prototype.slice,d=t.isFunction,m=function(t){return"string"==typeof t},g={},y={},v="onfocusin"in window,_={focus:"focusin",blur:"focusout"},x={mouseenter:"mouseover",mouseleave:"mouseout"};y.click=y.mousedown=y.mouseup=y.mousemove="MouseEvents",t.event={add:s,remove:h},t.proxy=function(r,n){var i=2 in arguments&&f.call(arguments,2);if(d(r)){var o=function(){return r.apply(n,i?i.concat(f.call(arguments)):arguments)};return o._zid=e(r),o}if(m(n))return i?(i.unshift(r[n],r),t.proxy.apply(null,i)):t.proxy(r[n],r);throw new TypeError("expected function")},t.fn.bind=function(t,e,r){return this.on(t,e,r)},t.fn.unbind=function(t,e){return this.off(t,e)},t.fn.one=function(t,e,r,n){return this.on(t,e,r,n,1)};var b=function(){return!0},w=function(){return!1},S=/^([A-Z]|returnValue$|layer[XY]$)/,M={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};t.fn.delegate=function(t,e,r){return this.on(e,t,r)},t.fn.undelegate=function(t,e,r){return this.off(e,t,r)},t.fn.live=function(e,r){return t(document.body).delegate(this.selector,e,r),this},t.fn.die=function(e,r){return t(document.body).undelegate(this.selector,e,r),this},t.fn.on=function(e,r,n,i,o){var a,u,p=this;return e&&!m(e)?(t.each(e,function(t,e){p.on(t,r,n,e,o)}),p):(m(r)||d(i)||i===!1||(i=n,n=r,r=l),(d(n)||n===!1)&&(i=n,n=l),i===!1&&(i=w),p.each(function(l,p){o&&(a=function(t){return h(p,t.type,i),i.apply(this,arguments)}),r&&(u=function(e){var n,o=t(e.target).closest(r,p).get(0);return o&&o!==p?(n=t.extend(c(e),{currentTarget:o,liveFired:p}),(a||i).apply(o,[n].concat(f.call(arguments,1)))):void 0}),s(p,e,i,n,r,u||a)}))},t.fn.off=function(e,r,n){var i=this;return e&&!m(e)?(t.each(e,function(t,e){i.off(t,r,e)}),i):(m(r)||d(n)||n===!1||(n=r,r=l),n===!1&&(n=w),i.each(function(){h(this,e,n,r)}))},t.fn.trigger=function(e,r){return e=m(e)||t.isPlainObject(e)?t.Event(e):u(e),e._args=r,this.each(function(){e.type in _&&"function"==typeof this[e.type]?this[e.type]():"dispatchEvent"in this?this.dispatchEvent(e):t(this).triggerHandler(e,r)})},t.fn.triggerHandler=function(e,n){var i,o;return this.each(function(a,s){i=c(m(e)?t.Event(e):e),i._args=n,i.target=s,t.each(r(s,e.type||e),function(t,e){return o=e.proxy(i),i.isImmediatePropagationStopped()?!1:void 0})}),o},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return 0 in arguments?this.bind(e,t):this.trigger(e)}}),t.Event=function(t,e){m(t)||(e=t,t=e.type);var r=document.createEvent(y[t]||"Events"),n=!0;if(e)for(var i in e)"bubbles"==i?n=!!e[i]:r[i]=e[i];return r.initEvent(t,n,!0),u(r)}}(e),function(t){function e(e,r,n){var i=t.Event(r);return t(e).trigger(i,n),!i.isDefaultPrevented()}function r(t,r,n,i){return t.global?e(r||v,n,i):void 0}function n(e){e.global&&0===t.active++&&r(e,null,"ajaxStart")}function i(e){e.global&&!--t.active&&r(e,null,"ajaxStop")}function o(t,e){var n=e.context;return e.beforeSend.call(n,t,e)===!1||r(e,n,"ajaxBeforeSend",[t,e])===!1?!1:void r(e,n,"ajaxSend",[t,e])}function a(t,e,n,i){var o=n.context,a="success";n.success.call(o,t,a,e),i&&i.resolveWith(o,[t,a,e]),r(n,o,"ajaxSuccess",[e,n,t]),h(a,e,n)}function s(t,e,n,i,o){var a=i.context;i.error.call(a,n,e,t),o&&o.rejectWith(a,[n,e,t]),r(i,a,"ajaxError",[n,i,t||e]),h(e,n,i)}function h(t,e,n){var o=n.context;n.complete.call(o,e,t),r(n,o,"ajaxComplete",[e,n]),i(n)}function u(){}function c(t){return t&&(t=t.split(";",2)[0]),t&&(t==S?"html":t==w?"json":x.test(t)?"script":b.test(t)&&"xml")||"text"}function l(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function p(e){e.processData&&e.data&&"string"!=t.type(e.data)&&(e.data=t.param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()||(e.url=l(e.url,e.data),e.data=void 0)}function f(e,r,n,i){return t.isFunction(r)&&(i=n,n=r,r=void 0),t.isFunction(n)||(i=n,n=void 0),{url:e,data:r,success:n,dataType:i}}function d(e,r,n,i){var o,a=t.isArray(r),s=t.isPlainObject(r);t.each(r,function(r,h){o=t.type(h),i&&(r=n?i:i+"["+(s||"object"==o||"array"==o?r:"")+"]"),!i&&a?e.add(h.name,h.value):"array"==o||!n&&"object"==o?d(e,h,n,r):e.add(r,h)})}var m,g,y=0,v=window.document,_=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,x=/^(?:text|application)\/javascript/i,b=/^(?:text|application)\/xml/i,w="application/json",S="text/html",M=/^\s*$/,T=v.createElement("a");T.href=window.location.href,t.active=0,t.ajaxJSONP=function(e,r){if(!("type"in e))return t.ajax(e);var n,i,h=e.jsonpCallback,u=(t.isFunction(h)?h():h)||"jsonp"+ ++y,c=v.createElement("script"),l=window[u],p=function(e){t(c).triggerHandler("error",e||"abort")},f={abort:p};return r&&r.promise(f),t(c).on("load error",function(o,h){clearTimeout(i),t(c).off().remove(),"error"!=o.type&&n?a(n[0],f,e,r):s(null,h||"error",f,e,r),window[u]=l,n&&t.isFunction(l)&&l(n[0]),l=n=void 0}),o(f,e)===!1?(p("abort"),f):(window[u]=function(){n=arguments},c.src=e.url.replace(/\?(.+)=\?/,"?$1="+u),v.head.appendChild(c),e.timeout>0&&(i=setTimeout(function(){p("timeout")},e.timeout)),f)},t.ajaxSettings={type:"GET",beforeSend:u,success:u,error:u,complete:u,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:w,xml:"application/xml, text/xml",html:S,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},t.ajax=function(e){var r,i=t.extend({},e||{}),h=t.Deferred&&t.Deferred();for(m in t.ajaxSettings)void 0===i[m]&&(i[m]=t.ajaxSettings[m]);n(i),i.crossDomain||(r=v.createElement("a"),r.href=i.url,r.href=r.href,i.crossDomain=T.protocol+"//"+T.host!=r.protocol+"//"+r.host),i.url||(i.url=window.location.toString()),p(i);var f=i.dataType,d=/\?.+=\?/.test(i.url);if(d&&(f="jsonp"),i.cache!==!1&&(e&&e.cache===!0||"script"!=f&&"jsonp"!=f)||(i.url=l(i.url,"_="+Date.now())),"jsonp"==f)return d||(i.url=l(i.url,i.jsonp?i.jsonp+"=?":i.jsonp===!1?"":"callback=?")),t.ajaxJSONP(i,h);var y,_=i.accepts[f],x={},b=function(t,e){x[t.toLowerCase()]=[t,e]},w=/^([\w-]+:)\/\//.test(i.url)?RegExp.$1:window.location.protocol,S=i.xhr(),E=S.setRequestHeader;if(h&&h.promise(S),i.crossDomain||b("X-Requested-With","XMLHttpRequest"),b("Accept",_||"*/*"),(_=i.mimeType||_)&&(_.indexOf(",")>-1&&(_=_.split(",",2)[0]),S.overrideMimeType&&S.overrideMimeType(_)),(i.contentType||i.contentType!==!1&&i.data&&"GET"!=i.type.toUpperCase())&&b("Content-Type",i.contentType||"application/x-www-form-urlencoded"),i.headers)for(g in i.headers)b(g,i.headers[g]);if(S.setRequestHeader=b,S.onreadystatechange=function(){if(4==S.readyState){S.onreadystatechange=u,clearTimeout(y);var e,r=!1;if(S.status>=200&&S.status<300||304==S.status||0==S.status&&"file:"==w){f=f||c(i.mimeType||S.getResponseHeader("content-type")),e=S.responseText;try{"script"==f?(1,eval)(e):"xml"==f?e=S.responseXML:"json"==f&&(e=M.test(e)?null:t.parseJSON(e))}catch(n){r=n}r?s(r,"parsererror",S,i,h):a(e,S,i,h)}else s(S.statusText||null,S.status?"error":"abort",S,i,h)}},o(S,i)===!1)return S.abort(),s(null,"abort",S,i,h),S;if(i.xhrFields)for(g in i.xhrFields)S[g]=i.xhrFields[g];var C="async"in i?i.async:!0;S.open(i.type,i.url,C,i.username,i.password);for(g in x)E.apply(S,x[g]);return i.timeout>0&&(y=setTimeout(function(){S.onreadystatechange=u,S.abort(),s(null,"timeout",S,i,h)},i.timeout)),S.send(i.data?i.data:null),S},t.get=function(){return t.ajax(f.apply(null,arguments))},t.post=function(){var e=f.apply(null,arguments);return e.type="POST",t.ajax(e)},t.getJSON=function(){var e=f.apply(null,arguments);return e.dataType="json",t.ajax(e)},t.fn.load=function(e,r,n){if(!this.length)return this;var i,o=this,a=e.split(/\s/),s=f(e,r,n),h=s.success;return a.length>1&&(s.url=a[0],i=a[1]),s.success=function(e){o.html(i?t("<div>").html(e.replace(_,"")).find(i):e),h&&h.apply(o,arguments)},t.ajax(s),this};var E=encodeURIComponent;t.param=function(e,r){var n=[];return n.add=function(e,r){t.isFunction(r)&&(r=r()),null==r&&(r=""),this.push(E(e)+"="+E(r))},d(n,e,r),n.join("&").replace(/%20/g,"+")}}(e),function(t){t.fn.serializeArray=function(){var e,r,n=[],i=function(t){return t.forEach?t.forEach(i):void n.push({name:e,value:t})};return this[0]&&t.each(this[0].elements,function(n,o){r=o.type,e=o.name,e&&"fieldset"!=o.nodeName.toLowerCase()&&!o.disabled&&"submit"!=r&&"reset"!=r&&"button"!=r&&"file"!=r&&("radio"!=r&&"checkbox"!=r||o.checked)&&i(t(o).val())}),n},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(0 in arguments)this.bind("submit",e);else if(this.length){var r=t.Event("submit");this.eq(0).trigger(r),r.isDefaultPrevented()||this.get(0).submit()}return this}}(e),function(t){"__proto__"in{}||t.extend(t.zepto,{Z:function(e,r){return e=e||[],t.extend(e,t.fn),e.selector=r||"",e.__Z=!0,e},isZ:function(e){return"array"===t.type(e)&&"__Z"in e}});try{getComputedStyle(void 0)}catch(e){var r=getComputedStyle;window.getComputedStyle=function(t){try{return r(t)}catch(e){return null}}}}(e),t.$=$}.apply(t,arguments)})}(this),function(){function t(t,e){if(t!==e){var r=t===t,n=e===e;if(t>e||!r||"undefined"==typeof t&&n)return 1;if(e>t||!n||"undefined"==typeof e&&r)return-1}return 0}function e(t,e,r){if(e!==e)return p(t,r);for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return-1}function r(t){return"function"==typeof t||!1}function n(t){return"string"==typeof t?t:null==t?"":t+""}function i(t){return t.charCodeAt(0)}function o(t,e){for(var r=-1,n=t.length;++r<n&&e.indexOf(t.charAt(r))>-1;);return r}function a(t,e){for(var r=t.length;r--&&e.indexOf(t.charAt(r))>-1;);return r}function s(e,r){return t(e.criteria,r.criteria)||e.index-r.index}function h(e,r,n){for(var i=-1,o=e.criteria,a=r.criteria,s=o.length,h=n.length;++i<s;){var u=t(o[i],a[i]);if(u)return i>=h?u:u*(n[i]?1:-1)}return e.index-r.index}function u(t){return Bt[t]}function c(t){return Vt[t]}function l(t){return"\\"+Ht[t]}function p(t,e,r){for(var n=t.length,i=e+(r?0:-1);r?i--:++i<n;){var o=t[i];if(o!==o)return i}return-1}function f(t){return t&&"object"==typeof t||!1}function d(t){return 160>=t&&t>=9&&13>=t||32==t||160==t||5760==t||6158==t||t>=8192&&(8202>=t||8232==t||8233==t||8239==t||8287==t||12288==t||65279==t)}function m(t,e){for(var r=-1,n=t.length,i=-1,o=[];++r<n;)t[r]===e&&(t[r]=V,o[++i]=r);return o}function g(t,e){for(var r,n=-1,i=t.length,o=-1,a=[];++n<i;){var s=t[n],h=e?e(s,n,t):s;n&&r===h||(r=h,a[++o]=s)}return a}function y(t){for(var e=-1,r=t.length;++e<r&&d(t.charCodeAt(e)););return e}function v(t){for(var e=t.length;e--&&d(t.charCodeAt(e)););return e}function _(t){return Gt[t]}function x(d){function q(t){if(f(t)&&!ss(t)&&!(t instanceof Bt)){if(t instanceof $)return t;if(ua.call(t,"__chain__")&&ua.call(t,"__wrapped__"))return Vr(t)}return new $(t)}function Q(){}function $(t,e,r){this.__wrapped__=t,this.__actions__=r||[],this.__chain__=!!e}function Bt(t){this.__wrapped__=t,this.__actions__=null,this.__dir__=1,this.__dropCount__=0,this.__filtered__=!1,this.__iteratees__=null,this.__takeCount__=Ba,this.__views__=null}function Vt(){var t=this.__actions__,e=this.__iteratees__,r=this.__views__,n=new Bt(this.__wrapped__);return n.__actions__=t?te(t):null,n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=e?te(e):null,n.__takeCount__=this.__takeCount__,n.__views__=r?te(r):null,n}function Gt(){if(this.__filtered__){var t=new Bt(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function zt(){var t=this.__wrapped__.value();if(!ss(t))return $e(t,this.__actions__);var e=this.__dir__,r=0>e,n=Sr(0,t.length,this.__views__),i=n.start,o=n.end,a=o-i,s=r?o:i-1,h=Da(a,this.__takeCount__),u=this.__iteratees__,c=u?u.length:0,l=0,p=[];t:for(;a--&&h>l;){s+=e;for(var f=-1,d=t[s];++f<c;){var m=u[f],g=m.iteratee,y=m.type;if(y==N){if(m.done&&(r?s>m.index:s<m.index)&&(m.count=0,m.done=!1),m.index=s,!m.done){var v=m.limit;if(!(m.done=v>-1?m.count++>=v:!g(d)))continue t}}else{var _=g(d);if(y==U)d=_;else if(!_){if(y==I)continue t;break t}}}p[l++]=d}return p}function Ht(){this.__data__={}}function jt(t){return this.has(t)&&delete this.__data__[t]}function Wt(t){return"__proto__"==t?b:this.__data__[t]}function Xt(t){return"__proto__"!=t&&ua.call(this.__data__,t)}function qt(t,e){return"__proto__"!=t&&(this.__data__[t]=e),this}function Qt(t){var e=t?t.length:0;for(this.data={hash:Ra(null),set:new wa};e--;)this.push(t[e])}function Jt(t,e){var r=t.data,n="string"==typeof e||Li(e)?r.set.has(e):r.hash[e];return n?0:-1}function $t(t){var e=this.data;"string"==typeof t||Li(t)?e.set.add(t):e.hash[t]=!0}function te(t,e){var r=-1,n=t.length;for(e||(e=Xo(n));++r<n;)e[r]=t[r];return e}function ee(t,e){for(var r=-1,n=t.length;++r<n&&e(t[r],r,t)!==!1;);return t}function re(t,e){for(var r=t.length;r--&&e(t[r],r,t)!==!1;);return t}function ne(t,e){for(var r=-1,n=t.length;++r<n;)if(!e(t[r],r,t))return!1;return!0}function ie(t,e){for(var r=-1,n=t.length,i=-1,o=[];++r<n;){var a=t[r];e(a,r,t)&&(o[++i]=a)}return o}function oe(t,e){for(var r=-1,n=t.length,i=Xo(n);++r<n;)i[r]=e(t[r],r,t);return i}function ae(t){for(var e=-1,r=t.length,n=Ua;++e<r;){var i=t[e];i>n&&(n=i)}return n}function se(t){for(var e=-1,r=t.length,n=Ba;++e<r;){var i=t[e];n>i&&(n=i)}return n}function he(t,e,r,n){var i=-1,o=t.length;for(n&&o&&(r=t[++i]);++i<o;)r=e(r,t[i],i,t);return r}function ue(t,e,r,n){var i=t.length;for(n&&i&&(r=t[--i]);i--;)r=e(r,t[i],i,t);return r}function ce(t,e){for(var r=-1,n=t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function le(t,e){return"undefined"==typeof t?e:t}function pe(t,e,r,n){return"undefined"!=typeof t&&ua.call(n,r)?t:e}function fe(t,e,r){var n=ps(e);if(!r)return me(e,t,n);for(var i=-1,o=n.length;++i<o;){var a=n[i],s=t[a],h=r(s,e[a],a,t,e);(h===h?h===s:s!==s)&&("undefined"!=typeof s||a in t)||(t[a]=h)}return t}function de(t,e){for(var r=-1,n=t.length,i=Pr(n),o=e.length,a=Xo(o);++r<o;){var s=e[r];i?(s=parseFloat(s),a[r]=Ar(s,n)?t[s]:b):a[r]=t[s]}return a}function me(t,e,r){r||(r=e,e={});for(var n=-1,i=r.length;++n<i;){var o=r[n];e[o]=t[o]}return e}function ge(t,e){for(var r=-1,n=e.length;++r<n;){var i=e[r];t[i]=gr(t[i],S,t)}return t}function ye(t,e,r){var n=typeof t;return"function"==n?"undefined"!=typeof e&&Cr(t)?rr(t,e,r):t:null==t?Do:"object"==n?Be(t):"undefined"==typeof e?He(t+""):Ve(t+"",e)}function ve(t,e,r,n,i,o,a){var s;if(r&&(s=i?r(t,n,i):r(t)),"undefined"!=typeof s)return s;if(!Li(t))return t;var h=ss(t);if(h){if(s=Mr(t),!e)return te(t,s)}else{var u=la.call(t),c=u==X;if(u!=Z&&u!=G&&(!c||i))return It[u]?Er(t,u,e):i?t:{};if(Zt(t))return i?t:{};if(s=Tr(c?{}:t),!e)return me(t,s,ps(t))}o||(o=[]),a||(a=[]);for(var l=o.length;l--;)if(o[l]==t)return a[l];return o.push(t),a.push(s),(h?ee:Le)(t,function(n,i){s[i]=ve(n,e,r,i,t,o,a)}),s}function _e(t,e,r,n){if("function"!=typeof t)throw new ea(B);return Sa(function(){t.apply(b,qe(r,n))},e)}function xe(t,r){var n=t?t.length:0,i=[];if(!n)return i;var o=-1,a=wr(),s=a==e,h=s&&r.length>=200?Qa(r):null,u=r.length;h&&(a=Jt,s=!1,r=h);t:for(;++o<n;){var c=t[o];if(s&&c===c){for(var l=u;l--;)if(r[l]===c)continue t;i.push(c)}else a(r,c,0)<0&&i.push(c)}return i}function be(t,e){var r=t?t.length:0;if(!Pr(r))return Le(t,e);for(var n=-1,i=Br(t);++n<r&&e(i[n],n,i)!==!1;);return t}function we(t,e){var r=t?t.length:0;if(!Pr(r))return Oe(t,e);for(var n=Br(t);r--&&e(n[r],r,n)!==!1;);return t}function Se(t,e){var r=!0;return be(t,function(t,n,i){return r=!!e(t,n,i)}),r}function Me(t,e,r,n){var i=t.length;for(r=null==r?0:+r||0,0>r&&(r=-r>i?0:i+r),n="undefined"==typeof n||n>i?i:+n||0,0>n&&(n+=i),i=r>n?0:n>>>0,r>>>=0;i>r;)t[r++]=e;return t}function Te(t,e){var r=[];return be(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r}function Ee(t,e,r,n){var i;return r(t,function(t,r,o){return e(t,r,o)?(i=n?r:t,!1):void 0}),i}function Ce(t,e,r,n){for(var i=n-1,o=t.length,a=-1,s=[];++i<o;){var h=t[i];if(f(h)&&Pr(h.length)&&(ss(h)||Mi(h))){e&&(h=Ce(h,e,r,0));var u=-1,c=h.length;
for(s.length+=c;++u<c;)s[++a]=h[u]}else r||(s[++a]=h)}return s}function Ae(t,e,r){for(var n=-1,i=Br(t),o=r(t),a=o.length;++n<a;){var s=o[n];if(e(i[s],s,i)===!1)break}return t}function Re(t,e,r){for(var n=Br(t),i=r(t),o=i.length;o--;){var a=i[o];if(e(n[a],a,n)===!1)break}return t}function Pe(t,e){return Ae(t,e,to)}function Le(t,e){return Ae(t,e,ps)}function Oe(t,e){return Re(t,e,ps)}function De(t,e){for(var r=-1,n=e.length,i=-1,o=[];++r<n;){var a=e[r];us(t[a])&&(o[++i]=a)}return o}function ke(t,e,r){var n=-1,i="function"==typeof e,o=t?t.length:0,a=Pr(o)?Xo(o):[];return be(t,function(t){var o=i?e:null!=t&&t[e];a[++n]=o?o.apply(t,r):b}),a}function Fe(t,e,r,n,i,o){if(t===e)return 0!==t||1/t==1/e;var a=typeof t,s=typeof e;return"function"!=a&&"object"!=a&&"function"!=s&&"object"!=s||null==t||null==e?t!==t&&e!==e:Ne(t,e,Fe,r,n,i,o)}function Ne(t,e,r,n,i,o,a){var s=ss(t),h=ss(e),u=z,c=z;s||(u=la.call(t),u==G?u=Z:u!=Z&&(s=Bi(t))),h||(c=la.call(e),c==G?c=Z:c!=Z&&(h=Bi(e)));var l=u==Z&&!Zt(t),p=c==Z&&!Zt(e),f=u==c;if(f&&!s&&!l)return vr(t,e,u);var d=l&&ua.call(t,"__wrapped__"),m=p&&ua.call(e,"__wrapped__");if(d||m)return r(d?t.value():t,m?e.value():e,n,i,o,a);if(!f)return!1;o||(o=[]),a||(a=[]);for(var g=o.length;g--;)if(o[g]==t)return a[g]==e;o.push(t),a.push(e);var y=(s?yr:_r)(t,e,r,n,i,o,a);return o.pop(),a.pop(),y}function Ie(t,e,r,n,i){var o=e.length;if(null==t)return!o;for(var a=-1,s=!i;++a<o;)if(s&&n[a]?r[a]!==t[e[a]]:!ua.call(t,e[a]))return!1;for(a=-1;++a<o;){var h=e[a];if(s&&n[a])var u=ua.call(t,h);else{var c=t[h],l=r[a];u=i?i(c,l,h):b,"undefined"==typeof u&&(u=Fe(l,c,i,!0))}if(!u)return!1}return!0}function Ue(t,e){var r=[];return be(t,function(t,n,i){r.push(e(t,n,i))}),r}function Be(t){var e=ps(t),r=e.length;if(1==r){var n=e[0],i=t[n];if(Lr(i))return function(t){return null!=t&&t[n]===i&&ua.call(t,n)}}for(var o=Xo(r),a=Xo(r);r--;)i=t[e[r]],o[r]=i,a[r]=Lr(i);return function(t){return Ie(t,e,o,a)}}function Ve(t,e){return Lr(e)?function(r){return null!=r&&r[t]===e}:function(r){return null!=r&&Fe(e,r[t],null,!0)}}function Ge(t,e,r,n,i){if(!Li(t))return t;var o=Pr(e.length)&&(ss(e)||Bi(e));return(o?ee:Le)(e,function(e,a,s){if(f(e))return n||(n=[]),i||(i=[]),ze(t,s,a,Ge,r,n,i);var h=t[a],u=r?r(h,e,a,t,s):b,c="undefined"==typeof u;c&&(u=e),!o&&"undefined"==typeof u||!c&&(u===u?u===h:h!==h)||(t[a]=u)}),t}function ze(t,e,r,n,i,o,a){for(var s=o.length,h=e[r];s--;)if(o[s]==h)return void(t[r]=a[s]);var u=t[r],c=i?i(u,h,r,t,e):b,l="undefined"==typeof c;l&&(c=h,Pr(h.length)&&(ss(h)||Bi(h))?c=ss(u)?u:u?te(u):[]:cs(h)||Mi(h)?c=Mi(u)?zi(u):cs(u)?u:{}:l=!1),o.push(h),a.push(c),l?t[r]=n(c,h,i,o,a):(c===c?c!==u:u===u)&&(t[r]=c)}function He(t){return function(e){return null==e?b:e[t]}}function je(e,r){var n=r.length,i=de(e,r);for(r.sort(t);n--;){var o=parseFloat(r[n]);if(o!=a&&Ar(o)){var a=o;Ma.call(e,o,1)}}return i}function We(t,e){return t+va(Ia()*(e-t+1))}function Xe(t,e,r,n,i){return i(t,function(t,i,o){r=n?(n=!1,t):e(r,t,i,o)}),r}function qe(t,e,r){var n=-1,i=t.length;e=null==e?0:+e||0,0>e&&(e=-e>i?0:i+e),r="undefined"==typeof r||r>i?i:+r||0,0>r&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var o=Xo(i);++n<i;)o[n]=t[n+e];return o}function Ye(t,e){var r;return be(t,function(t,n,i){return r=e(t,n,i),!r}),!!r}function Ze(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}function Ke(t,e,r){var n=-1,i=t.length,o=Pr(i)?Xo(i):[];return be(t,function(t){for(var r=e.length,i=Xo(r);r--;)i[r]=null==t?b:t[e[r]];o[++n]={criteria:i,index:n,value:t}}),Ze(o,function(t,e){return h(t,e,r)})}function Qe(t,r){var n=-1,i=wr(),o=t.length,a=i==e,s=a&&o>=200,h=s?Qa():null,u=[];h?(i=Jt,a=!1):(s=!1,h=r?[]:u);t:for(;++n<o;){var c=t[n],l=r?r(c,n,t):c;if(a&&c===c){for(var p=h.length;p--;)if(h[p]===l)continue t;r&&h.push(l),u.push(c)}else i(h,l,0)<0&&((r||s)&&h.push(l),u.push(c))}return u}function Je(t,e){for(var r=-1,n=e.length,i=Xo(n);++r<n;)i[r]=t[e[r]];return i}function $e(t,e){var r=t;r instanceof Bt&&(r=r.value());for(var n=-1,i=e.length;++n<i;){var o=[r],a=e[n];xa.apply(o,a.args),r=a.func.apply(a.thisArg,o)}return r}function tr(t,e,r){var n=0,i=t?t.length:n;if("number"==typeof e&&e===e&&za>=i){for(;i>n;){var o=n+i>>>1,a=t[o];(r?e>=a:e>a)?n=o+1:i=o}return i}return er(t,e,Do,r)}function er(t,e,r,n){e=r(e);for(var i=0,o=t?t.length:0,a=e!==e,s="undefined"==typeof e;o>i;){var h=va((i+o)/2),u=r(t[h]),c=u===u;if(a)var l=c||n;else l=s?c&&(n||"undefined"!=typeof u):n?e>=u:e>u;l?i=h+1:o=h}return Da(o,Ga)}function rr(t,e,r){if("function"!=typeof t)return Do;if("undefined"==typeof e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 3:return function(r,n,i){return t.call(e,r,n,i)};case 4:return function(r,n,i,o){return t.call(e,r,n,i,o)};case 5:return function(r,n,i,o,a){return t.call(e,r,n,i,o,a)}}return function(){return t.apply(e,arguments)}}function nr(t){return ma.call(t,0)}function ir(t,e,r){for(var n=r.length,i=-1,o=Oa(t.length-n,0),a=-1,s=e.length,h=Xo(o+s);++a<s;)h[a]=e[a];for(;++i<n;)h[r[i]]=t[i];for(;o--;)h[a++]=t[i++];return h}function or(t,e,r){for(var n=-1,i=r.length,o=-1,a=Oa(t.length-i,0),s=-1,h=e.length,u=Xo(a+h);++o<a;)u[o]=t[o];for(var c=o;++s<h;)u[c+s]=e[s];for(;++n<i;)u[c+r[n]]=t[o++];return u}function ar(t,e){return function(r,n,i){var o=e?e():{};if(n=br(n,i,3),ss(r))for(var a=-1,s=r.length;++a<s;){var h=r[a];t(o,h,n(h,a,r),r)}else be(r,function(e,r,i){t(o,e,n(e,r,i),i)});return o}}function sr(t){return function(){var e=arguments,r=e.length,n=e[0];if(2>r||null==n)return n;var i=e[r-2],o=e[r-1],a=e[3];r>3&&"function"==typeof i?(i=rr(i,o,5),r-=2):(i=r>2&&"function"==typeof o?o:null,r-=i?1:0),a&&Rr(e[1],e[2],a)&&(i=3==r?null:i,r=2);for(var s=0;++s<r;){var h=e[s];h&&t(n,h,i)}return n}}function hr(t,e){function r(){var i=this&&this!==Yt&&this instanceof r?n:t;return i.apply(e,arguments)}var n=lr(t);return r}function ur(t){return function(){var e=arguments.length,r=e,n=t?e-1:0;if(!e)return function(){return arguments[0]};for(var i=Xo(e);r--;)if(i[r]=arguments[r],"function"!=typeof i[r])throw new ea(B);return function(){for(var r=n,o=i[r].apply(this,arguments);t?r--:++r<e;)o=i[r].call(this,o);return o}}}function cr(t){return function(e){for(var r=-1,n=Ro(po(e)),i=n.length,o="";++r<i;)o=t(o,n[r],r);return o}}function lr(t){return function(){var e=Za(t.prototype),r=t.apply(e,arguments);return Li(r)?r:e}}function pr(t,e){return function(r,n,o){o&&Rr(r,n,o)&&(n=null);var a=br(),s=null==n;if(a===ye&&s||(s=!1,n=a(n,o,3)),s){var h=ss(r);if(h||!Ui(r))return t(h?r:Ur(r));n=i}return xr(r,n,e)}}function fr(t,e,r,n,i,o,a,s,h,u){function c(){for(var x=arguments.length,b=x,w=Xo(x);b--;)w[b]=arguments[b];if(n&&(w=ir(w,n,i)),o&&(w=or(w,o,a)),d||y){var T=c.placeholder,E=m(w,T);if(x-=E.length,u>x){var C=s?te(s):null,P=Oa(u-x,0),L=d?E:null,O=d?null:E,D=d?w:null,k=d?null:w;e|=d?A:R,e&=~(d?R:A),g||(e&=~(S|M));var F=fr(t,e,r,D,L,k,O,C,h,P);return F.placeholder=T,F}}var N=p?r:this;f&&(t=N[_]),s&&(w=Fr(w,s)),l&&h<w.length&&(w.length=h);var I=this&&this!==Yt&&this instanceof c?v||lr(t):t;return I.apply(N,w)}var l=e&L,p=e&S,f=e&M,d=e&E,g=e&T,y=e&C,v=!f&&lr(t),_=t;return c}function dr(t,e,r){var n=t.length;if(e=+e,n>=e||!Pa(e))return"";var i=e-n;return r=null==r?" ":r+"",bo(r,ga(i/r.length)).slice(0,i)}function mr(t,e,r,n){function i(){for(var e=-1,s=arguments.length,h=-1,u=n.length,c=Xo(s+u);++h<u;)c[h]=n[h];for(;s--;)c[h++]=arguments[++e];var l=this&&this!==Yt&&this instanceof i?a:t;return l.apply(o?r:this,c)}var o=e&S,a=lr(t);return i}function gr(t,e,r,n,i,o,a,s){var h=e&M;if(!h&&"function"!=typeof t)throw new ea(B);var u=n?n.length:0;if(u||(e&=~(A|R),n=i=null),u-=i?i.length:0,e&R){var c=n,l=i;n=i=null}var p=!h&&Ja(t),f=[t,e,r,n,i,c,l,o,a,s];if(p&&p!==!0&&(Or(f,p),e=f[1],s=f[9]),f[9]=null==s?h?0:t.length:Oa(s-u,0)||0,e==S)var d=hr(f[0],f[2]);else d=e!=A&&e!=(S|A)||f[4].length?fr.apply(b,f):mr.apply(b,f);var m=p?Ka:$a;return m(d,f)}function yr(t,e,r,n,i,o,a){var s=-1,h=t.length,u=e.length,c=!0;if(h!=u&&!(i&&u>h))return!1;for(;c&&++s<h;){var l=t[s],p=e[s];if(c=b,n&&(c=i?n(p,l,s):n(l,p,s)),"undefined"==typeof c)if(i)for(var f=u;f--&&(p=e[f],!(c=l&&l===p||r(l,p,n,i,o,a))););else c=l&&l===p||r(l,p,n,i,o,a)}return!!c}function vr(t,e,r){switch(r){case H:case j:return+t==+e;case W:return t.name==e.name&&t.message==e.message;case Y:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case K:case J:return t==e+""}return!1}function _r(t,e,r,n,i,o,a){var s=ps(t),h=s.length,u=ps(e),c=u.length;if(h!=c&&!i)return!1;for(var l,p=-1;++p<h;){var f=s[p],d=ua.call(e,f);if(d){var m=t[f],g=e[f];d=b,n&&(d=i?n(g,m,f):n(m,g,f)),"undefined"==typeof d&&(d=m&&m===g||r(m,g,n,i,o,a))}if(!d)return!1;l||(l="constructor"==f)}if(!l){var y=t.constructor,v=e.constructor;if(y!=v&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof v&&v instanceof v))return!1}return!0}function xr(t,e,r){var n=r?Ba:Ua,i=n,o=i;return be(t,function(t,a,s){var h=e(t,a,s);((r?i>h:h>i)||h===n&&h===o)&&(i=h,o=t)}),o}function br(t,e,r){var n=q.callback||Lo;return n=n===Lo?ye:n,r?n(t,e,r):n}function wr(t,r,n){var i=q.indexOf||tn;return i=i===tn?e:i,t?i(t,r,n):i}function Sr(t,e,r){for(var n=-1,i=r?r.length:0;++n<i;){var o=r[n],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=Da(e,t+a);break;case"takeRight":t=Oa(t,e-a)}}return{start:t,end:e}}function Mr(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&ua.call(t,"index")&&(r.index=t.index,r.input=t.input),r}function Tr(t){var e=t.constructor;return"function"==typeof e&&e instanceof e||(e=Jo),new e}function Er(t,e,r){var n=t.constructor;switch(e){case tt:return nr(t);case H:case j:return new n(+t);case et:case rt:case nt:case it:case ot:case at:case st:case ht:case ut:n instanceof n&&(n=Xa[e]);var i=t.buffer;return new n(r?nr(i):i,t.byteOffset,t.length);case Y:case J:return new n(t);case K:var o=new n(t.source,bt.exec(t));o.lastIndex=t.lastIndex}return o}function Cr(t){var e=q.support,r=!(e.funcNames?t.name:e.funcDecomp);if(!r){var n=sa.call(t);e.funcNames||(r=!wt.test(n)),r||(r=Rt.test(n)||ki(t),Ka(t,r))}return r}function Ar(t,e){return t=+t,e=null==e?ja:e,t>-1&&t%1==0&&e>t}function Rr(t,e,r){if(!Li(r))return!1;var n=typeof e;if("number"==n)var i=r.length,o=Pr(i)&&Ar(e,i);else o="string"==n&&e in r;if(o){var a=r[e];return t===t?t===a:a!==a}return!1}function Pr(t){return"number"==typeof t&&t>-1&&t%1==0&&ja>=t}function Lr(t){return t===t&&(0===t?1/t>0:!Li(t))}function Or(t,e){var r=t[1],n=e[1],i=r|n,o=L|P,a=S|M,s=o|a|T|C,h=r&L&&!(n&L),u=r&P&&!(n&P),c=(u?t:e)[7],l=(h?t:e)[8],p=!(r>=P&&n>a||r>a&&n>=P),f=i>=o&&s>=i&&(P>r||(u||h)&&c.length<=l);if(!p&&!f)return t;n&S&&(t[2]=e[2],i|=r&S?0:T);var d=e[3];if(d){var g=t[3];t[3]=g?ir(g,d,e[4]):te(d),t[4]=g?m(t[3],V):te(e[4])}return d=e[5],d&&(g=t[5],t[5]=g?or(g,d,e[6]):te(d),t[6]=g?m(t[5],V):te(e[6])),d=e[7],d&&(t[7]=te(d)),n&L&&(t[8]=null==t[8]?e[8]:Da(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i,t}function Dr(t,e){t=Br(t);for(var r=-1,n=e.length,i={};++r<n;){var o=e[r];o in t&&(i[o]=t[o])}return i}function kr(t,e){var r={};return Pe(t,function(t,n,i){e(t,n,i)&&(r[n]=t)}),r}function Fr(t,e){for(var r=t.length,n=Da(e.length,r),i=te(t);n--;){var o=e[n];t[n]=Ar(o,r)?i[o]:b}return t}function Nr(t){var e,r=q.support;if(!f(t)||la.call(t)!=Z||Zt(t)||!ua.call(t,"constructor")&&(e=t.constructor,"function"==typeof e&&!(e instanceof e))||!r.argsTag&&Mi(t))return!1;var n;return r.ownLast?(Pe(t,function(t,e,r){return n=ua.call(r,e),!1}),n!==!1):(Pe(t,function(t,e){n=e}),"undefined"==typeof n||ua.call(t,n))}function Ir(t){for(var e=to(t),r=e.length,n=r&&t.length,i=q.support,o=n&&Pr(n)&&(ss(t)||i.nonEnumStrings&&Ui(t)||i.nonEnumArgs&&Mi(t)),a=-1,s=[];++a<r;){var h=e[a];(o&&Ar(h,n)||ua.call(t,h))&&s.push(h)}return s}function Ur(t){return null==t?[]:Pr(t.length)?q.support.unindexedChars&&Ui(t)?t.split(""):Li(t)?t:Jo(t):so(t)}function Br(t){if(q.support.unindexedChars&&Ui(t)){for(var e=-1,r=t.length,n=Jo(t);++e<r;)n[e]=t.charAt(e);return n}return Li(t)?t:Jo(t)}function Vr(t){return t instanceof Bt?t.clone():new $(t.__wrapped__,t.__chain__,te(t.__actions__))}function Gr(t,e,r){e=(r?Rr(t,e,r):null==e)?1:Oa(+e||1,1);for(var n=0,i=t?t.length:0,o=-1,a=Xo(ga(i/e));i>n;)a[++o]=qe(t,n,n+=e);return a}function zr(t){for(var e=-1,r=t?t.length:0,n=-1,i=[];++e<r;){var o=t[e];o&&(i[++n]=o)}return i}function Hr(){for(var t=arguments,e=-1,r=t.length;++e<r;){var n=t[e];if(ss(n)||Mi(n))break}return xe(n,Ce(t,!1,!0,++e))}function jr(t,e,r){var n=t?t.length:0;return n?((r?Rr(t,e,r):null==e)&&(e=1),qe(t,0>e?0:e)):[]}function Wr(t,e,r){var n=t?t.length:0;return n?((r?Rr(t,e,r):null==e)&&(e=1),e=n-(+e||0),qe(t,0,0>e?0:e)):[]}function Xr(t,e,r){var n=t?t.length:0;if(!n)return[];for(e=br(e,r,3);n--&&e(t[n],n,t););return qe(t,0,n+1)}function qr(t,e,r){var n=t?t.length:0;if(!n)return[];var i=-1;for(e=br(e,r,3);++i<n&&e(t[i],i,t););return qe(t,i)}function Yr(t,e,r,n){var i=t?t.length:0;return i?(r&&"number"!=typeof r&&Rr(t,e,r)&&(r=0,n=i),Me(t,e,r,n)):[]}function Zr(t,e,r){var n=-1,i=t?t.length:0;for(e=br(e,r,3);++n<i;)if(e(t[n],n,t))return n;return-1}function Kr(t,e,r){var n=t?t.length:0;for(e=br(e,r,3);n--;)if(e(t[n],n,t))return n;return-1}function Qr(t){return t?t[0]:b}function Jr(t,e,r){var n=t?t.length:0;return r&&Rr(t,e,r)&&(e=!1),n?Ce(t,e,!1,0):[]}function $r(t){var e=t?t.length:0;return e?Ce(t,!0,!1,0):[]}function tn(t,r,n){var i=t?t.length:0;if(!i)return-1;if("number"==typeof n)n=0>n?Oa(i+n,0):n;else if(n){var o=tr(t,r),a=t[o];return(r===r?r===a:a!==a)?o:-1}return e(t,r,n||0)}function en(t){return Wr(t,1)}function rn(){for(var t=[],r=-1,n=arguments.length,i=[],o=wr(),a=o==e;++r<n;){var s=arguments[r];(ss(s)||Mi(s))&&(t.push(s),i.push(a&&s.length>=120?Qa(r&&s):null))}n=t.length;var h=t[0],u=-1,c=h?h.length:0,l=[],p=i[0];t:for(;++u<c;)if(s=h[u],(p?Jt(p,s):o(l,s,0))<0){for(r=n;--r;){var f=i[r];if((f?Jt(f,s):o(t[r],s,0))<0)continue t}p&&p.push(s),l.push(s)}return l}function nn(t){var e=t?t.length:0;return e?t[e-1]:b}function on(t,e,r){var n=t?t.length:0;if(!n)return-1;var i=n;if("number"==typeof r)i=(0>r?Oa(n+r,0):Da(r||0,n-1))+1;else if(r){i=tr(t,e,!0)-1;var o=t[i];return(e===e?e===o:o!==o)?i:-1}if(e!==e)return p(t,i,!0);for(;i--;)if(t[i]===e)return i;return-1}function an(){var t=arguments,e=t[0];if(!e||!e.length)return e;for(var r=0,n=wr(),i=t.length;++r<i;)for(var o=0,a=t[r];(o=n(e,a,o))>-1;)Ma.call(e,o,1);return e}function sn(t){return je(t||[],Ce(arguments,!1,!1,1))}function hn(t,e,r){var n=-1,i=t?t.length:0,o=[];for(e=br(e,r,3);++n<i;){var a=t[n];e(a,n,t)&&(o.push(a),Ma.call(t,n--,1),i--)}return o}function un(t){return jr(t,1)}function cn(t,e,r){var n=t?t.length:0;return n?(r&&"number"!=typeof r&&Rr(t,e,r)&&(e=0,r=n),qe(t,e,r)):[]}function ln(t,e,r,n){var i=br(r);return i===ye&&null==r?tr(t,e):er(t,e,i(r,n,1))}function pn(t,e,r,n){var i=br(r);return i===ye&&null==r?tr(t,e,!0):er(t,e,i(r,n,1),!0)}function fn(t,e,r){var n=t?t.length:0;return n?((r?Rr(t,e,r):null==e)&&(e=1),qe(t,0,0>e?0:e)):[]}function dn(t,e,r){var n=t?t.length:0;return n?((r?Rr(t,e,r):null==e)&&(e=1),e=n-(+e||0),qe(t,0>e?0:e)):[]}function mn(t,e,r){var n=t?t.length:0;if(!n)return[];for(e=br(e,r,3);n--&&e(t[n],n,t););return qe(t,n+1)}function gn(t,e,r){var n=t?t.length:0;if(!n)return[];var i=-1;for(e=br(e,r,3);++i<n&&e(t[i],i,t););return qe(t,0,i)}function yn(){return Qe(Ce(arguments,!1,!0,0))}function vn(t,r,n,i){var o=t?t.length:0;if(!o)return[];null!=r&&"boolean"!=typeof r&&(i=n,n=Rr(t,r,i)?null:r,r=!1);var a=br();return(a!==ye||null!=n)&&(n=a(n,i,3)),r&&wr()==e?g(t,n):Qe(t,n)}function _n(t){for(var e=-1,r=(t&&t.length&&ae(oe(t,ha)))>>>0,n=Xo(r);++e<r;)n[e]=oe(t,He(e));return n}function xn(t){return xe(t,qe(arguments,1))}function bn(){for(var t=-1,e=arguments.length;++t<e;){var r=arguments[t];if(ss(r)||Mi(r))var n=n?xe(n,r).concat(xe(r,n)):r}return n?Qe(n):[]}function wn(){for(var t=arguments.length,e=Xo(t);t--;)e[t]=arguments[t];return _n(e)}function Sn(t,e){var r=-1,n=t?t.length:0,i={};for(!n||e||ss(t[0])||(e=[]);++r<n;){var o=t[r];e?i[o]=e[r]:o&&(i[o[0]]=o[1])}return i}function Mn(t){var e=q(t);return e.__chain__=!0,e}function Tn(t,e,r){return e.call(r,t),t}function En(t,e,r){return e.call(r,t)}function Cn(){return Mn(this)}function An(){return new $(this.value(),this.__chain__)}function Rn(t){for(var e,r=this;r instanceof Q;){var n=Vr(r);e?i.__wrapped__=n:e=n;var i=n;r=r.__wrapped__}return i.__wrapped__=t,e}function Pn(){var t=this.__wrapped__;return t instanceof Bt?(this.__actions__.length&&(t=new Bt(this)),new $(t.reverse(),this.__chain__)):this.thru(function(t){return t.reverse()})}function Ln(){return this.value()+""}function On(){return $e(this.__wrapped__,this.__actions__)}function Dn(t){var e=t?t.length:0;return Pr(e)&&(t=Ur(t)),de(t,Ce(arguments,!1,!1,1))}function kn(t,e,r){var n=ss(t)?ne:Se;return("function"!=typeof e||"undefined"!=typeof r)&&(e=br(e,r,3)),n(t,e)}function Fn(t,e,r){var n=ss(t)?ie:Te;return e=br(e,r,3),n(t,e)}function Nn(t,e,r){if(ss(t)){var n=Zr(t,e,r);return n>-1?t[n]:b}return e=br(e,r,3),Ee(t,e,be)}function In(t,e,r){return e=br(e,r,3),Ee(t,e,we)}function Un(t,e){return Nn(t,Be(e))}function Bn(t,e,r){return"function"==typeof e&&"undefined"==typeof r&&ss(t)?ee(t,e):be(t,rr(e,r,3))}function Vn(t,e,r){return"function"==typeof e&&"undefined"==typeof r&&ss(t)?re(t,e):we(t,rr(e,r,3))}function Gn(t,e,r){var n=t?t.length:0;return Pr(n)||(t=so(t),n=t.length),n?(r="number"==typeof r?0>r?Oa(n+r,0):r||0:0,"string"==typeof t||!ss(t)&&Ui(t)?n>r&&t.indexOf(e,r)>-1:wr(t,e,r)>-1):!1}function zn(t,e){return ke(t,e,qe(arguments,2))}function Hn(t,e,r){var n=ss(t)?oe:Ue;return e=br(e,r,3),n(t,e)}function jn(t,e){return Hn(t,He(e))}function Wn(t,e,r,n){var i=ss(t)?he:Xe;return i(t,br(e,n,4),r,arguments.length<3,be)}function Xn(t,e,r,n){var i=ss(t)?ue:Xe;return i(t,br(e,n,4),r,arguments.length<3,we)}function qn(t,e,r){var n=ss(t)?ie:Te;return e=br(e,r,3),n(t,function(t,r,n){return!e(t,r,n)})}function Yn(t,e,r){if(r?Rr(t,e,r):null==e){t=Ur(t);var n=t.length;return n>0?t[We(0,n-1)]:b}var i=Zn(t);return i.length=Da(0>e?0:+e||0,i.length),i}function Zn(t){t=Ur(t);for(var e=-1,r=t.length,n=Xo(r);++e<r;){var i=We(0,e);e!=i&&(n[e]=n[i]),n[i]=t[e]}return n}function Kn(t){var e=t?t.length:0;return Pr(e)?e:ps(t).length}function Qn(t,e,r){var n=ss(t)?ce:Ye;return("function"!=typeof e||"undefined"!=typeof r)&&(e=br(e,r,3)),n(t,e)}function Jn(t,e,r){if(null==t)return[];var n=-1,i=t.length,o=Pr(i)?Xo(i):[];return r&&Rr(t,e,r)&&(e=null),e=br(e,r,3),be(t,function(t,r,i){o[++n]={criteria:e(t,r,i),index:n,value:t}}),Ze(o,s)}function $n(t){if(null==t)return[];var e=arguments,r=e[3];return r&&Rr(e[1],e[2],r)&&(e=[t,e[1]]),Ke(t,Ce(e,!1,!1,1),[])}function ti(t,e,r,n){return null==t?[]:(n&&Rr(e,r,n)&&(r=null),ss(e)||(e=null==e?[]:[e]),ss(r)||(r=null==r?[]:[r]),Ke(t,e,r))}function ei(t,e){return Fn(t,Be(e))}function ri(t,e){if("function"!=typeof e){if("function"!=typeof t)throw new ea(B);var r=t;t=e,e=r}return t=Pa(t=+t)?t:0,function(){return--t<1?e.apply(this,arguments):void 0}}function ni(t,e,r){return r&&Rr(t,e,r)&&(e=null),e=t&&null==e?t.length:Oa(+e||0,0),gr(t,L,null,null,null,null,e)}function ii(t,e){var r;if("function"!=typeof e){if("function"!=typeof t)throw new ea(B);var n=t;t=e,e=n}return function(){return--t>0?r=e.apply(this,arguments):e=null,r}}function oi(t,e){var r=S;if(arguments.length>2){var n=qe(arguments,2),i=m(n,oi.placeholder);r|=A}return gr(t,r,e,n,i)}function ai(t){return ge(t,arguments.length>1?Ce(arguments,!1,!1,1):Qi(t))}function si(t,e){var r=S|M;if(arguments.length>2){var n=qe(arguments,2),i=m(n,si.placeholder);r|=A}return gr(e,r,t,n,i)}function hi(t,e,r){r&&Rr(t,e,r)&&(e=null);var n=gr(t,E,null,null,null,null,null,e);return n.placeholder=hi.placeholder,n}function ui(t,e,r){r&&Rr(t,e,r)&&(e=null);var n=gr(t,C,null,null,null,null,null,e);return n.placeholder=ui.placeholder,n}function ci(t,e,r){function n(){p&&ya(p),h&&ya(h),h=p=f=b}function i(){var r=e-(is()-c);if(0>=r||r>e){h&&ya(h);var n=f;h=p=f=b,n&&(d=is(),u=t.apply(l,s),p||h||(s=l=null))}else p=Sa(i,r)}function o(){p&&ya(p),h=p=f=b,(g||m!==e)&&(d=is(),u=t.apply(l,s),p||h||(s=l=null))}function a(){if(s=arguments,c=is(),l=this,f=g&&(p||!y),m===!1)var r=y&&!p;else{h||y||(d=c);var n=m-(c-d),a=0>=n||n>m;a?(h&&(h=ya(h)),d=c,u=t.apply(l,s)):h||(h=Sa(o,n))}return a&&p?p=ya(p):p||e===m||(p=Sa(i,e)),r&&(a=!0,u=t.apply(l,s)),!a||p||h||(s=l=null),u}var s,h,u,c,l,p,f,d=0,m=!1,g=!0;if("function"!=typeof t)throw new ea(B);if(e=0>e?0:+e||0,r===!0){var y=!0;g=!1}else Li(r)&&(y=r.leading,m="maxWait"in r&&Oa(+r.maxWait||0,e),g="trailing"in r?r.trailing:g);return a.cancel=n,a}function li(t){return _e(t,1,arguments,1)}function pi(t,e){return _e(t,e,arguments,2)}function fi(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new ea(B);var r=function(){var n=arguments,i=r.cache,o=e?e.apply(this,n):n[0];if(i.has(o))return i.get(o);var a=t.apply(this,n);return i.set(o,a),a};return r.cache=new fi.Cache,r}function di(t){if("function"!=typeof t)throw new ea(B);return function(){return!t.apply(this,arguments)}}function mi(t){return ii(t,2)}function gi(t){var e=qe(arguments,1),r=m(e,gi.placeholder);return gr(t,A,null,e,r)}function yi(t){var e=qe(arguments,1),r=m(e,yi.placeholder);return gr(t,R,null,e,r)}function vi(t){var e=Ce(arguments,!1,!1,1);return gr(t,P,null,null,null,e)}function _i(t){if("function"!=typeof t)throw new ea(B);return function(e){return t.apply(this,e)}}function xi(t,e,r){var n=!0,i=!0;if("function"!=typeof t)throw new ea(B);return r===!1?n=!1:Li(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),Ut.leading=n,Ut.maxWait=+e,Ut.trailing=i,ci(t,e,Ut)}function bi(t,e){return e=null==e?Do:e,gr(e,A,null,[t],[])}function wi(t,e,r,n){return e&&"boolean"!=typeof e&&Rr(t,e,r)?e=!1:"function"==typeof e&&(n=r,r=e,e=!1),r="function"==typeof r&&rr(r,n,1),ve(t,e,r)}function Si(t,e,r){return e="function"==typeof e&&rr(e,r,1),ve(t,!0,e)}function Mi(t){var e=f(t)?t.length:b;return Pr(e)&&la.call(t)==G||!1}function Ti(t){return t===!0||t===!1||f(t)&&la.call(t)==H||!1}function Ei(t){return f(t)&&la.call(t)==j||!1}function Ci(t){return t&&1===t.nodeType&&f(t)&&(q.support.nodeTag?la.call(t).indexOf("Element")>-1:Zt(t))||!1}function Ai(t){if(null==t)return!0;var e=t.length;return Pr(e)&&(ss(t)||Ui(t)||Mi(t)||f(t)&&us(t.splice))?!e:!ps(t).length}function Ri(t,e,r,n){if(r="function"==typeof r&&rr(r,n,3),!r&&Lr(t)&&Lr(e))return t===e;var i=r?r(t,e):b;return"undefined"==typeof i?Fe(t,e,r):!!i}function Pi(t){return f(t)&&"string"==typeof t.message&&la.call(t)==W||!1}function Li(t){var e=typeof t;return"function"==e||t&&"object"==e||!1}function Oi(t,e,r,n){var i=ps(e),o=i.length;if(r="function"==typeof r&&rr(r,n,3),!r&&1==o){var a=i[0],s=e[a];if(Lr(s))return null!=t&&s===t[a]&&ua.call(t,a)}for(var h=Xo(o),u=Xo(o);o--;)s=h[o]=e[i[o]],u[o]=Lr(s);return Ie(t,i,h,u,r)}function Di(t){return Ni(t)&&t!=+t}function ki(t){return null==t?!1:la.call(t)==X?fa.test(sa.call(t)):f(t)&&(Zt(t)?fa:Mt).test(t)||!1}function Fi(t){return null===t}function Ni(t){return"number"==typeof t||f(t)&&la.call(t)==Y||!1}function Ii(t){return Li(t)&&la.call(t)==K||!1}function Ui(t){return"string"==typeof t||f(t)&&la.call(t)==J||!1}function Bi(t){return f(t)&&Pr(t.length)&&Nt[la.call(t)]||!1}function Vi(t){return"undefined"==typeof t}function Gi(t){var e=t?t.length:0;return Pr(e)?e?q.support.unindexedChars&&Ui(t)?t.split(""):te(t):[]:so(t)}function zi(t){return me(t,to(t))}function Hi(t,e,r){var n=Za(t);return r&&Rr(t,e,r)&&(e=null),e?me(e,n,ps(e)):n}function ji(t){if(null==t)return t;var e=te(arguments);return e.push(le),ls.apply(b,e)}function Wi(t,e,r){return e=br(e,r,3),Ee(t,e,Le,!0)}function Xi(t,e,r){return e=br(e,r,3),Ee(t,e,Oe,!0)}function qi(t,e,r){return("function"!=typeof e||"undefined"!=typeof r)&&(e=rr(e,r,3)),Ae(t,e,to)}function Yi(t,e,r){return e=rr(e,r,3),Re(t,e,to)}function Zi(t,e,r){return("function"!=typeof e||"undefined"!=typeof r)&&(e=rr(e,r,3)),Le(t,e)}function Ki(t,e,r){return e=rr(e,r,3),Re(t,e,ps)}function Qi(t){return De(t,to(t))}function Ji(t,e){return t?ua.call(t,e):!1}function $i(t,e,r){r&&Rr(t,e,r)&&(e=null);for(var n=-1,i=ps(t),o=i.length,a={};++n<o;){var s=i[n],h=t[s];e?ua.call(a,h)?a[h].push(s):a[h]=[s]:a[h]=s}return a}function to(t){if(null==t)return[];Li(t)||(t=Jo(t));var e=t.length,r=q.support;e=e&&Pr(e)&&(ss(t)||r.nonEnumStrings&&Ui(t)||r.nonEnumArgs&&Mi(t))&&e||0;for(var n=t.constructor,i=-1,o=us(n)&&n.prototype||ia,a=o===t,s=Xo(e),h=e>0,u=r.enumErrorProps&&(t===na||t instanceof Yo),c=r.enumPrototypes&&us(t);++i<e;)s[i]=i+"";for(var l in t)c&&"prototype"==l||u&&("message"==l||"name"==l)||h&&Ar(l,e)||"constructor"==l&&(a||!ua.call(t,l))||s.push(l);if(r.nonEnumShadows&&t!==ia){var p=t===oa?J:t===na?W:la.call(t),f=qa[p]||qa[Z];for(p==Z&&(o=ia),e=kt.length;e--;){l=kt[e];var d=f[l];a&&d||(d?!ua.call(t,l):t[l]===o[l])||s.push(l)}}return s}function eo(t,e,r){var n={};return e=br(e,r,3),Le(t,function(t,r,i){n[r]=e(t,r,i)}),n}function ro(t,e,r){if(null==t)return{};if("function"!=typeof e){var n=oe(Ce(arguments,!1,!1,1),ta);return Dr(t,xe(to(t),n))}return e=rr(e,r,3),kr(t,function(t,r,n){return!e(t,r,n)})}function no(t){for(var e=-1,r=ps(t),n=r.length,i=Xo(n);++e<n;){var o=r[e];i[e]=[o,t[o]]}return i}function io(t,e,r){return null==t?{}:"function"==typeof e?kr(t,rr(e,r,3)):Dr(t,Ce(arguments,!1,!1,1))}function oo(t,e,r){var n=null==t?b:t[e];return"undefined"==typeof n&&(n=r),us(n)?n.call(t):n}function ao(t,e,r,n){var i=ss(t)||Bi(t);if(e=br(e,n,4),null==r)if(i||Li(t)){var o=t.constructor;r=i?ss(t)?new o:[]:Za(us(o)&&o.prototype)}else r={};return(i?ee:Le)(t,function(t,n,i){return e(r,t,n,i)}),r}function so(t){return Je(t,ps(t))}function ho(t){return Je(t,to(t))}function uo(t,e,r){return e=+e||0,"undefined"==typeof r?(r=e,e=0):r=+r||0,t>=e&&r>t}function co(t,e,r){r&&Rr(t,e,r)&&(e=r=null);var n=null==t,i=null==e;if(null==r&&(i&&"boolean"==typeof t?(r=t,t=1):"boolean"==typeof e&&(r=e,i=!0)),n&&i&&(e=1,i=!1),t=+t||0,i?(e=t,t=0):e=+e||0,r||t%1||e%1){var o=Ia();return Da(t+o*(e-t+parseFloat("1e-"+((o+"").length-1))),e)}return We(t,e)}function lo(t){return t=n(t),t&&t.charAt(0).toUpperCase()+t.slice(1)}function po(t){return t=n(t),t&&t.replace(Tt,u)}function fo(t,e,r){t=n(t),e+="";var i=t.length;return r="undefined"==typeof r?i:Da(0>r?0:+r||0,i),r-=e.length,r>=0&&t.indexOf(e,r)==r}function mo(t){return t=n(t),t&&gt.test(t)?t.replace(dt,c):t}function go(t){return t=n(t),t&&At.test(t)?t.replace(Ct,"\\$&"):t}function yo(t,e,r){t=n(t),e=+e;var i=t.length;if(i>=e||!Pa(e))return t;var o=(e-i)/2,a=va(o),s=ga(o);return r=dr("",s,r),r.slice(0,a)+t+r}function vo(t,e,r){return t=n(t),t&&dr(t,e,r)+t}function _o(t,e,r){return t=n(t),t&&t+dr(t,e,r)}function xo(t,e,r){return r&&Rr(t,e,r)&&(e=0),Na(t,e)}function bo(t,e){var r="";if(t=n(t),e=+e,1>e||!t||!Pa(e))return r;do e%2&&(r+=t),e=va(e/2),t+=t;while(e);return r}function wo(t,e,r){return t=n(t),r=null==r?0:Da(0>r?0:+r||0,t.length),t.lastIndexOf(e,r)==r}function So(t,e,r){var i=q.templateSettings;r&&Rr(t,e,r)&&(e=r=null),t=n(t),e=fe(fe({},r||e),i,pe);var o,a,s=fe(fe({},e.imports),i.imports,pe),h=ps(s),u=Je(s,h),c=0,p=e.interpolate||Et,f="__p += '",d=$o((e.escape||Et).source+"|"+p.source+"|"+(p===_t?xt:Et).source+"|"+(e.evaluate||Et).source+"|$","g"),m="//# sourceURL="+("sourceURL"in e?e.sourceURL:"lodash.templateSources["+ ++Ft+"]")+"\n";t.replace(d,function(e,r,n,i,s,h){return n||(n=i),f+=t.slice(c,h).replace(Pt,l),r&&(o=!0,f+="' +\n__e("+r+") +\n'"),s&&(a=!0,f+="';\n"+s+";\n__p += '"),n&&(f+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),c=h+e.length,e}),f+="';\n";var g=e.variable;g||(f="with (obj) {\n"+f+"\n}\n"),f=(a?f.replace(ct,""):f).replace(lt,"$1").replace(pt,"$1;"),f="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var y=Po(function(){return Zo(h,m+"return "+f).apply(b,u)});if(y.source=f,Pi(y))throw y;return y}function Mo(t,e,r){var i=t;return(t=n(t))?(r?Rr(i,e,r):null==e)?t.slice(y(t),v(t)+1):(e+="",t.slice(o(t,e),a(t,e)+1)):t}function To(t,e,r){var i=t;return t=n(t),t?(r?Rr(i,e,r):null==e)?t.slice(y(t)):t.slice(o(t,e+"")):t}function Eo(t,e,r){var i=t;return t=n(t),t?(r?Rr(i,e,r):null==e)?t.slice(0,v(t)+1):t.slice(0,a(t,e+"")+1):t}function Co(t,e,r){r&&Rr(t,e,r)&&(e=null);var i=O,o=D;if(null!=e)if(Li(e)){var a="separator"in e?e.separator:a;i="length"in e?+e.length||0:i,o="omission"in e?n(e.omission):o}else i=+e||0;if(t=n(t),i>=t.length)return t;var s=i-o.length;if(1>s)return o;var h=t.slice(0,s);if(null==a)return h+o;if(Ii(a)){if(t.slice(s).search(a)){var u,c,l=t.slice(0,s);for(a.global||(a=$o(a.source,(bt.exec(a)||"")+"g")),a.lastIndex=0;u=a.exec(l);)c=u.index;h=h.slice(0,null==c?s:c)}}else if(t.indexOf(a,s)!=s){var p=h.lastIndexOf(a);p>-1&&(h=h.slice(0,p))}return h+o}function Ao(t){return t=n(t),t&&mt.test(t)?t.replace(ft,_):t}function Ro(t,e,r){return r&&Rr(t,e,r)&&(e=null),t=n(t),t.match(e||Lt)||[]}function Po(){for(var t=arguments[0],e=arguments.length,r=Xo(e?e-1:0);--e>0;)r[e-1]=arguments[e];try{return t.apply(b,r)}catch(n){return Pi(n)?n:new Yo(n)}}function Lo(t,e,r){return r&&Rr(t,e,r)&&(e=null),f(t)?ko(t):ye(t,e)}function Oo(t){return function(){return t}}function Do(t){return t}function ko(t){return Be(ve(t,!0))}function Fo(t,e){return Ve(t+"",ve(e,!0))}function No(t,e,r){if(null==r){var n=Li(e),i=n&&ps(e),o=i&&i.length&&De(e,i);(o?o.length:n)||(o=!1,r=e,e=t,t=this)}o||(o=De(e,ps(e)));var a=!0,s=-1,h=us(t),u=o.length;r===!1?a=!1:Li(r)&&"chain"in r&&(a=r.chain);for(;++s<u;){var c=o[s],l=e[c];t[c]=l,h&&(t.prototype[c]=function(e){return function(){var r=this.__chain__;if(a||r){var n=t(this.__wrapped__);return(n.__actions__=te(this.__actions__)).push({func:e,args:arguments,thisArg:t}),n.__chain__=r,n}var i=[this.value()];return xa.apply(i,arguments),e.apply(t,i)}}(l))}return t}function Io(){return d._=pa,this}function Uo(){}function Bo(t){return He(t+"")}function Vo(t){return function(e){return null==t?b:t[e]}}function Go(t,e,r){r&&Rr(t,e,r)&&(e=r=null),t=+t||0,r=null==r?1:+r||0,null==e?(e=t,t=0):e=+e||0;for(var n=-1,i=Oa(ga((e-t)/(r||1)),0),o=Xo(i);++n<i;)o[n]=t,t+=r;return o}function zo(t,e,r){if(t=+t,1>t||!Pa(t))return[];var n=-1,i=Xo(Da(t,Va));for(e=rr(e,r,1);++n<t;)Va>n?i[n]=e(n):e(n);return i}function Ho(t){var e=++ca;return n(t)+e}function jo(t,e){return t+e}function Wo(t){ss(t)||(t=Ur(t));for(var e=t.length,r=0;e--;)r+=+t[e]||0;return r}d=d?Kt.defaults(Yt.Object(),d,Kt.pick(Yt,Dt)):Yt;var Xo=d.Array,qo=d.Date,Yo=d.Error,Zo=d.Function,Ko=d.Math,Qo=d.Number,Jo=d.Object,$o=d.RegExp,ta=d.String,ea=d.TypeError,ra=Xo.prototype,na=Yo.prototype,ia=Jo.prototype,oa=ta.prototype,aa=(aa=d.window)&&aa.document,sa=Zo.prototype.toString,ha=He("length"),ua=ia.hasOwnProperty,ca=0,la=ia.toString,pa=d._,fa=$o("^"+go(la).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),da=ki(da=d.ArrayBuffer)&&da,ma=ki(ma=da&&new da(0).slice)&&ma,ga=Ko.ceil,ya=d.clearTimeout,va=Ko.floor,_a=ki(_a=Jo.getPrototypeOf)&&_a,xa=ra.push,ba=ia.propertyIsEnumerable,wa=ki(wa=d.Set)&&wa,Sa=d.setTimeout,Ma=ra.splice,Ta=ki(Ta=d.Uint8Array)&&Ta,Ea=ki(Ea=d.WeakMap)&&Ea,Ca=function(){try{var t=ki(t=d.Float64Array)&&t,e=new t(new da(10),0,1)&&t}catch(r){}return e}(),Aa=ki(Aa=Xo.isArray)&&Aa,Ra=ki(Ra=Jo.create)&&Ra,Pa=d.isFinite,La=ki(La=Jo.keys)&&La,Oa=Ko.max,Da=Ko.min,ka=ki(ka=qo.now)&&ka,Fa=ki(Fa=Qo.isFinite)&&Fa,Na=d.parseInt,Ia=Ko.random,Ua=Qo.NEGATIVE_INFINITY,Ba=Qo.POSITIVE_INFINITY,Va=Ko.pow(2,32)-1,Ga=Va-1,za=Va>>>1,Ha=Ca?Ca.BYTES_PER_ELEMENT:0,ja=Ko.pow(2,53)-1,Wa=Ea&&new Ea,Xa={};Xa[et]=d.Float32Array,Xa[rt]=d.Float64Array,Xa[nt]=d.Int8Array,Xa[it]=d.Int16Array,Xa[ot]=d.Int32Array,Xa[at]=d.Uint8Array,Xa[st]=d.Uint8ClampedArray,Xa[ht]=d.Uint16Array,Xa[ut]=d.Uint32Array;var qa={};qa[z]=qa[j]=qa[Y]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},qa[H]=qa[J]={constructor:!0,toString:!0,valueOf:!0},qa[W]=qa[X]=qa[K]={constructor:!0,toString:!0},qa[Z]={constructor:!0},ee(kt,function(t){for(var e in qa)if(ua.call(qa,e)){
var r=qa[e];r[t]=ua.call(r,t)}});var Ya=q.support={};!function(t){var e=function(){this.x=1},r={0:1,length:1},n=[];e.prototype={valueOf:1,y:1};for(var i in new e)n.push(i);Ya.argsTag=la.call(arguments)==G,Ya.enumErrorProps=ba.call(na,"message")||ba.call(na,"name"),Ya.enumPrototypes=ba.call(e,"prototype"),Ya.funcDecomp=!ki(d.WinRTError)&&Rt.test(x),Ya.funcNames="string"==typeof Zo.name,Ya.nodeTag=la.call(aa)!=Z,Ya.nonEnumStrings=!ba.call("x",0),Ya.nonEnumShadows=!/valueOf/.test(n),Ya.ownLast="x"!=n[0],Ya.spliceObjects=(Ma.call(r,0,1),!r[0]),Ya.unindexedChars="x"[0]+Jo("x")[0]!="xx";try{Ya.dom=11===aa.createDocumentFragment().nodeType}catch(o){Ya.dom=!1}try{Ya.nonEnumArgs=!ba.call(arguments,1)}catch(o){Ya.nonEnumArgs=!0}}(0,0),q.templateSettings={escape:yt,evaluate:vt,interpolate:_t,variable:"",imports:{_:q}};var Za=function(){function t(){}return function(e){if(Li(e)){t.prototype=e;var r=new t;t.prototype=null}return r||d.Object()}}(),Ka=Wa?function(t,e){return Wa.set(t,e),t}:Do;ma||(nr=da&&Ta?function(t){var e=t.byteLength,r=Ca?va(e/Ha):0,n=r*Ha,i=new da(e);if(r){var o=new Ca(i,0,r);o.set(new Ca(t,0,r))}return e!=n&&(o=new Ta(i,n),o.set(new Ta(t,n))),i}:Oo(null));var Qa=Ra&&wa?function(t){return new Qt(t)}:Oo(null),Ja=Wa?function(t){return Wa.get(t)}:Uo,$a=function(){var t=0,e=0;return function(r,n){var i=is(),o=F-(i-e);if(e=i,o>0){if(++t>=k)return r}else t=0;return Ka(r,n)}}(),ts=ar(function(t,e,r){ua.call(t,r)?++t[r]:t[r]=1}),es=ar(function(t,e,r){ua.call(t,r)?t[r].push(e):t[r]=[e]}),rs=ar(function(t,e,r){t[r]=e}),ns=ar(function(t,e,r){t[r?0:1].push(e)},function(){return[[],[]]}),is=ka||function(){return(new qo).getTime()},os=ur(),as=ur(!0);Ya.argsTag||(Mi=function(t){var e=f(t)?t.length:b;return Pr(e)&&ua.call(t,"callee")&&!ba.call(t,"callee")||!1});var ss=Aa||function(t){return f(t)&&Pr(t.length)&&la.call(t)==z||!1};Ya.dom||(Ci=function(t){return t&&1===t.nodeType&&f(t)&&!cs(t)||!1});var hs=Fa||function(t){return"number"==typeof t&&Pa(t)},us=r(/x/)||Ta&&!r(Ta)?function(t){return la.call(t)==X}:r,cs=_a?function(t){if(!t||la.call(t)!=Z||!q.support.argsTag&&Mi(t))return!1;var e=t.valueOf,r=ki(e)&&(r=_a(e))&&_a(r);return r?t==r||_a(t)==r:Nr(t)}:Nr,ls=sr(fe),ps=La?function(t){if(t)var e=t.constructor,r=t.length;return"function"==typeof e&&e.prototype===t||("function"==typeof t?q.support.enumPrototypes:r&&Pr(r))?Ir(t):Li(t)?La(t):[]}:Ir,fs=sr(Ge),ds=cr(function(t,e,r){return e=e.toLowerCase(),t+(r?e.charAt(0).toUpperCase()+e.slice(1):e)}),ms=cr(function(t,e,r){return t+(r?"-":"")+e.toLowerCase()});8!=Na(Ot+"08")&&(xo=function(t,e,r){return(r?Rr(t,e,r):null==e)?e=0:e&&(e=+e),t=Mo(t),Na(t,e||(St.test(t)?16:10))});var gs=cr(function(t,e,r){return t+(r?"_":"")+e.toLowerCase()}),ys=cr(function(t,e,r){return t+(r?" ":"")+(e.charAt(0).toUpperCase()+e.slice(1))}),vs=pr(ae),_s=pr(se,!0);return q.prototype=Q.prototype,$.prototype=Za(Q.prototype),$.prototype.constructor=$,Bt.prototype=Za(Q.prototype),Bt.prototype.constructor=Bt,Ht.prototype["delete"]=jt,Ht.prototype.get=Wt,Ht.prototype.has=Xt,Ht.prototype.set=qt,Qt.prototype.push=$t,fi.Cache=Ht,q.after=ri,q.ary=ni,q.assign=ls,q.at=Dn,q.before=ii,q.bind=oi,q.bindAll=ai,q.bindKey=si,q.callback=Lo,q.chain=Mn,q.chunk=Gr,q.compact=zr,q.constant=Oo,q.countBy=ts,q.create=Hi,q.curry=hi,q.curryRight=ui,q.debounce=ci,q.defaults=ji,q.defer=li,q.delay=pi,q.difference=Hr,q.drop=jr,q.dropRight=Wr,q.dropRightWhile=Xr,q.dropWhile=qr,q.fill=Yr,q.filter=Fn,q.flatten=Jr,q.flattenDeep=$r,q.flow=os,q.flowRight=as,q.forEach=Bn,q.forEachRight=Vn,q.forIn=qi,q.forInRight=Yi,q.forOwn=Zi,q.forOwnRight=Ki,q.functions=Qi,q.groupBy=es,q.indexBy=rs,q.initial=en,q.intersection=rn,q.invert=$i,q.invoke=zn,q.keys=ps,q.keysIn=to,q.map=Hn,q.mapValues=eo,q.matches=ko,q.matchesProperty=Fo,q.memoize=fi,q.merge=fs,q.mixin=No,q.negate=di,q.omit=ro,q.once=mi,q.pairs=no,q.partial=gi,q.partialRight=yi,q.partition=ns,q.pick=io,q.pluck=jn,q.property=Bo,q.propertyOf=Vo,q.pull=an,q.pullAt=sn,q.range=Go,q.rearg=vi,q.reject=qn,q.remove=hn,q.rest=un,q.shuffle=Zn,q.slice=cn,q.sortBy=Jn,q.sortByAll=$n,q.sortByOrder=ti,q.spread=_i,q.take=fn,q.takeRight=dn,q.takeRightWhile=mn,q.takeWhile=gn,q.tap=Tn,q.throttle=xi,q.thru=En,q.times=zo,q.toArray=Gi,q.toPlainObject=zi,q.transform=ao,q.union=yn,q.uniq=vn,q.unzip=_n,q.values=so,q.valuesIn=ho,q.where=ei,q.without=xn,q.wrap=bi,q.xor=bn,q.zip=wn,q.zipObject=Sn,q.backflow=as,q.collect=Hn,q.compose=as,q.each=Bn,q.eachRight=Vn,q.extend=ls,q.iteratee=Lo,q.methods=Qi,q.object=Sn,q.select=Fn,q.tail=un,q.unique=vn,No(q,q),q.add=jo,q.attempt=Po,q.camelCase=ds,q.capitalize=lo,q.clone=wi,q.cloneDeep=Si,q.deburr=po,q.endsWith=fo,q.escape=mo,q.escapeRegExp=go,q.every=kn,q.find=Nn,q.findIndex=Zr,q.findKey=Wi,q.findLast=In,q.findLastIndex=Kr,q.findLastKey=Xi,q.findWhere=Un,q.first=Qr,q.has=Ji,q.identity=Do,q.includes=Gn,q.indexOf=tn,q.inRange=uo,q.isArguments=Mi,q.isArray=ss,q.isBoolean=Ti,q.isDate=Ei,q.isElement=Ci,q.isEmpty=Ai,q.isEqual=Ri,q.isError=Pi,q.isFinite=hs,q.isFunction=us,q.isMatch=Oi,q.isNaN=Di,q.isNative=ki,q.isNull=Fi,q.isNumber=Ni,q.isObject=Li,q.isPlainObject=cs,q.isRegExp=Ii,q.isString=Ui,q.isTypedArray=Bi,q.isUndefined=Vi,q.kebabCase=ms,q.last=nn,q.lastIndexOf=on,q.max=vs,q.min=_s,q.noConflict=Io,q.noop=Uo,q.now=is,q.pad=yo,q.padLeft=vo,q.padRight=_o,q.parseInt=xo,q.random=co,q.reduce=Wn,q.reduceRight=Xn,q.repeat=bo,q.result=oo,q.runInContext=x,q.size=Kn,q.snakeCase=gs,q.some=Qn,q.sortedIndex=ln,q.sortedLastIndex=pn,q.startCase=ys,q.startsWith=wo,q.sum=Wo,q.template=So,q.trim=Mo,q.trimLeft=To,q.trimRight=Eo,q.trunc=Co,q.unescape=Ao,q.uniqueId=Ho,q.words=Ro,q.all=kn,q.any=Qn,q.contains=Gn,q.detect=Nn,q.foldl=Wn,q.foldr=Xn,q.head=Qr,q.include=Gn,q.inject=Wn,No(q,function(){var t={};return Le(q,function(e,r){q.prototype[r]||(t[r]=e)}),t}(),!1),q.sample=Yn,q.prototype.sample=function(t){return this.__chain__||null!=t?this.thru(function(e){return Yn(e,t)}):Yn(this.value())},q.VERSION=w,ee(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){q[t].placeholder=q}),ee(["dropWhile","filter","map","takeWhile"],function(t,e){var r=e!=U,n=e==N;Bt.prototype[t]=function(t,i){var o=this.__filtered__,a=o&&n?new Bt(this):this.clone(),s=a.__iteratees__||(a.__iteratees__=[]);return s.push({done:!1,count:0,index:0,iteratee:br(t,i,1),limit:-1,type:e}),a.__filtered__=o||r,a}}),ee(["drop","take"],function(t,e){var r=t+"While";Bt.prototype[t]=function(r){var n=this.__filtered__,i=n&&!e?this.dropWhile():this.clone();if(r=null==r?1:Oa(va(r)||0,0),n)e?i.__takeCount__=Da(i.__takeCount__,r):nn(i.__iteratees__).limit=r;else{var o=i.__views__||(i.__views__=[]);o.push({size:r,type:t+(i.__dir__<0?"Right":"")})}return i},Bt.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()},Bt.prototype[t+"RightWhile"]=function(t,e){return this.reverse()[r](t,e).reverse()}}),ee(["first","last"],function(t,e){var r="take"+(e?"Right":"");Bt.prototype[t]=function(){return this[r](1).value()[0]}}),ee(["initial","rest"],function(t,e){var r="drop"+(e?"":"Right");Bt.prototype[t]=function(){return this[r](1)}}),ee(["pluck","where"],function(t,e){var r=e?"filter":"map",n=e?Be:He;Bt.prototype[t]=function(t){return this[r](n(t))}}),Bt.prototype.compact=function(){return this.filter(Do)},Bt.prototype.reject=function(t,e){return t=br(t,e,1),this.filter(function(e){return!t(e)})},Bt.prototype.slice=function(t,e){t=null==t?0:+t||0;var r=0>t?this.takeRight(-t):this.drop(t);return"undefined"!=typeof e&&(e=+e||0,r=0>e?r.dropRight(-e):r.take(e-t)),r},Bt.prototype.toArray=function(){return this.drop(0)},Le(Bt.prototype,function(t,e){var r=q[e],n=/^(?:filter|map|reject)|While$/.test(e),i=/^(?:first|last)$/.test(e);q.prototype[e]=function(){var e=arguments,o=(e.length,this.__chain__),a=this.__wrapped__,s=!!this.__actions__.length,h=a instanceof Bt,u=e[0],c=h||ss(a);c&&n&&"function"==typeof u&&1!=u.length&&(h=c=!1);var l=h&&!s;if(i&&!o)return l?t.call(a):r.call(q,this.value());var p=function(t){var n=[t];return xa.apply(n,e),r.apply(q,n)};if(c){var f=l?a:new Bt(this),d=t.apply(f,e);if(!i&&(s||d.__actions__)){var m=d.__actions__||(d.__actions__=[]);m.push({func:En,args:[p],thisArg:q})}return new $(d,o)}return this.thru(p)}}),ee(["concat","join","pop","push","replace","shift","sort","splice","split","unshift"],function(t){var e=(/^(?:replace|split)$/.test(t)?oa:ra)[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=!Ya.spliceObjects&&/^(?:pop|shift|splice)$/.test(t),i=/^(?:join|pop|replace|shift)$/.test(t),o=n?function(){var t=e.apply(this,arguments);return 0===this.length&&delete this[0],t}:e;q.prototype[t]=function(){var t=arguments;return i&&!this.__chain__?o.apply(this.value(),t):this[r](function(e){return o.apply(e,t)})}}),Bt.prototype.clone=Vt,Bt.prototype.reverse=Gt,Bt.prototype.value=zt,q.prototype.chain=Cn,q.prototype.commit=An,q.prototype.plant=Rn,q.prototype.reverse=Pn,q.prototype.toString=Ln,q.prototype.run=q.prototype.toJSON=q.prototype.valueOf=q.prototype.value=On,q.prototype.collect=q.prototype.map,q.prototype.head=q.prototype.first,q.prototype.select=q.prototype.filter,q.prototype.tail=q.prototype.rest,q}var b,w="3.5.0",S=1,M=2,T=4,E=8,C=16,A=32,R=64,P=128,L=256,O=30,D="...",k=150,F=16,N=0,I=1,U=2,B="Expected a function",V="__lodash_placeholder__",G="[object Arguments]",z="[object Array]",H="[object Boolean]",j="[object Date]",W="[object Error]",X="[object Function]",q="[object Map]",Y="[object Number]",Z="[object Object]",K="[object RegExp]",Q="[object Set]",J="[object String]",$="[object WeakMap]",tt="[object ArrayBuffer]",et="[object Float32Array]",rt="[object Float64Array]",nt="[object Int8Array]",it="[object Int16Array]",ot="[object Int32Array]",at="[object Uint8Array]",st="[object Uint8ClampedArray]",ht="[object Uint16Array]",ut="[object Uint32Array]",ct=/\b__p \+= '';/g,lt=/\b(__p \+=) '' \+/g,pt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ft=/&(?:amp|lt|gt|quot|#39|#96);/g,dt=/[&<>"'`]/g,mt=RegExp(ft.source),gt=RegExp(dt.source),yt=/<%-([\s\S]+?)%>/g,vt=/<%([\s\S]+?)%>/g,_t=/<%=([\s\S]+?)%>/g,xt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,bt=/\w*$/,wt=/^\s*function[ \n\r\t]+\w/,St=/^0[xX]/,Mt=/^\[object .+?Constructor\]$/,Tt=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Et=/($^)/,Ct=/[.*+?^${}()|[\]\/\\]/g,At=RegExp(Ct.source),Rt=/\bthis\b/,Pt=/['\n\r\u2028\u2029\\]/g,Lt=function(){var t="[A-Z\\xc0-\\xd6\\xd8-\\xde]",e="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(t+"+(?="+t+e+")|"+t+"?"+e+"|"+t+"+|[0-9]+","g")}(),Ot=" 	\f\ufeff\n\r\u2028\u2029",Dt=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","document","isFinite","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","window","WinRTError"],kt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ft=-1,Nt={};Nt[et]=Nt[rt]=Nt[nt]=Nt[it]=Nt[ot]=Nt[at]=Nt[st]=Nt[ht]=Nt[ut]=!0,Nt[G]=Nt[z]=Nt[tt]=Nt[H]=Nt[j]=Nt[W]=Nt[X]=Nt[q]=Nt[Y]=Nt[Z]=Nt[K]=Nt[Q]=Nt[J]=Nt[$]=!1;var It={};It[G]=It[z]=It[tt]=It[H]=It[j]=It[et]=It[rt]=It[nt]=It[it]=It[ot]=It[Y]=It[Z]=It[K]=It[J]=It[at]=It[st]=It[ht]=It[ut]=!0,It[W]=It[X]=It[q]=It[Q]=It[$]=!1;var Ut={leading:!1,maxWait:0,trailing:!1},Bt={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss"},Vt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Gt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},zt={"function":!0,object:!0},Ht={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},jt=zt[typeof exports]&&exports&&!exports.nodeType&&exports,Wt=zt[typeof module]&&module&&!module.nodeType&&module,Xt=jt&&Wt&&"object"==typeof global&&global,qt=zt[typeof window]&&window,Yt=Xt||qt!==(this&&this.window)&&qt||this,Zt=function(){try{Object({toString:0}+"")}catch(t){return function(){return!1}}return function(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}}(),Kt=x();"function"==typeof define&&"object"==typeof define.amd&&define.amd&&define("lodash",[],function(){return Kt})}.call(this),function(t){define("threejs",[],function(){return function(){var e={REVISION:"72"};return"function"==typeof define&&define.amd?define("three",e):"undefined"!=typeof exports&&"undefined"!=typeof module&&(module.exports=e),(void 0===self.requestAnimationFrame||void 0===self.cancelAnimationFrame)&&!function(){for(var t=0,e=["ms","moz","webkit","o"],r=0;r<e.length&&!self.requestAnimationFrame;++r)self.requestAnimationFrame=self[e[r]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[e[r]+"CancelAnimationFrame"]||self[e[r]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(e){var r=Date.now(),n=Math.max(0,16-(r-t)),i=self.setTimeout(function(){e(r+n)},n);return t=r+n,i}),void 0===self.cancelAnimationFrame&&void 0!==self.clearTimeout&&(self.cancelAnimationFrame=function(t){self.clearTimeout(t)})}(),void 0===Math.sign&&(Math.sign=function(t){return 0>t?-1:t>0?1:+t}),void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}}),e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},e.CullFaceNone=0,e.CullFaceBack=1,e.CullFaceFront=2,e.CullFaceFrontBack=3,e.FrontFaceDirectionCW=0,e.FrontFaceDirectionCCW=1,e.BasicShadowMap=0,e.PCFShadowMap=1,e.PCFSoftShadowMap=2,e.FrontSide=0,e.BackSide=1,e.DoubleSide=2,e.FlatShading=1,e.SmoothShading=2,e.NoColors=0,e.FaceColors=1,e.VertexColors=2,e.NoBlending=0,e.NormalBlending=1,e.AdditiveBlending=2,e.SubtractiveBlending=3,e.MultiplyBlending=4,e.CustomBlending=5,e.AddEquation=100,e.SubtractEquation=101,e.ReverseSubtractEquation=102,e.MinEquation=103,e.MaxEquation=104,e.ZeroFactor=200,e.OneFactor=201,e.SrcColorFactor=202,e.OneMinusSrcColorFactor=203,e.SrcAlphaFactor=204,e.OneMinusSrcAlphaFactor=205,e.DstAlphaFactor=206,e.OneMinusDstAlphaFactor=207,e.DstColorFactor=208,e.OneMinusDstColorFactor=209,e.SrcAlphaSaturateFactor=210,e.NeverDepth=0,e.AlwaysDepth=1,e.LessDepth=2,e.LessEqualDepth=3,e.EqualDepth=4,e.GreaterEqualDepth=5,e.GreaterDepth=6,e.NotEqualDepth=7,e.MultiplyOperation=0,e.MixOperation=1,e.AddOperation=2,e.UVMapping=300,e.CubeReflectionMapping=301,e.CubeRefractionMapping=302,e.EquirectangularReflectionMapping=303,e.EquirectangularRefractionMapping=304,e.SphericalReflectionMapping=305,e.RepeatWrapping=1e3,e.ClampToEdgeWrapping=1001,e.MirroredRepeatWrapping=1002,e.NearestFilter=1003,e.NearestMipMapNearestFilter=1004,e.NearestMipMapLinearFilter=1005,e.LinearFilter=1006,e.LinearMipMapNearestFilter=1007,e.LinearMipMapLinearFilter=1008,e.UnsignedByteType=1009,e.ByteType=1010,e.ShortType=1011,e.UnsignedShortType=1012,e.IntType=1013,e.UnsignedIntType=1014,e.FloatType=1015,e.HalfFloatType=1025,e.UnsignedShort4444Type=1016,e.UnsignedShort5551Type=1017,e.UnsignedShort565Type=1018,e.AlphaFormat=1019,e.RGBFormat=1020,e.RGBAFormat=1021,e.LuminanceFormat=1022,e.LuminanceAlphaFormat=1023,e.RGBEFormat=e.RGBAFormat,e.RGB_S3TC_DXT1_Format=2001,e.RGBA_S3TC_DXT1_Format=2002,e.RGBA_S3TC_DXT3_Format=2003,e.RGBA_S3TC_DXT5_Format=2004,e.RGB_PVRTC_4BPPV1_Format=2100,e.RGB_PVRTC_2BPPV1_Format=2101,e.RGBA_PVRTC_4BPPV1_Format=2102,e.RGBA_PVRTC_2BPPV1_Format=2103,e.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(t,e){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},e.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},e.Color=function(t){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):this.set(t)},e.Color.prototype={constructor:e.Color,r:1,g:1,b:1,set:function(t){return t instanceof e.Color?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,r){return this.r=t,this.g=e,this.b=r,this},setHSL:function(){function t(t,e,r){return 0>r&&(r+=1),r>1&&(r-=1),1/6>r?t+6*(e-t)*r:.5>r?e:2/3>r?t+6*(e-t)*(2/3-r):t}return function(r,n,i){if(r=e.Math.euclideanModulo(r,1),n=e.Math.clamp(n,0,1),i=e.Math.clamp(i,0,1),0===n)this.r=this.g=this.b=i;else{var o=.5>=i?i*(1+n):i+n-i*n,a=2*i-o;this.r=t(a,o,r+1/3),this.g=t(a,o,r),this.b=t(a,o,r-1/3)}return this}}(),setStyle:function(t){var r,n=function(e){var r=parseFloat(e);return 1>r&&console.warn("THREE.Color: Alpha component of color "+t+" will be ignored."),r};if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var i,o=r[1],a=r[2];switch(o){case"rgb":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*$/.exec(a))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*$/.exec(a))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,this;break;case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([0-9]*\.?[0-9]+)\s*$/.exec(a))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,n(i[4]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*([0-9]*\.?[0-9]+)\s*$/.exec(a))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,n(i[4]),this;break;case"hsl":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*$/.exec(a)){var s=parseFloat(i[1]),h=parseInt(i[2],10)/100,u=parseInt(i[3],10)/100;return this.setHSL(s,h,u)}break;case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*([0-9]*\.?[0-9]+)\s*$/.exec(a)){var s=parseFloat(i[1]),h=parseInt(i[2],10)/100,u=parseInt(i[3],10)/100;return n(i[4]),this.setHSL(s,h,u)}}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(t)){var c=r[1],l=c.length;if(3===l)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}if(t&&t.length>0){var c=e.ColorKeywords[t];void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+t)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var r=e>0?1/e:1;return this.r=Math.pow(t.r,r),this.g=Math.pow(t.g,r),this.b=Math.pow(t.b,r),this},convertGammaToLinear:function(){var t=this.r,e=this.g,r=this.b;return this.r=t*t,this.g=e*e,this.b=r*r,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){var e,r,n=t||{h:0,s:0,l:0},i=this.r,o=this.g,a=this.b,s=Math.max(i,o,a),h=Math.min(i,o,a),u=(h+s)/2;if(h===s)e=0,r=0;else{var c=s-h;switch(r=.5>=u?c/(s+h):c/(2-s-h),s){case i:e=(o-a)/c+(a>o?6:0);break;case o:e=(a-i)/c+2;break;case a:e=(i-o)/c+4}e/=6}return n.h=e,n.s=r,n.l=u,n},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,r){var n=this.getHSL();return n.h+=t,n.s+=e,n.l+=r,this.setHSL(n.h,n.s,n.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t){return this.r=t[0],this.g=t[1],this.b=t[2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}},e.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},e.Quaternion=function(t,e,r,n){this._x=t||0,this._y=e||0,this._z=r||0,this._w=void 0!==n?n:1},e.Quaternion.prototype={constructor:e.Quaternion,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,e,r,n){return this._x=t,this._y=e,this._z=r,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,r){if(t instanceof e.Euler==!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=Math.cos(t._x/2),i=Math.cos(t._y/2),o=Math.cos(t._z/2),a=Math.sin(t._x/2),s=Math.sin(t._y/2),h=Math.sin(t._z/2),u=t.order;return"XYZ"===u?(this._x=a*i*o+n*s*h,this._y=n*s*o-a*i*h,this._z=n*i*h+a*s*o,this._w=n*i*o-a*s*h):"YXZ"===u?(this._x=a*i*o+n*s*h,this._y=n*s*o-a*i*h,this._z=n*i*h-a*s*o,this._w=n*i*o+a*s*h):"ZXY"===u?(this._x=a*i*o-n*s*h,this._y=n*s*o+a*i*h,this._z=n*i*h+a*s*o,this._w=n*i*o-a*s*h):"ZYX"===u?(this._x=a*i*o-n*s*h,this._y=n*s*o+a*i*h,this._z=n*i*h-a*s*o,this._w=n*i*o+a*s*h):"YZX"===u?(this._x=a*i*o+n*s*h,this._y=n*s*o+a*i*h,this._z=n*i*h-a*s*o,this._w=n*i*o-a*s*h):"XZY"===u&&(this._x=a*i*o-n*s*h,this._y=n*s*o-a*i*h,this._z=n*i*h+a*s*o,this._w=n*i*o+a*s*h),r!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var r=e/2,n=Math.sin(r);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(r),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,r=t.elements,n=r[0],i=r[4],o=r[8],a=r[1],s=r[5],h=r[9],u=r[2],c=r[6],l=r[10],p=n+s+l;return p>0?(e=.5/Math.sqrt(p+1),this._w=.25/e,this._x=(c-h)*e,this._y=(o-u)*e,this._z=(a-i)*e):n>s&&n>l?(e=2*Math.sqrt(1+n-s-l),this._w=(c-h)/e,this._x=.25*e,this._y=(i+a)/e,this._z=(o+u)/e):s>l?(e=2*Math.sqrt(1+s-n-l),this._w=(o-u)/e,this._x=(i+a)/e,this._y=.25*e,this._z=(h+c)/e):(e=2*Math.sqrt(1+l-n-s),this._w=(a-i)/e,this._x=(o+u)/e,this._y=(h+c)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,r,n=1e-6;return function(i,o){return void 0===t&&(t=new e.Vector3),r=i.dot(o)+1,n>r?(r=0,Math.abs(i.x)>Math.abs(i.z)?t.set(-i.y,i.x,0):t.set(0,-i.z,i.y)):t.crossVectors(i,o),this._x=t.x,this._y=t.y,this._z=t.z,this._w=r,this.normalize(),this}}(),inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,e){var r=t._x,n=t._y,i=t._z,o=t._w,a=e._x,s=e._y,h=e._z,u=e._w;return this._x=r*u+o*a+n*h-i*s,this._y=n*u+o*s+i*a-r*h,this._z=i*u+o*h+r*s-n*a,this._w=o*u-r*a-n*s-i*h,this.onChangeCallback(),this},multiplyVector3:function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var r=this._x,n=this._y,i=this._z,o=this._w,a=o*t._w+r*t._x+n*t._y+i*t._z;if(0>a?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=r,this._y=n,this._z=i,this;var s=Math.acos(a),h=Math.sqrt(1-a*a);if(Math.abs(h)<.001)return this._w=.5*(o+this._w),this._x=.5*(r+this._x),this._y=.5*(n+this._y),this._z=.5*(i+this._z),this;var u=Math.sin((1-e)*s)/h,c=Math.sin(e*s)/h;return this._w=o*u+this._w*c,this._x=r*u+this._x*c,this._y=n*u+this._y*c,this._z=i*u+this._z*c,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},e.Quaternion.slerp=function(t,e,r,n){return r.copy(t).slerp(e,n)},e.Vector2=function(t,e){this.x=t||0,this.y=e||0},e.Vector2.prototype={constructor:e.Vector2,set:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){if(0!==t){var e=1/t;this.x*=e,this.y*=e}else this.x=0,this.y=0;return this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this},clampScalar:function(){var t,r;return function(n,i){return void 0===t&&(t=new e.Vector2,r=new e.Vector2),t.set(n,n),r.set(i,i),this.clamp(t,r)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,r=this.y-t.y;return e*e+r*r},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},
lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,r){return this.subVectors(e,t).multiplyScalar(r).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromAttribute:function(t,e,r){return void 0===r&&(r=0),e=e*t.itemSize+r,this.x=t.array[e],this.y=t.array[e+1],this}},e.Vector3=function(t,e,r){this.x=t||0,this.y=e||0,this.z=r||0},e.Vector3.prototype={constructor:e.Vector3,set:function(t,e,r){return this.x=t,this.y=e,this.z=r,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t;return function(r){return r instanceof e.Euler==!1&&console.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order."),void 0===t&&(t=new e.Quaternion),this.applyQuaternion(t.setFromEuler(r)),this}}(),applyAxisAngle:function(){var t;return function(r,n){return void 0===t&&(t=new e.Quaternion),this.applyQuaternion(t.setFromAxisAngle(r,n)),this}}(),applyMatrix3:function(t){var e=this.x,r=this.y,n=this.z,i=t.elements;return this.x=i[0]*e+i[3]*r+i[6]*n,this.y=i[1]*e+i[4]*r+i[7]*n,this.z=i[2]*e+i[5]*r+i[8]*n,this},applyMatrix4:function(t){var e=this.x,r=this.y,n=this.z,i=t.elements;return this.x=i[0]*e+i[4]*r+i[8]*n+i[12],this.y=i[1]*e+i[5]*r+i[9]*n+i[13],this.z=i[2]*e+i[6]*r+i[10]*n+i[14],this},applyProjection:function(t){var e=this.x,r=this.y,n=this.z,i=t.elements,o=1/(i[3]*e+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*e+i[4]*r+i[8]*n+i[12])*o,this.y=(i[1]*e+i[5]*r+i[9]*n+i[13])*o,this.z=(i[2]*e+i[6]*r+i[10]*n+i[14])*o,this},applyQuaternion:function(t){var e=this.x,r=this.y,n=this.z,i=t.x,o=t.y,a=t.z,s=t.w,h=s*e+o*n-a*r,u=s*r+a*e-i*n,c=s*n+i*r-o*e,l=-i*e-o*r-a*n;return this.x=h*s+l*-i+u*-a-c*-o,this.y=u*s+l*-o+c*-i-h*-a,this.z=c*s+l*-a+h*-o-u*-i,this},project:function(){var t;return function(r){return void 0===t&&(t=new e.Matrix4),t.multiplyMatrices(r.projectionMatrix,t.getInverse(r.matrixWorld)),this.applyProjection(t)}}(),unproject:function(){var t;return function(r){return void 0===t&&(t=new e.Matrix4),t.multiplyMatrices(r.matrixWorld,t.getInverse(r.projectionMatrix)),this.applyProjection(t)}}(),transformDirection:function(t){var e=this.x,r=this.y,n=this.z,i=t.elements;return this.x=i[0]*e+i[4]*r+i[8]*n,this.y=i[1]*e+i[5]*r+i[9]*n,this.z=i[2]*e+i[6]*r+i[10]*n,this.normalize(),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){if(0!==t){var e=1/t;this.x*=e,this.y*=e,this.z*=e}else this.x=0,this.y=0,this.z=0;return this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this.z<t.z?this.z=t.z:this.z>e.z&&(this.z=e.z),this},clampScalar:function(){var t,r;return function(n,i){return void 0===t&&(t=new e.Vector3,r=new e.Vector3),t.set(n,n,n),r.set(i,i,i),this.clamp(t,r)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,r){return this.subVectors(e,t).multiplyScalar(r).add(t),this},cross:function(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var r=this.x,n=this.y,i=this.z;return this.x=n*t.z-i*t.y,this.y=i*t.x-r*t.z,this.z=r*t.y-n*t.x,this},crossVectors:function(t,e){var r=t.x,n=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=n*s-i*a,this.y=i*o-r*s,this.z=r*a-n*o,this},projectOnVector:function(){var t,r;return function(n){return void 0===t&&(t=new e.Vector3),t.copy(n).normalize(),r=this.dot(t),this.copy(t).multiplyScalar(r)}}(),projectOnPlane:function(){var t;return function(r){return void 0===t&&(t=new e.Vector3),t.copy(this).projectOnVector(r),this.sub(t)}}(),reflect:function(){var t;return function(r){return void 0===t&&(t=new e.Vector3),this.sub(t.copy(r).multiplyScalar(2*this.dot(r)))}}(),angleTo:function(t){var r=this.dot(t)/(this.length()*t.length());return Math.acos(e.Math.clamp(r,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,r=this.y-t.y,n=this.z-t.z;return e*e+r*r+n*n},setEulerFromRotationMatrix:function(t,e){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(t,e){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},setFromMatrixPosition:function(t){return this.x=t.elements[12],this.y=t.elements[13],this.z=t.elements[14],this},setFromMatrixScale:function(t){var e=this.set(t.elements[0],t.elements[1],t.elements[2]).length(),r=this.set(t.elements[4],t.elements[5],t.elements[6]).length(),n=this.set(t.elements[8],t.elements[9],t.elements[10]).length();return this.x=e,this.y=r,this.z=n,this},setFromMatrixColumn:function(t,e){var r=4*t,n=e.elements;return this.x=n[r],this.y=n[r+1],this.z=n[r+2],this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromAttribute:function(t,e,r){return void 0===r&&(r=0),e=e*t.itemSize+r,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this}},e.Vector4=function(t,e,r,n){this.x=t||0,this.y=e||0,this.z=r||0,this.w=void 0!==n?n:1},e.Vector4.prototype={constructor:e.Vector4,set:function(t,e,r,n){return this.x=t,this.y=e,this.z=r,this.w=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,r=this.y,n=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*r+o[8]*n+o[12]*i,this.y=o[1]*e+o[5]*r+o[9]*n+o[13]*i,this.z=o[2]*e+o[6]*r+o[10]*n+o[14]*i,this.w=o[3]*e+o[7]*r+o[11]*n+o[15]*i,this},divideScalar:function(t){if(0!==t){var e=1/t;this.x*=e,this.y*=e,this.z*=e,this.w*=e}else this.x=0,this.y=0,this.z=0,this.w=1;return this},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,r,n,i,o=.01,a=.1,s=t.elements,h=s[0],u=s[4],c=s[8],l=s[1],p=s[5],f=s[9],d=s[2],m=s[6],g=s[10];if(Math.abs(u-l)<o&&Math.abs(c-d)<o&&Math.abs(f-m)<o){if(Math.abs(u+l)<a&&Math.abs(c+d)<a&&Math.abs(f+m)<a&&Math.abs(h+p+g-3)<a)return this.set(1,0,0,0),this;e=Math.PI;var y=(h+1)/2,v=(p+1)/2,_=(g+1)/2,x=(u+l)/4,b=(c+d)/4,w=(f+m)/4;return y>v&&y>_?o>y?(r=0,n=.707106781,i=.707106781):(r=Math.sqrt(y),n=x/r,i=b/r):v>_?o>v?(r=.707106781,n=0,i=.707106781):(n=Math.sqrt(v),r=x/n,i=w/n):o>_?(r=.707106781,n=.707106781,i=0):(i=Math.sqrt(_),r=b/i,n=w/i),this.set(r,n,i,e),this}var S=Math.sqrt((m-f)*(m-f)+(c-d)*(c-d)+(l-u)*(l-u));return Math.abs(S)<.001&&(S=1),this.x=(m-f)/S,this.y=(c-d)/S,this.z=(l-u)/S,this.w=Math.acos((h+p+g-1)/2),this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this.w>t.w&&(this.w=t.w),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this.w<t.w&&(this.w=t.w),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this.z<t.z?this.z=t.z:this.z>e.z&&(this.z=e.z),this.w<t.w?this.w=t.w:this.w>e.w&&(this.w=e.w),this},clampScalar:function(){var t,r;return function(n,i){return void 0===t&&(t=new e.Vector4,r=new e.Vector4),t.set(n,n,n,n),r.set(i,i,i,i),this.clamp(t,r)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,r){return this.subVectors(e,t).multiplyScalar(r).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromAttribute:function(t,e,r){return void 0===r&&(r=0),e=e*t.itemSize+r,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this.w=t.array[e+3],this}},e.Euler=function(t,r,n,i){this._x=t||0,this._y=r||0,this._z=n||0,this._order=i||e.Euler.DefaultOrder},e.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],e.Euler.DefaultOrder="XYZ",e.Euler.prototype={constructor:e.Euler,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,r,n){return this._x=t,this._y=e,this._z=r,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,r,n){var i=e.Math.clamp,o=t.elements,a=o[0],s=o[4],h=o[8],u=o[1],c=o[5],l=o[9],p=o[2],f=o[6],d=o[10];return r=r||this._order,"XYZ"===r?(this._y=Math.asin(i(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(-l,d),this._z=Math.atan2(-s,a)):(this._x=Math.atan2(f,c),this._z=0)):"YXZ"===r?(this._x=Math.asin(-i(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(h,d),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-p,a),this._z=0)):"ZXY"===r?(this._x=Math.asin(i(f,-1,1)),Math.abs(f)<.99999?(this._y=Math.atan2(-p,d),this._z=Math.atan2(-s,c)):(this._y=0,this._z=Math.atan2(u,a))):"ZYX"===r?(this._y=Math.asin(-i(p,-1,1)),Math.abs(p)<.99999?(this._x=Math.atan2(f,d),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-s,c))):"YZX"===r?(this._z=Math.asin(i(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-p,a)):(this._x=0,this._y=Math.atan2(h,d))):"XZY"===r?(this._z=Math.asin(-i(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(f,c),this._y=Math.atan2(h,a)):(this._x=Math.atan2(-l,d),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+r),this._order=r,n!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(r,n,i){return void 0===t&&(t=new e.Matrix4),t.makeRotationFromQuaternion(r),this.setFromRotationMatrix(t,n,i),this}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new e.Quaternion;return function(e){t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new e.Vector3(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},e.Line3=function(t,r){this.start=void 0!==t?t:new e.Vector3,this.end=void 0!==r?r:new e.Vector3},e.Line3.prototype={constructor:e.Line3,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},center:function(t){var r=t||new e.Vector3;return r.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){var r=t||new e.Vector3;return r.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,r){var n=r||new e.Vector3;return this.delta(n).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new e.Vector3,r=new e.Vector3;return function(n,i){t.subVectors(n,this.start),r.subVectors(this.end,this.start);var o=r.dot(r),a=r.dot(t),s=a/o;return i&&(s=e.Math.clamp(s,0,1)),s}}(),closestPointToPoint:function(t,r,n){var i=this.closestPointToPointParameter(t,r),o=n||new e.Vector3;return this.delta(o).multiplyScalar(i).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}},e.Box2=function(t,r){this.min=void 0!==t?t:new e.Vector2(1/0,1/0),this.max=void 0!==r?r:new e.Vector2(-(1/0),-(1/0))},e.Box2.prototype={constructor:e.Box2,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,r=t.length;r>e;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new e.Vector2;return function(e,r){var n=t.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-(1/0),this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(t){var r=t||new e.Vector2;return r.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){var r=t||new e.Vector2;return r.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y?!1:!0},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y?!0:!1},getParameter:function(t,r){var n=r||new e.Vector2;return n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(t){return t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y?!1:!0},clampPoint:function(t,r){var n=r||new e.Vector2;return n.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new e.Vector2;return function(e){var r=t.copy(e).clamp(this.min,this.max);return r.sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},e.Box3=function(t,r){this.min=void 0!==t?t:new e.Vector3(1/0,1/0,1/0),this.max=void 0!==r?r:new e.Vector3(-(1/0),-(1/0),-(1/0))},e.Box3.prototype={constructor:e.Box3,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,r=t.length;r>e;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new e.Vector3;return function(e,r){var n=t.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),setFromObject:function(){var t=new e.Vector3;return function(r){var n=this;return r.updateMatrixWorld(!0),this.makeEmpty(),r.traverse(function(r){var i=r.geometry;if(void 0!==i)if(i instanceof e.Geometry)for(var o=i.vertices,a=0,s=o.length;s>a;a++)t.copy(o[a]),t.applyMatrix4(r.matrixWorld),n.expandByPoint(t);else if(i instanceof e.BufferGeometry&&void 0!==i.attributes.position)for(var h=i.attributes.position.array,a=0,s=h.length;s>a;a+=3)t.set(h[a],h[a+1],h[a+2]),t.applyMatrix4(r.matrixWorld),n.expandByPoint(t)}),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-(1/0),this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(t){var r=t||new e.Vector3;return r.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){var r=t||new e.Vector3;return r.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z?!1:!0},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z?!0:!1},getParameter:function(t,r){var n=r||new e.Vector3;return n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(t){return t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z?!1:!0},clampPoint:function(t,r){var n=r||new e.Vector3;return n.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new e.Vector3;return function(e){var r=t.copy(e).clamp(this.min,this.max);return r.sub(e).length()}}(),getBoundingSphere:function(){var t=new e.Vector3;return function(r){var n=r||new e.Sphere;return n.center=this.center(),n.radius=.5*this.size(t).length(),n}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new e.Vector3,new e.Vector3,new e.Vector3,new e.Vector3,new e.Vector3,new e.Vector3,new e.Vector3,new e.Vector3];return function(e){return t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.makeEmpty(),this.setFromPoints(t),this}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},e.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},e.Matrix3.prototype={constructor:e.Matrix3,set:function(t,e,r,n,i,o,a,s,h){var u=this.elements;return u[0]=t,u[3]=e,u[6]=r,u[1]=n,u[4]=i,u[7]=o,u[2]=a,u[5]=s,u[8]=h,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},applyToVector3Array:function(){var t;return function(r,n,i){void 0===t&&(t=new e.Vector3),void 0===n&&(n=0),void 0===i&&(i=r.length);for(var o=0,a=n;i>o;o+=3,a+=3)t.fromArray(r,a),t.applyMatrix3(this),t.toArray(r,a);return r}}(),applyToBuffer:function(){var t;return function(r,n,i){void 0===t&&(t=new e.Vector3),void 0===n&&(n=0),void 0===i&&(i=r.length/r.itemSize);for(var o=0,a=n;i>o;o++,a++)t.x=r.getX(a),t.y=r.getY(a),t.z=r.getZ(a),t.applyMatrix3(this),r.setXYZ(t.x,t.y,t.z);return r}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],a=t[5],s=t[6],h=t[7],u=t[8];return e*o*u-e*a*h-r*i*u+r*a*s+n*i*h-n*o*s},getInverse:function(t,e){var r=t.elements,n=this.elements;n[0]=r[10]*r[5]-r[6]*r[9],n[1]=-r[10]*r[1]+r[2]*r[9],n[2]=r[6]*r[1]-r[2]*r[5],n[3]=-r[10]*r[4]+r[6]*r[8],n[4]=r[10]*r[0]-r[2]*r[8],n[5]=-r[6]*r[0]+r[2]*r[4],n[6]=r[9]*r[4]-r[5]*r[8],n[7]=-r[9]*r[0]+r[1]*r[8],n[8]=r[5]*r[0]-r[1]*r[4];var i=r[0]*n[0]+r[1]*n[3]+r[2]*n[6];if(0===i){var o="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(o);return console.warn(o),this.identity(),this}return this.multiplyScalar(1/i),this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},flattenToArrayOffset:function(t,e){var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t},getNormalMatrix:function(t){return this.getInverse(t).transpose(),this},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}},e.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},e.Matrix4.prototype={constructor:e.Matrix4,set:function(t,e,r,n,i,o,a,s,h,u,c,l,p,f,d,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=r,g[12]=n,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=h,g[6]=u,g[10]=c,g[14]=l,g[3]=p,g[7]=f,g[11]=d,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new e.Matrix4).fromArray(this.elements)},copy:function(t){return this.elements.set(t.elements),this},extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},copyPosition:function(t){var e=this.elements,r=t.elements;return e[12]=r[12],e[13]=r[13],e[14]=r[14],this},extractBasis:function(t,e,r){var n=this.elements;return t.set(n[0],n[1],n[2]),e.set(n[4],n[5],n[6]),r.set(n[8],n[9],n[10]),this},makeBasis:function(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this},extractRotation:function(){var t;return function(r){void 0===t&&(t=new e.Vector3);var n=this.elements,i=r.elements,o=1/t.set(i[0],i[1],i[2]).length(),a=1/t.set(i[4],i[5],i[6]).length(),s=1/t.set(i[8],i[9],i[10]).length();return n[0]=i[0]*o,n[1]=i[1]*o,n[2]=i[2]*o,n[4]=i[4]*a,n[5]=i[5]*a,n[6]=i[6]*a,n[8]=i[8]*s,n[9]=i[9]*s,n[10]=i[10]*s,this}}(),makeRotationFromEuler:function(t){t instanceof e.Euler==!1&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var r=this.elements,n=t.x,i=t.y,o=t.z,a=Math.cos(n),s=Math.sin(n),h=Math.cos(i),u=Math.sin(i),c=Math.cos(o),l=Math.sin(o);if("XYZ"===t.order){var p=a*c,f=a*l,d=s*c,m=s*l;r[0]=h*c,r[4]=-h*l,r[8]=u,r[1]=f+d*u,r[5]=p-m*u,r[9]=-s*h,r[2]=m-p*u,r[6]=d+f*u,r[10]=a*h}else if("YXZ"===t.order){var g=h*c,y=h*l,v=u*c,_=u*l;r[0]=g+_*s,r[4]=v*s-y,r[8]=a*u,r[1]=a*l,r[5]=a*c,r[9]=-s,r[2]=y*s-v,r[6]=_+g*s,r[10]=a*h}else if("ZXY"===t.order){var g=h*c,y=h*l,v=u*c,_=u*l;r[0]=g-_*s,r[4]=-a*l,r[8]=v+y*s,r[1]=y+v*s,r[5]=a*c,r[9]=_-g*s,r[2]=-a*u,r[6]=s,r[10]=a*h}else if("ZYX"===t.order){var p=a*c,f=a*l,d=s*c,m=s*l;r[0]=h*c,r[4]=d*u-f,r[8]=p*u+m,r[1]=h*l,r[5]=m*u+p,r[9]=f*u-d,r[2]=-u,r[6]=s*h,r[10]=a*h}else if("YZX"===t.order){var x=a*h,b=a*u,w=s*h,S=s*u;r[0]=h*c,r[4]=S-x*l,r[8]=w*l+b,r[1]=l,r[5]=a*c,r[9]=-s*c,r[2]=-u*c,r[6]=b*l+w,r[10]=x-S*l}else if("XZY"===t.order){var x=a*h,b=a*u,w=s*h,S=s*u;r[0]=h*c,r[4]=-l,r[8]=u*c,r[1]=x*l+S,r[5]=a*c,r[9]=b*l-w,r[2]=w*l-b,r[6]=s*c,r[10]=S*l+x}return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},makeRotationFromQuaternion:function(t){var e=this.elements,r=t.x,n=t.y,i=t.z,o=t.w,a=r+r,s=n+n,h=i+i,u=r*a,c=r*s,l=r*h,p=n*s,f=n*h,d=i*h,m=o*a,g=o*s,y=o*h;return e[0]=1-(p+d),e[4]=c-y,e[8]=l+g,e[1]=c+y,e[5]=1-(u+d),e[9]=f-m,e[2]=l-g,e[6]=f+m,e[10]=1-(u+p),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t,r,n;return function(i,o,a){void 0===t&&(t=new e.Vector3),void 0===r&&(r=new e.Vector3),void 0===n&&(n=new e.Vector3);var s=this.elements;return n.subVectors(i,o).normalize(),0===n.length()&&(n.z=1),t.crossVectors(a,n).normalize(),0===t.length()&&(n.x+=1e-4,t.crossVectors(a,n).normalize()),r.crossVectors(n,t),s[0]=t.x,s[4]=r.x,s[8]=n.x,s[1]=t.y,s[5]=r.y,s[9]=n.y,s[2]=t.z,s[6]=r.z,s[10]=n.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},multiplyMatrices:function(t,e){var r=t.elements,n=e.elements,i=this.elements,o=r[0],a=r[4],s=r[8],h=r[12],u=r[1],c=r[5],l=r[9],p=r[13],f=r[2],d=r[6],m=r[10],g=r[14],y=r[3],v=r[7],_=r[11],x=r[15],b=n[0],w=n[4],S=n[8],M=n[12],T=n[1],E=n[5],C=n[9],A=n[13],R=n[2],P=n[6],L=n[10],O=n[14],D=n[3],k=n[7],F=n[11],N=n[15];return i[0]=o*b+a*T+s*R+h*D,i[4]=o*w+a*E+s*P+h*k,
i[8]=o*S+a*C+s*L+h*F,i[12]=o*M+a*A+s*O+h*N,i[1]=u*b+c*T+l*R+p*D,i[5]=u*w+c*E+l*P+p*k,i[9]=u*S+c*C+l*L+p*F,i[13]=u*M+c*A+l*O+p*N,i[2]=f*b+d*T+m*R+g*D,i[6]=f*w+d*E+m*P+g*k,i[10]=f*S+d*C+m*L+g*F,i[14]=f*M+d*A+m*O+g*N,i[3]=y*b+v*T+_*R+x*D,i[7]=y*w+v*E+_*P+x*k,i[11]=y*S+v*C+_*L+x*F,i[15]=y*M+v*A+_*O+x*N,this},multiplyToArray:function(t,e,r){var n=this.elements;return this.multiplyMatrices(t,e),r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},applyToVector3Array:function(){var t;return function(r,n,i){void 0===t&&(t=new e.Vector3),void 0===n&&(n=0),void 0===i&&(i=r.length);for(var o=0,a=n;i>o;o+=3,a+=3)t.fromArray(r,a),t.applyMatrix4(this),t.toArray(r,a);return r}}(),applyToBuffer:function(){var t;return function(r,n,i){void 0===t&&(t=new e.Vector3),void 0===n&&(n=0),void 0===i&&(i=r.length/r.itemSize);for(var o=0,a=n;i>o;o++,a++)t.x=r.getX(a),t.y=r.getY(a),t.z=r.getZ(a),t.applyMatrix4(this),r.setXYZ(t.x,t.y,t.z);return r}}(),rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},determinant:function(){var t=this.elements,e=t[0],r=t[4],n=t[8],i=t[12],o=t[1],a=t[5],s=t[9],h=t[13],u=t[2],c=t[6],l=t[10],p=t[14],f=t[3],d=t[7],m=t[11],g=t[15];return f*(+i*s*c-n*h*c-i*a*l+r*h*l+n*a*p-r*s*p)+d*(+e*s*p-e*h*l+i*o*l-n*o*p+n*h*u-i*s*u)+m*(+e*h*c-e*a*p-i*o*c+r*o*p+i*a*u-r*h*u)+g*(-n*a*u-e*s*c+e*a*l+n*o*c-r*o*l+r*s*u)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArrayOffset:function(t,e){var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t},getPosition:function(){var t;return function(){void 0===t&&(t=new e.Vector3),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var r=this.elements;return t.set(r[12],r[13],r[14])}}(),setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var r=this.elements,n=t.elements,i=n[0],o=n[4],a=n[8],s=n[12],h=n[1],u=n[5],c=n[9],l=n[13],p=n[2],f=n[6],d=n[10],m=n[14],g=n[3],y=n[7],v=n[11],_=n[15];r[0]=c*m*y-l*d*y+l*f*v-u*m*v-c*f*_+u*d*_,r[4]=s*d*y-a*m*y-s*f*v+o*m*v+a*f*_-o*d*_,r[8]=a*l*y-s*c*y+s*u*v-o*l*v-a*u*_+o*c*_,r[12]=s*c*f-a*l*f-s*u*d+o*l*d+a*u*m-o*c*m,r[1]=l*d*g-c*m*g-l*p*v+h*m*v+c*p*_-h*d*_,r[5]=a*m*g-s*d*g+s*p*v-i*m*v-a*p*_+i*d*_,r[9]=s*c*g-a*l*g-s*h*v+i*l*v+a*h*_-i*c*_,r[13]=a*l*p-s*c*p+s*h*d-i*l*d-a*h*m+i*c*m,r[2]=u*m*g-l*f*g+l*p*y-h*m*y-u*p*_+h*f*_,r[6]=s*f*g-o*m*g-s*p*y+i*m*y+o*p*_-i*f*_,r[10]=o*l*g-s*u*g+s*h*y-i*l*y-o*h*_+i*u*_,r[14]=s*u*p-o*l*p-s*h*f+i*l*f+o*h*m-i*u*m,r[3]=c*f*g-u*d*g-c*p*y+h*d*y+u*p*v-h*f*v,r[7]=o*d*g-a*f*g+a*p*y-i*d*y-o*p*v+i*f*v,r[11]=a*u*g-o*c*g-a*h*y+i*c*y+o*h*v-i*u*v,r[15]=o*c*p-a*u*p+a*h*f-i*c*f-o*h*d+i*u*d;var x=i*r[0]+h*r[4]+p*r[8]+g*r[12];if(0===x){var b="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(b);return console.warn(b),this.identity(),this}return this.multiplyScalar(1/x),this},translate:function(t){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(t){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(t){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(t){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(t,e){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(t){var e=this.elements,r=t.x,n=t.y,i=t.z;return e[0]*=r,e[4]*=n,e[8]*=i,e[1]*=r,e[5]*=n,e[9]*=i,e[2]*=r,e[6]*=n,e[10]*=i,e[3]*=r,e[7]*=n,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,Math.max(r,n)))},makeTranslation:function(t,e,r){return this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,e,-r,0,0,r,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(e,0,r,0,0,1,0,0,-r,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,0,r,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var r=Math.cos(e),n=Math.sin(e),i=1-r,o=t.x,a=t.y,s=t.z,h=i*o,u=i*a;return this.set(h*o+r,h*a-n*s,h*s+n*a,0,h*a+n*s,u*a+r,u*s-n*o,0,h*s-n*a,u*s+n*o,i*s*s+r,0,0,0,0,1),this},makeScale:function(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this},compose:function(t,e,r){return this.makeRotationFromQuaternion(e),this.scale(r),this.setPosition(t),this},decompose:function(){var t,r;return function(n,i,o){void 0===t&&(t=new e.Vector3),void 0===r&&(r=new e.Matrix4);var a=this.elements,s=t.set(a[0],a[1],a[2]).length(),h=t.set(a[4],a[5],a[6]).length(),u=t.set(a[8],a[9],a[10]).length(),c=this.determinant();0>c&&(s=-s),n.x=a[12],n.y=a[13],n.z=a[14],r.elements.set(this.elements);var l=1/s,p=1/h,f=1/u;return r.elements[0]*=l,r.elements[1]*=l,r.elements[2]*=l,r.elements[4]*=p,r.elements[5]*=p,r.elements[6]*=p,r.elements[8]*=f,r.elements[9]*=f,r.elements[10]*=f,i.setFromRotationMatrix(r),o.x=s,o.y=h,o.z=u,this}}(),makeFrustum:function(t,e,r,n,i,o){var a=this.elements,s=2*i/(e-t),h=2*i/(n-r),u=(e+t)/(e-t),c=(n+r)/(n-r),l=-(o+i)/(o-i),p=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=h,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=l,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(t,r,n,i){var o=n*Math.tan(e.Math.degToRad(.5*t)),a=-o,s=a*r,h=o*r;return this.makeFrustum(s,h,a,o,n,i)},makeOrthographic:function(t,e,r,n,i,o){var a=this.elements,s=e-t,h=r-n,u=o-i,c=(e+t)/s,l=(r+n)/h,p=(o+i)/u;return a[0]=2/s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2/h,a[9]=0,a[13]=-l,a[2]=0,a[6]=0,a[10]=-2/u,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,r=t.elements,n=0;16>n;n++)if(e[n]!==r[n])return!1;return!0},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}},e.Ray=function(t,r){this.origin=void 0!==t?t:new e.Vector3,this.direction=void 0!==r?r:new e.Vector3},e.Ray.prototype={constructor:e.Ray,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,r){var n=r||new e.Vector3;return n.copy(this.direction).multiplyScalar(t).add(this.origin)},recast:function(){var t=new e.Vector3;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,r){var n=r||new e.Vector3;n.subVectors(t,this.origin);var i=n.dot(this.direction);return 0>i?n.copy(this.origin):n.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new e.Vector3;return function(e){var r=t.subVectors(e,this.origin).dot(this.direction);return 0>r?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(r).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new e.Vector3,r=new e.Vector3,n=new e.Vector3;return function(e,i,o,a){t.copy(e).add(i).multiplyScalar(.5),r.copy(i).sub(e).normalize(),n.copy(this.origin).sub(t);var s,h,u,c,l=.5*e.distanceTo(i),p=-this.direction.dot(r),f=n.dot(this.direction),d=-n.dot(r),m=n.lengthSq(),g=Math.abs(1-p*p);if(g>0)if(s=p*d-f,h=p*f-d,c=l*g,s>=0)if(h>=-c)if(c>=h){var y=1/g;s*=y,h*=y,u=s*(s+p*h+2*f)+h*(p*s+h+2*d)+m}else h=l,s=Math.max(0,-(p*h+f)),u=-s*s+h*(h+2*d)+m;else h=-l,s=Math.max(0,-(p*h+f)),u=-s*s+h*(h+2*d)+m;else-c>=h?(s=Math.max(0,-(-p*l+f)),h=s>0?-l:Math.min(Math.max(-l,-d),l),u=-s*s+h*(h+2*d)+m):c>=h?(s=0,h=Math.min(Math.max(-l,-d),l),u=h*(h+2*d)+m):(s=Math.max(0,-(p*l+f)),h=s>0?l:Math.min(Math.max(-l,-d),l),u=-s*s+h*(h+2*d)+m);else h=p>0?-l:l,s=Math.max(0,-(p*h+f)),u=-s*s+h*(h+2*d)+m;return o&&o.copy(this.direction).multiplyScalar(s).add(this.origin),a&&a.copy(r).multiplyScalar(h).add(t),u}}(),isIntersectionSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},intersectSphere:function(){var t=new e.Vector3;return function(e,r){t.subVectors(e.center,this.origin);var n=t.dot(this.direction),i=t.dot(t)-n*n,o=e.radius*e.radius;if(i>o)return null;var a=Math.sqrt(o-i),s=n-a,h=n+a;return 0>s&&0>h?null:0>s?this.at(h,r):this.at(s,r)}}(),isIntersectionPlane:function(t){var e=t.distanceToPoint(this.origin);if(0===e)return!0;var r=t.normal.dot(this.direction);return 0>r*e?!0:!1},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var r=-(this.origin.dot(t.normal)+t.constant)/e;return r>=0?r:null},intersectPlane:function(t,e){var r=this.distanceToPlane(t);return null===r?null:this.at(r,e)},isIntersectionBox:function(){var t=new e.Vector3;return function(e){return null!==this.intersectBox(e,t)}}(),intersectBox:function(t,e){var r,n,i,o,a,s,h=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,l=this.origin;return h>=0?(r=(t.min.x-l.x)*h,n=(t.max.x-l.x)*h):(r=(t.max.x-l.x)*h,n=(t.min.x-l.x)*h),u>=0?(i=(t.min.y-l.y)*u,o=(t.max.y-l.y)*u):(i=(t.max.y-l.y)*u,o=(t.min.y-l.y)*u),r>o||i>n?null:((i>r||r!==r)&&(r=i),(n>o||n!==n)&&(n=o),c>=0?(a=(t.min.z-l.z)*c,s=(t.max.z-l.z)*c):(a=(t.max.z-l.z)*c,s=(t.min.z-l.z)*c),r>s||a>n?null:((a>r||r!==r)&&(r=a),(n>s||n!==n)&&(n=s),0>n?null:this.at(r>=0?r:n,e)))},intersectTriangle:function(){var t=new e.Vector3,r=new e.Vector3,n=new e.Vector3,i=new e.Vector3;return function(e,o,a,s,h){r.subVectors(o,e),n.subVectors(a,e),i.crossVectors(r,n);var u,c=this.direction.dot(i);if(c>0){if(s)return null;u=1}else{if(!(0>c))return null;u=-1,c=-c}t.subVectors(this.origin,e);var l=u*this.direction.dot(n.crossVectors(t,n));if(0>l)return null;var p=u*this.direction.dot(r.cross(t));if(0>p)return null;if(l+p>c)return null;var f=-u*t.dot(i);return 0>f?null:this.at(f/c,h)}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}},e.Sphere=function(t,r){this.center=void 0!==t?t:new e.Vector3,this.radius=void 0!==r?r:0},e.Sphere.prototype={constructor:e.Sphere,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new e.Box3;return function(e,r){var n=this.center;void 0!==r?n.copy(r):t.setFromPoints(e).center(n);for(var i=0,o=0,a=e.length;a>o;o++)i=Math.max(i,n.distanceToSquared(e[o]));return this.radius=Math.sqrt(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},clampPoint:function(t,r){var n=this.center.distanceToSquared(t),i=r||new e.Vector3;return i.copy(t),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(t){var r=t||new e.Box3;return r.set(this.center,this.center),r.expandByScalar(this.radius),r},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}},e.Frustum=function(t,r,n,i,o,a){this.planes=[void 0!==t?t:new e.Plane,void 0!==r?r:new e.Plane,void 0!==n?n:new e.Plane,void 0!==i?i:new e.Plane,void 0!==o?o:new e.Plane,void 0!==a?a:new e.Plane]},e.Frustum.prototype={constructor:e.Frustum,set:function(t,e,r,n,i,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(r),a[3].copy(n),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,r=0;6>r;r++)e[r].copy(t.planes[r]);return this},setFromMatrix:function(t){var e=this.planes,r=t.elements,n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],h=r[5],u=r[6],c=r[7],l=r[8],p=r[9],f=r[10],d=r[11],m=r[12],g=r[13],y=r[14],v=r[15];return e[0].setComponents(a-n,c-s,d-l,v-m).normalize(),e[1].setComponents(a+n,c+s,d+l,v+m).normalize(),e[2].setComponents(a+i,c+h,d+p,v+g).normalize(),e[3].setComponents(a-i,c-h,d-p,v-g).normalize(),e[4].setComponents(a-o,c-u,d-f,v-y).normalize(),e[5].setComponents(a+o,c+u,d+f,v+y).normalize(),this},intersectsObject:function(){var t=new e.Sphere;return function(e){var r=e.geometry;return null===r.boundingSphere&&r.computeBoundingSphere(),t.copy(r.boundingSphere),t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,r=t.center,n=-t.radius,i=0;6>i;i++){var o=e[i].distanceToPoint(r);if(n>o)return!1}return!0},intersectsBox:function(){var t=new e.Vector3,r=new e.Vector3;return function(e){for(var n=this.planes,i=0;6>i;i++){var o=n[i];t.x=o.normal.x>0?e.min.x:e.max.x,r.x=o.normal.x>0?e.max.x:e.min.x,t.y=o.normal.y>0?e.min.y:e.max.y,r.y=o.normal.y>0?e.max.y:e.min.y,t.z=o.normal.z>0?e.min.z:e.max.z,r.z=o.normal.z>0?e.max.z:e.min.z;var a=o.distanceToPoint(t),s=o.distanceToPoint(r);if(0>a&&0>s)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,r=0;6>r;r++)if(e[r].distanceToPoint(t)<0)return!1;return!0}},e.Plane=function(t,r){this.normal=void 0!==t?t:new e.Vector3(1,0,0),this.constant=void 0!==r?r:0},e.Plane.prototype={constructor:e.Plane,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,r,n){return this.normal.set(t,e,r),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new e.Vector3,r=new e.Vector3;return function(e,n,i){var o=t.subVectors(i,n).cross(r.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,e),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,r){var n=this.distanceToPoint(t),i=r||new e.Vector3;return i.copy(this.normal).multiplyScalar(n)},isIntersectionLine:function(t){var e=this.distanceToPoint(t.start),r=this.distanceToPoint(t.end);return 0>e&&r>0||0>r&&e>0},intersectLine:function(){var t=new e.Vector3;return function(r,n){var i=n||new e.Vector3,o=r.delta(t),a=this.normal.dot(o);if(0===a)return 0===this.distanceToPoint(r.start)?i.copy(r.start):void 0;var s=-(r.start.dot(this.normal)+this.constant)/a;return 0>s||s>1?void 0:i.copy(o).multiplyScalar(s).add(r.start)}}(),coplanarPoint:function(t){var r=t||new e.Vector3;return r.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new e.Vector3,r=new e.Vector3,n=new e.Matrix3;return function(e,i){var o=i||n.getNormalMatrix(e),a=t.copy(this.normal).applyMatrix3(o),s=this.coplanarPoint(r);return s.applyMatrix4(e),this.setFromNormalAndCoplanarPoint(a,s),this}}(),translate:function(t){return this.constant=this.constant-t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}},e.Math={generateUUID:function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=new Array(36),n=0;return function(){for(var i=0;36>i;i++)8===i||13===i||18===i||23===i?r[i]="-":14===i?r[i]="4":(2>=n&&(n=33554432+16777216*Math.random()|0),t=15&n,n>>=4,r[i]=e[19===i?3&t|8:t]);return r.join("")}}(),clamp:function(t,e,r){return e>t?e:t>r?r:t},clampBottom:function(t,e){return e>t?e:t},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,r,n,i){return n+(t-e)*(i-n)/(r-e)},smoothstep:function(t,e,r){return e>=t?0:t>=r?1:(t=(t-e)/(r-e),t*t*(3-2*t))},smootherstep:function(t,e,r){return e>=t?0:t>=r?1:(t=(t-e)/(r-e),t*t*t*(t*(6*t-15)+10))},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(){var t=Math.PI/180;return function(e){return e*t}}(),radToDeg:function(){var t=180/Math.PI;return function(e){return e*t}}(),isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}},e.Spline=function(t){function r(t,e,r,n,i,o,a){var s=.5*(r-t),h=.5*(n-e);return(2*(e-r)+s+h)*a+(-3*(e-r)-2*s-h)*o+s*i+e}this.points=t;var n,i,o,a,s,h,u,c,l,p=[],f={x:0,y:0,z:0};this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return n=(this.points.length-1)*t,i=Math.floor(n),o=n-i,p[0]=0===i?i:i-1,p[1]=i,p[2]=i>this.points.length-2?this.points.length-1:i+1,p[3]=i>this.points.length-3?this.points.length-1:i+2,h=this.points[p[0]],u=this.points[p[1]],c=this.points[p[2]],l=this.points[p[3]],a=o*o,s=o*a,f.x=r(h.x,u.x,c.x,l.x,o,a,s),f.y=r(h.y,u.y,c.y,l.y,o,a,s),f.z=r(h.z,u.z,c.z,l.z,o,a,s),f},this.getControlPointsArray=function(){var t,e,r=this.points.length,n=[];for(t=0;r>t;t++)e=this.points[t],n[t]=[e.x,e.y,e.z];return n},this.getLength=function(t){var r,n,i,o,a=0,s=0,h=0,u=new e.Vector3,c=new e.Vector3,l=[],p=0;for(l[0]=0,t||(t=100),i=this.points.length*t,u.copy(this.points[0]),r=1;i>r;r++)n=r/i,o=this.getPoint(n),c.copy(o),p+=c.distanceTo(u),u.copy(o),a=(this.points.length-1)*n,s=Math.floor(a),s!==h&&(l[s]=p,h=s);return l[l.length]=p,{chunks:l,total:p}},this.reparametrizeByArcLength=function(t){var r,n,i,o,a,s,h,u,c=[],l=new e.Vector3,p=this.getLength();for(c.push(l.copy(this.points[0]).clone()),r=1;r<this.points.length;r++){for(s=p.chunks[r]-p.chunks[r-1],h=Math.ceil(t*s/p.total),o=(r-1)/(this.points.length-1),a=r/(this.points.length-1),n=1;h-1>n;n++)i=o+n*(1/h)*(a-o),u=this.getPoint(i),c.push(l.copy(u).clone());c.push(l.copy(this.points[r]).clone())}this.points=c}},e.Triangle=function(t,r,n){this.a=void 0!==t?t:new e.Vector3,this.b=void 0!==r?r:new e.Vector3,this.c=void 0!==n?n:new e.Vector3},e.Triangle.normal=function(){var t=new e.Vector3;return function(r,n,i,o){var a=o||new e.Vector3;a.subVectors(i,n),t.subVectors(r,n),a.cross(t);var s=a.lengthSq();return s>0?a.multiplyScalar(1/Math.sqrt(s)):a.set(0,0,0)}}(),e.Triangle.barycoordFromPoint=function(){var t=new e.Vector3,r=new e.Vector3,n=new e.Vector3;return function(i,o,a,s,h){t.subVectors(s,o),r.subVectors(a,o),n.subVectors(i,o);var u=t.dot(t),c=t.dot(r),l=t.dot(n),p=r.dot(r),f=r.dot(n),d=u*p-c*c,m=h||new e.Vector3;if(0===d)return m.set(-2,-1,-1);var g=1/d,y=(p*l-c*f)*g,v=(u*f-c*l)*g;return m.set(1-y-v,v,y)}}(),e.Triangle.containsPoint=function(){var t=new e.Vector3;return function(r,n,i,o){var a=e.Triangle.barycoordFromPoint(r,n,i,o,t);return a.x>=0&&a.y>=0&&a.x+a.y<=1}}(),e.Triangle.prototype={constructor:e.Triangle,set:function(t,e,r){return this.a.copy(t),this.b.copy(e),this.c.copy(r),this},setFromPointsAndIndices:function(t,e,r,n){return this.a.copy(t[e]),this.b.copy(t[r]),this.c.copy(t[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new e.Vector3,r=new e.Vector3;return function(){return t.subVectors(this.c,this.b),r.subVectors(this.a,this.b),.5*t.cross(r).length()}}(),midpoint:function(t){var r=t||new e.Vector3;return r.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return e.Triangle.normal(this.a,this.b,this.c,t)},plane:function(t){var r=t||new e.Plane;return r.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,r){return e.Triangle.barycoordFromPoint(t,this.a,this.b,this.c,r)},containsPoint:function(t){return e.Triangle.containsPoint(t,this.a,this.b,this.c)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},e.Clock=function(t){this.autoStart=void 0!==t?t:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},e.Clock.prototype={constructor:e.Clock,start:function(){this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();t=.001*(e-this.oldTime),this.oldTime=e,this.elapsedTime+=t}return t}},e.EventDispatcher=function(){},e.EventDispatcher.prototype={constructor:e.EventDispatcher,apply:function(t){t.addEventListener=e.EventDispatcher.prototype.addEventListener,t.hasEventListener=e.EventDispatcher.prototype.hasEventListener,t.removeEventListener=e.EventDispatcher.prototype.removeEventListener,t.dispatchEvent=e.EventDispatcher.prototype.dispatchEvent},addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[t]&&(r[t]=[]),-1===r[t].indexOf(e)&&r[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[t]&&-1!==r[t].indexOf(e)?!0:!1},removeEventListener:function(t,e){if(void 0!==this._listeners){var r=this._listeners,n=r[t];if(void 0!==n){var i=n.indexOf(e);-1!==i&&n.splice(i,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners,r=e[t.type];if(void 0!==r){t.target=this;for(var n=[],i=r.length,o=0;i>o;o++)n[o]=r[o];for(var o=0;i>o;o++)n[o].call(this,t)}}}},function(t){function e(t,e){return t.distance-e.distance}t.Raycaster=function(e,r,n,i){this.ray=new t.Ray(e,r),this.near=n||0,this.far=i||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})};var r=function(t,e,n,i){if(t.visible!==!1&&(t.raycast(e,n),i===!0))for(var o=t.children,a=0,s=o.length;s>a;a++)r(o[a],e,n,!0)};t.Raycaster.prototype={constructor:t.Raycaster,linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(e,r){r instanceof t.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(r.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(r).sub(this.ray.origin).normalize()):r instanceof t.OrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(r),this.ray.direction.set(0,0,-1).transformDirection(r.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,n){var i=[];return r(t,this,i,n),i.sort(e),i},intersectObjects:function(t,n){var i=[];if(Array.isArray(t)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var o=0,a=t.length;a>o;o++)r(t[o],this,i,n);return i.sort(e),i}}}(e),e.Object3D=function(){Object.defineProperty(this,"id",{value:e.Object3DIdCount++}),this.uuid=e.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=e.Object3D.DefaultUp.clone();var t=new e.Vector3,r=new e.Euler,n=new e.Quaternion,i=new e.Vector3(1,1,1),o=function(){n.setFromEuler(r,!1)},a=function(){r.setFromQuaternion(n,void 0,!1)};r.onChange(o),n.onChange(a),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:r},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:i},modelViewMatrix:{value:new e.Matrix4},normalMatrix:{value:new e.Matrix3}}),this.rotationAutoUpdate=!0,this.matrix=new e.Matrix4,this.matrixWorld=new e.Matrix4,this.matrixAutoUpdate=e.Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},e.Object3D.DefaultUp=new e.Vector3(0,1,0),e.Object3D.DefaultMatrixAutoUpdate=!0,e.Object3D.prototype={constructor:e.Object3D,get eulerOrder(){return console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order},set eulerOrder(t){console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order=t},get useQuaternion(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(t){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set renderDepth(t){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new e.Quaternion;return function(e,r){return t.setFromAxisAngle(e,r),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new e.Vector3(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new e.Vector3(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new e.Vector3(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new e.Vector3;return function(e,r){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(r)),this}}(),translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},translateX:function(){var t=new e.Vector3(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new e.Vector3(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new e.Vector3(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new e.Matrix4;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new e.Matrix4;return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t instanceof e.Object3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);var r=this.children.indexOf(t);-1!==r&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(r,1))},getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var r=0,n=this.children.length;n>r;r++){var i=this.children[r],o=i.getObjectByProperty(t,e);if(void 0!==o)return o}return void 0},getWorldPosition:function(t){var r=t||new e.Vector3;return this.updateMatrixWorld(!0),r.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new e.Vector3,r=new e.Vector3;return function(n){var i=n||new e.Quaternion;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,i,r),i}}(),getWorldRotation:function(){var t=new e.Quaternion;return function(r){var n=r||new e.Euler;return this.getWorldQuaternion(t),n.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new e.Vector3,r=new e.Quaternion;return function(n){var i=n||new e.Vector3;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,r,i),i}}(),getWorldDirection:function(){var t=new e.Quaternion;return function(r){var n=r||new e.Vector3;return this.getWorldQuaternion(t),n.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,r=0,n=e.length;n>r;r++)e[r].traverse(t)},traverseVisible:function(t){if(this.visible!==!1){t(this);for(var e=this.children,r=0,n=e.length;n>r;r++)e[r].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||t===!0)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=0,r=this.children.length;r>e;e++)this.children[e].updateMatrixWorld(t)},toJSON:function(t){function e(t){var e=[];for(var r in t){var n=t[r];delete n.metadata,e.push(n)}return e}var r=void 0===t,n={},i={object:n};if(r&&(t={geometries:{},materials:{},textures:{},images:{}},i.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"}),n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),this.visible!==!0&&(n.visible=this.visible),n.matrix=this.matrix.toArray(),this.children.length>0){n.children=[];for(var o=0;o<this.children.length;o++)n.children.push(this.children[o].toJSON(t).object)}if(r){var a=e(t.geometries),s=e(t.materials),h=e(t.textures),u=e(t.images);
a.length>0&&(i.geometries=a),s.length>0&&(i.materials=s),h.length>0&&(i.textures=h),u.length>0&&(i.images=u)}return i},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.rotationAutoUpdate=t.rotationAutoUpdate,this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(var r=0;r<t.children.length;r++){var n=t.children[r];this.add(n.clone())}return this}},e.EventDispatcher.prototype.apply(e.Object3D.prototype),e.Object3DIdCount=0,e.Face3=function(t,r,n,i,o,a){this.a=t,this.b=r,this.c=n,this.normal=i instanceof e.Vector3?i:new e.Vector3,this.vertexNormals=Array.isArray(i)?i:[],this.color=o instanceof e.Color?o:new e.Color,this.vertexColors=Array.isArray(o)?o:[],this.materialIndex=void 0!==a?a:0},e.Face3.prototype={constructor:e.Face3,clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,r=t.vertexNormals.length;r>e;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(var e=0,r=t.vertexColors.length;r>e;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}},e.Face4=function(t,r,n,i,o,a,s){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new e.Face3(t,r,n,o,a,s)},e.BufferAttribute=function(t,r){this.uuid=e.Math.generateUUID(),this.array=t,this.itemSize=r,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},e.BufferAttribute.prototype={constructor:e.BufferAttribute,get length(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length},get count(){return this.array.length/this.itemSize},set needsUpdate(t){t===!0&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.dynamic=t.dynamic,this},copyAt:function(t,e,r){t*=this.itemSize,r*=e.itemSize;for(var n=0,i=this.itemSize;i>n;n++)this.array[t+n]=e.array[r+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var r=this.array,n=0,i=0,o=t.length;o>i;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),a=new e.Color),r[n++]=a.r,r[n++]=a.g,r[n++]=a.b}return this},copyIndicesArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;i>n;n++){var o=t[n];e[r++]=o.a,e[r++]=o.b,e[r++]=o.c}return this},copyVector2sArray:function(t){for(var r=this.array,n=0,i=0,o=t.length;o>i;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),a=new e.Vector2),r[n++]=a.x,r[n++]=a.y}return this},copyVector3sArray:function(t){for(var r=this.array,n=0,i=0,o=t.length;o>i;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),a=new e.Vector3),r[n++]=a.x,r[n++]=a.y,r[n++]=a.z}return this},copyVector4sArray:function(t){for(var r=this.array,n=0,i=0,o=t.length;o>i;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),a=new e.Vector4),r[n++]=a.x,r[n++]=a.y,r[n++]=a.z,r[n++]=a.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this},setXYZ:function(t,e,r,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this},setXYZW:function(t,e,r,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this.array[t+3]=i,this},clone:function(){return(new this.constructor).copy(this)}},e.Int8Attribute=function(t,r){return new e.BufferAttribute(new Int8Array(t),r)},e.Uint8Attribute=function(t,r){return new e.BufferAttribute(new Uint8Array(t),r)},e.Uint8ClampedAttribute=function(t,r){return new e.BufferAttribute(new Uint8ClampedArray(t),r)},e.Int16Attribute=function(t,r){return new e.BufferAttribute(new Int16Array(t),r)},e.Uint16Attribute=function(t,r){return new e.BufferAttribute(new Uint16Array(t),r)},e.Int32Attribute=function(t,r){return new e.BufferAttribute(new Int32Array(t),r)},e.Uint32Attribute=function(t,r){return new e.BufferAttribute(new Uint32Array(t),r)},e.Float32Attribute=function(t,r){return new e.BufferAttribute(new Float32Array(t),r)},e.Float64Attribute=function(t,r){return new e.BufferAttribute(new Float64Array(t),r)},e.DynamicBufferAttribute=function(t,r){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new e.BufferAttribute(t,r).setDynamic(!0)},e.InstancedBufferAttribute=function(t,r,n){e.BufferAttribute.call(this,t,r),this.meshPerAttribute=n||1},e.InstancedBufferAttribute.prototype=Object.create(e.BufferAttribute.prototype),e.InstancedBufferAttribute.prototype.constructor=e.InstancedBufferAttribute,e.InstancedBufferAttribute.prototype.copy=function(t){return e.BufferAttribute.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},e.InterleavedBuffer=function(t,r){this.uuid=e.Math.generateUUID(),this.array=t,this.stride=r,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},e.InterleavedBuffer.prototype={constructor:e.InterleavedBuffer,get length(){return this.array.length},get count(){return this.array.length/this.stride},set needsUpdate(t){t===!0&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){this.array=new t.array.constructor(t.array),this.stride=t.stride,this.dynamic=t.dynamic},copyAt:function(t,e,r){t*=this.stride,r*=e.stride;for(var n=0,i=this.stride;i>n;n++)this.array[t+n]=e.array[r+n];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)}},e.InstancedInterleavedBuffer=function(t,r,n){e.InterleavedBuffer.call(this,t,r),this.meshPerAttribute=n||1},e.InstancedInterleavedBuffer.prototype=Object.create(e.InterleavedBuffer.prototype),e.InstancedInterleavedBuffer.prototype.constructor=e.InstancedInterleavedBuffer,e.InstancedInterleavedBuffer.prototype.copy=function(t){return e.InterleavedBuffer.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},e.InterleavedBufferAttribute=function(t,r,n){this.uuid=e.Math.generateUUID(),this.data=t,this.itemSize=r,this.offset=n},e.InterleavedBufferAttribute.prototype={constructor:e.InterleavedBufferAttribute,get length(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length},get count(){return this.data.array.length/this.data.stride},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this},setXYZ:function(t,e,r,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=n,this},setXYZW:function(t,e,r,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=n,this.data.array[t+3]=i,this}},e.Geometry=function(){Object.defineProperty(this,"id",{value:e.GeometryIdCount++}),this.uuid=e.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},e.Geometry.prototype={constructor:e.Geometry,applyMatrix:function(t){for(var r=(new e.Matrix3).getNormalMatrix(t),n=0,i=this.vertices.length;i>n;n++){var o=this.vertices[n];o.applyMatrix4(t)}for(var n=0,i=this.faces.length;i>n;n++){var a=this.faces[n];a.normal.applyMatrix3(r).normalize();for(var s=0,h=a.vertexNormals.length;h>s;s++)a.vertexNormals[s].applyMatrix3(r).normalize()}null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0},rotateX:function(){var t;return function(r){return void 0===t&&(t=new e.Matrix4),t.makeRotationX(r),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(r){return void 0===t&&(t=new e.Matrix4),t.makeRotationY(r),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(r){return void 0===t&&(t=new e.Matrix4),t.makeRotationZ(r),this.applyMatrix(t),this}}(),translate:function(){var t;return function(r,n,i){return void 0===t&&(t=new e.Matrix4),t.makeTranslation(r,n,i),this.applyMatrix(t),this}}(),scale:function(){var t;return function(r,n,i){return void 0===t&&(t=new e.Matrix4),t.makeScale(r,n,i),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(r){void 0===t&&(t=new e.Object3D),t.lookAt(r),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){var r=this,n=null!==t.index?t.index.array:void 0,i=t.attributes,o=i.position.array,a=void 0!==i.normal?i.normal.array:void 0,s=void 0!==i.color?i.color.array:void 0,h=void 0!==i.uv?i.uv.array:void 0,u=void 0!==i.uv2?i.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var c=[],l=[],p=[],f=0,d=0,m=0;f<o.length;f+=3,d+=2,m+=4)r.vertices.push(new e.Vector3(o[f],o[f+1],o[f+2])),void 0!==a&&c.push(new e.Vector3(a[f],a[f+1],a[f+2])),void 0!==s&&r.colors.push(new e.Color(s[f],s[f+1],s[f+2])),void 0!==h&&l.push(new e.Vector2(h[d],h[d+1])),void 0!==u&&p.push(new e.Vector2(u[d],u[d+1]));var g=function(t,n,i){var o=void 0!==a?[c[t].clone(),c[n].clone(),c[i].clone()]:[],f=void 0!==s?[r.colors[t].clone(),r.colors[n].clone(),r.colors[i].clone()]:[],d=new e.Face3(t,n,i,o,f);r.faces.push(d),void 0!==h&&r.faceVertexUvs[0].push([l[t].clone(),l[n].clone(),l[i].clone()]),void 0!==u&&r.faceVertexUvs[1].push([p[t].clone(),p[n].clone(),p[i].clone()])};if(void 0!==n){var y=t.groups;if(y.length>0)for(var f=0;f<y.length;f++)for(var v=y[f],_=v.start,x=v.count,d=_,b=_+x;b>d;d+=3)g(n[d],n[d+1],n[d+2]);else for(var f=0;f<n.length;f+=3)g(n[f],n[f+1],n[f+2])}else for(var f=0;f<o.length/3;f+=3)g(f,f+1,f+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,r=this.boundingSphere.radius,n=0===r?1:1/r,i=new e.Matrix4;return i.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix(i),this},computeFaceNormals:function(){for(var t=new e.Vector3,r=new e.Vector3,n=0,i=this.faces.length;i>n;n++){var o=this.faces[n],a=this.vertices[o.a],s=this.vertices[o.b],h=this.vertices[o.c];t.subVectors(h,s),r.subVectors(a,s),t.cross(r),t.normalize(),o.normal.copy(t)}},computeVertexNormals:function(t){var r,n,i,o,a,s;for(s=new Array(this.vertices.length),r=0,n=this.vertices.length;n>r;r++)s[r]=new e.Vector3;if(t){var h,u,c,l=new e.Vector3,p=new e.Vector3;for(i=0,o=this.faces.length;o>i;i++)a=this.faces[i],h=this.vertices[a.a],u=this.vertices[a.b],c=this.vertices[a.c],l.subVectors(c,u),p.subVectors(h,u),l.cross(p),s[a.a].add(l),s[a.b].add(l),s[a.c].add(l)}else for(i=0,o=this.faces.length;o>i;i++)a=this.faces[i],s[a.a].add(a.normal),s[a.b].add(a.normal),s[a.c].add(a.normal);for(r=0,n=this.vertices.length;n>r;r++)s[r].normalize();for(i=0,o=this.faces.length;o>i;i++){a=this.faces[i];var f=a.vertexNormals;3===f.length?(f[0].copy(s[a.a]),f[1].copy(s[a.b]),f[2].copy(s[a.c])):(f[0]=s[a.a].clone(),f[1]=s[a.b].clone(),f[2]=s[a.c].clone())}},computeMorphNormals:function(){var t,r,n,i,o;for(n=0,i=this.faces.length;i>n;n++)for(o=this.faces[n],o.__originalFaceNormal?o.__originalFaceNormal.copy(o.normal):o.__originalFaceNormal=o.normal.clone(),o.__originalVertexNormals||(o.__originalVertexNormals=[]),t=0,r=o.vertexNormals.length;r>t;t++)o.__originalVertexNormals[t]?o.__originalVertexNormals[t].copy(o.vertexNormals[t]):o.__originalVertexNormals[t]=o.vertexNormals[t].clone();var a=new e.Geometry;for(a.faces=this.faces,t=0,r=this.morphTargets.length;r>t;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var s,h,u=this.morphNormals[t].faceNormals,c=this.morphNormals[t].vertexNormals;for(n=0,i=this.faces.length;i>n;n++)s=new e.Vector3,h={a:new e.Vector3,b:new e.Vector3,c:new e.Vector3},u.push(s),c.push(h)}var l=this.morphNormals[t];a.vertices=this.morphTargets[t].vertices,a.computeFaceNormals(),a.computeVertexNormals();var s,h;for(n=0,i=this.faces.length;i>n;n++)o=this.faces[n],s=l.faceNormals[n],h=l.vertexNormals[n],s.copy(o.normal),h.a.copy(o.vertexNormals[0]),h.b.copy(o.vertexNormals[1]),h.c.copy(o.vertexNormals[2])}for(n=0,i=this.faces.length;i>n;n++)o=this.faces[n],o.normal=o.__originalFaceNormal,o.vertexNormals=o.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var t=0,e=this.vertices,r=0,n=e.length;n>r;r++)r>0&&(t+=e[r].distanceTo(e[r-1])),this.lineDistances[r]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new e.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new e.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,r,n){if(t instanceof e.Geometry==!1)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);var i,o=this.vertices.length,a=this.vertices,s=t.vertices,h=this.faces,u=t.faces,c=this.faceVertexUvs[0],l=t.faceVertexUvs[0];void 0===n&&(n=0),void 0!==r&&(i=(new e.Matrix3).getNormalMatrix(r));for(var p=0,f=s.length;f>p;p++){var d=s[p],m=d.clone();void 0!==r&&m.applyMatrix4(r),a.push(m)}for(p=0,f=u.length;f>p;p++){var g,y,v,_=u[p],x=_.vertexNormals,b=_.vertexColors;g=new e.Face3(_.a+o,_.b+o,_.c+o),g.normal.copy(_.normal),void 0!==i&&g.normal.applyMatrix3(i).normalize();for(var w=0,S=x.length;S>w;w++)y=x[w].clone(),void 0!==i&&y.applyMatrix3(i).normalize(),g.vertexNormals.push(y);g.color.copy(_.color);for(var w=0,S=b.length;S>w;w++)v=b[w],g.vertexColors.push(v.clone());g.materialIndex=_.materialIndex+n,h.push(g)}for(p=0,f=l.length;f>p;p++){var M=l[p],T=[];if(void 0!==M){for(var w=0,S=M.length;S>w;w++)T.push(M[w].clone());c.push(T)}}},mergeMesh:function(t){return t instanceof e.Mesh==!1?void console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t):(t.matrixAutoUpdate&&t.updateMatrix(),void this.merge(t.geometry,t.matrix))},mergeVertices:function(){var t,e,r,n,i,o,a,s,h={},u=[],c=[],l=4,p=Math.pow(10,l);for(r=0,n=this.vertices.length;n>r;r++)t=this.vertices[r],e=Math.round(t.x*p)+"_"+Math.round(t.y*p)+"_"+Math.round(t.z*p),void 0===h[e]?(h[e]=r,u.push(this.vertices[r]),c[r]=u.length-1):c[r]=c[h[e]];var f=[];for(r=0,n=this.faces.length;n>r;r++){i=this.faces[r],i.a=c[i.a],i.b=c[i.b],i.c=c[i.c],o=[i.a,i.b,i.c];for(var d=-1,m=0;3>m;m++)if(o[m]===o[(m+1)%3]){d=m,f.push(r);break}}for(r=f.length-1;r>=0;r--){var g=f[r];for(this.faces.splice(g,1),a=0,s=this.faceVertexUvs.length;s>a;a++)this.faceVertexUvs[a].splice(g,1)}var y=this.vertices.length-u.length;return this.vertices=u,y},toJSON:function(){function t(t,e,r){return r?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==p[e]?p[e]:(p[e]=l.length/3,l.push(t.x,t.y,t.z),p[e])}function r(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==d[e]?d[e]:(d[e]=f.length,f.push(t.getHex()),d[e])}function n(t){var e=t.x.toString()+t.y.toString();return void 0!==g[e]?g[e]:(g[e]=m.length/2,m.push(t.x,t.y),g[e])}var i={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),void 0!==this.parameters){var o=this.parameters;for(var a in o)void 0!==o[a]&&(i[a]=o[a]);return i}for(var s=[],h=0;h<this.vertices.length;h++){var u=this.vertices[h];s.push(u.x,u.y,u.z)}for(var c=[],l=[],p={},f=[],d={},m=[],g={},h=0;h<this.faces.length;h++){var y=this.faces[h],v=!1,_=!1,x=void 0!==this.faceVertexUvs[0][h],b=y.normal.length()>0,w=y.vertexNormals.length>0,S=1!==y.color.r||1!==y.color.g||1!==y.color.b,M=y.vertexColors.length>0,T=0;if(T=t(T,0,0),T=t(T,1,v),T=t(T,2,_),T=t(T,3,x),T=t(T,4,b),T=t(T,5,w),T=t(T,6,S),T=t(T,7,M),c.push(T),c.push(y.a,y.b,y.c),x){var E=this.faceVertexUvs[0][h];c.push(n(E[0]),n(E[1]),n(E[2]))}if(b&&c.push(e(y.normal)),w){var C=y.vertexNormals;c.push(e(C[0]),e(C[1]),e(C[2]))}if(S&&c.push(r(y.color)),M){var A=y.vertexColors;c.push(r(A[0]),r(A[1]),r(A[2]))}}return i.data={},i.data.vertices=s,i.data.normals=l,f.length>0&&(i.data.colors=f),m.length>0&&(i.data.uvs=[m]),i.data.faces=c,i},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]];for(var e=t.vertices,r=0,n=e.length;n>r;r++)this.vertices.push(e[r].clone());for(var i=t.faces,r=0,n=i.length;n>r;r++)this.faces.push(i[r].clone());for(var r=0,n=t.faceVertexUvs.length;n>r;r++){var o=t.faceVertexUvs[r];void 0===this.faceVertexUvs[r]&&(this.faceVertexUvs[r]=[]);for(var a=0,s=o.length;s>a;a++){for(var h=o[a],u=[],c=0,l=h.length;l>c;c++){var p=h[c];u.push(p.clone())}this.faceVertexUvs[r].push(u)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},e.EventDispatcher.prototype.apply(e.Geometry.prototype),e.GeometryIdCount=0,e.DirectGeometry=function(){Object.defineProperty(this,"id",{value:e.GeometryIdCount++}),this.uuid=e.Math.generateUUID(),this.name="",this.type="DirectGeometry",this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1},e.DirectGeometry.prototype={constructor:e.DirectGeometry,computeBoundingBox:e.Geometry.prototype.computeBoundingBox,computeBoundingSphere:e.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},computeGroups:function(t){for(var e,r,n=[],i=t.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==r&&(r=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:r})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var r=t.faces,n=t.vertices,i=t.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=t.morphTargets,h=s.length;if(h>0){for(var u=[],c=0;h>c;c++)u[c]=[];this.morphTargets.position=u}var l=t.morphNormals,p=l.length;if(p>0){for(var f=[],c=0;p>c;c++)f[c]=[];this.morphTargets.normal=f}for(var d=t.skinIndices,m=t.skinWeights,g=d.length===n.length,y=m.length===n.length,c=0;c<r.length;c++){var v=r[c];this.vertices.push(n[v.a],n[v.b],n[v.c]);var _=v.vertexNormals;if(3===_.length)this.normals.push(_[0],_[1],_[2]);else{var x=v.normal;this.normals.push(x,x,x)}var b=v.vertexColors;if(3===b.length)this.colors.push(b[0],b[1],b[2]);else{var w=v.color;this.colors.push(w,w,w)}if(o===!0){var S=i[0][c];void 0!==S?this.uvs.push(S[0],S[1],S[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new e.Vector2,new e.Vector2,new e.Vector2))}if(a===!0){var S=i[1][c];void 0!==S?this.uvs2.push(S[0],S[1],S[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new e.Vector2,new e.Vector2,new e.Vector2))}for(var M=0;h>M;M++){var T=s[M].vertices;u[M].push(T[v.a],T[v.b],T[v.c])}for(var M=0;p>M;M++){var E=l[M].vertexNormals[c];f[M].push(E.a,E.b,E.c)}g&&this.skinIndices.push(d[v.a],d[v.b],d[v.c]),y&&this.skinWeights.push(m[v.a],m[v.b],m[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},e.EventDispatcher.prototype.apply(e.DirectGeometry.prototype),e.BufferGeometry=function(){Object.defineProperty(this,"id",{value:e.GeometryIdCount++}),this.uuid=e.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}},e.BufferGeometry.prototype={constructor:e.BufferGeometry,addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},getIndex:function(){return this.index},setIndex:function(t){this.index=t},addAttribute:function(t,r){return r instanceof e.BufferAttribute==!1&&r instanceof e.InterleavedBufferAttribute==!1?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new e.BufferAttribute(arguments[1],arguments[2]))):"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(r)):void(this.attributes[t]=r)},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){delete this.attributes[t]},get drawcalls(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups},get offsets(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups},addDrawCall:function(t,e,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},addGroup:function(t,e,r){this.groups.push({start:t,count:e,materialIndex:void 0!==r?r:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var r=this.attributes.position;void 0!==r&&(t.applyToVector3Array(r.array),r.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var i=(new e.Matrix3).getNormalMatrix(t);i.applyToVector3Array(n.array),n.needsUpdate=!0}null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere()},rotateX:function(){var t;return function(r){return void 0===t&&(t=new e.Matrix4),t.makeRotationX(r),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(r){return void 0===t&&(t=new e.Matrix4),t.makeRotationY(r),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(r){return void 0===t&&(t=new e.Matrix4),t.makeRotationZ(r),this.applyMatrix(t),this}}(),translate:function(){var t;return function(r,n,i){return void 0===t&&(t=new e.Matrix4),t.makeTranslation(r,n,i),this.applyMatrix(t),this}}(),scale:function(){var t;return function(r,n,i){return void 0===t&&(t=new e.Matrix4),t.makeScale(r,n,i),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(r){void 0===t&&(t=new e.Object3D),t.lookAt(r),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var r=t.geometry;if(t instanceof e.Points||t instanceof e.Line){var n=new e.Float32Attribute(3*r.vertices.length,3),i=new e.Float32Attribute(3*r.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(r.vertices)),this.addAttribute("color",i.copyColorsArray(r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length){var o=new e.Float32Attribute(r.lineDistances.length,1);this.addAttribute("lineDistance",o.copyArray(r.lineDistances))}null!==r.boundingSphere&&(this.boundingSphere=r.boundingSphere.clone()),null!==r.boundingBox&&(this.boundingBox=r.boundingBox.clone())}else t instanceof e.Mesh&&r instanceof e.Geometry&&this.fromGeometry(r);return this},updateFromObject:function(t){var r=t.geometry;if(t instanceof e.Mesh){var n=r.__directGeometry;if(void 0===n)return this.fromGeometry(r);n.verticesNeedUpdate=r.verticesNeedUpdate,n.normalsNeedUpdate=r.normalsNeedUpdate,n.colorsNeedUpdate=r.colorsNeedUpdate,n.uvsNeedUpdate=r.uvsNeedUpdate,n.groupsNeedUpdate=r.groupsNeedUpdate,r.verticesNeedUpdate=!1,r.normalsNeedUpdate=!1,r.colorsNeedUpdate=!1,r.uvsNeedUpdate=!1,r.groupsNeedUpdate=!1,r=n}if(r.verticesNeedUpdate===!0){var i=this.attributes.position;void 0!==i&&(i.copyVector3sArray(r.vertices),i.needsUpdate=!0),r.verticesNeedUpdate=!1}if(r.normalsNeedUpdate===!0){var i=this.attributes.normal;void 0!==i&&(i.copyVector3sArray(r.normals),i.needsUpdate=!0),r.normalsNeedUpdate=!1}if(r.colorsNeedUpdate===!0){var i=this.attributes.color;void 0!==i&&(i.copyColorsArray(r.colors),i.needsUpdate=!0),r.colorsNeedUpdate=!1}if(r.lineDistancesNeedUpdate){var i=this.attributes.lineDistance;void 0!==i&&(i.copyArray(r.lineDistances),i.needsUpdate=!0),r.lineDistancesNeedUpdate=!1}return r.groupsNeedUpdate&&(r.computeGroups(t.geometry),this.groups=r.groups,r.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new e.DirectGeometry).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var r=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new e.BufferAttribute(r,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.addAttribute("normal",new e.BufferAttribute(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var i=new Float32Array(3*t.colors.length);this.addAttribute("color",new e.BufferAttribute(i,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var o=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new e.BufferAttribute(o,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var a=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new e.BufferAttribute(a,2).copyVector2sArray(t.uvs2))}if(t.indices.length>0){var s=t.vertices.length>65535?Uint32Array:Uint16Array,h=new s(3*t.indices.length);this.setIndex(new e.BufferAttribute(h,1).copyIndicesArray(t.indices))}this.groups=t.groups;for(var u in t.morphTargets){for(var c=[],l=t.morphTargets[u],p=0,f=l.length;f>p;p++){var d=l[p],m=new e.Float32Attribute(3*d.length,3);c.push(m.copyVector3sArray(d))}this.morphAttributes[u]=c}if(t.skinIndices.length>0){var g=new e.Float32Attribute(4*t.skinIndices.length,4);this.addAttribute("skinIndex",g.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var y=new e.Float32Attribute(4*t.skinWeights.length,4);this.addAttribute("skinWeight",y.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){var t=new e.Vector3;return function(){null===this.boundingBox&&(this.boundingBox=new e.Box3);var r=this.attributes.position.array;if(r){var n=this.boundingBox;n.makeEmpty();for(var i=0,o=r.length;o>i;i+=3)t.fromArray(r,i),n.expandByPoint(t)}(void 0===r||0===r.length)&&(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}(),computeBoundingSphere:function(){var t=new e.Box3,r=new e.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new e.Sphere);var n=this.attributes.position.array;if(n){t.makeEmpty();for(var i=this.boundingSphere.center,o=0,a=n.length;a>o;o+=3)r.fromArray(n,o),t.expandByPoint(r);t.center(i);for(var s=0,o=0,a=n.length;a>o;o+=3)r.fromArray(n,o),s=Math.max(s,i.distanceToSquared(r));this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,r=this.attributes,n=this.groups;if(r.position){var i=r.position.array;if(void 0===r.normal)this.addAttribute("normal",new e.BufferAttribute(new Float32Array(i.length),3));else for(var o=r.normal.array,a=0,s=o.length;s>a;a++)o[a]=0;var h,u,c,o=r.normal.array,l=new e.Vector3,p=new e.Vector3,f=new e.Vector3,d=new e.Vector3,m=new e.Vector3;if(t){var g=t.array;0===n.length&&this.addGroup(0,g.length);for(var y=0,v=n.length;v>y;++y)for(var _=n[y],x=_.start,b=_.count,a=x,s=x+b;s>a;a+=3)h=3*g[a+0],u=3*g[a+1],c=3*g[a+2],l.fromArray(i,h),p.fromArray(i,u),f.fromArray(i,c),d.subVectors(f,p),m.subVectors(l,p),d.cross(m),o[h]+=d.x,o[h+1]+=d.y,o[h+2]+=d.z,o[u]+=d.x,o[u+1]+=d.y,o[u+2]+=d.z,o[c]+=d.x,o[c+1]+=d.y,o[c+2]+=d.z}else for(var a=0,s=i.length;s>a;a+=9)l.fromArray(i,a),p.fromArray(i,a+3),f.fromArray(i,a+6),d.subVectors(f,p),m.subVectors(l,p),d.cross(m),o[a]=d.x,o[a+1]=d.y,o[a+2]=d.z,o[a+3]=d.x,o[a+4]=d.y,o[a+5]=d.z,o[a+6]=d.x,o[a+7]=d.y,o[a+8]=d.z;this.normalizeNormals(),r.normal.needsUpdate=!0}},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(t){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},merge:function(t,r){if(t instanceof e.BufferGeometry==!1)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===r&&(r=0);var n=this.attributes;for(var i in n)if(void 0!==t.attributes[i])for(var o=n[i],a=o.array,s=t.attributes[i],h=s.array,u=s.itemSize,c=0,l=u*r;c<h.length;c++,l++)a[l]=h[c];return this},normalizeNormals:function(){for(var t,e,r,n,i=this.attributes.normal.array,o=0,a=i.length;a>o;o+=3)t=i[o],e=i[o+1],r=i[o+2],n=1/Math.sqrt(t*t+e*e+r*r),i[o]*=n,i[o+1]*=n,i[o+2]*=n},toJSON:function(){var t={metadata:{version:4.4,type:"BufferGeometry",
generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var r in e)void 0!==e[r]&&(t[r]=e[r]);return t}t.data={attributes:{}};var n=this.index;if(null!==n){var i=Array.prototype.slice.call(n.array);t.data.index={type:n.array.constructor.name,array:i}}var o=this.attributes;for(var r in o){var a=o[r],i=Array.prototype.slice.call(a.array);t.data.attributes[r]={itemSize:a.itemSize,type:a.array.constructor.name,array:i}}var s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));var h=this.boundingSphere;return null!==h&&(t.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),t},clone:function(){return(new this.constructor).copy(this)},copy:function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var r=t.attributes;for(var n in r){var i=r[n];this.addAttribute(n,i.clone())}for(var o=t.groups,a=0,s=o.length;s>a;a++){var h=o[a];this.addGroup(h.start,h.count)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},e.EventDispatcher.prototype.apply(e.BufferGeometry.prototype),e.BufferGeometry.MaxIndex=65535,e.InstancedBufferGeometry=function(){e.BufferGeometry.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0},e.InstancedBufferGeometry.prototype=Object.create(e.BufferGeometry.prototype),e.InstancedBufferGeometry.prototype.constructor=e.InstancedBufferGeometry,e.InstancedBufferGeometry.prototype.addGroup=function(t,e,r){this.groups.push({start:t,count:e,instances:r})},e.InstancedBufferGeometry.prototype.copy=function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var r=t.attributes;for(var n in r){var i=r[n];this.addAttribute(n,i.clone())}for(var o=t.groups,a=0,s=o.length;s>a;a++){var h=o[a];this.addGroup(h.start,h.count,h.instances)}return this},e.EventDispatcher.prototype.apply(e.InstancedBufferGeometry.prototype),e.Camera=function(){e.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new e.Matrix4,this.projectionMatrix=new e.Matrix4},e.Camera.prototype=Object.create(e.Object3D.prototype),e.Camera.prototype.constructor=e.Camera,e.Camera.prototype.getWorldDirection=function(){var t=new e.Quaternion;return function(r){var n=r||new e.Vector3;return this.getWorldQuaternion(t),n.set(0,0,-1).applyQuaternion(t)}}(),e.Camera.prototype.lookAt=function(){var t=new e.Matrix4;return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t)}}(),e.Camera.prototype.clone=function(){return(new this.constructor).copy(this)},e.Camera.prototype.copy=function(t){return e.Object3D.prototype.copy.call(this,t),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},e.CubeCamera=function(t,r,n){e.Object3D.call(this),this.type="CubeCamera";var i=90,o=1,a=new e.PerspectiveCamera(i,o,t,r);a.up.set(0,-1,0),a.lookAt(new e.Vector3(1,0,0)),this.add(a);var s=new e.PerspectiveCamera(i,o,t,r);s.up.set(0,-1,0),s.lookAt(new e.Vector3(-1,0,0)),this.add(s);var h=new e.PerspectiveCamera(i,o,t,r);h.up.set(0,0,1),h.lookAt(new e.Vector3(0,1,0)),this.add(h);var u=new e.PerspectiveCamera(i,o,t,r);u.up.set(0,0,-1),u.lookAt(new e.Vector3(0,-1,0)),this.add(u);var c=new e.PerspectiveCamera(i,o,t,r);c.up.set(0,-1,0),c.lookAt(new e.Vector3(0,0,1)),this.add(c);var l=new e.PerspectiveCamera(i,o,t,r);l.up.set(0,-1,0),l.lookAt(new e.Vector3(0,0,-1)),this.add(l),this.renderTarget=new e.WebGLRenderTargetCube(n,n,{format:e.RGBFormat,magFilter:e.LinearFilter,minFilter:e.LinearFilter}),this.updateCubeMap=function(t,e){null===this.parent&&this.updateMatrixWorld();var r=this.renderTarget,n=r.generateMipmaps;r.generateMipmaps=!1,r.activeCubeFace=0,t.render(e,a,r),r.activeCubeFace=1,t.render(e,s,r),r.activeCubeFace=2,t.render(e,h,r),r.activeCubeFace=3,t.render(e,u,r),r.activeCubeFace=4,t.render(e,c,r),r.generateMipmaps=n,r.activeCubeFace=5,t.render(e,l,r),t.setRenderTarget(null)}},e.CubeCamera.prototype=Object.create(e.Object3D.prototype),e.CubeCamera.prototype.constructor=e.CubeCamera,e.OrthographicCamera=function(t,r,n,i,o,a){e.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=t,this.right=r,this.top=n,this.bottom=i,this.near=void 0!==o?o:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()},e.OrthographicCamera.prototype=Object.create(e.Camera.prototype),e.OrthographicCamera.prototype.constructor=e.OrthographicCamera,e.OrthographicCamera.prototype.updateProjectionMatrix=function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(r-t,r+t,n+e,n-e,this.near,this.far)},e.OrthographicCamera.prototype.copy=function(t){return e.Camera.prototype.copy.call(this,t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this},e.OrthographicCamera.prototype.toJSON=function(t){var r=e.Object3D.prototype.toJSON.call(this,t);return r.object.zoom=this.zoom,r.object.left=this.left,r.object.right=this.right,r.object.top=this.top,r.object.bottom=this.bottom,r.object.near=this.near,r.object.far=this.far,r},e.PerspectiveCamera=function(t,r,n,i){e.Camera.call(this),this.type="PerspectiveCamera",this.zoom=1,this.fov=void 0!==t?t:50,this.aspect=void 0!==r?r:1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.updateProjectionMatrix()},e.PerspectiveCamera.prototype=Object.create(e.Camera.prototype),e.PerspectiveCamera.prototype.constructor=e.PerspectiveCamera,e.PerspectiveCamera.prototype.setLens=function(t,r){void 0===r&&(r=24),this.fov=2*e.Math.radToDeg(Math.atan(r/(2*t))),this.updateProjectionMatrix()},e.PerspectiveCamera.prototype.setViewOffset=function(t,e,r,n,i,o){this.fullWidth=t,this.fullHeight=e,this.x=r,this.y=n,this.width=i,this.height=o,this.updateProjectionMatrix()},e.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var t=e.Math.radToDeg(2*Math.atan(Math.tan(.5*e.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var r=this.fullWidth/this.fullHeight,n=Math.tan(e.Math.degToRad(.5*t))*this.near,i=-n,o=r*i,a=r*n,s=Math.abs(a-o),h=Math.abs(n-i);this.projectionMatrix.makeFrustum(o+this.x*s/this.fullWidth,o+(this.x+this.width)*s/this.fullWidth,n-(this.y+this.height)*h/this.fullHeight,n-this.y*h/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(t,this.aspect,this.near,this.far)},e.PerspectiveCamera.prototype.copy=function(t){return e.Camera.prototype.copy.call(this,t),this.fov=t.fov,this.aspect=t.aspect,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this},e.PerspectiveCamera.prototype.toJSON=function(t){var r=e.Object3D.prototype.toJSON.call(this,t);return r.object.zoom=this.zoom,r.object.fov=this.fov,r.object.aspect=this.aspect,r.object.near=this.near,r.object.far=this.far,r},e.Light=function(t){e.Object3D.call(this),this.type="Light",this.color=new e.Color(t)},e.Light.prototype=Object.create(e.Object3D.prototype),e.Light.prototype.constructor=e.Light,e.Light.prototype.copy=function(t){return e.Object3D.prototype.copy.call(this,t),this.color.copy(t.color),this},e.AmbientLight=function(t){e.Light.call(this,t),this.type="AmbientLight"},e.AmbientLight.prototype=Object.create(e.Light.prototype),e.AmbientLight.prototype.constructor=e.AmbientLight,e.AmbientLight.prototype.toJSON=function(t){var r=e.Object3D.prototype.toJSON.call(this,t);return r.object.color=this.color.getHex(),r},e.DirectionalLight=function(t,r){e.Light.call(this,t),this.type="DirectionalLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new e.Object3D,this.intensity=void 0!==r?r:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},e.DirectionalLight.prototype=Object.create(e.Light.prototype),e.DirectionalLight.prototype.constructor=e.DirectionalLight,e.DirectionalLight.prototype.copy=function(t){return e.Light.prototype.copy.call(this,t),this.intensity=t.intensity,this.target=t.target.clone(),this.castShadow=t.castShadow,this.onlyShadow=t.onlyShadow,this.shadowCameraNear=t.shadowCameraNear,this.shadowCameraFar=t.shadowCameraFar,this.shadowCameraLeft=t.shadowCameraLeft,this.shadowCameraRight=t.shadowCameraRight,this.shadowCameraTop=t.shadowCameraTop,this.shadowCameraBottom=t.shadowCameraBottom,this.shadowCameraVisible=t.shadowCameraVisible,this.shadowBias=t.shadowBias,this.shadowDarkness=t.shadowDarkness,this.shadowMapWidth=t.shadowMapWidth,this.shadowMapHeight=t.shadowMapHeight,this},e.DirectionalLight.prototype.toJSON=function(t){var r=e.Object3D.prototype.toJSON.call(this,t);return r.object.color=this.color.getHex(),r.object.intensity=this.intensity,r},e.HemisphereLight=function(t,r,n){e.Light.call(this,t),this.type="HemisphereLight",this.position.set(0,1,0),this.updateMatrix(),this.groundColor=new e.Color(r),this.intensity=void 0!==n?n:1},e.HemisphereLight.prototype=Object.create(e.Light.prototype),e.HemisphereLight.prototype.constructor=e.HemisphereLight,e.HemisphereLight.prototype.copy=function(t){return e.Light.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this.intensity=t.intensity,this},e.HemisphereLight.prototype.toJSON=function(t){var r=e.Object3D.prototype.toJSON.call(this,t);return r.object.color=this.color.getHex(),r.object.groundColor=this.groundColor.getHex(),r.object.intensity=this.intensity,r},e.PointLight=function(t,r,n,i){e.Light.call(this,t),this.type="PointLight",this.intensity=void 0!==r?r:1,this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1},e.PointLight.prototype=Object.create(e.Light.prototype),e.PointLight.prototype.constructor=e.PointLight,e.PointLight.prototype.copy=function(t){return e.Light.prototype.copy.call(this,t),this.intensity=t.intensity,this.distance=t.distance,this.decay=t.decay,this},e.PointLight.prototype.toJSON=function(t){var r=e.Object3D.prototype.toJSON.call(this,t);return r.object.color=this.color.getHex(),r.object.intensity=this.intensity,r.object.distance=this.distance,r.object.decay=this.decay,r},e.SpotLight=function(t,r,n,i,o,a){e.Light.call(this,t),this.type="SpotLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new e.Object3D,this.intensity=void 0!==r?r:1,this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.exponent=void 0!==o?o:10,this.decay=void 0!==a?a:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},e.SpotLight.prototype=Object.create(e.Light.prototype),e.SpotLight.prototype.constructor=e.SpotLight,e.SpotLight.prototype.copy=function(t){return e.Light.prototype.copy.call(this,t),this.intensity=t.intensity,this.distance=t.distance,this.angle=t.angle,this.exponent=t.exponent,this.decay=t.decay,this.target=t.target.clone(),this.castShadow=t.castShadow,this.onlyShadow=t.onlyShadow,this.shadowCameraNear=t.shadowCameraNear,this.shadowCameraFar=t.shadowCameraFar,this.shadowCameraFov=t.shadowCameraFov,this.shadowCameraVisible=t.shadowCameraVisible,this.shadowBias=t.shadowBias,this.shadowDarkness=t.shadowDarkness,this.shadowMapWidth=t.shadowMapWidth,this.shadowMapHeight=t.shadowMapHeight,this},e.SpotLight.prototype.toJSON=function(t){var r=e.Object3D.prototype.toJSON.call(this,t);return r.object.color=this.color.getHex(),r.object.intensity=this.intensity,r.object.distance=this.distance,r.object.angle=this.angle,r.object.exponent=this.exponent,r.object.decay=this.decay,r},e.Cache={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){return this.enabled!==!1?this.files[t]:void 0},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},e.Loader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},e.Loader.prototype={constructor:e.Loader,crossOrigin:void 0,extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")},initMaterials:function(t,e,r){for(var n=[],i=0;i<t.length;++i)n[i]=this.createMaterial(t[i],e,r);return n},createMaterial:function(){var t;return function(r,n,i){function o(t){var e=Math.log(t)/Math.LN2;return Math.pow(2,Math.round(e))}function a(r,a,s,h,u,c,l){var p,f=n+s,d=e.Loader.Handlers.get(f);if(null!==d?p=d.load(f):(p=new e.Texture,d=t,d.setCrossOrigin(i),d.load(f,function(t){if(e.Math.isPowerOfTwo(t.width)===!1||e.Math.isPowerOfTwo(t.height)===!1){var r=o(t.width),n=o(t.height),i=document.createElement("canvas");i.width=r,i.height=n;var a=i.getContext("2d");a.drawImage(t,0,0,r,n),p.image=i}else p.image=t;p.needsUpdate=!0})),p.sourceFile=s,h&&(p.repeat.set(h[0],h[1]),1!==h[0]&&(p.wrapS=e.RepeatWrapping),1!==h[1]&&(p.wrapT=e.RepeatWrapping)),u&&p.offset.set(u[0],u[1]),c){var m={repeat:e.RepeatWrapping,mirror:e.MirroredRepeatWrapping};void 0!==m[c[0]]&&(p.wrapS=m[c[0]]),void 0!==m[c[1]]&&(p.wrapT=m[c[1]])}l&&(p.anisotropy=l),r[a]=p}function s(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]}var h=this;void 0===i&&void 0!==h.crossOrigin&&(i=h.crossOrigin),void 0===t&&(t=new e.ImageLoader);var u="MeshLambertMaterial",c={};if(r.shading){var l=r.shading.toLowerCase();"phong"===l?u="MeshPhongMaterial":"basic"===l&&(u="MeshBasicMaterial")}void 0!==r.blending&&void 0!==e[r.blending]&&(c.blending=e[r.blending]),void 0!==r.transparent&&(c.transparent=r.transparent),void 0!==r.opacity&&r.opacity<1&&(c.transparent=!0),void 0!==r.depthTest&&(c.depthTest=r.depthTest),void 0!==r.depthWrite&&(c.depthWrite=r.depthWrite),void 0!==r.visible&&(c.visible=r.visible),void 0!==r.flipSided&&(c.side=e.BackSide),void 0!==r.doubleSided&&(c.side=e.DoubleSide),void 0!==r.wireframe&&(c.wireframe=r.wireframe),void 0!==r.vertexColors&&("face"===r.vertexColors?c.vertexColors=e.FaceColors:r.vertexColors&&(c.vertexColors=e.VertexColors)),r.colorDiffuse?c.color=s(r.colorDiffuse):r.DbgColor&&(c.color=r.DbgColor),r.colorEmissive&&(c.emissive=s(r.colorEmissive)),"MeshPhongMaterial"===u&&(r.colorSpecular&&(c.specular=s(r.colorSpecular)),r.specularCoef&&(c.shininess=r.specularCoef)),void 0!==r.transparency&&(console.warn("THREE.Loader: transparency has been renamed to opacity"),r.opacity=r.transparency),void 0!==r.opacity&&(c.opacity=r.opacity),n&&(r.mapDiffuse&&a(c,"map",r.mapDiffuse,r.mapDiffuseRepeat,r.mapDiffuseOffset,r.mapDiffuseWrap,r.mapDiffuseAnisotropy),r.mapLight&&a(c,"lightMap",r.mapLight,r.mapLightRepeat,r.mapLightOffset,r.mapLightWrap,r.mapLightAnisotropy),r.mapAO&&a(c,"aoMap",r.mapAO,r.mapAORepeat,r.mapAOOffset,r.mapAOWrap,r.mapAOAnisotropy),r.mapBump&&a(c,"bumpMap",r.mapBump,r.mapBumpRepeat,r.mapBumpOffset,r.mapBumpWrap,r.mapBumpAnisotropy),r.mapNormal&&a(c,"normalMap",r.mapNormal,r.mapNormalRepeat,r.mapNormalOffset,r.mapNormalWrap,r.mapNormalAnisotropy),r.mapSpecular&&a(c,"specularMap",r.mapSpecular,r.mapSpecularRepeat,r.mapSpecularOffset,r.mapSpecularWrap,r.mapSpecularAnisotropy),r.mapAlpha&&a(c,"alphaMap",r.mapAlpha,r.mapAlphaRepeat,r.mapAlphaOffset,r.mapAlphaWrap,r.mapAlphaAnisotropy)),r.mapBumpScale&&(c.bumpScale=r.mapBumpScale),r.mapNormalFactor&&(c.normalScale=new e.Vector2(r.mapNormalFactor,r.mapNormalFactor));var p=new e[u](c);return void 0!==r.DbgName&&(p.name=r.DbgName),p}}()},e.Loader.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=0,r=this.handlers.length;r>e;e+=2){var n=this.handlers[e],i=this.handlers[e+1];if(n.test(t))return i}return null}},e.XHRLoader=function(t){this.manager=void 0!==t?t:e.DefaultLoadingManager},e.XHRLoader.prototype={constructor:e.XHRLoader,load:function(t,r,n,i){var o=this,a=e.Cache.get(t);if(void 0!==a)return r&&setTimeout(function(){r(a)},0),a;var s=new XMLHttpRequest;return s.open("GET",t,!0),s.addEventListener("load",function(n){e.Cache.add(t,this.response),r&&r(this.response),o.manager.itemEnd(t)},!1),void 0!==n&&s.addEventListener("progress",function(t){n(t)},!1),s.addEventListener("error",function(e){i&&i(e),o.manager.itemError(t)},!1),void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),void 0!==this.responseType&&(s.responseType=this.responseType),void 0!==this.withCredentials&&(s.withCredentials=this.withCredentials),s.send(null),o.manager.itemStart(t),s},setResponseType:function(t){this.responseType=t},setCrossOrigin:function(t){this.crossOrigin=t},setWithCredentials:function(t){this.withCredentials=t}},e.ImageLoader=function(t){this.manager=void 0!==t?t:e.DefaultLoadingManager},e.ImageLoader.prototype={constructor:e.ImageLoader,load:function(t,r,n,i){var o=this,a=e.Cache.get(t);if(void 0!==a)return r&&setTimeout(function(){r(a)},0),a;var s=document.createElement("img");return s.addEventListener("load",function(n){e.Cache.add(t,this),r&&r(this),o.manager.itemEnd(t)},!1),void 0!==n&&s.addEventListener("progress",function(t){n(t)},!1),s.addEventListener("error",function(e){i&&i(e),o.manager.itemError(t)},!1),void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),o.manager.itemStart(t),s.src=t,s},setCrossOrigin:function(t){this.crossOrigin=t}},e.JSONLoader=function(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:e.DefaultLoadingManager,this.withCredentials=!1},e.JSONLoader.prototype={constructor:e.JSONLoader,get statusDomElement(){return void 0===this._statusDomElement&&(this._statusDomElement=document.createElement("div")),console.warn("THREE.JSONLoader: .statusDomElement has been removed."),this._statusDomElement},load:function(t,r,n,i){var o=this,a=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:e.Loader.prototype.extractUrlBase(t),s=new e.XHRLoader(this.manager);s.setCrossOrigin(this.crossOrigin),s.setWithCredentials(this.withCredentials),s.load(t,function(e){var n=JSON.parse(e),i=n.metadata;if(void 0!==i){if("object"===i.type)return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===i.type)return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}var s=o.parse(n,a);r(s.geometry,s.materials)})},setCrossOrigin:function(t){this.crossOrigin=t},setTexturePath:function(t){this.texturePath=t},parse:function(t,r){function n(r){function n(t,e){return t&1<<e}var i,o,s,h,u,c,l,p,f,d,m,g,y,v,_,x,b,w,S,M,T,E,C,A,R,P,L,O=t.faces,D=t.vertices,k=t.normals,F=t.colors,N=0;if(void 0!==t.uvs){for(i=0;i<t.uvs.length;i++)t.uvs[i].length&&N++;for(i=0;N>i;i++)a.faceVertexUvs[i]=[]}for(h=0,u=D.length;u>h;)w=new e.Vector3,w.x=D[h++]*r,w.y=D[h++]*r,w.z=D[h++]*r,a.vertices.push(w);for(h=0,u=O.length;u>h;)if(d=O[h++],m=n(d,0),g=n(d,1),y=n(d,3),v=n(d,4),_=n(d,5),x=n(d,6),b=n(d,7),m){if(M=new e.Face3,M.a=O[h],M.b=O[h+1],M.c=O[h+3],T=new e.Face3,T.a=O[h+1],T.b=O[h+2],T.c=O[h+3],h+=4,g&&(f=O[h++],M.materialIndex=f,T.materialIndex=f),s=a.faces.length,y)for(i=0;N>i;i++)for(A=t.uvs[i],a.faceVertexUvs[i][s]=[],a.faceVertexUvs[i][s+1]=[],o=0;4>o;o++)p=O[h++],P=A[2*p],L=A[2*p+1],R=new e.Vector2(P,L),2!==o&&a.faceVertexUvs[i][s].push(R),0!==o&&a.faceVertexUvs[i][s+1].push(R);if(v&&(l=3*O[h++],M.normal.set(k[l++],k[l++],k[l]),T.normal.copy(M.normal)),_)for(i=0;4>i;i++)l=3*O[h++],C=new e.Vector3(k[l++],k[l++],k[l]),2!==i&&M.vertexNormals.push(C),0!==i&&T.vertexNormals.push(C);if(x&&(c=O[h++],E=F[c],M.color.setHex(E),T.color.setHex(E)),b)for(i=0;4>i;i++)c=O[h++],E=F[c],2!==i&&M.vertexColors.push(new e.Color(E)),0!==i&&T.vertexColors.push(new e.Color(E));a.faces.push(M),a.faces.push(T)}else{if(S=new e.Face3,S.a=O[h++],S.b=O[h++],S.c=O[h++],g&&(f=O[h++],S.materialIndex=f),s=a.faces.length,y)for(i=0;N>i;i++)for(A=t.uvs[i],a.faceVertexUvs[i][s]=[],o=0;3>o;o++)p=O[h++],P=A[2*p],L=A[2*p+1],R=new e.Vector2(P,L),a.faceVertexUvs[i][s].push(R);if(v&&(l=3*O[h++],S.normal.set(k[l++],k[l++],k[l])),_)for(i=0;3>i;i++)l=3*O[h++],C=new e.Vector3(k[l++],k[l++],k[l]),S.vertexNormals.push(C);if(x&&(c=O[h++],S.color.setHex(F[c])),b)for(i=0;3>i;i++)c=O[h++],S.vertexColors.push(new e.Color(F[c]));a.faces.push(S)}}function i(){var r=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var n=0,i=t.skinWeights.length;i>n;n+=r){var o=t.skinWeights[n],s=r>1?t.skinWeights[n+1]:0,h=r>2?t.skinWeights[n+2]:0,u=r>3?t.skinWeights[n+3]:0;a.skinWeights.push(new e.Vector4(o,s,h,u))}if(t.skinIndices)for(var n=0,i=t.skinIndices.length;i>n;n+=r){var c=t.skinIndices[n],l=r>1?t.skinIndices[n+1]:0,p=r>2?t.skinIndices[n+2]:0,f=r>3?t.skinIndices[n+3]:0;a.skinIndices.push(new e.Vector4(c,l,p,f))}a.bones=t.bones,a.bones&&a.bones.length>0&&(a.skinWeights.length!==a.skinIndices.length||a.skinIndices.length!==a.vertices.length)&&console.warn("When skinning, number of vertices ("+a.vertices.length+"), skinIndices ("+a.skinIndices.length+"), and skinWeights ("+a.skinWeights.length+") should match."),a.animation=t.animation,a.animations=t.animations}function o(r){if(void 0!==t.morphTargets){var n,i,o,s,h,u;for(n=0,i=t.morphTargets.length;i>n;n++)for(a.morphTargets[n]={},a.morphTargets[n].name=t.morphTargets[n].name,a.morphTargets[n].vertices=[],h=a.morphTargets[n].vertices,u=t.morphTargets[n].vertices,o=0,s=u.length;s>o;o+=3){var c=new e.Vector3;c.x=u[o]*r,c.y=u[o+1]*r,c.z=u[o+2]*r,h.push(c)}}if(void 0!==t.morphColors){var n,i,l,p,f,d,m;for(n=0,i=t.morphColors.length;i>n;n++)for(a.morphColors[n]={},a.morphColors[n].name=t.morphColors[n].name,a.morphColors[n].colors=[],f=a.morphColors[n].colors,d=t.morphColors[n].colors,l=0,p=d.length;p>l;l+=3)m=new e.Color(16755200),m.setRGB(d[l],d[l+1],d[l+2]),f.push(m)}}var a=new e.Geometry,s=void 0!==t.scale?1/t.scale:1;if(n(s),i(),o(s),a.computeFaceNormals(),a.computeBoundingSphere(),void 0===t.materials||0===t.materials.length)return{geometry:a};var h=e.Loader.prototype.initMaterials(t.materials,r,this.crossOrigin);return{geometry:a,materials:h}}},e.LoadingManager=function(t,e,r){var n=this,i=!1,o=0,a=0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=r,this.itemStart=function(t){a++,i===!1&&void 0!==n.onStart&&n.onStart(t,o,a),i=!0},this.itemEnd=function(t){o++,void 0!==n.onProgress&&n.onProgress(t,o,a),o===a&&(i=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)}},e.DefaultLoadingManager=new e.LoadingManager,e.BufferGeometryLoader=function(t){this.manager=void 0!==t?t:e.DefaultLoadingManager},e.BufferGeometryLoader.prototype={constructor:e.BufferGeometryLoader,load:function(t,r,n,i){var o=this,a=new e.XHRLoader(o.manager);a.setCrossOrigin(this.crossOrigin),a.load(t,function(t){r(o.parse(JSON.parse(t)))},n,i)},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t){var r=new e.BufferGeometry,n=t.data.index;if(void 0!==n){var i=new self[n.type](n.array);r.setIndex(new e.BufferAttribute(i,1))}var o=t.data.attributes;for(var a in o){var s=o[a],i=new self[s.type](s.array);r.addAttribute(a,new e.BufferAttribute(i,s.itemSize))}var h=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==h)for(var u=0,c=h.length;u!==c;++u){var l=h[u];r.addGroup(l.start,l.count)}var p=t.data.boundingSphere;if(void 0!==p){var f=new e.Vector3;void 0!==p.center&&f.fromArray(p.center),r.boundingSphere=new e.Sphere(f,p.radius)}return r}},e.MaterialLoader=function(t){this.manager=void 0!==t?t:e.DefaultLoadingManager,this.textures={}},e.MaterialLoader.prototype={constructor:e.MaterialLoader,load:function(t,r,n,i){var o=this,a=new e.XHRLoader(o.manager);a.setCrossOrigin(this.crossOrigin),a.load(t,function(t){r(o.parse(JSON.parse(t)))},n,i)},setCrossOrigin:function(t){this.crossOrigin=t},setTextures:function(t){this.textures=t},getTexture:function(t){var e=this.textures;return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]},parse:function(t){var r=new e[t.type];if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.uniforms&&(r.uniforms=t.uniforms),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(r.vertexColors=t.vertexColors),void 0!==t.shading&&(r.shading=t.shading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=this.getTexture(t.map)),void 0!==t.alphaMap&&(r.alphaMap=this.getTexture(t.alphaMap),r.transparent=!0),void 0!==t.bumpMap&&(r.bumpMap=this.getTexture(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=this.getTexture(t.normalMap)),t.normalScale&&(r.normalScale=new e.Vector2(t.normalScale,t.normalScale)),void 0!==t.displacementMap&&(r.displacementMap=this.getTexture(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.specularMap&&(r.specularMap=this.getTexture(t.specularMap)),void 0!==t.envMap&&(r.envMap=this.getTexture(t.envMap),r.combine=e.MultiplyOperation),t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.lightMap&&(r.lightMap=this.getTexture(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=this.getTexture(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.materials)for(var n=0,i=t.materials.length;i>n;n++)r.materials.push(this.parse(t.materials[n]));return r}},e.ObjectLoader=function(t){this.manager=void 0!==t?t:e.DefaultLoadingManager,this.texturePath=""},e.ObjectLoader.prototype={constructor:e.ObjectLoader,load:function(t,r,n,i){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var o=this,a=new e.XHRLoader(o.manager);a.setCrossOrigin(this.crossOrigin),a.load(t,function(t){o.parse(JSON.parse(t),r)},n,i)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var r=this.parseGeometries(t.geometries),n=this.parseImages(t.images,function(){void 0!==e&&e(a)}),i=this.parseTextures(t.textures,n),o=this.parseMaterials(t.materials,i),a=this.parseObject(t.object,r,o);return(void 0===t.images||0===t.images.length)&&void 0!==e&&e(a),a},parseGeometries:function(t){var r={};if(void 0!==t)for(var n=new e.JSONLoader,i=new e.BufferGeometryLoader,o=0,a=t.length;a>o;o++){var s,h=t[o];switch(h.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new e[h.type](h.width,h.height,h.widthSegments,h.heightSegments);break;case"BoxGeometry":case"CubeGeometry":s=new e.BoxGeometry(h.width,h.height,h.depth,h.widthSegments,h.heightSegments,h.depthSegments);break;case"CircleBufferGeometry":s=new e.CircleBufferGeometry(h.radius,h.segments,h.thetaStart,h.thetaLength);break;case"CircleGeometry":s=new e.CircleGeometry(h.radius,h.segments,h.thetaStart,h.thetaLength);break;case"CylinderGeometry":s=new e.CylinderGeometry(h.radiusTop,h.radiusBottom,h.height,h.radialSegments,h.heightSegments,h.openEnded,h.thetaStart,h.thetaLength);break;case"SphereGeometry":s=new e.SphereGeometry(h.radius,h.widthSegments,h.heightSegments,h.phiStart,h.phiLength,h.thetaStart,h.thetaLength);break;case"SphereBufferGeometry":s=new e.SphereBufferGeometry(h.radius,h.widthSegments,h.heightSegments,h.phiStart,h.phiLength,h.thetaStart,h.thetaLength);break;case"DodecahedronGeometry":s=new e.DodecahedronGeometry(h.radius,h.detail);break;case"IcosahedronGeometry":s=new e.IcosahedronGeometry(h.radius,h.detail);break;case"OctahedronGeometry":s=new e.OctahedronGeometry(h.radius,h.detail);break;case"TetrahedronGeometry":s=new e.TetrahedronGeometry(h.radius,h.detail);break;case"RingGeometry":s=new e.RingGeometry(h.innerRadius,h.outerRadius,h.thetaSegments,h.phiSegments,h.thetaStart,h.thetaLength);break;case"TorusGeometry":s=new e.TorusGeometry(h.radius,h.tube,h.radialSegments,h.tubularSegments,h.arc);break;case"TorusKnotGeometry":s=new e.TorusKnotGeometry(h.radius,h.tube,h.radialSegments,h.tubularSegments,h.p,h.q,h.heightScale);break;case"TextGeometry":s=new e.TextGeometry(h.text,h.data);break;case"BufferGeometry":s=i.parse(h);break;case"Geometry":s=n.parse(h.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+h.type+'"');continue}s.uuid=h.uuid,void 0!==h.name&&(s.name=h.name),r[h.uuid]=s}return r},parseMaterials:function(t,r){var n={};if(void 0!==t){var i=new e.MaterialLoader;i.setTextures(r);for(var o=0,a=t.length;a>o;o++){var s=i.parse(t[o]);n[s.uuid]=s}}return n},parseImages:function(t,r){function n(t){return i.manager.itemStart(t),s.load(t,function(){i.manager.itemEnd(t)})}var i=this,o={};if(void 0!==t&&t.length>0){var a=new e.LoadingManager(r),s=new e.ImageLoader(a);s.setCrossOrigin(this.crossOrigin);for(var h=0,u=t.length;u>h;h++){var c=t[h],l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:i.texturePath+c.url;o[c.uuid]=n(l)}}return o},parseTextures:function(t,r){function n(t){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var i={};if(void 0!==t)for(var o=0,a=t.length;a>o;o++){var s=t[o];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===r[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);var h=new e.Texture(r[s.image]);h.needsUpdate=!0,h.uuid=s.uuid,void 0!==s.name&&(h.name=s.name),void 0!==s.mapping&&(h.mapping=n(s.mapping)),void 0!==s.offset&&(h.offset=new e.Vector2(s.offset[0],s.offset[1])),void 0!==s.repeat&&(h.repeat=new e.Vector2(s.repeat[0],s.repeat[1])),void 0!==s.minFilter&&(h.minFilter=n(s.minFilter)),void 0!==s.magFilter&&(h.magFilter=n(s.magFilter)),void 0!==s.anisotropy&&(h.anisotropy=s.anisotropy),Array.isArray(s.wrap)&&(h.wrapS=n(s.wrap[0]),h.wrapT=n(s.wrap[1])),i[s.uuid]=h}return i},parseObject:function(){var t=new e.Matrix4;return function(r,n,i){var o,a=function(t){return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),n[t]},s=function(t){return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),i[t]};switch(r.type){case"Scene":o=new e.Scene;break;case"PerspectiveCamera":o=new e.PerspectiveCamera(r.fov,r.aspect,r.near,r.far);break;case"OrthographicCamera":o=new e.OrthographicCamera(r.left,r.right,r.top,r.bottom,r.near,r.far);break;case"AmbientLight":o=new e.AmbientLight(r.color);break;case"DirectionalLight":o=new e.DirectionalLight(r.color,r.intensity);break;case"PointLight":o=new e.PointLight(r.color,r.intensity,r.distance,r.decay);break;case"SpotLight":o=new e.SpotLight(r.color,r.intensity,r.distance,r.angle,r.exponent,r.decay);break;case"HemisphereLight":o=new e.HemisphereLight(r.color,r.groundColor,r.intensity);break;case"Mesh":o=new e.Mesh(a(r.geometry),s(r.material));break;case"LOD":o=new e.LOD;break;case"Line":o=new e.Line(a(r.geometry),s(r.material),r.mode);break;case"PointCloud":case"Points":o=new e.Points(a(r.geometry),s(r.material));break;case"Sprite":o=new e.Sprite(s(r.material));break;case"Group":o=new e.Group;break;default:o=new e.Object3D}if(o.uuid=r.uuid,void 0!==r.name&&(o.name=r.name),
void 0!==r.matrix?(t.fromArray(r.matrix),t.decompose(o.position,o.quaternion,o.scale)):(void 0!==r.position&&o.position.fromArray(r.position),void 0!==r.rotation&&o.rotation.fromArray(r.rotation),void 0!==r.scale&&o.scale.fromArray(r.scale)),void 0!==r.castShadow&&(o.castShadow=r.castShadow),void 0!==r.receiveShadow&&(o.receiveShadow=r.receiveShadow),void 0!==r.visible&&(o.visible=r.visible),void 0!==r.userData&&(o.userData=r.userData),void 0!==r.children)for(var h in r.children)o.add(this.parseObject(r.children[h],n,i));if("LOD"===r.type)for(var u=r.levels,c=0;c<u.length;c++){var l=u[c],h=o.getObjectByProperty("uuid",l.object);void 0!==h&&o.addLevel(h,l.distance)}return o}}()},e.TextureLoader=function(t){this.manager=void 0!==t?t:e.DefaultLoadingManager},e.TextureLoader.prototype={constructor:e.TextureLoader,load:function(t,r,n,i){var o=this,a=new e.ImageLoader(o.manager);a.setCrossOrigin(this.crossOrigin),a.load(t,function(t){var n=new e.Texture(t);n.needsUpdate=!0,void 0!==r&&r(n)},n,i)},setCrossOrigin:function(t){this.crossOrigin=t}},e.DataTextureLoader=e.BinaryTextureLoader=function(t){this.manager=void 0!==t?t:e.DefaultLoadingManager,this._parser=null},e.BinaryTextureLoader.prototype={constructor:e.BinaryTextureLoader,load:function(t,r,n,i){var o=this,a=new e.DataTexture,s=new e.XHRLoader(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setResponseType("arraybuffer"),s.load(t,function(t){var n=o._parser(t);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:e.ClampToEdgeWrapping,a.wrapT=void 0!==n.wrapT?n.wrapT:e.ClampToEdgeWrapping,a.magFilter=void 0!==n.magFilter?n.magFilter:e.LinearFilter,a.minFilter=void 0!==n.minFilter?n.minFilter:e.LinearMipMapLinearFilter,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps),1===n.mipmapCount&&(a.minFilter=e.LinearFilter),a.needsUpdate=!0,r&&r(a,n))},n,i),a},setCrossOrigin:function(t){this.crossOrigin=t}},e.CompressedTextureLoader=function(t){this.manager=void 0!==t?t:e.DefaultLoadingManager,this._parser=null},e.CompressedTextureLoader.prototype={constructor:e.CompressedTextureLoader,load:function(t,r,n,i){var o=this,a=[],s=new e.CompressedTexture;s.image=a;var h=new e.XHRLoader(this.manager);if(h.setCrossOrigin(this.crossOrigin),h.setResponseType("arraybuffer"),Array.isArray(t))for(var u=0,c=function(c){h.load(t[c],function(t){var n=o._parser(t,!0);a[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},u+=1,6===u&&(1===n.mipmapCount&&(s.minFilter=e.LinearFilter),s.format=n.format,s.needsUpdate=!0,r&&r(s))},n,i)},l=0,p=t.length;p>l;++l)c(l);else h.load(t,function(t){var n=o._parser(t,!0);if(n.isCubemap)for(var i=n.mipmaps.length/n.mipmapCount,h=0;i>h;h++){a[h]={mipmaps:[]};for(var u=0;u<n.mipmapCount;u++)a[h].mipmaps.push(n.mipmaps[h*n.mipmapCount+u]),a[h].format=n.format,a[h].width=n.width,a[h].height=n.height}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=e.LinearFilter),s.format=n.format,s.needsUpdate=!0,r&&r(s)},n,i);return s},setCrossOrigin:function(t){this.crossOrigin=t}},e.Material=function(){Object.defineProperty(this,"id",{value:e.MaterialIdCount++}),this.uuid=e.Math.generateUUID(),this.name="",this.type="Material",this.side=e.FrontSide,this.opacity=1,this.transparent=!1,this.blending=e.NormalBlending,this.blendSrc=e.SrcAlphaFactor,this.blendDst=e.OneMinusSrcAlphaFactor,this.blendEquation=e.AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=e.LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.overdraw=0,this.visible=!0,this._needsUpdate=!0},e.Material.prototype={constructor:e.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){t===!0&&this.update(),this._needsUpdate=t},setValues:function(t){if(void 0!==t)for(var r in t){var n=t[r];if(void 0!==n){var i=this[r];void 0!==i?i instanceof e.Color?i.set(n):i instanceof e.Vector3&&n instanceof e.Vector3?i.copy(n):"overdraw"===r?this[r]=Number(n):this[r]=n:console.warn("THREE."+this.type+": '"+r+"' is not a property of this material.")}else console.warn("THREE.Material: '"+r+"' parameter is undefined.")}},toJSON:function(t){var r={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};return r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color instanceof e.Color&&(r.color=this.color.getHex()),this.emissive instanceof e.Color&&(r.emissive=this.emissive.getHex()),this.specular instanceof e.Color&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),this.map instanceof e.Texture&&(r.map=this.map.toJSON(t).uuid),this.alphaMap instanceof e.Texture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap instanceof e.Texture&&(r.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap instanceof e.Texture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap instanceof e.Texture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalScale=this.normalScale),this.displacementMap instanceof e.Texture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.specularMap instanceof e.Texture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.envMap instanceof e.Texture&&(r.envMap=this.envMap.toJSON(t).uuid,r.reflectivity=this.reflectivity),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),void 0!==this.vertexColors&&this.vertexColors!==e.NoColors&&(r.vertexColors=this.vertexColors),void 0!==this.shading&&this.shading!==e.SmoothShading&&(r.shading=this.shading),void 0!==this.blending&&this.blending!==e.NormalBlending&&(r.blending=this.blending),void 0!==this.side&&this.side!==e.FrontSide&&(r.side=this.side),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),r},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.side=t.side,this.opacity=t.opacity,this.transparent=t.transparent,this.blending=t.blending,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.alphaTest=t.alphaTest,this.overdraw=t.overdraw,this.visible=t.visible,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})},get wrapAround(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set wrapAround(t){console.warn("THREE."+this.type+": .wrapAround has been removed.")},get wrapRGB(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new e.Color}},e.EventDispatcher.prototype.apply(e.Material.prototype),e.MaterialIdCount=0,e.LineBasicMaterial=function(t){e.Material.call(this),this.type="LineBasicMaterial",this.color=new e.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=e.NoColors,this.fog=!0,this.setValues(t)},e.LineBasicMaterial.prototype=Object.create(e.Material.prototype),e.LineBasicMaterial.prototype.constructor=e.LineBasicMaterial,e.LineBasicMaterial.prototype.copy=function(t){return e.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.vertexColors=t.vertexColors,this.fog=t.fog,this},e.LineDashedMaterial=function(t){e.Material.call(this),this.type="LineDashedMaterial",this.color=new e.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(t)},e.LineDashedMaterial.prototype=Object.create(e.Material.prototype),e.LineDashedMaterial.prototype.constructor=e.LineDashedMaterial,e.LineDashedMaterial.prototype.copy=function(t){return e.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this.vertexColors=t.vertexColors,this.fog=t.fog,this},e.MeshBasicMaterial=function(t){e.Material.call(this),this.type="MeshBasicMaterial",this.color=new e.Color(16777215),this.map=null,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=e.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=e.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=e.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(t)},e.MeshBasicMaterial.prototype=Object.create(e.Material.prototype),e.MeshBasicMaterial.prototype.constructor=e.MeshBasicMaterial,e.MeshBasicMaterial.prototype.copy=function(t){return e.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},e.MeshLambertMaterial=function(t){e.Material.call(this),this.type="MeshLambertMaterial",this.color=new e.Color(16777215),this.emissive=new e.Color(0),this.map=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=e.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=e.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},e.MeshLambertMaterial.prototype=Object.create(e.Material.prototype),e.MeshLambertMaterial.prototype.constructor=e.MeshLambertMaterial,e.MeshLambertMaterial.prototype.copy=function(t){return e.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.emissive.copy(t.emissive),this.map=t.map,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},e.MeshPhongMaterial=function(t){e.Material.call(this),this.type="MeshPhongMaterial",this.color=new e.Color(16777215),this.emissive=new e.Color(0),this.specular=new e.Color(1118481),this.shininess=30,this.metal=!1,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new e.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=e.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=e.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=e.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},e.MeshPhongMaterial.prototype=Object.create(e.Material.prototype),e.MeshPhongMaterial.prototype.constructor=e.MeshPhongMaterial,e.MeshPhongMaterial.prototype.copy=function(t){return e.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.emissive.copy(t.emissive),this.specular.copy(t.specular),this.shininess=t.shininess,this.metal=t.metal,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissiveMap=t.emissiveMap,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},e.MeshDepthMaterial=function(t){e.Material.call(this),this.type="MeshDepthMaterial",this.morphTargets=!1,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)},e.MeshDepthMaterial.prototype=Object.create(e.Material.prototype),e.MeshDepthMaterial.prototype.constructor=e.MeshDepthMaterial,e.MeshDepthMaterial.prototype.copy=function(t){return e.Material.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},e.MeshNormalMaterial=function(t){e.Material.call(this,t),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(t)},e.MeshNormalMaterial.prototype=Object.create(e.Material.prototype),e.MeshNormalMaterial.prototype.constructor=e.MeshNormalMaterial,e.MeshNormalMaterial.prototype.copy=function(t){return e.Material.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},e.MultiMaterial=function(t){this.uuid=e.Math.generateUUID(),this.type="MultiMaterial",this.materials=t instanceof Array?t:[],this.visible=!0},e.MultiMaterial.prototype={constructor:e.MultiMaterial,toJSON:function(){for(var t={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},e=0,r=this.materials.length;r>e;e++)t.materials.push(this.materials[e].toJSON());return t.visible=this.visible,t},clone:function(){for(var t=new this.constructor,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t.visible=this.visible,t}},e.MeshFaceMaterial=e.MultiMaterial,e.PointsMaterial=function(t){e.Material.call(this),this.type="PointsMaterial",this.color=new e.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=e.NoColors,this.fog=!0,this.setValues(t)},e.PointsMaterial.prototype=Object.create(e.Material.prototype),e.PointsMaterial.prototype.constructor=e.PointsMaterial,e.PointsMaterial.prototype.copy=function(t){return e.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.vertexColors=t.vertexColors,this.fog=t.fog,this},e.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new e.PointsMaterial(t)},e.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new e.PointsMaterial(t)},e.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new e.PointsMaterial(t)},e.ShaderMaterial=function(t){e.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=e.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=e.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.derivatives=!1,this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))},e.ShaderMaterial.prototype=Object.create(e.Material.prototype),e.ShaderMaterial.prototype.constructor=e.ShaderMaterial,e.ShaderMaterial.prototype.copy=function(t){return e.Material.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=e.UniformsUtils.clone(t.uniforms),this.attributes=t.attributes,this.defines=t.defines,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.derivatives=t.derivatives,this},e.ShaderMaterial.prototype.toJSON=function(t){var r=e.Material.prototype.toJSON.call(this,t);return r.uniforms=this.uniforms,r.attributes=this.attributes,r.vertexShader=this.vertexShader,r.fragmentShader=this.fragmentShader,r},e.RawShaderMaterial=function(t){e.ShaderMaterial.call(this,t),this.type="RawShaderMaterial"},e.RawShaderMaterial.prototype=Object.create(e.ShaderMaterial.prototype),e.RawShaderMaterial.prototype.constructor=e.RawShaderMaterial,e.SpriteMaterial=function(t){e.Material.call(this),this.type="SpriteMaterial",this.color=new e.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(t)},e.SpriteMaterial.prototype=Object.create(e.Material.prototype),e.SpriteMaterial.prototype.constructor=e.SpriteMaterial,e.SpriteMaterial.prototype.copy=function(t){return e.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this.fog=t.fog,this},e.Texture=function(t,r,n,i,o,a,s,h,u){Object.defineProperty(this,"id",{value:e.TextureIdCount++}),this.uuid=e.Math.generateUUID(),this.name="",this.sourceFile="",this.image=void 0!==t?t:e.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==r?r:e.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:e.ClampToEdgeWrapping,this.wrapT=void 0!==i?i:e.ClampToEdgeWrapping,this.magFilter=void 0!==o?o:e.LinearFilter,this.minFilter=void 0!==a?a:e.LinearMipMapLinearFilter,this.anisotropy=void 0!==u?u:1,this.format=void 0!==s?s:e.RGBAFormat,this.type=void 0!==h?h:e.UnsignedByteType,this.offset=new e.Vector2(0,0),this.repeat=new e.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.version=0,this.onUpdate=null},e.Texture.DEFAULT_IMAGE=void 0,e.Texture.DEFAULT_MAPPING=e.UVMapping,e.Texture.prototype={constructor:e.Texture,set needsUpdate(t){t===!0&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this},toJSON:function(t){function r(t){var e;return void 0!==t.toDataURL?e=t:(e=document.createElement("canvas"),e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0,t.width,t.height)),e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}if(void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var i=this.image;void 0===i.uuid&&(i.uuid=e.Math.generateUUID()),void 0===t.images[i.uuid]&&(t.images[i.uuid]={uuid:i.uuid,url:r(i)}),n.image=i.uuid}return t.textures[this.uuid]=n,n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===e.UVMapping){if(t.multiply(this.repeat),t.add(this.offset),t.x<0||t.x>1)switch(this.wrapS){case e.RepeatWrapping:t.x=t.x-Math.floor(t.x);break;case e.ClampToEdgeWrapping:t.x=t.x<0?0:1;break;case e.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case e.RepeatWrapping:t.y=t.y-Math.floor(t.y);break;case e.ClampToEdgeWrapping:t.y=t.y<0?0:1;break;case e.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}},e.EventDispatcher.prototype.apply(e.Texture.prototype),e.TextureIdCount=0,e.CanvasTexture=function(t,r,n,i,o,a,s,h,u){e.Texture.call(this,t,r,n,i,o,a,s,h,u),this.needsUpdate=!0},e.CanvasTexture.prototype=Object.create(e.Texture.prototype),e.CanvasTexture.prototype.constructor=e.CanvasTexture,e.CubeTexture=function(t,r,n,i,o,a,s,h,u){r=void 0!==r?r:e.CubeReflectionMapping,e.Texture.call(this,t,r,n,i,o,a,s,h,u),this.images=t,this.flipY=!1},e.CubeTexture.prototype=Object.create(e.Texture.prototype),e.CubeTexture.prototype.constructor=e.CubeTexture,e.CubeTexture.prototype.copy=function(t){return e.Texture.prototype.copy.call(this,t),this.images=t.images,this},e.CompressedTexture=function(t,r,n,i,o,a,s,h,u,c,l){e.Texture.call(this,null,a,s,h,u,c,i,o,l),this.image={width:r,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1},e.CompressedTexture.prototype=Object.create(e.Texture.prototype),e.CompressedTexture.prototype.constructor=e.CompressedTexture,e.DataTexture=function(t,r,n,i,o,a,s,h,u,c,l){e.Texture.call(this,null,a,s,h,u,c,i,o,l),this.image={data:t,width:r,height:n},this.magFilter=void 0!==u?u:e.NearestFilter,this.minFilter=void 0!==c?c:e.NearestFilter,this.flipY=!1,this.generateMipmaps=!1},e.DataTexture.prototype=Object.create(e.Texture.prototype),e.DataTexture.prototype.constructor=e.DataTexture,e.VideoTexture=function(t,r,n,i,o,a,s,h,u){e.Texture.call(this,t,r,n,i,o,a,s,h,u),this.generateMipmaps=!1;var c=this,l=function(){requestAnimationFrame(l),t.readyState===t.HAVE_ENOUGH_DATA&&(c.needsUpdate=!0)};l()},e.VideoTexture.prototype=Object.create(e.Texture.prototype),e.VideoTexture.prototype.constructor=e.VideoTexture,e.Group=function(){e.Object3D.call(this),this.type="Group"},e.Group.prototype=Object.create(e.Object3D.prototype),e.Group.prototype.constructor=e.Group,e.Points=function(t,r){e.Object3D.call(this),this.type="Points",this.geometry=void 0!==t?t:new e.Geometry,this.material=void 0!==r?r:new e.PointsMaterial({color:16777215*Math.random()})},e.Points.prototype=Object.create(e.Object3D.prototype),e.Points.prototype.constructor=e.Points,e.Points.prototype.raycast=function(){var t=new e.Matrix4,r=new e.Ray;return function(n,i){function o(t,e){var o=r.distanceSqToPoint(t);if(c>o){var s=r.closestPointToPoint(t);s.applyMatrix4(a.matrixWorld);var h=n.ray.origin.distanceTo(s);if(h<n.near||h>n.far)return;i.push({distance:h,distanceToRay:Math.sqrt(o),point:s.clone(),index:e,face:null,object:a})}}var a=this,s=a.geometry,h=n.params.Points.threshold;if(t.getInverse(this.matrixWorld),r.copy(n.ray).applyMatrix4(t),null===s.boundingBox||r.isIntersectionBox(s.boundingBox)!==!1){var u=h/((this.scale.x+this.scale.y+this.scale.z)/3),c=u*u,l=new e.Vector3;if(s instanceof e.BufferGeometry){var p=s.index,f=s.attributes,d=f.position.array;if(null!==p)for(var m=p.array,g=0,y=m.length;y>g;g++){var v=m[g];l.fromArray(d,3*v),o(l,v)}else for(var g=0,_=d.length/3;_>g;g++)l.fromArray(d,3*g),o(l,g)}else for(var x=s.vertices,g=0,_=x.length;_>g;g++)o(x[g],g)}}}(),e.Points.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},e.Points.prototype.toJSON=function(t){var r=e.Object3D.prototype.toJSON.call(this,t);return void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON()),void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON()),r.object.geometry=this.geometry.uuid,r.object.material=this.material.uuid,r},e.PointCloud=function(t,r){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new e.Points(t,r)},e.ParticleSystem=function(t,r){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new e.Points(t,r)},e.Line=function(t,r,n){return 1===n?(console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new e.LineSegments(t,r)):(e.Object3D.call(this),this.type="Line",this.geometry=void 0!==t?t:new e.Geometry,void(this.material=void 0!==r?r:new e.LineBasicMaterial({color:16777215*Math.random()})))},e.Line.prototype=Object.create(e.Object3D.prototype),e.Line.prototype.constructor=e.Line,e.Line.prototype.raycast=function(){var t=new e.Matrix4,r=new e.Ray,n=new e.Sphere;return function(i,o){var a=i.linePrecision,s=a*a,h=this.geometry;if(null===h.boundingSphere&&h.computeBoundingSphere(),n.copy(h.boundingSphere),n.applyMatrix4(this.matrixWorld),i.ray.isIntersectionSphere(n)!==!1){t.getInverse(this.matrixWorld),r.copy(i.ray).applyMatrix4(t);var u=new e.Vector3,c=new e.Vector3,l=new e.Vector3,p=new e.Vector3,f=this instanceof e.LineSegments?2:1;if(h instanceof e.BufferGeometry){var d=h.index,m=h.attributes;if(null!==d)for(var g=d.array,y=m.position.array,v=0,_=g.length-1;_>v;v+=f){var x=g[v],b=g[v+1];u.fromArray(y,3*x),c.fromArray(y,3*b);var w=r.distanceSqToSegment(u,c,p,l);if(!(w>s)){p.applyMatrix4(this.matrixWorld);var S=i.ray.origin.distanceTo(p);S<i.near||S>i.far||o.push({distance:S,point:l.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else for(var y=m.position.array,v=0,_=y.length/3-1;_>v;v+=f){u.fromArray(y,3*v),c.fromArray(y,3*v+3);var w=r.distanceSqToSegment(u,c,p,l);if(!(w>s)){p.applyMatrix4(this.matrixWorld);var S=i.ray.origin.distanceTo(p);S<i.near||S>i.far||o.push({distance:S,point:l.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}else if(h instanceof e.Geometry)for(var M=h.vertices,T=M.length,v=0;T-1>v;v+=f){var w=r.distanceSqToSegment(M[v],M[v+1],p,l);if(!(w>s)){p.applyMatrix4(this.matrixWorld);var S=i.ray.origin.distanceTo(p);S<i.near||S>i.far||o.push({distance:S,point:l.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}}}(),e.Line.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},e.Line.prototype.toJSON=function(t){var r=e.Object3D.prototype.toJSON.call(this,t);return void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON()),void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON()),r.object.geometry=this.geometry.uuid,r.object.material=this.material.uuid,r},e.LineStrip=0,e.LinePieces=1,e.LineSegments=function(t,r){e.Line.call(this,t,r),this.type="LineSegments"},e.LineSegments.prototype=Object.create(e.Line.prototype),e.LineSegments.prototype.constructor=e.LineSegments,e.Mesh=function(t,r){e.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new e.Geometry,this.material=void 0!==r?r:new e.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},e.Mesh.prototype=Object.create(e.Object3D.prototype),e.Mesh.prototype.constructor=e.Mesh,e.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var t=0,e=this.geometry.morphTargets.length;e>t;t++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[t].name]=t}},e.Mesh.prototype.getMorphTargetIndexByName=function(t){return void 0!==this.morphTargetDictionary[t]?this.morphTargetDictionary[t]:(console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+t+" does not exist. Returning 0."),0)},e.Mesh.prototype.raycast=function(){function t(t,r,n,i,o,a,s){return e.Triangle.barycoordFromPoint(t,r,n,i,d),o.multiplyScalar(d.x),a.multiplyScalar(d.y),s.multiplyScalar(d.z),o.add(a).add(s),o.clone()}var r=new e.Matrix4,n=new e.Ray,i=new e.Sphere,o=new e.Vector3,a=new e.Vector3,s=new e.Vector3,h=new e.Vector3,u=new e.Vector3,c=new e.Vector3,l=new e.Vector2,p=new e.Vector2,f=new e.Vector2,d=new e.Vector3,m=new e.Vector3,g=new e.Vector3;return function(d,y){var v=this.geometry,_=this.material;if(void 0!==_&&(null===v.boundingSphere&&v.computeBoundingSphere(),i.copy(v.boundingSphere),i.applyMatrix4(this.matrixWorld),d.ray.isIntersectionSphere(i)!==!1&&(r.getInverse(this.matrixWorld),n.copy(d.ray).applyMatrix4(r),null===v.boundingBox||n.isIntersectionBox(v.boundingBox)!==!1))){var x,b,w;if(v instanceof e.BufferGeometry){var S=v.index,M=v.attributes;if(null!==S)for(var T=S.array,E=M.position.array,C=0,A=T.length;A>C;C+=3){if(x=T[C],b=T[C+1],w=T[C+2],o.fromArray(E,3*x),a.fromArray(E,3*b),s.fromArray(E,3*w),_.side===e.BackSide){if(null===n.intersectTriangle(s,a,o,!0,m))continue}else if(null===n.intersectTriangle(o,a,s,_.side!==e.DoubleSide,m))continue;g.copy(m),g.applyMatrix4(this.matrixWorld);var R=d.ray.origin.distanceTo(g);if(!(R<d.near||R>d.far)){var P;if(void 0!==M.uv){var L=M.uv.array;l.fromArray(L,2*x),p.fromArray(L,2*b),f.fromArray(L,2*w),P=t(m,o,a,s,l,p,f)}y.push({distance:R,point:g.clone(),uv:P,face:new e.Face3(x,b,w,e.Triangle.normal(o,a,s)),faceIndex:Math.floor(C/3),object:this})}}else for(var E=M.position.array,C=0,A=E.length;A>C;C+=9){if(o.fromArray(E,C),a.fromArray(E,C+3),s.fromArray(E,C+6),_.side===e.BackSide){if(null===n.intersectTriangle(s,a,o,!0,m))continue}else if(null===n.intersectTriangle(o,a,s,_.side!==e.DoubleSide,m))continue;g.copy(m),g.applyMatrix4(this.matrixWorld);var R=d.ray.origin.distanceTo(g);if(!(R<d.near||R>d.far)){var P;if(void 0!==M.uv){var L=M.uv.array;l.fromArray(L,C),p.fromArray(L,C+2),f.fromArray(L,C+4),P=t(m,o,a,s,l,p,f)}x=C/3,b=x+1,w=x+2,y.push({distance:R,point:g.clone(),uv:P,face:new e.Face3(x,b,w,e.Triangle.normal(o,a,s)),index:x,object:this})}}}else if(v instanceof e.Geometry)for(var O=_ instanceof e.MeshFaceMaterial,D=O===!0?_.materials:null,k=v.vertices,F=v.faces,N=0,I=F.length;I>N;N++){var U=F[N],B=O===!0?D[U.materialIndex]:_;if(void 0!==B){if(x=k[U.a],b=k[U.b],w=k[U.c],B.morphTargets===!0){var V=v.morphTargets,G=this.morphTargetInfluences;o.set(0,0,0),a.set(0,0,0),s.set(0,0,0);for(var z=0,H=V.length;H>z;z++){var j=G[z];if(0!==j){var W=V[z].vertices;o.addScaledVector(h.subVectors(W[U.a],x),j),a.addScaledVector(u.subVectors(W[U.b],b),j),s.addScaledVector(c.subVectors(W[U.c],w),j)}}o.add(x),a.add(b),s.add(w),x=o,b=a,w=s}if(B.side===e.BackSide){if(null===n.intersectTriangle(w,b,x,!0,m))continue}else if(null===n.intersectTriangle(x,b,w,B.side!==e.DoubleSide,m))continue;g.copy(m),g.applyMatrix4(this.matrixWorld);var R=d.ray.origin.distanceTo(g);if(!(R<d.near||R>d.far)){var P;if(v.faceVertexUvs[0].length>0){var L=v.faceVertexUvs[0][N];l.copy(L[0]),p.copy(L[1]),f.copy(L[2]),P=t(m,x,b,w,l,p,f)}y.push({distance:R,point:g.clone(),
uv:P,face:U,faceIndex:N,object:this})}}}}}}(),e.Mesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},e.Mesh.prototype.toJSON=function(t){var r=e.Object3D.prototype.toJSON.call(this,t);return void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON(t)),void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON(t)),r.object.geometry=this.geometry.uuid,r.object.material=this.material.uuid,r},e.Bone=function(t){e.Object3D.call(this),this.type="Bone",this.skin=t},e.Bone.prototype=Object.create(e.Object3D.prototype),e.Bone.prototype.constructor=e.Bone,e.Bone.prototype.copy=function(t){return e.Object3D.prototype.copy.call(this,t),this.skin=t.skin,this},e.Skeleton=function(t,r,n){if(this.useVertexTexture=void 0!==n?n:!0,this.identityMatrix=new e.Matrix4,t=t||[],this.bones=t.slice(0),this.useVertexTexture){var i=Math.sqrt(4*this.bones.length);i=e.Math.nextPowerOfTwo(Math.ceil(i)),i=Math.max(i,4),this.boneTextureWidth=i,this.boneTextureHeight=i,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new e.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,e.RGBAFormat,e.FloatType)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===r)this.calculateInverses();else if(this.bones.length===r.length)this.boneInverses=r.slice(0);else{console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var o=0,a=this.bones.length;a>o;o++)this.boneInverses.push(new e.Matrix4)}},e.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var t=0,r=this.bones.length;r>t;t++){var n=new e.Matrix4;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},e.Skeleton.prototype.pose=function(){for(var t,e=0,r=this.bones.length;r>e;e++)t=this.bones[e],t&&t.matrixWorld.getInverse(this.boneInverses[e]);for(var e=0,r=this.bones.length;r>e;e++)t=this.bones[e],t&&(t.parent?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},e.Skeleton.prototype.update=function(){var t=new e.Matrix4;return function(){for(var e=0,r=this.bones.length;r>e;e++){var n=this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix;t.multiplyMatrices(n,this.boneInverses[e]),t.flattenToArrayOffset(this.boneMatrices,16*e)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),e.Skeleton.prototype.clone=function(){return new e.Skeleton(this.bones,this.boneInverses,this.useVertexTexture)},e.SkinnedMesh=function(t,r,n){e.Mesh.call(this,t,r),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new e.Matrix4,this.bindMatrixInverse=new e.Matrix4;var i=[];if(this.geometry&&void 0!==this.geometry.bones){for(var o,a,s=0,h=this.geometry.bones.length;h>s;++s)a=this.geometry.bones[s],o=new e.Bone(this),i.push(o),o.name=a.name,o.position.fromArray(a.pos),o.quaternion.fromArray(a.rotq),void 0!==a.scl&&o.scale.fromArray(a.scl);for(var s=0,h=this.geometry.bones.length;h>s;++s)a=this.geometry.bones[s],-1!==a.parent?i[a.parent].add(i[s]):this.add(i[s])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new e.Skeleton(i,void 0,n),this.matrixWorld)},e.SkinnedMesh.prototype=Object.create(e.Mesh.prototype),e.SkinnedMesh.prototype.constructor=e.SkinnedMesh,e.SkinnedMesh.prototype.bind=function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},e.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},e.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof e.Geometry)for(var t=0;t<this.geometry.skinIndices.length;t++){var r=this.geometry.skinWeights[t],n=1/r.lengthManhattan();n!==1/0?r.multiplyScalar(n):r.set(1)}},e.SkinnedMesh.prototype.updateMatrixWorld=function(t){e.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},e.SkinnedMesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material,this.useVertexTexture).copy(this)},e.MorphAnimMesh=function(t,r){e.Mesh.call(this,t,r),this.type="MorphAnimMesh",this.duration=1e3,this.mirroredLoop=!1,this.time=0,this.lastKeyframe=0,this.currentKeyframe=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,t.morphTargets.length-1)},e.MorphAnimMesh.prototype=Object.create(e.Mesh.prototype),e.MorphAnimMesh.prototype.constructor=e.MorphAnimMesh,e.MorphAnimMesh.prototype.setFrameRange=function(t,e){this.startKeyframe=t,this.endKeyframe=e,this.length=this.endKeyframe-this.startKeyframe+1},e.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},e.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},e.MorphAnimMesh.prototype.parseAnimations=function(){var t=this.geometry;t.animations||(t.animations={});for(var e,r=t.animations,n=/([a-z]+)_?(\d+)/,i=0,o=t.morphTargets.length;o>i;i++){var a=t.morphTargets[i],s=a.name.match(n);if(s&&s.length>1){var h=s[1];r[h]||(r[h]={start:1/0,end:-(1/0)});var u=r[h];i<u.start&&(u.start=i),i>u.end&&(u.end=i),e||(e=h)}}t.firstAnimation=e},e.MorphAnimMesh.prototype.setAnimationLabel=function(t,e,r){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[t]={start:e,end:r}},e.MorphAnimMesh.prototype.playAnimation=function(t,e){var r=this.geometry.animations[t];r?(this.setFrameRange(r.start,r.end),this.duration=1e3*((r.end-r.start)/e),this.time=0):console.warn("THREE.MorphAnimMesh: animation["+t+"] undefined in .playAnimation()")},e.MorphAnimMesh.prototype.updateAnimation=function(t){var r=this.duration/this.length;this.time+=this.direction*t,this.mirroredLoop?(this.time>this.duration||this.time<0)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),this.time<0&&(this.time=0,this.directionBackwards=!1)):(this.time=this.time%this.duration,this.time<0&&(this.time+=this.duration));var n=this.startKeyframe+e.Math.clamp(Math.floor(this.time/r),0,this.length-1),i=this.morphTargetInfluences;n!==this.currentKeyframe&&(i[this.lastKeyframe]=0,i[this.currentKeyframe]=1,i[n]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=n);var o=this.time%r/r;this.directionBackwards&&(o=1-o),i[this.currentKeyframe]=o,i[this.lastKeyframe]=1-o},e.MorphAnimMesh.prototype.interpolateTargets=function(t,e,r){for(var n=this.morphTargetInfluences,i=0,o=n.length;o>i;i++)n[i]=0;t>-1&&(n[t]=1-r),e>-1&&(n[e]=r)},e.MorphAnimMesh.prototype.copy=function(t){return e.Mesh.prototype.copy.call(this,t),this.duration=t.duration,this.mirroredLoop=t.mirroredLoop,this.time=t.time,this.lastKeyframe=t.lastKeyframe,this.currentKeyframe=t.currentKeyframe,this.direction=t.direction,this.directionBackwards=t.directionBackwards,this},e.LOD=function(){e.Object3D.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}})},e.LOD.prototype=Object.create(e.Object3D.prototype),e.LOD.prototype.constructor=e.LOD,e.LOD.prototype.addLevel=function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var r=this.levels,n=0;n<r.length&&!(e<r[n].distance);n++);r.splice(n,0,{distance:e,object:t}),this.add(t)},e.LOD.prototype.getObjectForDistance=function(t){for(var e=this.levels,r=1,n=e.length;n>r&&!(t<e[r].distance);r++);return e[r-1].object},e.LOD.prototype.raycast=function(){var t=new e.Vector3;return function(e,r){t.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(t);this.getObjectForDistance(n).raycast(e,r)}}(),e.LOD.prototype.update=function(){var t=new e.Vector3,r=new e.Vector3;return function(e){var n=this.levels;if(n.length>1){t.setFromMatrixPosition(e.matrixWorld),r.setFromMatrixPosition(this.matrixWorld);var i=t.distanceTo(r);n[0].object.visible=!0;for(var o=1,a=n.length;a>o&&i>=n[o].distance;o++)n[o-1].object.visible=!1,n[o].object.visible=!0;for(;a>o;o++)n[o].object.visible=!1}}}(),e.LOD.prototype.copy=function(t){e.Object3D.prototype.copy.call(this,t,!1);for(var r=t.levels,n=0,i=r.length;i>n;n++){var o=r[n];this.addLevel(o.object.clone(),o.distance)}return this},e.LOD.prototype.toJSON=function(t){var r=e.Object3D.prototype.toJSON.call(this,t);r.object.levels=[];for(var n=this.levels,i=0,o=n.length;o>i;i++){var a=n[i];r.object.levels.push({object:a.object.uuid,distance:a.distance})}return r},e.Sprite=function(){var t=new Uint16Array([0,1,2,0,2,3]),r=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),n=new Float32Array([0,0,1,0,1,1,0,1]),i=new e.BufferGeometry;return i.setIndex(new e.BufferAttribute(t,1)),i.addAttribute("position",new e.BufferAttribute(r,3)),i.addAttribute("uv",new e.BufferAttribute(n,2)),function(t){e.Object3D.call(this),this.type="Sprite",this.geometry=i,this.material=void 0!==t?t:new e.SpriteMaterial}}(),e.Sprite.prototype=Object.create(e.Object3D.prototype),e.Sprite.prototype.constructor=e.Sprite,e.Sprite.prototype.raycast=function(){var t=new e.Vector3;return function(e,r){t.setFromMatrixPosition(this.matrixWorld);var n=e.ray.distanceSqToPoint(t),i=this.scale.x*this.scale.y;n>i||r.push({distance:Math.sqrt(n),point:this.position,face:null,object:this})}}(),e.Sprite.prototype.clone=function(){return new this.constructor(this.material).copy(this)},e.Sprite.prototype.toJSON=function(t){var r=e.Object3D.prototype.toJSON.call(this,t);return void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON()),r.object.material=this.material.uuid,r},e.Particle=e.Sprite,e.LensFlare=function(t,r,n,i,o){e.Object3D.call(this),this.lensFlares=[],this.positionScreen=new e.Vector3,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,r,n,i,o)},e.LensFlare.prototype=Object.create(e.Object3D.prototype),e.LensFlare.prototype.constructor=e.LensFlare,e.LensFlare.prototype.add=function(t,r,n,i,o,a){void 0===r&&(r=-1),void 0===n&&(n=0),void 0===a&&(a=1),void 0===o&&(o=new e.Color(16777215)),void 0===i&&(i=e.NormalBlending),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:t,size:r,distance:n,x:0,y:0,z:0,scale:1,rotation:0,opacity:a,color:o,blending:i})},e.LensFlare.prototype.updateLensFlares=function(){var t,e,r=this.lensFlares.length,n=2*-this.positionScreen.x,i=2*-this.positionScreen.y;for(t=0;r>t;t++)e=this.lensFlares[t],e.x=this.positionScreen.x+n*e.distance,e.y=this.positionScreen.y+i*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)},e.LensFlare.prototype.copy=function(t){e.Object3D.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var r=0,n=t.lensFlares.length;n>r;r++)this.lensFlares.push(t.lensFlares[r]);return this},e.Scene=function(){e.Object3D.call(this),this.type="Scene",this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},e.Scene.prototype=Object.create(e.Object3D.prototype),e.Scene.prototype.constructor=e.Scene,e.Scene.prototype.copy=function(t){return e.Object3D.prototype.copy.call(this,t),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},e.Fog=function(t,r,n){this.name="",this.color=new e.Color(t),this.near=void 0!==r?r:1,this.far=void 0!==n?n:1e3},e.Fog.prototype.clone=function(){return new e.Fog(this.color.getHex(),this.near,this.far)},e.FogExp2=function(t,r){this.name="",this.color=new e.Color(t),this.density=void 0!==r?r:25e-5},e.FogExp2.prototype.clone=function(){return new e.FogExp2(this.color.getHex(),this.density)},e.ShaderChunk={},e.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\n	diffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",e.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\n	uniform sampler2D alphaMap;\n\n#endif\n",e.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\n	if ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n",e.ShaderChunk.aomap_fragment="#ifdef USE_AOMAP\n\n	totalAmbientLight *= ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\n#endif\n",e.ShaderChunk.aomap_pars_fragment="#ifdef USE_AOMAP\n\n	uniform sampler2D aoMap;\n	uniform float aoMapIntensity;\n\n#endif",e.ShaderChunk.begin_vertex="\nvec3 transformed = vec3( position );\n",e.ShaderChunk.beginnormal_vertex="\nvec3 objectNormal = vec3( normal );\n",e.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n\n	// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n	// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n	// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n	vec2 dHdxy_fwd() {\n\n		vec2 dSTdx = dFdx( vUv );\n		vec2 dSTdy = dFdy( vUv );\n\n		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n		return vec2( dBx, dBy );\n\n	}\n\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n		vec3 vSigmaX = dFdx( surf_pos );\n		vec3 vSigmaY = dFdy( surf_pos );\n		vec3 vN = surf_norm;		// normalized\n\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n\n		float fDet = dot( vSigmaX, R1 );\n\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n\n	}\n\n#endif\n",e.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\n	diffuseColor.rgb *= vColor;\n\n#endif",e.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif\n",e.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif",e.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\n	vColor.xyz = color.xyz;\n\n#endif",e.ShaderChunk.common="#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\n\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\n\n	return normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\n\n}\n\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n\n	return normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n\n}\n\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n	float distance = dot( planeNormal, point - pointOnPlane );\n\n	return - distance * planeNormal + point;\n\n}\n\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n	return sign( dot( point - pointOnPlane, planeNormal ) );\n\n}\n\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n\n}\n\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\n\n	if ( decayExponent > 0.0 ) {\n\n	  return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\n	}\n\n	return 1.0;\n\n}\n\nvec3 F_Schlick( in vec3 specularColor, in float dotLH ) {\n\n	// Original approximation by Christophe Schlick '94\n	//;float fresnel = pow( 1.0 - dotLH, 5.0 );\n\n	// Optimized variant (presented by Epic at SIGGRAPH '13)\n	float fresnel = exp2( ( -5.55437 * dotLH - 6.98316 ) * dotLH );\n\n	return ( 1.0 - specularColor ) * fresnel + specularColor;\n\n}\n\nfloat G_BlinnPhong_Implicit( /* in float dotNL, in float dotNV */ ) {\n\n	// geometry term is (nl)(nv) / 4(nl)(nv)\n\n	return 0.25;\n\n}\n\nfloat D_BlinnPhong( in float shininess, in float dotNH ) {\n\n	// factor of 1/PI in distribution term omitted\n\n	return ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n\n}\n\nvec3 BRDF_BlinnPhong( in vec3 specularColor, in float shininess, in vec3 normal, in vec3 lightDir, in vec3 viewDir ) {\n\n	vec3 halfDir = normalize( lightDir + viewDir );\n\n	//float dotNL = saturate( dot( normal, lightDir ) );\n	//float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotLH = saturate( dot( lightDir, halfDir ) );\n\n	vec3 F = F_Schlick( specularColor, dotLH );\n\n	float G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );\n\n	float D = D_BlinnPhong( shininess, dotNH );\n\n	return F * G * D;\n\n}\n\nvec3 inputToLinear( in vec3 a ) {\n\n	#ifdef GAMMA_INPUT\n\n		return pow( a, vec3( float( GAMMA_FACTOR ) ) );\n\n	#else\n\n		return a;\n\n	#endif\n\n}\n\nvec3 linearToOutput( in vec3 a ) {\n\n	#ifdef GAMMA_OUTPUT\n\n		return pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n\n	#else\n\n		return a;\n\n	#endif\n\n}\n",e.ShaderChunk.defaultnormal_vertex="#ifdef FLIP_SIDED\n\n	objectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;\n",e.ShaderChunk.displacementmap_vertex="#ifdef USE_DISPLACEMENTMAP\n\n	transformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n\n#endif\n",e.ShaderChunk.displacementmap_pars_vertex="#ifdef USE_DISPLACEMENTMAP\n\n	uniform sampler2D displacementMap;\n	uniform float displacementScale;\n	uniform float displacementBias;\n\n#endif\n",e.ShaderChunk.emissivemap_fragment="#ifdef USE_EMISSIVEMAP\n\n	vec4 emissiveColor = texture2D( emissiveMap, vUv );\n\n	emissiveColor.rgb = inputToLinear( emissiveColor.rgb );\n\n	totalEmissiveLight *= emissiveColor.rgb;\n\n#endif\n",e.ShaderChunk.emissivemap_pars_fragment="#ifdef USE_EMISSIVEMAP\n\n	uniform sampler2D emissiveMap;\n\n#endif\n",e.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n		// Transforming Normal Vectors with the Inverse Transformation\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n		#ifdef ENVMAP_MODE_REFLECTION\n\n			vec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n		#else\n\n			vec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n		#endif\n\n	#else\n\n		vec3 reflectVec = vReflect;\n\n	#endif\n\n	#ifdef DOUBLE_SIDED\n		float flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n	#else\n		float flipNormal = 1.0;\n	#endif\n\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n	#elif defined( ENVMAP_TYPE_EQUIREC )\n		vec2 sampleUV;\n		sampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n		sampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n		vec4 envColor = texture2D( envMap, sampleUV );\n\n	#elif defined( ENVMAP_TYPE_SPHERE )\n		vec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n	#endif\n\n	envColor.xyz = inputToLinear( envColor.xyz );\n\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n	#elif defined( ENVMAP_BLENDING_MIX )\n\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n	#elif defined( ENVMAP_BLENDING_ADD )\n\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n	#endif\n\n#endif\n",e.ShaderChunk.envmap_pars_fragment="#ifdef USE_ENVMAP\n\n	uniform float reflectivity;\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	uniform float flipEnvMap;\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n		uniform float refractionRatio;\n\n	#else\n\n		varying vec3 vReflect;\n\n	#endif\n\n#endif\n",e.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n	varying vec3 vReflect;\n\n	uniform float refractionRatio;\n\n#endif\n",e.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n	vec3 worldNormal = transformDirection( objectNormal, modelMatrix );\n\n	vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n	#ifdef ENVMAP_MODE_REFLECTION\n\n		vReflect = reflect( cameraToVertex, worldNormal );\n\n	#else\n\n		vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n	#endif\n\n#endif\n",e.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		float depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n	#else\n\n		float depth = gl_FragCoord.z / gl_FragCoord.w;\n\n	#endif\n\n	#ifdef FOG_EXP2\n\n		float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\n	#else\n\n		float fogFactor = smoothstep( fogNear, fogFar, depth );\n\n	#endif\n	\n	outgoingLight = mix( outgoingLight, fogColor, fogFactor );\n\n#endif",e.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\n	uniform vec3 fogColor;\n\n	#ifdef FOG_EXP2\n\n		uniform float fogDensity;\n\n	#else\n\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n\n#endif",e.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\n	totalAmbientLight += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\n#endif\n",e.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\n	uniform sampler2D lightMap;\n	uniform float lightMapIntensity;\n\n#endif",e.ShaderChunk.lights_lambert_pars_vertex="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n",e.ShaderChunk.lights_lambert_vertex="vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack = vec3( 0.0 );\n\n#endif\n\nvec3 normal = normalize( transformedNormal );\n\n#if MAX_POINT_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec3 lightColor = pointLightColor[ i ];\n\n		vec3 lVector = pointLightPosition[ i ] - mvPosition.xyz;\n		vec3 lightDir = normalize( lVector );\n\n		// attenuation\n\n		float attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n		// diffuse\n\n		float dotProduct = dot( normal, lightDir );\n\n		vLightFront += lightColor * attenuation * saturate( dotProduct );\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += lightColor * attenuation * saturate( - dotProduct );\n\n		#endif\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec3 lightColor = spotLightColor[ i ];\n\n		vec3 lightPosition = spotLightPosition[ i ];\n		vec3 lVector = lightPosition - mvPosition.xyz;\n		vec3 lightDir = normalize( lVector );\n\n		float spotEffect = dot( spotLightDirection[ i ], lightDir );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\n\n			// attenuation\n\n			float attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n			attenuation *= spotEffect;\n\n			// diffuse\n\n			float dotProduct = dot( normal, lightDir );\n\n			vLightFront += lightColor * attenuation * saturate( dotProduct );\n\n			#ifdef DOUBLE_SIDED\n\n				vLightBack += lightColor * attenuation * saturate( - dotProduct );\n\n			#endif\n\n		}\n\n	}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n		vec3 lightColor = directionalLightColor[ i ];\n\n		vec3 lightDir = directionalLightDirection[ i ];\n\n		// diffuse\n\n		float dotProduct = dot( normal, lightDir );\n\n		vLightFront += lightColor * saturate( dotProduct );\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += lightColor * saturate( - dotProduct );\n\n		#endif\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec3 lightDir = hemisphereLightDirection[ i ];\n\n		// diffuse\n\n		float dotProduct = dot( normal, lightDir );\n\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n		vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		#ifdef DOUBLE_SIDED\n\n			float hemiDiffuseWeightBack = - 0.5 * dotProduct + 0.5;\n\n			vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n		#endif\n\n	}\n\n#endif\n\nvLightFront += ambientLightColor;\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack += ambientLightColor;\n\n#endif\n",e.ShaderChunk.lights_phong_fragment="#ifndef FLAT_SHADED\n\n	vec3 normal = normalize( vNormal );\n\n	#ifdef DOUBLE_SIDED\n\n		normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n	#endif\n\n#else\n\n	vec3 fdx = dFdx( vViewPosition );\n	vec3 fdy = dFdy( vViewPosition );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n\n#endif\n\n#ifdef USE_NORMALMAP\n\n	normal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\nvec3 viewDir = normalize( vViewPosition );\n\nvec3 totalDiffuseLight = vec3( 0.0 );\nvec3 totalSpecularLight = vec3( 0.0 );\n\n#if MAX_POINT_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec3 lightColor = pointLightColor[ i ];\n\n		vec3 lightPosition = pointLightPosition[ i ];\n		vec3 lVector = lightPosition + vViewPosition.xyz;\n		vec3 lightDir = normalize( lVector );\n\n		// attenuation\n\n		float attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n		// diffuse\n\n		float cosineTerm = saturate( dot( normal, lightDir ) );\n\n		totalDiffuseLight += lightColor * attenuation * cosineTerm;\n\n		// specular\n\n		vec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\n\n		totalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\n\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec3 lightColor = spotLightColor[ i ];\n\n		vec3 lightPosition = spotLightPosition[ i ];\n		vec3 lVector = lightPosition + vViewPosition.xyz;\n		vec3 lightDir = normalize( lVector );\n\n		float spotEffect = dot( spotLightDirection[ i ], lightDir );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\n\n			// attenuation\n\n			float attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n			attenuation *= spotEffect;\n\n			// diffuse\n\n			float cosineTerm = saturate( dot( normal, lightDir ) );\n\n			totalDiffuseLight += lightColor * attenuation * cosineTerm;\n\n			// specular\n\n			vec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\n\n			totalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\n\n		}\n\n	}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n	for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n		vec3 lightColor = directionalLightColor[ i ];\n\n		vec3 lightDir = directionalLightDirection[ i ];\n\n		// diffuse\n\n		float cosineTerm = saturate( dot( normal, lightDir ) );\n\n		totalDiffuseLight += lightColor * cosineTerm;\n\n		// specular\n\n		vec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\n\n		totalSpecularLight += brdf * specularStrength * lightColor * cosineTerm;\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec3 lightDir = hemisphereLightDirection[ i ];\n\n		// diffuse\n\n		float dotProduct = dot( normal, lightDir );\n\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n		vec3 lightColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		totalDiffuseLight += lightColor;\n\n		// specular (sky term only)\n\n		vec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\n\n		totalSpecularLight += brdf * specularStrength * lightColor * max( dotProduct, 0.0 );\n\n	}\n\n#endif\n\n#ifdef METAL\n\n	outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) * specular + totalSpecularLight + totalEmissiveLight;\n\n#else\n\n	outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) + totalSpecularLight + totalEmissiveLight;\n\n#endif\n",e.ShaderChunk.lights_phong_pars_fragment="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n	varying vec3 vNormal;\n\n#endif\n",e.ShaderChunk.lights_phong_pars_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n",e.ShaderChunk.lights_phong_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\n\n	vWorldPosition = worldPosition.xyz;\n\n#endif\n",e.ShaderChunk.linear_to_gamma_fragment="\n	outgoingLight = linearToOutput( outgoingLight );\n",e.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n	gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif",e.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\n	uniform float logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		varying float vFragDepth;\n\n	#endif\n\n#endif\n",e.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		varying float vFragDepth;\n\n	#endif\n\n	uniform float logDepthBufFC;\n\n#endif",
e.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\n	gl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		vFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n		gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n	#endif\n\n#endif",e.ShaderChunk.map_fragment="#ifdef USE_MAP\n\n	vec4 texelColor = texture2D( map, vUv );\n\n	texelColor.xyz = inputToLinear( texelColor.xyz );\n\n	diffuseColor *= texelColor;\n\n#endif\n",e.ShaderChunk.map_pars_fragment="#ifdef USE_MAP\n\n	uniform sampler2D map;\n\n#endif",e.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\n	diffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\n#endif\n",e.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\n	uniform vec4 offsetRepeat;\n	uniform sampler2D map;\n\n#endif\n",e.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\n	objectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n	objectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n	objectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n	objectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n#endif\n",e.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\n	#ifndef USE_MORPHNORMALS\n\n	uniform float morphTargetInfluences[ 8 ];\n\n	#else\n\n	uniform float morphTargetInfluences[ 4 ];\n\n	#endif\n\n#endif",e.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\n	transformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n	transformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n	transformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n	transformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n	#ifndef USE_MORPHNORMALS\n\n	transformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n	transformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n	transformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n	transformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n	#endif\n\n#endif\n",e.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n\n	// Per-Pixel Tangent Space Normal Mapping\n	// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( vUv.st );\n		vec2 st1 = dFdy( vUv.st );\n\n		vec3 S = normalize( q0 * st1.t - q1 * st0.t );\n		vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n		vec3 N = normalize( surf_norm );\n\n		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n		mapN.xy = normalScale * mapN.xy;\n		mat3 tsn = mat3( S, T, N );\n		return normalize( tsn * mapN );\n\n	}\n\n#endif\n",e.ShaderChunk.project_vertex="#ifdef USE_SKINNING\n\n	vec4 mvPosition = modelViewMatrix * skinned;\n\n#else\n\n	vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;\n",e.ShaderChunk.shadowmap_fragment="#ifdef USE_SHADOWMAP\n\n	#ifdef SHADOWMAP_DEBUG\n\n		vec3 frustumColors[3];\n		frustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n		frustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n		frustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n	#endif\n\n	float fDepth;\n	vec3 shadowColor = vec3( 1.0 );\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n				// if ( something && something ) breaks ATI OpenGL shader compiler\n				// if ( all( something, something ) ) using this instead\n\n		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n		bool inFrustum = all( inFrustumVec );\n\n		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n		bool frustumTest = all( frustumTestVec );\n\n		if ( frustumTest ) {\n\n			shadowCoord.z += shadowBias[ i ];\n\n			#if defined( SHADOWMAP_TYPE_PCF )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n		/*\n						// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n						// must enroll loop manually\n\n				for ( float y = -1.25; y <= 1.25; y += 1.25 )\n					for ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n						vec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n								// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n								//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n						float fDepth = unpackDepth( rgbaDepth );\n\n						if ( fDepth < shadowCoord.z )\n							shadow += 1.0;\n\n				}\n\n				shadow /= 9.0;\n\n		*/\n\n				const float shadowDelta = 1.0 / 9.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.25 * xPixelOffset;\n				float dy0 = -1.25 * yPixelOffset;\n				float dx1 = 1.25 * xPixelOffset;\n				float dy1 = 1.25 * yPixelOffset;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.0 * xPixelOffset;\n				float dy0 = -1.0 * yPixelOffset;\n				float dx1 = 1.0 * xPixelOffset;\n				float dy1 = 1.0 * yPixelOffset;\n\n				mat3 shadowKernel;\n				mat3 depthKernel;\n\n				depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n				vec3 shadowZ = vec3( shadowCoord.z );\n				shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n				shadowKernel[0] *= vec3(0.25);\n\n				shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n				shadowKernel[1] *= vec3(0.25);\n\n				shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n				shadowKernel[2] *= vec3(0.25);\n\n				vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n				shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n				shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n				vec4 shadowValues;\n				shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n				shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n				shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n				shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n				shadow = dot( shadowValues, vec4( 1.0 ) );\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#else\n\n				vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n				float fDepth = unpackDepth( rgbaDepth );\n\n				if ( fDepth < shadowCoord.z )\n\n		// spot with multiple shadows is darker\n\n					shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n		// spot with multiple shadows has the same color as single shadow spot\n\n		// 					shadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n			#endif\n\n		}\n\n\n		#ifdef SHADOWMAP_DEBUG\n\n			if ( inFrustum ) outgoingLight *= frustumColors[ i ];\n\n		#endif\n\n	}\n\n	outgoingLight = outgoingLight * shadowColor;\n\n#endif\n",e.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\n	uniform sampler2D shadowMap[ MAX_SHADOWS ];\n	uniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n	uniform float shadowDarkness[ MAX_SHADOWS ];\n	uniform float shadowBias[ MAX_SHADOWS ];\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n	float unpackDepth( const in vec4 rgba_depth ) {\n\n		const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n		float depth = dot( rgba_depth, bit_shift );\n		return depth;\n\n	}\n\n#endif",e.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n	uniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif",e.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n	}\n\n#endif",e.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif",e.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n\n	#ifdef BONE_TEXTURE\n\n		uniform sampler2D boneTexture;\n		uniform int boneTextureWidth;\n		uniform int boneTextureHeight;\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			float j = i * 4.0;\n			float x = mod( j, float( boneTextureWidth ) );\n			float y = floor( j / float( boneTextureWidth ) );\n\n			float dx = 1.0 / float( boneTextureWidth );\n			float dy = 1.0 / float( boneTextureHeight );\n\n			y = dy * ( y + 0.5 );\n\n			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n			mat4 bone = mat4( v1, v2, v3, v4 );\n\n			return bone;\n\n		}\n\n	#else\n\n		uniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			mat4 bone = boneGlobalMatrices[ int(i) ];\n			return bone;\n\n		}\n\n	#endif\n\n#endif\n",e.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\n	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	skinned  = bindMatrixInverse * skinned;\n\n#endif\n",e.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\n#endif\n",e.ShaderChunk.specularmap_fragment="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	specularStrength = texelSpecular.r;\n\n#else\n\n	specularStrength = 1.0;\n\n#endif",e.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\n	uniform sampler2D specularMap;\n\n#endif",e.ShaderChunk.uv2_pars_fragment="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n	varying vec2 vUv2;\n\n#endif",e.ShaderChunk.uv2_pars_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n	attribute vec2 uv2;\n	varying vec2 vUv2;\n\n#endif",e.ShaderChunk.uv2_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n	vUv2 = uv2;\n\n#endif",e.ShaderChunk.uv_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\n\n	varying vec2 vUv;\n\n#endif",e.ShaderChunk.uv_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\n\n	varying vec2 vUv;\n	uniform vec4 offsetRepeat;\n\n#endif\n",e.ShaderChunk.uv_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\n\n	vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif",e.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n	#ifdef USE_SKINNING\n\n		vec4 worldPosition = modelMatrix * skinned;\n\n	#else\n\n		vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\n	#endif\n\n#endif\n",e.UniformsUtils={merge:function(t){for(var e={},r=0;r<t.length;r++){var n=this.clone(t[r]);for(var i in n)e[i]=n[i]}return e},clone:function(t){var r={};for(var n in t){r[n]={};for(var i in t[n]){var o=t[n][i];o instanceof e.Color||o instanceof e.Vector2||o instanceof e.Vector3||o instanceof e.Vector4||o instanceof e.Matrix3||o instanceof e.Matrix4||o instanceof e.Texture?r[n][i]=o.clone():Array.isArray(o)?r[n][i]=o.slice():r[n][i]=o}}return r}},e.UniformsLib={common:{diffuse:{type:"c",value:new e.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new e.Vector4(0,0,1,1)},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98}},aomap:{aoMap:{type:"t",value:null},aoMapIntensity:{type:"f",value:1}},lightmap:{lightMap:{type:"t",value:null},lightMapIntensity:{type:"f",value:1}},emissivemap:{emissiveMap:{type:"t",value:null}},bumpmap:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new e.Vector2(1,1)}},displacementmap:{displacementMap:{type:"t",value:null},displacementScale:{type:"f",value:1},displacementBias:{type:"f",value:0}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new e.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},pointLightDecay:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]},spotLightDecay:{type:"fv1",value:[]}},points:{psColor:{type:"c",value:new e.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new e.Vector4(0,0,1,1)},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new e.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},e.ShaderLib={basic:{uniforms:e.UniformsUtils.merge([e.UniformsLib.common,e.UniformsLib.aomap,e.UniformsLib.fog,e.UniformsLib.shadowmap]),vertexShader:[e.ShaderChunk.common,e.ShaderChunk.uv_pars_vertex,e.ShaderChunk.uv2_pars_vertex,e.ShaderChunk.envmap_pars_vertex,e.ShaderChunk.color_pars_vertex,e.ShaderChunk.morphtarget_pars_vertex,e.ShaderChunk.skinning_pars_vertex,e.ShaderChunk.shadowmap_pars_vertex,e.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",e.ShaderChunk.uv_vertex,e.ShaderChunk.uv2_vertex,e.ShaderChunk.color_vertex,e.ShaderChunk.skinbase_vertex,"	#ifdef USE_ENVMAP",e.ShaderChunk.beginnormal_vertex,e.ShaderChunk.morphnormal_vertex,e.ShaderChunk.skinnormal_vertex,e.ShaderChunk.defaultnormal_vertex,"	#endif",e.ShaderChunk.begin_vertex,e.ShaderChunk.morphtarget_vertex,e.ShaderChunk.skinning_vertex,e.ShaderChunk.project_vertex,e.ShaderChunk.logdepthbuf_vertex,e.ShaderChunk.worldpos_vertex,e.ShaderChunk.envmap_vertex,e.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",e.ShaderChunk.common,e.ShaderChunk.color_pars_fragment,e.ShaderChunk.uv_pars_fragment,e.ShaderChunk.uv2_pars_fragment,e.ShaderChunk.map_pars_fragment,e.ShaderChunk.alphamap_pars_fragment,e.ShaderChunk.aomap_pars_fragment,e.ShaderChunk.envmap_pars_fragment,e.ShaderChunk.fog_pars_fragment,e.ShaderChunk.shadowmap_pars_fragment,e.ShaderChunk.specularmap_pars_fragment,e.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );","	vec3 totalAmbientLight = vec3( 1.0 );",e.ShaderChunk.logdepthbuf_fragment,e.ShaderChunk.map_fragment,e.ShaderChunk.color_fragment,e.ShaderChunk.alphamap_fragment,e.ShaderChunk.alphatest_fragment,e.ShaderChunk.specularmap_fragment,e.ShaderChunk.aomap_fragment,"	outgoingLight = diffuseColor.rgb * totalAmbientLight;",e.ShaderChunk.envmap_fragment,e.ShaderChunk.shadowmap_fragment,e.ShaderChunk.linear_to_gamma_fragment,e.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},lambert:{uniforms:e.UniformsUtils.merge([e.UniformsLib.common,e.UniformsLib.fog,e.UniformsLib.lights,e.UniformsLib.shadowmap,{emissive:{type:"c",value:new e.Color(0)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","#endif",e.ShaderChunk.common,e.ShaderChunk.uv_pars_vertex,e.ShaderChunk.uv2_pars_vertex,e.ShaderChunk.envmap_pars_vertex,e.ShaderChunk.lights_lambert_pars_vertex,e.ShaderChunk.color_pars_vertex,e.ShaderChunk.morphtarget_pars_vertex,e.ShaderChunk.skinning_pars_vertex,e.ShaderChunk.shadowmap_pars_vertex,e.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",e.ShaderChunk.uv_vertex,e.ShaderChunk.uv2_vertex,e.ShaderChunk.color_vertex,e.ShaderChunk.beginnormal_vertex,e.ShaderChunk.morphnormal_vertex,e.ShaderChunk.skinbase_vertex,e.ShaderChunk.skinnormal_vertex,e.ShaderChunk.defaultnormal_vertex,e.ShaderChunk.begin_vertex,e.ShaderChunk.morphtarget_vertex,e.ShaderChunk.skinning_vertex,e.ShaderChunk.project_vertex,e.ShaderChunk.logdepthbuf_vertex,e.ShaderChunk.worldpos_vertex,e.ShaderChunk.envmap_vertex,e.ShaderChunk.lights_lambert_vertex,e.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform vec3 emissive;","uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","#endif",e.ShaderChunk.common,e.ShaderChunk.color_pars_fragment,e.ShaderChunk.uv_pars_fragment,e.ShaderChunk.uv2_pars_fragment,e.ShaderChunk.map_pars_fragment,e.ShaderChunk.alphamap_pars_fragment,e.ShaderChunk.envmap_pars_fragment,e.ShaderChunk.fog_pars_fragment,e.ShaderChunk.shadowmap_pars_fragment,e.ShaderChunk.specularmap_pars_fragment,e.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );",e.ShaderChunk.logdepthbuf_fragment,e.ShaderChunk.map_fragment,e.ShaderChunk.color_fragment,e.ShaderChunk.alphamap_fragment,e.ShaderChunk.alphatest_fragment,e.ShaderChunk.specularmap_fragment,"	#ifdef DOUBLE_SIDED","		if ( gl_FrontFacing )","			outgoingLight += diffuseColor.rgb * vLightFront + emissive;","		else","			outgoingLight += diffuseColor.rgb * vLightBack + emissive;","	#else","		outgoingLight += diffuseColor.rgb * vLightFront + emissive;","	#endif",e.ShaderChunk.envmap_fragment,e.ShaderChunk.shadowmap_fragment,e.ShaderChunk.linear_to_gamma_fragment,e.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},phong:{uniforms:e.UniformsUtils.merge([e.UniformsLib.common,e.UniformsLib.aomap,e.UniformsLib.lightmap,e.UniformsLib.emissivemap,e.UniformsLib.bumpmap,e.UniformsLib.normalmap,e.UniformsLib.displacementmap,e.UniformsLib.fog,e.UniformsLib.lights,e.UniformsLib.shadowmap,{emissive:{type:"c",value:new e.Color(0)},specular:{type:"c",value:new e.Color(1118481)},shininess:{type:"f",value:30}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","#ifndef FLAT_SHADED","	varying vec3 vNormal;","#endif",e.ShaderChunk.common,e.ShaderChunk.uv_pars_vertex,e.ShaderChunk.uv2_pars_vertex,e.ShaderChunk.displacementmap_pars_vertex,e.ShaderChunk.envmap_pars_vertex,e.ShaderChunk.lights_phong_pars_vertex,e.ShaderChunk.color_pars_vertex,e.ShaderChunk.morphtarget_pars_vertex,e.ShaderChunk.skinning_pars_vertex,e.ShaderChunk.shadowmap_pars_vertex,e.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",e.ShaderChunk.uv_vertex,e.ShaderChunk.uv2_vertex,e.ShaderChunk.color_vertex,e.ShaderChunk.beginnormal_vertex,e.ShaderChunk.morphnormal_vertex,e.ShaderChunk.skinbase_vertex,e.ShaderChunk.skinnormal_vertex,e.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED","	vNormal = normalize( transformedNormal );","#endif",e.ShaderChunk.begin_vertex,e.ShaderChunk.displacementmap_vertex,e.ShaderChunk.morphtarget_vertex,e.ShaderChunk.skinning_vertex,e.ShaderChunk.project_vertex,e.ShaderChunk.logdepthbuf_vertex,"	vViewPosition = - mvPosition.xyz;",e.ShaderChunk.worldpos_vertex,e.ShaderChunk.envmap_vertex,e.ShaderChunk.lights_phong_vertex,e.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define PHONG","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;",e.ShaderChunk.common,e.ShaderChunk.color_pars_fragment,e.ShaderChunk.uv_pars_fragment,e.ShaderChunk.uv2_pars_fragment,e.ShaderChunk.map_pars_fragment,e.ShaderChunk.alphamap_pars_fragment,e.ShaderChunk.aomap_pars_fragment,e.ShaderChunk.lightmap_pars_fragment,e.ShaderChunk.emissivemap_pars_fragment,e.ShaderChunk.envmap_pars_fragment,e.ShaderChunk.fog_pars_fragment,e.ShaderChunk.lights_phong_pars_fragment,e.ShaderChunk.shadowmap_pars_fragment,e.ShaderChunk.bumpmap_pars_fragment,e.ShaderChunk.normalmap_pars_fragment,e.ShaderChunk.specularmap_pars_fragment,e.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );","	vec3 totalAmbientLight = ambientLightColor;","	vec3 totalEmissiveLight = emissive;",e.ShaderChunk.logdepthbuf_fragment,e.ShaderChunk.map_fragment,e.ShaderChunk.color_fragment,e.ShaderChunk.alphamap_fragment,e.ShaderChunk.alphatest_fragment,e.ShaderChunk.specularmap_fragment,e.ShaderChunk.lightmap_fragment,e.ShaderChunk.aomap_fragment,e.ShaderChunk.emissivemap_fragment,e.ShaderChunk.lights_phong_fragment,e.ShaderChunk.envmap_fragment,e.ShaderChunk.shadowmap_fragment,e.ShaderChunk.linear_to_gamma_fragment,e.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},points:{uniforms:e.UniformsUtils.merge([e.UniformsLib.points,e.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",e.ShaderChunk.common,e.ShaderChunk.color_pars_vertex,e.ShaderChunk.shadowmap_pars_vertex,e.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",e.ShaderChunk.color_vertex,"	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","	#ifdef USE_SIZEATTENUATION","		gl_PointSize = size * ( scale / length( mvPosition.xyz ) );","	#else","		gl_PointSize = size;","	#endif","	gl_Position = projectionMatrix * mvPosition;",e.ShaderChunk.logdepthbuf_vertex,e.ShaderChunk.worldpos_vertex,e.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",e.ShaderChunk.common,e.ShaderChunk.color_pars_fragment,e.ShaderChunk.map_particle_pars_fragment,e.ShaderChunk.fog_pars_fragment,e.ShaderChunk.shadowmap_pars_fragment,e.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( psColor, opacity );",e.ShaderChunk.logdepthbuf_fragment,e.ShaderChunk.map_particle_fragment,e.ShaderChunk.color_fragment,e.ShaderChunk.alphatest_fragment,"	outgoingLight = diffuseColor.rgb;",e.ShaderChunk.shadowmap_fragment,e.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},dashed:{uniforms:e.UniformsUtils.merge([e.UniformsLib.common,e.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",e.ShaderChunk.common,e.ShaderChunk.color_pars_vertex,e.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",e.ShaderChunk.color_vertex,"	vLineDistance = scale * lineDistance;","	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","	gl_Position = projectionMatrix * mvPosition;",e.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",e.ShaderChunk.common,e.ShaderChunk.color_pars_fragment,e.ShaderChunk.fog_pars_fragment,e.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	if ( mod( vLineDistance, totalSize ) > dashSize ) {","		discard;","	}","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );",e.ShaderChunk.logdepthbuf_fragment,e.ShaderChunk.color_fragment,"	outgoingLight = diffuseColor.rgb;",e.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[e.ShaderChunk.common,e.ShaderChunk.morphtarget_pars_vertex,e.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",e.ShaderChunk.begin_vertex,e.ShaderChunk.morphtarget_vertex,e.ShaderChunk.project_vertex,e.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;",e.ShaderChunk.common,e.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",e.ShaderChunk.logdepthbuf_fragment,"	#ifdef USE_LOGDEPTHBUF_EXT","		float depth = gl_FragDepthEXT / gl_FragCoord.w;","	#else","		float depth = gl_FragCoord.z / gl_FragCoord.w;","	#endif","	float color = 1.0 - smoothstep( mNear, mFar, depth );","	gl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",e.ShaderChunk.common,e.ShaderChunk.morphtarget_pars_vertex,e.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vNormal = normalize( normalMatrix * normal );",e.ShaderChunk.begin_vertex,e.ShaderChunk.morphtarget_vertex,e.ShaderChunk.project_vertex,e.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;",e.ShaderChunk.common,e.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",e.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",e.ShaderChunk.common,e.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vWorldPosition = transformDirection( position, modelMatrix );","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",e.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;",e.ShaderChunk.common,e.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",e.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",e.ShaderChunk.common,e.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vWorldPosition = transformDirection( position, modelMatrix );","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",e.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","uniform float tFlip;","varying vec3 vWorldPosition;",e.ShaderChunk.common,e.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","vec3 direction = normalize( vWorldPosition );","vec2 sampleUV;","sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );","sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","gl_FragColor = texture2D( tEquirect, sampleUV );",e.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[e.ShaderChunk.common,e.ShaderChunk.morphtarget_pars_vertex,e.ShaderChunk.skinning_pars_vertex,e.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",e.ShaderChunk.skinbase_vertex,e.ShaderChunk.begin_vertex,e.ShaderChunk.morphtarget_vertex,e.ShaderChunk.skinning_vertex,e.ShaderChunk.project_vertex,e.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[e.ShaderChunk.common,e.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {","	const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","	const vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","	vec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );","	res -= res.xxyz * bit_mask;","	return res;","}","void main() {",e.ShaderChunk.logdepthbuf_fragment,"	#ifdef USE_LOGDEPTHBUF_EXT","		gl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );","	#else","		gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","	#endif","}"].join("\n")}},e.WebGLRenderer=function(t){function r(t,e,r,n){ot===!0&&(t*=n,e*=n,r*=n),zt.clearColor(t,e,r,n)}function n(){qt.init(),zt.viewport(At,Rt,Pt,Lt),r(st.r,st.g,st.b,ht)}function i(){wt=null,Et=null,Tt="",Mt=-1,Ut=!0,qt.reset()}function o(t){t.preventDefault(),i(),n(),
Yt.clear()}function a(t){var e=t.target;e.removeEventListener("dispose",a),u(e),Vt.textures--}function s(t){var e=t.target;e.removeEventListener("dispose",s),c(e),Vt.textures--}function h(t){var e=t.target;e.removeEventListener("dispose",h),l(e)}function u(t){var e=Yt.get(t);if(t.image&&e.__image__webglTextureCube)zt.deleteTexture(e.__image__webglTextureCube);else{if(void 0===e.__webglInit)return;zt.deleteTexture(e.__webglTexture)}Yt["delete"](t)}function c(t){var r=Yt.get(t);if(t&&void 0!==r.__webglTexture){if(zt.deleteTexture(r.__webglTexture),t instanceof e.WebGLRenderTargetCube)for(var n=0;6>n;n++)zt.deleteFramebuffer(r.__webglFramebuffer[n]),zt.deleteRenderbuffer(r.__webglRenderbuffer[n]);else zt.deleteFramebuffer(r.__webglFramebuffer),zt.deleteRenderbuffer(r.__webglRenderbuffer);Yt["delete"](t)}}function l(t){p(t),Yt["delete"](t)}function p(t){var e=Yt.get(t).program;t.program=void 0,void 0!==e&&Kt.releaseProgram(e)}function f(t,r,n,i){var o;if(n instanceof e.InstancedBufferGeometry&&(o=Wt.get("ANGLE_instanced_arrays"),null===o))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===i&&(i=0),qt.initAttributes();var a=n.attributes,s=r.getAttributes(),h=t.defaultAttributeValues;for(var u in s){var c=s[u];if(c>=0){var l=a[u];if(void 0!==l){qt.enableAttribute(c);var p=l.itemSize,f=Zt.getAttributeBuffer(l);if(l instanceof e.InterleavedBufferAttribute){var d=l.data,m=d.stride,g=l.offset;if(zt.bindBuffer(zt.ARRAY_BUFFER,f),zt.vertexAttribPointer(c,p,zt.FLOAT,!1,m*d.array.BYTES_PER_ELEMENT,(i*m+g)*d.array.BYTES_PER_ELEMENT),d instanceof e.InstancedInterleavedBuffer){if(null===o)return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferAttribute but hardware does not support extension ANGLE_instanced_arrays.");o.vertexAttribDivisorANGLE(c,d.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=d.meshPerAttribute*d.count)}}else if(zt.bindBuffer(zt.ARRAY_BUFFER,f),zt.vertexAttribPointer(c,p,zt.FLOAT,!1,0,i*p*4),l instanceof e.InstancedBufferAttribute){if(null===o)return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferAttribute but hardware does not support extension ANGLE_instanced_arrays.");o.vertexAttribDivisorANGLE(c,l.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=l.meshPerAttribute*l.count)}}else if(void 0!==h){var y=h[u];if(void 0!==y)switch(y.length){case 2:zt.vertexAttrib2fv(c,y);break;case 3:zt.vertexAttrib3fv(c,y);break;case 4:zt.vertexAttrib4fv(c,y);break;default:zt.vertexAttrib1fv(c,y)}}}}qt.disableUnusedAttributes()}function d(t,e){return e[0]-t[0]}function m(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function g(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function y(t){var e,r;t.material.transparent?(e=gt,r=++yt):(e=dt,r=++mt),r<e.length?e[r]=t:e.push(t)}function v(t,e,r,n,i){var o,a;r.transparent?(o=pt,a=++ft):(o=ct,a=++lt);var s=o[a];void 0!==s?(s.id=t.id,s.object=t,s.geometry=e,s.material=r,s.z=Nt.z,s.group=i):(s={id:t.id,object:t,geometry:e,material:r,z:Nt.z,group:i},o.push(s))}function _(t){if(t.visible!==!1){if(t instanceof e.Light)ut.push(t);else if(t instanceof e.Sprite)_t.push(t);else if(t instanceof e.LensFlare)xt.push(t);else if(t instanceof e.ImmediateRenderObject)y(t);else if((t instanceof e.Mesh||t instanceof e.Line||t instanceof e.Points)&&(t instanceof e.SkinnedMesh&&t.skeleton.update(),t.frustumCulled===!1||kt.intersectsObject(t)===!0)){var r=t.material;if(r.visible===!0){bt.sortObjects===!0&&(Nt.setFromMatrixPosition(t.matrixWorld),Nt.applyProjection(Ft));var n=Zt.update(t);if(r instanceof e.MeshFaceMaterial)for(var i=n.groups,o=r.materials,a=0,s=i.length;s>a;a++){var h=i[a],u=o[h.materialIndex];u.visible===!0&&v(t,n,u,Nt.z,h)}else v(t,n,r,Nt.z)}}for(var c=t.children,a=0,s=c.length;s>a;a++)_(c[a])}}function x(t,e,r,n,i){for(var o=0,a=t.length;a>o;o++){var s=t[o],h=s.object,u=s.geometry,c=void 0===i?s.material:i,l=s.group;h.modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,h.matrixWorld),h.normalMatrix.getNormalMatrix(h.modelViewMatrix),bt.renderBufferDirect(e,r,n,u,c,h,l)}}function b(t,e,r,n,i){for(var o=i,a=0,s=t.length;s>a;a++){var h=t[a];h.modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,h.matrixWorld),h.normalMatrix.getNormalMatrix(h.modelViewMatrix),void 0===i&&(o=h.material),S(o);var u=T(e,r,n,o,h);Tt="",h.render(function(t){bt.renderBufferImmediate(t,u,o)})}}function w(t,r,n,i){var o=Yt.get(t),a=Kt.getParameters(t,r,n,i),s=Kt.getProgramCode(t,a),u=o.program,c=!0;if(void 0===u)t.addEventListener("dispose",h);else if(u.code!==s)p(t);else{if(void 0!==a.shaderID)return;c=!1}if(c){if(a.shaderID){var l=e.ShaderLib[a.shaderID];o.__webglShader={name:t.type,uniforms:e.UniformsUtils.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}}else o.__webglShader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.__webglShader=o.__webglShader,u=Kt.acquireProgram(t,a,s),o.program=u,t.program=u}var f=u.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var d=0;d<bt.maxMorphTargets;d++)f["morphTarget"+d]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals)for(t.numSupportedMorphNormals=0,d=0;d<bt.maxMorphNormals;d++)f["morphNormal"+d]>=0&&t.numSupportedMorphNormals++;o.uniformsList=[];var m=o.program.getUniforms();for(var g in o.__webglShader.uniforms){var y=m[g];y&&o.uniformsList.push([o.__webglShader.uniforms[g],y])}}function S(t){M(t),t.transparent===!0?qt.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha):qt.setBlending(e.NoBlending),qt.setDepthFunc(t.depthFunc),qt.setDepthTest(t.depthTest),qt.setDepthWrite(t.depthWrite),qt.setColorWrite(t.colorWrite),qt.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function M(t){t.side!==e.DoubleSide?qt.enable(zt.CULL_FACE):qt.disable(zt.CULL_FACE),qt.setFlipSided(t.side===e.BackSide)}function T(t,r,n,i,o){Ct=0;var a=Yt.get(i);(i.needsUpdate||!a.program)&&(w(i,r,n,o),i.needsUpdate=!1);var s=!1,h=!1,u=!1,c=a.program,l=c.getUniforms(),p=a.__webglShader.uniforms;if(c.id!==wt&&(zt.useProgram(c.program),wt=c.id,s=!0,h=!0,u=!0),i.id!==Mt&&(-1===Mt&&(u=!0),Mt=i.id,h=!0),(s||t!==Et)&&(zt.uniformMatrix4fv(l.projectionMatrix,!1,t.projectionMatrix.elements),Xt.logarithmicDepthBuffer&&zt.uniform1f(l.logDepthBufFC,2/(Math.log(t.far+1)/Math.LN2)),t!==Et&&(Et=t),(i instanceof e.ShaderMaterial||i instanceof e.MeshPhongMaterial||i.envMap)&&void 0!==l.cameraPosition&&(Nt.setFromMatrixPosition(t.matrixWorld),zt.uniform3f(l.cameraPosition,Nt.x,Nt.y,Nt.z)),(i instanceof e.MeshPhongMaterial||i instanceof e.MeshLambertMaterial||i instanceof e.MeshBasicMaterial||i instanceof e.ShaderMaterial||i.skinning)&&void 0!==l.viewMatrix&&zt.uniformMatrix4fv(l.viewMatrix,!1,t.matrixWorldInverse.elements)),i.skinning)if(o.bindMatrix&&void 0!==l.bindMatrix&&zt.uniformMatrix4fv(l.bindMatrix,!1,o.bindMatrix.elements),o.bindMatrixInverse&&void 0!==l.bindMatrixInverse&&zt.uniformMatrix4fv(l.bindMatrixInverse,!1,o.bindMatrixInverse.elements),Xt.floatVertexTextures&&o.skeleton&&o.skeleton.useVertexTexture){if(void 0!==l.boneTexture){var f=N();zt.uniform1i(l.boneTexture,f),bt.setTexture(o.skeleton.boneTexture,f)}void 0!==l.boneTextureWidth&&zt.uniform1i(l.boneTextureWidth,o.skeleton.boneTextureWidth),void 0!==l.boneTextureHeight&&zt.uniform1i(l.boneTextureHeight,o.skeleton.boneTextureHeight)}else o.skeleton&&o.skeleton.boneMatrices&&void 0!==l.boneGlobalMatrices&&zt.uniformMatrix4fv(l.boneGlobalMatrices,!1,o.skeleton.boneMatrices);return h&&(n&&i.fog&&P(p,n),(i instanceof e.MeshPhongMaterial||i instanceof e.MeshLambertMaterial||i.lights)&&(Ut&&(u=!0,B(r,t),Ut=!1),u?(O(p,Bt),D(p,!0)):D(p,!1)),(i instanceof e.MeshBasicMaterial||i instanceof e.MeshLambertMaterial||i instanceof e.MeshPhongMaterial)&&E(p,i),i instanceof e.LineBasicMaterial?C(p,i):i instanceof e.LineDashedMaterial?(C(p,i),A(p,i)):i instanceof e.PointsMaterial?R(p,i):i instanceof e.MeshPhongMaterial?L(p,i):i instanceof e.MeshDepthMaterial?(p.mNear.value=t.near,p.mFar.value=t.far,p.opacity.value=i.opacity):i instanceof e.MeshNormalMaterial&&(p.opacity.value=i.opacity),o.receiveShadow&&!i._shadowPass&&k(p,r),I(a.uniformsList)),F(l,o),void 0!==l.modelMatrix&&zt.uniformMatrix4fv(l.modelMatrix,!1,o.matrixWorld.elements),c}function E(t,r){t.opacity.value=r.opacity,t.diffuse.value=r.color,r.emissive&&(t.emissive.value=r.emissive),t.map.value=r.map,t.specularMap.value=r.specularMap,t.alphaMap.value=r.alphaMap,r.aoMap&&(t.aoMap.value=r.aoMap,t.aoMapIntensity.value=r.aoMapIntensity);var n;if(r.map?n=r.map:r.specularMap?n=r.specularMap:r.displacementMap?n=r.displacementMap:r.normalMap?n=r.normalMap:r.bumpMap?n=r.bumpMap:r.alphaMap?n=r.alphaMap:r.emissiveMap&&(n=r.emissiveMap),void 0!==n){var i=n.offset,o=n.repeat;t.offsetRepeat.value.set(i.x,i.y,o.x,o.y)}t.envMap.value=r.envMap,t.flipEnvMap.value=r.envMap instanceof e.WebGLRenderTargetCube?1:-1,t.reflectivity.value=r.reflectivity,t.refractionRatio.value=r.refractionRatio}function C(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function A(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function R(t,e){if(t.psColor.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size,t.scale.value=K.height/2,t.map.value=e.map,null!==e.map){var r=e.map.offset,n=e.map.repeat;t.offsetRepeat.value.set(r.x,r.y,n.x,n.y)}}function P(t,r){t.fogColor.value=r.color,r instanceof e.Fog?(t.fogNear.value=r.near,t.fogFar.value=r.far):r instanceof e.FogExp2&&(t.fogDensity.value=r.density)}function L(t,e){t.specular.value=e.specular,t.shininess.value=e.shininess,e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function O(t,e){t.ambientLightColor.value=e.ambient,t.directionalLightColor.value=e.directional.colors,t.directionalLightDirection.value=e.directional.positions,t.pointLightColor.value=e.point.colors,t.pointLightPosition.value=e.point.positions,t.pointLightDistance.value=e.point.distances,t.pointLightDecay.value=e.point.decays,t.spotLightColor.value=e.spot.colors,t.spotLightPosition.value=e.spot.positions,t.spotLightDistance.value=e.spot.distances,t.spotLightDirection.value=e.spot.directions,t.spotLightAngleCos.value=e.spot.anglesCos,t.spotLightExponent.value=e.spot.exponents,t.spotLightDecay.value=e.spot.decays,t.hemisphereLightSkyColor.value=e.hemi.skyColors,t.hemisphereLightGroundColor.value=e.hemi.groundColors,t.hemisphereLightDirection.value=e.hemi.positions}function D(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLightColor.needsUpdate=e,t.directionalLightDirection.needsUpdate=e,t.pointLightColor.needsUpdate=e,t.pointLightPosition.needsUpdate=e,t.pointLightDistance.needsUpdate=e,t.pointLightDecay.needsUpdate=e,t.spotLightColor.needsUpdate=e,t.spotLightPosition.needsUpdate=e,t.spotLightDistance.needsUpdate=e,t.spotLightDirection.needsUpdate=e,t.spotLightAngleCos.needsUpdate=e,t.spotLightExponent.needsUpdate=e,t.spotLightDecay.needsUpdate=e,t.hemisphereLightSkyColor.needsUpdate=e,t.hemisphereLightGroundColor.needsUpdate=e,t.hemisphereLightDirection.needsUpdate=e}function k(t,r){if(t.shadowMatrix)for(var n=0,i=0,o=r.length;o>i;i++){var a=r[i];a.castShadow&&(a instanceof e.SpotLight||a instanceof e.DirectionalLight)&&(t.shadowMap.value[n]=a.shadowMap,t.shadowMapSize.value[n]=a.shadowMapSize,t.shadowMatrix.value[n]=a.shadowMatrix,t.shadowDarkness.value[n]=a.shadowDarkness,t.shadowBias.value[n]=a.shadowBias,n++)}}function F(t,e){zt.uniformMatrix4fv(t.modelViewMatrix,!1,e.modelViewMatrix.elements),t.normalMatrix&&zt.uniformMatrix3fv(t.normalMatrix,!1,e.normalMatrix.elements)}function N(){var t=Ct;return t>=Xt.maxTextures&&console.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+Xt.maxTextures),Ct+=1,t}function I(t){for(var r,n,i=0,o=t.length;o>i;i++){var a=t[i][0];if(a.needsUpdate!==!1){var s=a.type,h=a.value,u=t[i][1];switch(s){case"1i":zt.uniform1i(u,h);break;case"1f":zt.uniform1f(u,h);break;case"2f":zt.uniform2f(u,h[0],h[1]);break;case"3f":zt.uniform3f(u,h[0],h[1],h[2]);break;case"4f":zt.uniform4f(u,h[0],h[1],h[2],h[3]);break;case"1iv":zt.uniform1iv(u,h);break;case"3iv":zt.uniform3iv(u,h);break;case"1fv":zt.uniform1fv(u,h);break;case"2fv":zt.uniform2fv(u,h);break;case"3fv":zt.uniform3fv(u,h);break;case"4fv":zt.uniform4fv(u,h);break;case"Matrix3fv":zt.uniformMatrix3fv(u,!1,h);break;case"Matrix4fv":zt.uniformMatrix4fv(u,!1,h);break;case"i":zt.uniform1i(u,h);break;case"f":zt.uniform1f(u,h);break;case"v2":zt.uniform2f(u,h.x,h.y);break;case"v3":zt.uniform3f(u,h.x,h.y,h.z);break;case"v4":zt.uniform4f(u,h.x,h.y,h.z,h.w);break;case"c":zt.uniform3f(u,h.r,h.g,h.b);break;case"iv1":zt.uniform1iv(u,h);break;case"iv":zt.uniform3iv(u,h);break;case"fv1":zt.uniform1fv(u,h);break;case"fv":zt.uniform3fv(u,h);break;case"v2v":void 0===a._array&&(a._array=new Float32Array(2*h.length));for(var c=0,l=0,p=h.length;p>c;c++,l+=2)a._array[l+0]=h[c].x,a._array[l+1]=h[c].y;zt.uniform2fv(u,a._array);break;case"v3v":void 0===a._array&&(a._array=new Float32Array(3*h.length));for(var c=0,f=0,p=h.length;p>c;c++,f+=3)a._array[f+0]=h[c].x,a._array[f+1]=h[c].y,a._array[f+2]=h[c].z;zt.uniform3fv(u,a._array);break;case"v4v":void 0===a._array&&(a._array=new Float32Array(4*h.length));for(var c=0,d=0,p=h.length;p>c;c++,d+=4)a._array[d+0]=h[c].x,a._array[d+1]=h[c].y,a._array[d+2]=h[c].z,a._array[d+3]=h[c].w;zt.uniform4fv(u,a._array);break;case"m3":zt.uniformMatrix3fv(u,!1,h.elements);break;case"m3v":void 0===a._array&&(a._array=new Float32Array(9*h.length));for(var c=0,p=h.length;p>c;c++)h[c].flattenToArrayOffset(a._array,9*c);zt.uniformMatrix3fv(u,!1,a._array);break;case"m4":zt.uniformMatrix4fv(u,!1,h.elements);break;case"m4v":void 0===a._array&&(a._array=new Float32Array(16*h.length));for(var c=0,p=h.length;p>c;c++)h[c].flattenToArrayOffset(a._array,16*c);zt.uniformMatrix4fv(u,!1,a._array);break;case"t":if(r=h,n=N(),zt.uniform1i(u,n),!r)continue;r instanceof e.CubeTexture||Array.isArray(r.image)&&6===r.image.length?H(r,n):r instanceof e.WebGLRenderTargetCube?j(r,n):bt.setTexture(r,n);break;case"tv":void 0===a._array&&(a._array=[]);for(var c=0,p=a.value.length;p>c;c++)a._array[c]=N();zt.uniform1iv(u,a._array);for(var c=0,p=a.value.length;p>c;c++)r=a.value[c],n=a._array[c],r&&bt.setTexture(r,n);break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+s)}}}}function U(t,e,r,n){t[e+0]=r.r*n,t[e+1]=r.g*n,t[e+2]=r.b*n}function B(t,r){var n,i,o,a,s,h,u,c,l=0,p=0,f=0,d=Bt,m=r.matrixWorldInverse,g=d.directional.colors,y=d.directional.positions,v=d.point.colors,_=d.point.positions,x=d.point.distances,b=d.point.decays,w=d.spot.colors,S=d.spot.positions,M=d.spot.distances,T=d.spot.directions,E=d.spot.anglesCos,C=d.spot.exponents,A=d.spot.decays,R=d.hemi.skyColors,P=d.hemi.groundColors,L=d.hemi.positions,O=0,D=0,k=0,F=0,N=0,I=0,B=0,V=0,G=0,z=0,H=0,j=0;for(n=0,i=t.length;i>n;n++)if(o=t[n],!o.onlyShadow)if(a=o.color,u=o.intensity,c=o.distance,o instanceof e.AmbientLight){if(!o.visible)continue;l+=a.r,p+=a.g,f+=a.b}else if(o instanceof e.DirectionalLight){if(N+=1,!o.visible)continue;It.setFromMatrixPosition(o.matrixWorld),Nt.setFromMatrixPosition(o.target.matrixWorld),It.sub(Nt),It.transformDirection(m),G=3*O,y[G+0]=It.x,y[G+1]=It.y,y[G+2]=It.z,U(g,G,a,u),O+=1}else if(o instanceof e.PointLight){if(I+=1,!o.visible)continue;z=3*D,U(v,z,a,u),Nt.setFromMatrixPosition(o.matrixWorld),Nt.applyMatrix4(m),_[z+0]=Nt.x,_[z+1]=Nt.y,_[z+2]=Nt.z,x[D]=c,b[D]=0===o.distance?0:o.decay,D+=1}else if(o instanceof e.SpotLight){if(B+=1,!o.visible)continue;H=3*k,U(w,H,a,u),It.setFromMatrixPosition(o.matrixWorld),Nt.copy(It).applyMatrix4(m),S[H+0]=Nt.x,S[H+1]=Nt.y,S[H+2]=Nt.z,M[k]=c,Nt.setFromMatrixPosition(o.target.matrixWorld),It.sub(Nt),It.transformDirection(m),T[H+0]=It.x,T[H+1]=It.y,T[H+2]=It.z,E[k]=Math.cos(o.angle),C[k]=o.exponent,A[k]=0===o.distance?0:o.decay,k+=1}else if(o instanceof e.HemisphereLight){if(V+=1,!o.visible)continue;It.setFromMatrixPosition(o.matrixWorld),It.transformDirection(m),j=3*F,L[j+0]=It.x,L[j+1]=It.y,L[j+2]=It.z,s=o.color,h=o.groundColor,U(R,j,s,u),U(P,j,h,u),F+=1}for(n=3*O,i=Math.max(g.length,3*N);i>n;n++)g[n]=0;for(n=3*D,i=Math.max(v.length,3*I);i>n;n++)v[n]=0;for(n=3*k,i=Math.max(w.length,3*B);i>n;n++)w[n]=0;for(n=3*F,i=Math.max(R.length,3*V);i>n;n++)R[n]=0;for(n=3*F,i=Math.max(P.length,3*V);i>n;n++)P[n]=0;d.directional.length=O,d.point.length=D,d.spot.length=k,d.hemi.length=F,d.ambient[0]=l,d.ambient[1]=p,d.ambient[2]=f}function V(t,r,n){var i;if(n?(zt.texParameteri(t,zt.TEXTURE_WRAP_S,Z(r.wrapS)),zt.texParameteri(t,zt.TEXTURE_WRAP_T,Z(r.wrapT)),zt.texParameteri(t,zt.TEXTURE_MAG_FILTER,Z(r.magFilter)),zt.texParameteri(t,zt.TEXTURE_MIN_FILTER,Z(r.minFilter))):(zt.texParameteri(t,zt.TEXTURE_WRAP_S,zt.CLAMP_TO_EDGE),zt.texParameteri(t,zt.TEXTURE_WRAP_T,zt.CLAMP_TO_EDGE),(r.wrapS!==e.ClampToEdgeWrapping||r.wrapT!==e.ClampToEdgeWrapping)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( "+r.sourceFile+" )"),zt.texParameteri(t,zt.TEXTURE_MAG_FILTER,Y(r.magFilter)),zt.texParameteri(t,zt.TEXTURE_MIN_FILTER,Y(r.minFilter)),r.minFilter!==e.NearestFilter&&r.minFilter!==e.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( "+r.sourceFile+" )")),i=Wt.get("EXT_texture_filter_anisotropic")){if(r.type===e.FloatType&&null===Wt.get("OES_texture_float_linear"))return;if(r.type===e.HalfFloatType&&null===Wt.get("OES_texture_half_float_linear"))return;(r.anisotropy>1||Yt.get(r).__currentAnisotropy)&&(zt.texParameterf(t,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(r.anisotropy,bt.getMaxAnisotropy())),Yt.get(r).__currentAnisotropy=r.anisotropy)}}function G(t,r,n){void 0===t.__webglInit&&(t.__webglInit=!0,r.__webglInit=!0,r.addEventListener("dispose",a),t.__webglTexture=zt.createTexture(),Vt.textures++),qt.activeTexture(zt.TEXTURE0+n),qt.bindTexture(zt.TEXTURE_2D,t.__webglTexture),zt.pixelStorei(zt.UNPACK_FLIP_Y_WEBGL,r.flipY),zt.pixelStorei(zt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),zt.pixelStorei(zt.UNPACK_ALIGNMENT,r.unpackAlignment),r.image=z(r.image,Xt.maxTextureSize);var i=r.image,o=e.Math.isPowerOfTwo(i.width)&&e.Math.isPowerOfTwo(i.height),s=Z(r.format),h=Z(r.type);V(zt.TEXTURE_2D,r,o);var u,c=r.mipmaps;if(r instanceof e.DataTexture)if(c.length>0&&o){for(var l=0,p=c.length;p>l;l++)u=c[l],qt.texImage2D(zt.TEXTURE_2D,l,s,u.width,u.height,0,s,h,u.data);r.generateMipmaps=!1}else qt.texImage2D(zt.TEXTURE_2D,0,s,i.width,i.height,0,s,h,i.data);else if(r instanceof e.CompressedTexture)for(var l=0,p=c.length;p>l;l++)u=c[l],r.format!==e.RGBAFormat&&r.format!==e.RGBFormat?qt.getCompressedTextureFormats().indexOf(s)>-1?qt.compressedTexImage2D(zt.TEXTURE_2D,l,s,u.width,u.height,0,u.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):qt.texImage2D(zt.TEXTURE_2D,l,s,u.width,u.height,0,s,h,u.data);else if(c.length>0&&o){for(var l=0,p=c.length;p>l;l++)u=c[l],qt.texImage2D(zt.TEXTURE_2D,l,s,s,h,u);r.generateMipmaps=!1}else qt.texImage2D(zt.TEXTURE_2D,0,s,s,h,r.image);r.generateMipmaps&&o&&zt.generateMipmap(zt.TEXTURE_2D),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function z(t,e){if(t.width>e||t.height>e){var r=e/Math.max(t.width,t.height),n=document.createElement("canvas");n.width=Math.floor(t.width*r),n.height=Math.floor(t.height*r);var i=n.getContext("2d");return i.drawImage(t,0,0,t.width,t.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+n.width+"x"+n.height,t),n}return t}function H(t,r){var n=Yt.get(t);if(6===t.image.length)if(t.version>0&&n.__version!==t.version){n.__image__webglTextureCube||(t.addEventListener("dispose",a),n.__image__webglTextureCube=zt.createTexture(),Vt.textures++),qt.activeTexture(zt.TEXTURE0+r),qt.bindTexture(zt.TEXTURE_CUBE_MAP,n.__image__webglTextureCube),zt.pixelStorei(zt.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var i=t instanceof e.CompressedTexture,o=t.image[0]instanceof e.DataTexture,s=[],h=0;6>h;h++)!bt.autoScaleCubemaps||i||o?s[h]=o?t.image[h].image:t.image[h]:s[h]=z(t.image[h],Xt.maxCubemapSize);var u=s[0],c=e.Math.isPowerOfTwo(u.width)&&e.Math.isPowerOfTwo(u.height),l=Z(t.format),p=Z(t.type);V(zt.TEXTURE_CUBE_MAP,t,c);for(var h=0;6>h;h++)if(i)for(var f,d=s[h].mipmaps,m=0,g=d.length;g>m;m++)f=d[m],t.format!==e.RGBAFormat&&t.format!==e.RGBFormat?qt.getCompressedTextureFormats().indexOf(l)>-1?qt.compressedTexImage2D(zt.TEXTURE_CUBE_MAP_POSITIVE_X+h,m,l,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):qt.texImage2D(zt.TEXTURE_CUBE_MAP_POSITIVE_X+h,m,l,f.width,f.height,0,l,p,f.data);else o?qt.texImage2D(zt.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,l,s[h].width,s[h].height,0,l,p,s[h].data):qt.texImage2D(zt.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,l,l,p,s[h]);t.generateMipmaps&&c&&zt.generateMipmap(zt.TEXTURE_CUBE_MAP),n.__version=t.version,t.onUpdate&&t.onUpdate(t)}else qt.activeTexture(zt.TEXTURE0+r),qt.bindTexture(zt.TEXTURE_CUBE_MAP,n.__image__webglTextureCube)}function j(t,e){qt.activeTexture(zt.TEXTURE0+e),qt.bindTexture(zt.TEXTURE_CUBE_MAP,Yt.get(t).__webglTexture)}function W(t,e,r){zt.bindFramebuffer(zt.FRAMEBUFFER,t),zt.framebufferTexture2D(zt.FRAMEBUFFER,zt.COLOR_ATTACHMENT0,r,Yt.get(e).__webglTexture,0)}function X(t,e){zt.bindRenderbuffer(zt.RENDERBUFFER,t),e.depthBuffer&&!e.stencilBuffer?(zt.renderbufferStorage(zt.RENDERBUFFER,zt.DEPTH_COMPONENT16,e.width,e.height),zt.framebufferRenderbuffer(zt.FRAMEBUFFER,zt.DEPTH_ATTACHMENT,zt.RENDERBUFFER,t)):e.depthBuffer&&e.stencilBuffer?(zt.renderbufferStorage(zt.RENDERBUFFER,zt.DEPTH_STENCIL,e.width,e.height),zt.framebufferRenderbuffer(zt.FRAMEBUFFER,zt.DEPTH_STENCIL_ATTACHMENT,zt.RENDERBUFFER,t)):zt.renderbufferStorage(zt.RENDERBUFFER,zt.RGBA4,e.width,e.height)}function q(t){t instanceof e.WebGLRenderTargetCube?(qt.bindTexture(zt.TEXTURE_CUBE_MAP,Yt.get(t).__webglTexture),zt.generateMipmap(zt.TEXTURE_CUBE_MAP),qt.bindTexture(zt.TEXTURE_CUBE_MAP,null)):(qt.bindTexture(zt.TEXTURE_2D,Yt.get(t).__webglTexture),zt.generateMipmap(zt.TEXTURE_2D),qt.bindTexture(zt.TEXTURE_2D,null))}function Y(t){return t===e.NearestFilter||t===e.NearestMipMapNearestFilter||t===e.NearestMipMapLinearFilter?zt.NEAREST:zt.LINEAR}function Z(t){var r;if(t===e.RepeatWrapping)return zt.REPEAT;if(t===e.ClampToEdgeWrapping)return zt.CLAMP_TO_EDGE;if(t===e.MirroredRepeatWrapping)return zt.MIRRORED_REPEAT;if(t===e.NearestFilter)return zt.NEAREST;if(t===e.NearestMipMapNearestFilter)return zt.NEAREST_MIPMAP_NEAREST;if(t===e.NearestMipMapLinearFilter)return zt.NEAREST_MIPMAP_LINEAR;if(t===e.LinearFilter)return zt.LINEAR;if(t===e.LinearMipMapNearestFilter)return zt.LINEAR_MIPMAP_NEAREST;if(t===e.LinearMipMapLinearFilter)return zt.LINEAR_MIPMAP_LINEAR;if(t===e.UnsignedByteType)return zt.UNSIGNED_BYTE;if(t===e.UnsignedShort4444Type)return zt.UNSIGNED_SHORT_4_4_4_4;if(t===e.UnsignedShort5551Type)return zt.UNSIGNED_SHORT_5_5_5_1;if(t===e.UnsignedShort565Type)return zt.UNSIGNED_SHORT_5_6_5;if(t===e.ByteType)return zt.BYTE;if(t===e.ShortType)return zt.SHORT;if(t===e.UnsignedShortType)return zt.UNSIGNED_SHORT;if(t===e.IntType)return zt.INT;if(t===e.UnsignedIntType)return zt.UNSIGNED_INT;if(t===e.FloatType)return zt.FLOAT;if(r=Wt.get("OES_texture_half_float"),null!==r&&t===e.HalfFloatType)return r.HALF_FLOAT_OES;if(t===e.AlphaFormat)return zt.ALPHA;if(t===e.RGBFormat)return zt.RGB;if(t===e.RGBAFormat)return zt.RGBA;if(t===e.LuminanceFormat)return zt.LUMINANCE;if(t===e.LuminanceAlphaFormat)return zt.LUMINANCE_ALPHA;if(t===e.AddEquation)return zt.FUNC_ADD;if(t===e.SubtractEquation)return zt.FUNC_SUBTRACT;if(t===e.ReverseSubtractEquation)return zt.FUNC_REVERSE_SUBTRACT;if(t===e.ZeroFactor)return zt.ZERO;if(t===e.OneFactor)return zt.ONE;if(t===e.SrcColorFactor)return zt.SRC_COLOR;if(t===e.OneMinusSrcColorFactor)return zt.ONE_MINUS_SRC_COLOR;if(t===e.SrcAlphaFactor)return zt.SRC_ALPHA;if(t===e.OneMinusSrcAlphaFactor)return zt.ONE_MINUS_SRC_ALPHA;if(t===e.DstAlphaFactor)return zt.DST_ALPHA;if(t===e.OneMinusDstAlphaFactor)return zt.ONE_MINUS_DST_ALPHA;if(t===e.DstColorFactor)return zt.DST_COLOR;if(t===e.OneMinusDstColorFactor)return zt.ONE_MINUS_DST_COLOR;if(t===e.SrcAlphaSaturateFactor)return zt.SRC_ALPHA_SATURATE;if(r=Wt.get("WEBGL_compressed_texture_s3tc"),null!==r){if(t===e.RGB_S3TC_DXT1_Format)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===e.RGBA_S3TC_DXT1_Format)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===e.RGBA_S3TC_DXT3_Format)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===e.RGBA_S3TC_DXT5_Format)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(r=Wt.get("WEBGL_compressed_texture_pvrtc"),null!==r){if(t===e.RGB_PVRTC_4BPPV1_Format)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===e.RGB_PVRTC_2BPPV1_Format)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===e.RGBA_PVRTC_4BPPV1_Format)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===e.RGBA_PVRTC_2BPPV1_Format)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r=Wt.get("EXT_blend_minmax"),null!==r){if(t===e.MinEquation)return r.MIN_EXT;if(t===e.MaxEquation)return r.MAX_EXT}return 0}console.log("THREE.WebGLRenderer",e.REVISION),t=t||{};var K=void 0!==t.canvas?t.canvas:document.createElement("canvas"),Q=void 0!==t.context?t.context:null,J=K.width,$=K.height,tt=1,et=void 0!==t.alpha?t.alpha:!1,rt=void 0!==t.depth?t.depth:!0,nt=void 0!==t.stencil?t.stencil:!0,it=void 0!==t.antialias?t.antialias:!1,ot=void 0!==t.premultipliedAlpha?t.premultipliedAlpha:!0,at=void 0!==t.preserveDrawingBuffer?t.preserveDrawingBuffer:!1,st=new e.Color(0),ht=0,ut=[],ct=[],lt=-1,pt=[],ft=-1,dt=[],mt=-1,gt=[],yt=-1,vt=new Float32Array(8),_t=[],xt=[];this.domElement=K,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0;var bt=this,wt=null,St=null,Mt=-1,Tt="",Et=null,Ct=0,At=0,Rt=0,Pt=K.width,Lt=K.height,Ot=0,Dt=0,kt=new e.Frustum,Ft=new e.Matrix4,Nt=new e.Vector3,It=new e.Vector3,Ut=!0,Bt={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[],decays:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[],decays:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},Vt={geometries:0,textures:0},Gt={calls:0,vertices:0,faces:0,points:0};this.info={render:Gt,memory:Vt,programs:null};var zt;try{var Ht={alpha:et,depth:rt,stencil:nt,antialias:it,premultipliedAlpha:ot,preserveDrawingBuffer:at};if(zt=Q||K.getContext("webgl",Ht)||K.getContext("experimental-webgl",Ht),null===zt)throw null!==K.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";K.addEventListener("webglcontextlost",o,!1)}catch(jt){console.error("THREE.WebGLRenderer: "+jt)}var Wt=new e.WebGLExtensions(zt);Wt.get("OES_texture_float"),Wt.get("OES_texture_float_linear"),Wt.get("OES_texture_half_float"),Wt.get("OES_texture_half_float_linear"),Wt.get("OES_standard_derivatives"),Wt.get("ANGLE_instanced_arrays"),Wt.get("OES_element_index_uint")&&(e.BufferGeometry.MaxIndex=4294967296);var Xt=new e.WebGLCapabilities(zt,Wt,t),qt=new e.WebGLState(zt,Wt,Z),Yt=new e.WebGLProperties,Zt=new e.WebGLObjects(zt,Yt,this.info),Kt=new e.WebGLPrograms(this,Xt);this.info.programs=Kt.programs;var Qt=new e.WebGLBufferRenderer(zt,Wt,Gt),Jt=new e.WebGLIndexedBufferRenderer(zt,Wt,Gt);n(),this.context=zt,this.capabilities=Xt,this.extensions=Wt,this.state=qt;var $t=new e.WebGLShadowMap(this,ut,Zt);this.shadowMap=$t;var te=new e.SpritePlugin(this,_t),ee=new e.LensFlarePlugin(this,xt);this.getContext=function(){return zt},this.getContextAttributes=function(){return zt.getContextAttributes()},this.forceContextLoss=function(){Wt.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){var t;return function(){if(void 0!==t)return t;var e=Wt.get("EXT_texture_filter_anisotropic");return t=null!==e?zt.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}(),this.getPrecision=function(){return Xt.precision},this.getPixelRatio=function(){return tt},this.setPixelRatio=function(t){void 0!==t&&(tt=t)},this.getSize=function(){return{width:J,height:$}},this.setSize=function(t,e,r){J=t,$=e,K.width=t*tt,K.height=e*tt,r!==!1&&(K.style.width=t+"px",K.style.height=e+"px"),this.setViewport(0,0,t,e)},this.setViewport=function(t,e,r,n){At=t*tt,Rt=e*tt,Pt=r*tt,Lt=n*tt,zt.viewport(At,Rt,Pt,Lt)},this.setScissor=function(t,e,r,n){zt.scissor(t*tt,e*tt,r*tt,n*tt)},this.enableScissorTest=function(t){qt.setScissorTest(t)},this.getClearColor=function(){return st},this.setClearColor=function(t,e){st.set(t),ht=void 0!==e?e:1,r(st.r,st.g,st.b,ht)},this.getClearAlpha=function(){return ht},this.setClearAlpha=function(t){ht=t,r(st.r,st.g,st.b,ht)},this.clear=function(t,e,r){var n=0;(void 0===t||t)&&(n|=zt.COLOR_BUFFER_BIT),(void 0===e||e)&&(n|=zt.DEPTH_BUFFER_BIT),(void 0===r||r)&&(n|=zt.STENCIL_BUFFER_BIT),zt.clear(n)},this.clearColor=function(){zt.clear(zt.COLOR_BUFFER_BIT)},this.clearDepth=function(){zt.clear(zt.DEPTH_BUFFER_BIT)},this.clearStencil=function(){zt.clear(zt.STENCIL_BUFFER_BIT)},this.clearTarget=function(t,e,r,n){this.setRenderTarget(t),this.clear(e,r,n)},this.resetGLState=i,this.dispose=function(){K.removeEventListener("webglcontextlost",o,!1)},this.renderBufferImmediate=function(t,r,n){qt.initAttributes();var i=Yt.get(t);t.hasPositions&&!i.position&&(i.position=zt.createBuffer()),t.hasNormals&&!i.normal&&(i.normal=zt.createBuffer()),t.hasUvs&&!i.uv&&(i.uv=zt.createBuffer()),t.hasColors&&!i.color&&(i.color=zt.createBuffer());var o=r.getAttributes();if(t.hasPositions&&(zt.bindBuffer(zt.ARRAY_BUFFER,i.position),zt.bufferData(zt.ARRAY_BUFFER,t.positionArray,zt.DYNAMIC_DRAW),qt.enableAttribute(o.position),zt.vertexAttribPointer(o.position,3,zt.FLOAT,!1,0,0)),t.hasNormals){if(zt.bindBuffer(zt.ARRAY_BUFFER,i.normal),"MeshPhongMaterial"!==n.type&&n.shading===e.FlatShading)for(var a=0,s=3*t.count;s>a;a+=9){var h=t.normalArray,u=(h[a+0]+h[a+3]+h[a+6])/3,c=(h[a+1]+h[a+4]+h[a+7])/3,l=(h[a+2]+h[a+5]+h[a+8])/3;h[a+0]=u,h[a+1]=c,h[a+2]=l,h[a+3]=u,h[a+4]=c,h[a+5]=l,h[a+6]=u,h[a+7]=c,h[a+8]=l}zt.bufferData(zt.ARRAY_BUFFER,t.normalArray,zt.DYNAMIC_DRAW),qt.enableAttribute(o.normal),zt.vertexAttribPointer(o.normal,3,zt.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(zt.bindBuffer(zt.ARRAY_BUFFER,i.uv),zt.bufferData(zt.ARRAY_BUFFER,t.uvArray,zt.DYNAMIC_DRAW),qt.enableAttribute(o.uv),zt.vertexAttribPointer(o.uv,2,zt.FLOAT,!1,0,0)),t.hasColors&&n.vertexColors!==e.NoColors&&(zt.bindBuffer(zt.ARRAY_BUFFER,i.color),zt.bufferData(zt.ARRAY_BUFFER,t.colorArray,zt.DYNAMIC_DRAW),qt.enableAttribute(o.color),zt.vertexAttribPointer(o.color,3,zt.FLOAT,!1,0,0)),qt.disableUnusedAttributes(),zt.drawArrays(zt.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,r,n,i,o,a,s){S(o);var h=T(t,r,n,o,a),u=!1,c=i.id+"_"+h.id+"_"+o.wireframe;c!==Tt&&(Tt=c,u=!0);var l=a.morphTargetInfluences;if(void 0!==l){for(var p=[],m=0,g=l.length;g>m;m++){var y=l[m];p.push([y,m]);
}p.sort(d),p.length>8&&(p.length=8);for(var v=i.morphAttributes,m=0,g=p.length;g>m;m++){var y=p[m];if(vt[m]=y[0],0!==y[0]){var _=y[1];o.morphTargets===!0&&v.position&&i.addAttribute("morphTarget"+m,v.position[_]),o.morphNormals===!0&&v.normal&&i.addAttribute("morphNormal"+m,v.normal[_])}else o.morphTargets===!0&&i.removeAttribute("morphTarget"+m),o.morphNormals===!0&&i.removeAttribute("morphNormal"+m)}var x=h.getUniforms();null!==x.morphTargetInfluences&&zt.uniform1fv(x.morphTargetInfluences,vt),u=!0}var _=i.index,b=i.attributes.position;o.wireframe===!0&&(_=Zt.getWireframeAttribute(i));var w;if(null!==_?(w=Jt,w.setIndex(_)):w=Qt,u&&(f(o,h,i),null!==_&&zt.bindBuffer(zt.ELEMENT_ARRAY_BUFFER,Zt.getAttributeBuffer(_))),void 0===s){var M;M=null!==_?_.array.length:b.count;var E=i.drawRange;s={start:E.start,count:Math.min(E.count,M)}}if(a instanceof e.Mesh)o.wireframe===!0?(qt.setLineWidth(o.wireframeLinewidth*tt),w.setMode(zt.LINES)):w.setMode(zt.TRIANGLES),i instanceof e.InstancedBufferGeometry&&i.maxInstancedCount>0?w.renderInstances(i):w.render(s.start,s.count);else if(a instanceof e.Line){var C=o.linewidth;void 0===C&&(C=1),qt.setLineWidth(C*tt),a instanceof e.LineSegments?w.setMode(zt.LINES):w.setMode(zt.LINE_STRIP),w.render(s.start,s.count)}else a instanceof e.Points&&(w.setMode(zt.POINTS),w.render(s.start,s.count))},this.render=function(t,r,n,i){if(r instanceof e.Camera==!1)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");var o=t.fog;if(Tt="",Mt=-1,Et=null,Ut=!0,t.autoUpdate===!0&&t.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),r.matrixWorldInverse.getInverse(r.matrixWorld),Ft.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),kt.setFromMatrix(Ft),ut.length=0,lt=-1,ft=-1,mt=-1,yt=-1,_t.length=0,xt.length=0,_(t),ct.length=lt+1,pt.length=ft+1,dt.length=mt+1,gt.length=yt+1,bt.sortObjects===!0&&(ct.sort(m),pt.sort(g)),$t.render(t,r),Gt.calls=0,Gt.vertices=0,Gt.faces=0,Gt.points=0,this.setRenderTarget(n),(this.autoClear||i)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),t.overrideMaterial){var a=t.overrideMaterial;x(ct,r,ut,o,a),x(pt,r,ut,o,a),b(dt,r,ut,o,a),b(gt,r,ut,o,a)}else qt.setBlending(e.NoBlending),x(ct,r,ut,o),b(dt,r,ut,o),x(pt,r,ut,o),b(gt,r,ut,o);te.render(t,r),ee.render(t,r,Ot,Dt),n&&n.generateMipmaps&&n.minFilter!==e.NearestFilter&&n.minFilter!==e.LinearFilter&&q(n),qt.setDepthTest(!0),qt.setDepthWrite(!0),qt.setColorWrite(!0)},this.setFaceCulling=function(t,r){t===e.CullFaceNone?qt.disable(zt.CULL_FACE):(r===e.FrontFaceDirectionCW?zt.frontFace(zt.CW):zt.frontFace(zt.CCW),t===e.CullFaceBack?zt.cullFace(zt.BACK):t===e.CullFaceFront?zt.cullFace(zt.FRONT):zt.cullFace(zt.FRONT_AND_BACK),qt.enable(zt.CULL_FACE))},this.setTexture=function(t,e){var r=Yt.get(t);if(t.version>0&&r.__version!==t.version){var n=t.image;return void 0===n?void console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t):n.complete===!1?void console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t):void G(r,t,e)}qt.activeTexture(zt.TEXTURE0+e),qt.bindTexture(zt.TEXTURE_2D,r.__webglTexture)},this.setRenderTarget=function(t){var r=t instanceof e.WebGLRenderTargetCube;if(t&&void 0===Yt.get(t).__webglFramebuffer){var n=Yt.get(t);void 0===t.depthBuffer&&(t.depthBuffer=!0),void 0===t.stencilBuffer&&(t.stencilBuffer=!0),t.addEventListener("dispose",s),n.__webglTexture=zt.createTexture(),Vt.textures++;var i=e.Math.isPowerOfTwo(t.width)&&e.Math.isPowerOfTwo(t.height),o=Z(t.format),a=Z(t.type);if(r){n.__webglFramebuffer=[],n.__webglRenderbuffer=[],qt.bindTexture(zt.TEXTURE_CUBE_MAP,n.__webglTexture),V(zt.TEXTURE_CUBE_MAP,t,i);for(var h=0;6>h;h++)n.__webglFramebuffer[h]=zt.createFramebuffer(),n.__webglRenderbuffer[h]=zt.createRenderbuffer(),qt.texImage2D(zt.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,o,t.width,t.height,0,o,a,null),W(n.__webglFramebuffer[h],t,zt.TEXTURE_CUBE_MAP_POSITIVE_X+h),X(n.__webglRenderbuffer[h],t);t.generateMipmaps&&i&&zt.generateMipmap(zt.TEXTURE_CUBE_MAP)}else n.__webglFramebuffer=zt.createFramebuffer(),t.shareDepthFrom?n.__webglRenderbuffer=t.shareDepthFrom.__webglRenderbuffer:n.__webglRenderbuffer=zt.createRenderbuffer(),qt.bindTexture(zt.TEXTURE_2D,n.__webglTexture),V(zt.TEXTURE_2D,t,i),qt.texImage2D(zt.TEXTURE_2D,0,o,t.width,t.height,0,o,a,null),W(n.__webglFramebuffer,t,zt.TEXTURE_2D),t.shareDepthFrom?t.depthBuffer&&!t.stencilBuffer?zt.framebufferRenderbuffer(zt.FRAMEBUFFER,zt.DEPTH_ATTACHMENT,zt.RENDERBUFFER,n.__webglRenderbuffer):t.depthBuffer&&t.stencilBuffer&&zt.framebufferRenderbuffer(zt.FRAMEBUFFER,zt.DEPTH_STENCIL_ATTACHMENT,zt.RENDERBUFFER,n.__webglRenderbuffer):X(n.__webglRenderbuffer,t),t.generateMipmaps&&i&&zt.generateMipmap(zt.TEXTURE_2D);r?qt.bindTexture(zt.TEXTURE_CUBE_MAP,null):qt.bindTexture(zt.TEXTURE_2D,null),zt.bindRenderbuffer(zt.RENDERBUFFER,null),zt.bindFramebuffer(zt.FRAMEBUFFER,null)}var u,c,l,p,f;if(t){var n=Yt.get(t);u=r?n.__webglFramebuffer[t.activeCubeFace]:n.__webglFramebuffer,c=t.width,l=t.height,p=0,f=0}else u=null,c=Pt,l=Lt,p=At,f=Rt;u!==St&&(zt.bindFramebuffer(zt.FRAMEBUFFER,u),zt.viewport(p,f,c,l),St=u),Ot=c,Dt=l},this.readRenderTargetPixels=function(t,r,n,i,o,a){if(!(t instanceof e.WebGLRenderTarget))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");if(Yt.get(t).__webglFramebuffer){if(t.format!==e.RGBAFormat)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.");var s=!1;Yt.get(t).__webglFramebuffer!==St&&(zt.bindFramebuffer(zt.FRAMEBUFFER,Yt.get(t).__webglFramebuffer),s=!0),zt.checkFramebufferStatus(zt.FRAMEBUFFER)===zt.FRAMEBUFFER_COMPLETE?zt.readPixels(r,n,i,o,zt.RGBA,zt.UNSIGNED_BYTE,a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."),s&&zt.bindFramebuffer(zt.FRAMEBUFFER,St)}},this.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),Wt.get("OES_texture_float")},this.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),Wt.get("OES_texture_half_float")},this.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),Wt.get("OES_standard_derivatives")},this.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),Wt.get("WEBGL_compressed_texture_s3tc")},this.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),Wt.get("WEBGL_compressed_texture_pvrtc")},this.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),Wt.get("EXT_blend_minmax")},this.supportsVertexTextures=function(){return Xt.vertexTextures},this.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),Wt.get("ANGLE_instanced_arrays")},this.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},this.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},this.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},this.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Object.defineProperties(this,{shadowMapEnabled:{get:function(){return $t.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),$t.enabled=t}},shadowMapType:{get:function(){return $t.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),$t.type=t}},shadowMapCullFace:{get:function(){return $t.cullFace},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),$t.cullFace=t}},shadowMapDebug:{get:function(){return $t.debug},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapDebug is now .shadowMap.debug."),$t.debug=t}}})},e.WebGLRenderTarget=function(t,r,n){this.uuid=e.Math.generateUUID(),this.width=t,this.height=r,n=n||{},this.wrapS=void 0!==n.wrapS?n.wrapS:e.ClampToEdgeWrapping,this.wrapT=void 0!==n.wrapT?n.wrapT:e.ClampToEdgeWrapping,this.magFilter=void 0!==n.magFilter?n.magFilter:e.LinearFilter,this.minFilter=void 0!==n.minFilter?n.minFilter:e.LinearMipMapLinearFilter,this.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,this.offset=new e.Vector2(0,0),this.repeat=new e.Vector2(1,1),this.format=void 0!==n.format?n.format:e.RGBAFormat,this.type=void 0!==n.type?n.type:e.UnsignedByteType,this.depthBuffer=void 0!==n.depthBuffer?n.depthBuffer:!0,this.stencilBuffer=void 0!==n.stencilBuffer?n.stencilBuffer:!0,this.generateMipmaps=!0,this.shareDepthFrom=void 0!==n.shareDepthFrom?n.shareDepthFrom:null},e.WebGLRenderTarget.prototype={constructor:e.WebGLRenderTarget,setSize:function(t,e){(this.width!==t||this.height!==e)&&(this.width=t,this.height=e,this.dispose())},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.format=t.format,this.type=t.type,this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.generateMipmaps=t.generateMipmaps,this.shareDepthFrom=t.shareDepthFrom,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},e.EventDispatcher.prototype.apply(e.WebGLRenderTarget.prototype),e.WebGLRenderTargetCube=function(t,r,n){e.WebGLRenderTarget.call(this,t,r,n),this.activeCubeFace=0},e.WebGLRenderTargetCube.prototype=Object.create(e.WebGLRenderTarget.prototype),e.WebGLRenderTargetCube.prototype.constructor=e.WebGLRenderTargetCube,e.WebGLBufferRenderer=function(t,r,n){function i(t){s=t}function o(e,r){t.drawArrays(s,e,r),n.calls++,n.vertices+=r,s===t.TRIANGLES&&(n.faces+=r/3)}function a(t){var n=r.get("ANGLE_instanced_arrays");if(null===n)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");var i=t.attributes.position;i instanceof e.InterleavedBufferAttribute?n.drawArraysInstancedANGLE(s,0,i.data.count,t.maxInstancedCount):n.drawArraysInstancedANGLE(s,0,i.count,t.maxInstancedCount)}var s;this.setMode=i,this.render=o,this.renderInstances=a},e.WebGLIndexedBufferRenderer=function(t,e,r){function n(t){s=t}function i(r){r.array instanceof Uint32Array&&e.get("OES_element_index_uint")?(h=t.UNSIGNED_INT,u=4):(h=t.UNSIGNED_SHORT,u=2)}function o(e,n){t.drawElements(s,n,h,e*u),r.calls++,r.vertices+=n,s===t.TRIANGLES&&(r.faces+=n/3)}function a(t){var r=e.get("ANGLE_instanced_arrays");if(null===r)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");var n=t.index;r.drawElementsInstancedANGLE(s,n.array.length,h,0,t.maxInstancedCount)}var s,h,u;this.setMode=n,this.setIndex=i,this.render=o,this.renderInstances=a},e.WebGLExtensions=function(t){var e={};this.get=function(r){if(void 0!==e[r])return e[r];var n;switch(r){case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(r)}return null===n&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),e[r]=n,n}},e.WebGLCapabilities=function(t,e,r){function n(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}this.getMaxPrecision=n,this.precision=void 0!==r.precision?r.precision:"highp",this.logarithmicDepthBuffer=void 0!==r.logarithmicDepthBuffer?r.logarithmicDepthBuffer:!1,this.maxTextures=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),this.maxVertexTextures=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxCubemapSize=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),this.maxAttributes=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.maxVertexUniforms=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),this.maxVaryings=t.getParameter(t.MAX_VARYING_VECTORS),this.maxFragmentUniforms=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),this.vertexTextures=this.maxVertexTextures>0,this.floatFragmentTextures=!!e.get("OES_texture_float"),this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures;var i=n(this.precision);i!==this.precision&&(console.warn("THREE.WebGLRenderer:",this.precision,"not supported, using",i,"instead."),this.precision=i),this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!e.get("EXT_frag_depth"))},e.WebGLGeometries=function(t,r,n){function i(t){var r=t.geometry;if(void 0!==c[r.id])return c[r.id];r.addEventListener("dispose",o);var i;return r instanceof e.BufferGeometry?i=r:r instanceof e.Geometry&&(void 0===r._bufferGeometry&&(r._bufferGeometry=(new e.BufferGeometry).setFromObject(t)),i=r._bufferGeometry),c[r.id]=i,n.memory.geometries++,i}function o(t){var e=t.target,i=c[e.id];h(i.attributes),e.removeEventListener("dispose",o),delete c[e.id];var a=r.get(e);a.wireframe&&s(a.wireframe),n.memory.geometries--}function a(t){return t instanceof e.InterleavedBufferAttribute?r.get(t.data).__webglBuffer:r.get(t).__webglBuffer}function s(e){var r=a(e);void 0!==r&&(t.deleteBuffer(r),u(e))}function h(t){for(var e in t)s(t[e])}function u(t){t instanceof e.InterleavedBufferAttribute?r["delete"](t.data):r["delete"](t)}var c={};this.get=i},e.WebGLObjects=function(t,r,n){function i(r){var n=l.get(r);r.geometry instanceof e.Geometry&&n.updateFromObject(r);var i=n.index,a=n.attributes;null!==i&&o(i,t.ELEMENT_ARRAY_BUFFER);for(var s in a)o(a[s],t.ARRAY_BUFFER);var h=n.morphAttributes;for(var s in h)for(var u=h[s],c=0,p=u.length;p>c;c++)o(u[c],t.ARRAY_BUFFER);return n}function o(t,n){var i=t instanceof e.InterleavedBufferAttribute?t.data:t,o=r.get(i);void 0===o.__webglBuffer?a(o,i,n):o.version!==i.version&&s(o,i,n)}function a(e,r,n){e.__webglBuffer=t.createBuffer(),t.bindBuffer(n,e.__webglBuffer);var i=r.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW;t.bufferData(n,r.array,i),e.version=r.version}function s(e,r,n){t.bindBuffer(n,e.__webglBuffer),r.dynamic===!1||-1===r.updateRange.count?t.bufferSubData(n,0,r.array):0===r.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(n,r.updateRange.offset*r.array.BYTES_PER_ELEMENT,r.array.subarray(r.updateRange.offset,r.updateRange.offset+r.updateRange.count)),r.updateRange.count=0),e.version=r.version}function h(t){return t instanceof e.InterleavedBufferAttribute?r.get(t.data).__webglBuffer:r.get(t).__webglBuffer}function u(n){var i=r.get(n);if(void 0!==i.wireframe)return i.wireframe;var a=[],s=n.index,h=n.attributes,u=h.position;if(null!==s)for(var l={},p=s.array,f=0,d=p.length;d>f;f+=3){var m=p[f+0],g=p[f+1],y=p[f+2];c(l,m,g)&&a.push(m,g),c(l,g,y)&&a.push(g,y),c(l,y,m)&&a.push(y,m)}else for(var p=h.position.array,f=0,d=p.length/3-1;d>f;f+=3){var m=f+0,g=f+1,y=f+2;a.push(m,g,g,y,y,m)}var v=u.count>65535?Uint32Array:Uint16Array,_=new e.BufferAttribute(new v(a),1);return o(_,t.ELEMENT_ARRAY_BUFFER),i.wireframe=_,_}function c(t,e,r){if(e>r){var n=e;e=r,r=n}var i=t[e];return void 0===i?(t[e]=[r],!0):-1===i.indexOf(r)?(i.push(r),!0):!1}var l=new e.WebGLGeometries(t,r,n);this.getAttributeBuffer=h,this.getWireframeAttribute=u,this.update=i},e.WebGLProgram=function(){function t(t){var e=[];for(var r in t){var n=t[r];n!==!1&&e.push("#define "+r+" "+n)}return e.join("\n")}function r(t,e,r){for(var n={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),o=0;i>o;o++){var a=t.getActiveUniform(e,o),s=a.name,h=t.getUniformLocation(e,s),u=s.lastIndexOf("[0]");-1!==u&&u===s.length-3&&(n[s.substr(0,u)]=h),n[s]=h}return n}function n(t,e,r){for(var n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o=0;i>o;o++){var a=t.getActiveAttrib(e,o),s=a.name;n[s]=t.getAttribLocation(e,s)}return n}function i(t){return""!==t}var o=0;return function(a,s,h,u){var c=a.context,l=h.defines,p=h.__webglShader.vertexShader,f=h.__webglShader.fragmentShader,d="SHADOWMAP_TYPE_BASIC";u.shadowMapType===e.PCFShadowMap?d="SHADOWMAP_TYPE_PCF":u.shadowMapType===e.PCFSoftShadowMap&&(d="SHADOWMAP_TYPE_PCF_SOFT");var m="ENVMAP_TYPE_CUBE",g="ENVMAP_MODE_REFLECTION",y="ENVMAP_BLENDING_MULTIPLY";if(u.envMap){switch(h.envMap.mapping){case e.CubeReflectionMapping:case e.CubeRefractionMapping:m="ENVMAP_TYPE_CUBE";break;case e.EquirectangularReflectionMapping:case e.EquirectangularRefractionMapping:m="ENVMAP_TYPE_EQUIREC";break;case e.SphericalReflectionMapping:m="ENVMAP_TYPE_SPHERE"}switch(h.envMap.mapping){case e.CubeRefractionMapping:case e.EquirectangularRefractionMapping:g="ENVMAP_MODE_REFRACTION"}switch(h.combine){case e.MultiplyOperation:y="ENVMAP_BLENDING_MULTIPLY";break;case e.MixOperation:y="ENVMAP_BLENDING_MIX";break;case e.AddOperation:y="ENVMAP_BLENDING_ADD"}}var v,_,x=a.gammaFactor>0?a.gammaFactor:1,b=t(l),w=c.createProgram();h instanceof e.RawShaderMaterial?(v="",_=""):(v=["precision "+u.precision+" float;","precision "+u.precision+" int;","#define SHADER_NAME "+h.__webglShader.name,b,u.supportsVertexTextures?"#define VERTEX_TEXTURES":"",a.gammaInput?"#define GAMMA_INPUT":"",a.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+x,"#define MAX_DIR_LIGHTS "+u.maxDirLights,"#define MAX_POINT_LIGHTS "+u.maxPointLights,"#define MAX_SPOT_LIGHTS "+u.maxSpotLights,"#define MAX_HEMI_LIGHTS "+u.maxHemiLights,"#define MAX_SHADOWS "+u.maxShadows,"#define MAX_BONES "+u.maxBones,u.map?"#define USE_MAP":"",u.envMap?"#define USE_ENVMAP":"",u.envMap?"#define "+g:"",u.lightMap?"#define USE_LIGHTMAP":"",u.aoMap?"#define USE_AOMAP":"",u.emissiveMap?"#define USE_EMISSIVEMAP":"",u.bumpMap?"#define USE_BUMPMAP":"",u.normalMap?"#define USE_NORMALMAP":"",u.displacementMap&&u.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",u.specularMap?"#define USE_SPECULARMAP":"",u.alphaMap?"#define USE_ALPHAMAP":"",u.vertexColors?"#define USE_COLOR":"",u.flatShading?"#define FLAT_SHADED":"",u.skinning?"#define USE_SKINNING":"",u.useVertexTexture?"#define BONE_TEXTURE":"",u.morphTargets?"#define USE_MORPHTARGETS":"",u.morphNormals&&u.flatShading===!1?"#define USE_MORPHNORMALS":"",u.doubleSided?"#define DOUBLE_SIDED":"",u.flipSided?"#define FLIP_SIDED":"",u.shadowMapEnabled?"#define USE_SHADOWMAP":"",u.shadowMapEnabled?"#define "+d:"",u.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",u.sizeAttenuation?"#define USE_SIZEATTENUATION":"",u.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",u.logarithmicDepthBuffer&&a.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif","\n"].filter(i).join("\n"),_=[u.bumpMap||u.normalMap||u.flatShading||h.derivatives?"#extension GL_OES_standard_derivatives : enable":"",u.logarithmicDepthBuffer&&a.extensions.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"","precision "+u.precision+" float;","precision "+u.precision+" int;","#define SHADER_NAME "+h.__webglShader.name,b,"#define MAX_DIR_LIGHTS "+u.maxDirLights,"#define MAX_POINT_LIGHTS "+u.maxPointLights,"#define MAX_SPOT_LIGHTS "+u.maxSpotLights,"#define MAX_HEMI_LIGHTS "+u.maxHemiLights,"#define MAX_SHADOWS "+u.maxShadows,u.alphaTest?"#define ALPHATEST "+u.alphaTest:"",a.gammaInput?"#define GAMMA_INPUT":"",a.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+x,u.useFog&&u.fog?"#define USE_FOG":"",u.useFog&&u.fogExp?"#define FOG_EXP2":"",u.map?"#define USE_MAP":"",u.envMap?"#define USE_ENVMAP":"",u.envMap?"#define "+m:"",u.envMap?"#define "+g:"",u.envMap?"#define "+y:"",u.lightMap?"#define USE_LIGHTMAP":"",u.aoMap?"#define USE_AOMAP":"",u.emissiveMap?"#define USE_EMISSIVEMAP":"",u.bumpMap?"#define USE_BUMPMAP":"",u.normalMap?"#define USE_NORMALMAP":"",u.specularMap?"#define USE_SPECULARMAP":"",u.alphaMap?"#define USE_ALPHAMAP":"",u.vertexColors?"#define USE_COLOR":"",u.flatShading?"#define FLAT_SHADED":"",u.metal?"#define METAL":"",u.doubleSided?"#define DOUBLE_SIDED":"",u.flipSided?"#define FLIP_SIDED":"",u.shadowMapEnabled?"#define USE_SHADOWMAP":"",u.shadowMapEnabled?"#define "+d:"",u.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",u.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",u.logarithmicDepthBuffer&&a.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","\n"].filter(i).join("\n"));var S=v+p,M=_+f,T=e.WebGLShader(c,c.VERTEX_SHADER,S),E=e.WebGLShader(c,c.FRAGMENT_SHADER,M);c.attachShader(w,T),c.attachShader(w,E),void 0!==h.index0AttributeName?c.bindAttribLocation(w,0,h.index0AttributeName):u.morphTargets===!0&&c.bindAttribLocation(w,0,"position"),c.linkProgram(w);var C=c.getProgramInfoLog(w),A=c.getShaderInfoLog(T),R=c.getShaderInfoLog(E),P=!0,L=!0;c.getProgramParameter(w,c.LINK_STATUS)===!1?(P=!1,console.error("THREE.WebGLProgram: shader error: ",c.getError(),"gl.VALIDATE_STATUS",c.getProgramParameter(w,c.VALIDATE_STATUS),"gl.getProgramInfoLog",C,A,R)):""!==C?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",C):(""===A||""===R)&&(L=!1),L&&(this.diagnostics={runnable:P,material:h,programLog:C,vertexShader:{log:A,prefix:v},fragmentShader:{log:R,prefix:_}}),c.deleteShader(T),c.deleteShader(E);var O;this.getUniforms=function(){return void 0===O&&(O=r(c,w)),O};var D;return this.getAttributes=function(){return void 0===D&&(D=n(c,w)),D},this.destroy=function(){c.deleteProgram(w),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=o++,this.code=s,this.usedTimes=1,this.program=w,this.vertexShader=T,this.fragmentShader=E,this}}(),e.WebGLPrograms=function(t,r){function n(t){if(r.floatVertexTextures&&t&&t.skeleton&&t.skeleton.useVertexTexture)return 1024;var n=r.maxVertexUniforms,i=Math.floor((n-20)/4),o=i;return void 0!==t&&t instanceof e.SkinnedMesh&&(o=Math.min(t.skeleton.bones.length,o),o<t.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+t.skeleton.bones.length+", this GPU supports just "+o+" (try OpenGL instead of ANGLE)")),o}function i(t){for(var r=0,n=0,i=0,o=0,a=0,s=t.length;s>a;a++){var h=t[a];h.onlyShadow||h.visible===!1||(h instanceof e.DirectionalLight&&r++,h instanceof e.PointLight&&n++,h instanceof e.SpotLight&&i++,h instanceof e.HemisphereLight&&o++)}return{directional:r,point:n,spot:i,hemi:o}}function o(t){for(var r=0,n=0,i=t.length;i>n;n++){var o=t[n];o.castShadow&&(o instanceof e.SpotLight&&r++,o instanceof e.DirectionalLight&&r++)}return r}var a=[],s={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},h=["precision","supportsVertexTextures","map","envMap","envMapMode","lightMap","aoMap","emissiveMap","bumpMap","normalMap","specularMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","maxDirLights","maxPointLights","maxSpotLights","maxHemiLights","maxShadows","shadowMapEnabled","shadowMapType","shadowMapDebug","alphaTest","metal","doubleSided","flipSided"];this.getParameters=function(a,h,u,c){var l=s[a.type],p=i(h),f=o(h),d=n(c),m=t.getPrecision();null!==a.precision&&(m=r.getMaxPrecision(a.precision),m!==a.precision&&console.warn("THREE.WebGLRenderer.initMaterial:",a.precision,"not supported, using",m,"instead."));var g={shaderID:l,precision:m,supportsVertexTextures:r.vertexTextures,map:!!a.map,envMap:!!a.envMap,envMapMode:a.envMap&&a.envMap.mapping,lightMap:!!a.lightMap,aoMap:!!a.aoMap,emissiveMap:!!a.emissiveMap,bumpMap:!!a.bumpMap,normalMap:!!a.normalMap,displacementMap:!!a.displacementMap,specularMap:!!a.specularMap,alphaMap:!!a.alphaMap,combine:a.combine,vertexColors:a.vertexColors,fog:u,useFog:a.fog,fogExp:u instanceof e.FogExp2,flatShading:a.shading===e.FlatShading,sizeAttenuation:a.sizeAttenuation,logarithmicDepthBuffer:r.logarithmicDepthBuffer,skinning:a.skinning,maxBones:d,useVertexTexture:r.floatVertexTextures&&c&&c.skeleton&&c.skeleton.useVertexTexture,morphTargets:a.morphTargets,morphNormals:a.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,maxDirLights:p.directional,maxPointLights:p.point,maxSpotLights:p.spot,maxHemiLights:p.hemi,maxShadows:f,shadowMapEnabled:t.shadowMap.enabled&&c.receiveShadow&&f>0,shadowMapType:t.shadowMap.type,shadowMapDebug:t.shadowMap.debug,alphaTest:a.alphaTest,metal:a.metal,doubleSided:a.side===e.DoubleSide,flipSided:a.side===e.BackSide};return g},this.getProgramCode=function(t,e){var r=[];if(e.shaderID?r.push(e.shaderID):(r.push(t.fragmentShader),r.push(t.vertexShader)),void 0!==t.defines)for(var n in t.defines)r.push(n),r.push(t.defines[n]);for(var i=0;i<h.length;i++){var o=h[i];r.push(o),r.push(e[o])}return r.join()},this.acquireProgram=function(r,n,i){for(var o,s=0,h=a.length;h>s;s++){var u=a[s];if(u.code===i){o=u,++o.usedTimes;break}}return void 0===o&&(o=new e.WebGLProgram(t,i,r,n),a.push(o)),o},this.releaseProgram=function(t){if(0===--t.usedTimes){var e=a.indexOf(t);a[e]=a[a.length-1],a.pop(),t.destroy()}},this.programs=a},e.WebGLProperties=function(){var t={};this.get=function(e){var r=e.uuid,n=t[r];return void 0===n&&(n={},t[r]=n),n},this["delete"]=function(e){delete t[e.uuid]},this.clear=function(){t={}}},e.WebGLShader=function(){var t=function(t){for(var e=t.split("\n"),r=0;r<e.length;r++)e[r]=r+1+": "+e[r];return e.join("\n")};return function(e,r,n){var i=e.createShader(r);return e.shaderSource(i,n),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)===!1&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(i)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",r===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(i),t(n)),i}}(),e.WebGLShadowMap=function(t,r,n){function i(t,r){var n,i=t.geometry,o=void 0!==i.morphTargets&&i.morphTargets.length>0&&r.morphTargets,a=t instanceof e.SkinnedMesh&&r.skinning;return n=t.customDepthMaterial?t.customDepthMaterial:a?o?y:g:o?m:d,n.visible=r.visible,n.wireframe=r.wireframe,n.wireframeLinewidth=r.wireframeLinewidth,n}function o(t,r){if(t.visible!==!1){if((t instanceof e.Mesh||t instanceof e.Line||t instanceof e.Points)&&t.castShadow&&(t.frustumCulled===!1||h.intersectsObject(t)===!0)){var n=t.material;n.visible===!0&&(t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),l.push(t))}for(var i=t.children,a=0,s=i.length;s>a;a++)o(i[a],r)}}var a=t.context,s=t.state,h=new e.Frustum,u=new e.Matrix4,c=(new e.Vector3,new e.Vector3,new e.Vector3),l=[],p=e.ShaderLib.depthRGBA,f=e.UniformsUtils.clone(p.uniforms),d=new e.ShaderMaterial({uniforms:f,vertexShader:p.vertexShader,fragmentShader:p.fragmentShader}),m=new e.ShaderMaterial({uniforms:f,vertexShader:p.vertexShader,fragmentShader:p.fragmentShader,morphTargets:!0}),g=new e.ShaderMaterial({uniforms:f,vertexShader:p.vertexShader,fragmentShader:p.fragmentShader,skinning:!0}),y=new e.ShaderMaterial({uniforms:f,vertexShader:p.vertexShader,fragmentShader:p.fragmentShader,morphTargets:!0,skinning:!0});d._shadowPass=!0,m._shadowPass=!0,g._shadowPass=!0,y._shadowPass=!0;var v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=e.PCFShadowMap,this.cullFace=e.CullFaceFront,this.render=function(p,f){if(v.enabled!==!1&&(v.autoUpdate!==!1||v.needsUpdate!==!1)){a.clearColor(1,1,1,1),s.disable(a.BLEND),s.enable(a.CULL_FACE),a.frontFace(a.CCW),v.cullFace===e.CullFaceFront?a.cullFace(a.FRONT):a.cullFace(a.BACK),s.setDepthTest(!0);for(var d=0,m=r.length;m>d;d++){var g=r[d];if(g.castShadow){if(!g.shadowMap){var y=e.LinearFilter;v.type===e.PCFSoftShadowMap&&(y=e.NearestFilter);var _={minFilter:y,magFilter:y,format:e.RGBAFormat};g.shadowMap=new e.WebGLRenderTarget(g.shadowMapWidth,g.shadowMapHeight,_),g.shadowMapSize=new e.Vector2(g.shadowMapWidth,g.shadowMapHeight),g.shadowMatrix=new e.Matrix4}if(!g.shadowCamera){if(g instanceof e.SpotLight)g.shadowCamera=new e.PerspectiveCamera(g.shadowCameraFov,g.shadowMapWidth/g.shadowMapHeight,g.shadowCameraNear,g.shadowCameraFar);else{if(!(g instanceof e.DirectionalLight)){console.error("THREE.ShadowMapPlugin: Unsupported light type for shadow",g);continue}g.shadowCamera=new e.OrthographicCamera(g.shadowCameraLeft,g.shadowCameraRight,g.shadowCameraTop,g.shadowCameraBottom,g.shadowCameraNear,g.shadowCameraFar)}p.add(g.shadowCamera),p.autoUpdate===!0&&p.updateMatrixWorld()}g.shadowCameraVisible&&!g.cameraHelper&&(g.cameraHelper=new e.CameraHelper(g.shadowCamera),p.add(g.cameraHelper));var x=g.shadowMap,b=g.shadowMatrix,w=g.shadowCamera;w.position.setFromMatrixPosition(g.matrixWorld),c.setFromMatrixPosition(g.target.matrixWorld),w.lookAt(c),w.updateMatrixWorld(),w.matrixWorldInverse.getInverse(w.matrixWorld),g.cameraHelper&&(g.cameraHelper.visible=g.shadowCameraVisible),g.shadowCameraVisible&&g.cameraHelper.update(),b.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),b.multiply(w.projectionMatrix),b.multiply(w.matrixWorldInverse),u.multiplyMatrices(w.projectionMatrix,w.matrixWorldInverse),h.setFromMatrix(u),t.setRenderTarget(x),t.clear(),l.length=0,o(p,w);for(var S=0,M=l.length;M>S;S++){var T=l[S],E=n.update(T),C=T.material;if(C instanceof e.MeshFaceMaterial)for(var A=E.groups,R=C.materials,P=0,L=A.length;L>P;P++){var O=A[P],D=R[O.materialIndex];D.visible===!0&&t.renderBufferDirect(w,r,null,E,i(T,D),T,O)}else t.renderBufferDirect(w,r,null,E,i(T,C),T)}}}var k=t.getClearColor(),F=t.getClearAlpha();
t.setClearColor(k,F),s.enable(a.BLEND),v.cullFace===e.CullFaceFront&&a.cullFace(a.BACK),t.resetGLState(),v.needsUpdate=!1}}},e.WebGLState=function(t,r,n){var i=this,o=new Uint8Array(16),a=new Uint8Array(16),s={},h=null,u=null,c=null,l=null,p=null,f=null,d=null,m=null,g=null,y=null,v=null,_=null,x=null,b=null,w=null,S=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),M=void 0,T={};this.init=function(){t.clearColor(0,0,0,1),t.clearDepth(1),t.clearStencil(0),this.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.frontFace(t.CCW),t.cullFace(t.BACK),this.enable(t.CULL_FACE),this.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)},this.initAttributes=function(){for(var t=0,e=o.length;e>t;t++)o[t]=0},this.enableAttribute=function(e){o[e]=1,0===a[e]&&(t.enableVertexAttribArray(e),a[e]=1)},this.disableUnusedAttributes=function(){for(var e=0,r=a.length;r>e;e++)a[e]!==o[e]&&(t.disableVertexAttribArray(e),a[e]=0)},this.enable=function(e){s[e]!==!0&&(t.enable(e),s[e]=!0)},this.disable=function(e){s[e]!==!1&&(t.disable(e),s[e]=!1)},this.getCompressedTextureFormats=function(){if(null===h&&(h=[],r.get("WEBGL_compressed_texture_pvrtc")||r.get("WEBGL_compressed_texture_s3tc")))for(var e=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),n=0;n<e.length;n++)h.push(e[n]);return h},this.setBlending=function(r,i,o,a,s,h,g){r!==u&&(r===e.NoBlending?this.disable(t.BLEND):r===e.AdditiveBlending?(this.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):r===e.SubtractiveBlending?(this.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):r===e.MultiplyBlending?(this.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):r===e.CustomBlending?this.enable(t.BLEND):(this.enable(t.BLEND),t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),u=r),r===e.CustomBlending?(s=s||i,h=h||o,g=g||a,(i!==c||s!==f)&&(t.blendEquationSeparate(n(i),n(s)),c=i,f=s),(o!==l||a!==p||h!==d||g!==m)&&(t.blendFuncSeparate(n(o),n(a),n(h),n(g)),l=o,p=a,d=h,m=g)):(c=null,l=null,p=null,f=null,d=null,m=null)},this.setDepthFunc=function(r){if(g!==r){if(r)switch(r){case e.NeverDepth:t.depthFunc(t.NEVER);break;case e.AlwaysDepth:t.depthFunc(t.ALWAYS);break;case e.LessDepth:t.depthFunc(t.LESS);break;case e.LessEqualDepth:t.depthFunc(t.LEQUAL);break;case e.EqualDepth:t.depthFunc(t.EQUAL);break;case e.GreaterEqualDepth:t.depthFunc(t.GEQUAL);break;case e.GreaterDepth:t.depthFunc(t.GREATER);break;case e.NotEqualDepth:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);g=r}},this.setDepthTest=function(e){e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)},this.setDepthWrite=function(e){y!==e&&(t.depthMask(e),y=e)},this.setColorWrite=function(e){v!==e&&(t.colorMask(e,e,e,e),v=e)},this.setFlipSided=function(e){_!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),_=e)},this.setLineWidth=function(e){e!==x&&(t.lineWidth(e),x=e)},this.setPolygonOffset=function(e,r,n){e?this.enable(t.POLYGON_OFFSET_FILL):this.disable(t.POLYGON_OFFSET_FILL),!e||b===r&&w===n||(t.polygonOffset(r,n),b=r,w=n)},this.setScissorTest=function(e){e?this.enable(t.SCISSOR_TEST):this.disable(t.SCISSOR_TEST)},this.activeTexture=function(e){void 0===e&&(e=t.TEXTURE0+S-1),M!==e&&(t.activeTexture(e),M=e)},this.bindTexture=function(e,r){void 0===M&&i.activeTexture();var n=T[M];void 0===n&&(n={type:void 0,texture:void 0},T[M]=n),(n.type!==e||n.texture!==r)&&(t.bindTexture(e,r),n.type=e,n.texture=r)},this.compressedTexImage2D=function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(e){console.error(e)}},this.texImage2D=function(){try{t.texImage2D.apply(t,arguments)}catch(e){console.error(e)}},this.reset=function(){for(var e=0;e<a.length;e++)1===a[e]&&(t.disableVertexAttribArray(e),a[e]=0);s={},h=null,u=null,y=null,v=null,_=null}},e.LensFlarePlugin=function(t,r){function n(e){var r=p.createProgram(),n=p.createShader(p.FRAGMENT_SHADER),i=p.createShader(p.VERTEX_SHADER),o="precision "+t.getPrecision()+" float;\n";return p.shaderSource(n,o+e.fragmentShader),p.shaderSource(i,o+e.vertexShader),p.compileShader(n),p.compileShader(i),p.attachShader(r,n),p.attachShader(r,i),p.linkProgram(r),r}var i,o,a,s,h,u,c,l,p=t.context,f=t.state,d=function(){var t=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),e=new Uint16Array([0,1,2,0,2,3]);i=p.createBuffer(),o=p.createBuffer(),p.bindBuffer(p.ARRAY_BUFFER,i),p.bufferData(p.ARRAY_BUFFER,t,p.STATIC_DRAW),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,o),p.bufferData(p.ELEMENT_ARRAY_BUFFER,e,p.STATIC_DRAW),c=p.createTexture(),l=p.createTexture(),f.bindTexture(p.TEXTURE_2D,c),p.texImage2D(p.TEXTURE_2D,0,p.RGB,16,16,0,p.RGB,p.UNSIGNED_BYTE,null),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),f.bindTexture(p.TEXTURE_2D,l),p.texImage2D(p.TEXTURE_2D,0,p.RGBA,16,16,0,p.RGBA,p.UNSIGNED_BYTE,null),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),u=p.getParameter(p.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;var r;r=u?{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},a=n(r),s={vertex:p.getAttribLocation(a,"position"),uv:p.getAttribLocation(a,"uv")},h={renderType:p.getUniformLocation(a,"renderType"),map:p.getUniformLocation(a,"map"),occlusionMap:p.getUniformLocation(a,"occlusionMap"),opacity:p.getUniformLocation(a,"opacity"),color:p.getUniformLocation(a,"color"),scale:p.getUniformLocation(a,"scale"),rotation:p.getUniformLocation(a,"rotation"),screenPosition:p.getUniformLocation(a,"screenPosition")}};this.render=function(n,m,g,y){if(0!==r.length){var v=new e.Vector3,_=y/g,x=.5*g,b=.5*y,w=16/y,S=new e.Vector2(w*_,w),M=new e.Vector3(1,1,0),T=new e.Vector2(1,1);void 0===a&&d(),p.useProgram(a),f.initAttributes(),f.enableAttribute(s.vertex),f.enableAttribute(s.uv),f.disableUnusedAttributes(),p.uniform1i(h.occlusionMap,0),p.uniform1i(h.map,1),p.bindBuffer(p.ARRAY_BUFFER,i),p.vertexAttribPointer(s.vertex,2,p.FLOAT,!1,16,0),p.vertexAttribPointer(s.uv,2,p.FLOAT,!1,16,8),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,o),f.disable(p.CULL_FACE),p.depthMask(!1);for(var E=0,C=r.length;C>E;E++){w=16/y,S.set(w*_,w);var A=r[E];if(v.set(A.matrixWorld.elements[12],A.matrixWorld.elements[13],A.matrixWorld.elements[14]),v.applyMatrix4(m.matrixWorldInverse),v.applyProjection(m.projectionMatrix),M.copy(v),T.x=M.x*x+x,T.y=M.y*b+b,u||T.x>0&&T.x<g&&T.y>0&&T.y<y){f.activeTexture(p.TEXTURE0),f.bindTexture(p.TEXTURE_2D,null),f.activeTexture(p.TEXTURE1),f.bindTexture(p.TEXTURE_2D,c),p.copyTexImage2D(p.TEXTURE_2D,0,p.RGB,T.x-8,T.y-8,16,16,0),p.uniform1i(h.renderType,0),p.uniform2f(h.scale,S.x,S.y),p.uniform3f(h.screenPosition,M.x,M.y,M.z),f.disable(p.BLEND),f.enable(p.DEPTH_TEST),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0),f.activeTexture(p.TEXTURE0),f.bindTexture(p.TEXTURE_2D,l),p.copyTexImage2D(p.TEXTURE_2D,0,p.RGBA,T.x-8,T.y-8,16,16,0),p.uniform1i(h.renderType,1),f.disable(p.DEPTH_TEST),f.activeTexture(p.TEXTURE1),f.bindTexture(p.TEXTURE_2D,c),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0),A.positionScreen.copy(M),A.customUpdateCallback?A.customUpdateCallback(A):A.updateLensFlares(),p.uniform1i(h.renderType,2),f.enable(p.BLEND);for(var R=0,P=A.lensFlares.length;P>R;R++){var L=A.lensFlares[R];L.opacity>.001&&L.scale>.001&&(M.x=L.x,M.y=L.y,M.z=L.z,w=L.size*L.scale/y,S.x=w*_,S.y=w,p.uniform3f(h.screenPosition,M.x,M.y,M.z),p.uniform2f(h.scale,S.x,S.y),p.uniform1f(h.rotation,L.rotation),p.uniform1f(h.opacity,L.opacity),p.uniform3f(h.color,L.color.r,L.color.g,L.color.b),f.setBlending(L.blending,L.blendEquation,L.blendSrc,L.blendDst),t.setTexture(L.texture,1),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0))}}}f.enable(p.CULL_FACE),f.enable(p.DEPTH_TEST),p.depthMask(!0),t.resetGLState()}}},e.SpritePlugin=function(t,r){function n(){var e=l.createProgram(),r=l.createShader(l.VERTEX_SHADER),n=l.createShader(l.FRAGMENT_SHADER);return l.shaderSource(r,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),l.shaderSource(n,["precision "+t.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),l.compileShader(r),l.compileShader(n),l.attachShader(e,r),l.attachShader(e,n),l.linkProgram(e),e}function i(t,e){return t.z!==e.z?e.z-t.z:e.id-t.id}var o,a,s,h,u,c,l=t.context,p=t.state,f=new e.Vector3,d=new e.Quaternion,m=new e.Vector3,g=function(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),r=new Uint16Array([0,1,2,0,2,3]);o=l.createBuffer(),a=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,o),l.bufferData(l.ARRAY_BUFFER,t,l.STATIC_DRAW),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,a),l.bufferData(l.ELEMENT_ARRAY_BUFFER,r,l.STATIC_DRAW),s=n(),h={position:l.getAttribLocation(s,"position"),uv:l.getAttribLocation(s,"uv")},u={uvOffset:l.getUniformLocation(s,"uvOffset"),uvScale:l.getUniformLocation(s,"uvScale"),rotation:l.getUniformLocation(s,"rotation"),scale:l.getUniformLocation(s,"scale"),color:l.getUniformLocation(s,"color"),map:l.getUniformLocation(s,"map"),opacity:l.getUniformLocation(s,"opacity"),modelViewMatrix:l.getUniformLocation(s,"modelViewMatrix"),projectionMatrix:l.getUniformLocation(s,"projectionMatrix"),fogType:l.getUniformLocation(s,"fogType"),fogDensity:l.getUniformLocation(s,"fogDensity"),fogNear:l.getUniformLocation(s,"fogNear"),fogFar:l.getUniformLocation(s,"fogFar"),fogColor:l.getUniformLocation(s,"fogColor"),alphaTest:l.getUniformLocation(s,"alphaTest")};var i=document.createElement("canvas");i.width=8,i.height=8;var p=i.getContext("2d");p.fillStyle="white",p.fillRect(0,0,8,8),c=new e.Texture(i),c.needsUpdate=!0};this.render=function(n,y){if(0!==r.length){void 0===s&&g(),l.useProgram(s),p.initAttributes(),p.enableAttribute(h.position),p.enableAttribute(h.uv),p.disableUnusedAttributes(),p.disable(l.CULL_FACE),p.enable(l.BLEND),l.bindBuffer(l.ARRAY_BUFFER,o),l.vertexAttribPointer(h.position,2,l.FLOAT,!1,16,0),l.vertexAttribPointer(h.uv,2,l.FLOAT,!1,16,8),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,a),l.uniformMatrix4fv(u.projectionMatrix,!1,y.projectionMatrix.elements),p.activeTexture(l.TEXTURE0),l.uniform1i(u.map,0);var v=0,_=0,x=n.fog;x?(l.uniform3f(u.fogColor,x.color.r,x.color.g,x.color.b),x instanceof e.Fog?(l.uniform1f(u.fogNear,x.near),l.uniform1f(u.fogFar,x.far),l.uniform1i(u.fogType,1),v=1,_=1):x instanceof e.FogExp2&&(l.uniform1f(u.fogDensity,x.density),l.uniform1i(u.fogType,2),v=2,_=2)):(l.uniform1i(u.fogType,0),v=0,_=0);for(var b=0,w=r.length;w>b;b++){var S=r[b];S.modelViewMatrix.multiplyMatrices(y.matrixWorldInverse,S.matrixWorld),S.z=-S.modelViewMatrix.elements[14]}r.sort(i);for(var M=[],b=0,w=r.length;w>b;b++){var S=r[b],T=S.material;l.uniform1f(u.alphaTest,T.alphaTest),l.uniformMatrix4fv(u.modelViewMatrix,!1,S.modelViewMatrix.elements),S.matrixWorld.decompose(f,d,m),M[0]=m.x,M[1]=m.y;var E=0;n.fog&&T.fog&&(E=_),v!==E&&(l.uniform1i(u.fogType,E),v=E),null!==T.map?(l.uniform2f(u.uvOffset,T.map.offset.x,T.map.offset.y),l.uniform2f(u.uvScale,T.map.repeat.x,T.map.repeat.y)):(l.uniform2f(u.uvOffset,0,0),l.uniform2f(u.uvScale,1,1)),l.uniform1f(u.opacity,T.opacity),l.uniform3f(u.color,T.color.r,T.color.g,T.color.b),l.uniform1f(u.rotation,T.rotation),l.uniform2fv(u.scale,M),p.setBlending(T.blending,T.blendEquation,T.blendSrc,T.blendDst),p.setDepthTest(T.depthTest),p.setDepthWrite(T.depthWrite),T.map&&T.map.image&&T.map.image.width?t.setTexture(T.map,0):t.setTexture(c,0),l.drawElements(l.TRIANGLES,6,l.UNSIGNED_SHORT,0)}p.enable(l.CULL_FACE),t.resetGLState()}}},e.GeometryUtils={merge:function(t,r,n){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var i;r instanceof e.Mesh&&(r.matrixAutoUpdate&&r.updateMatrix(),i=r.matrix,r=r.geometry),t.merge(r,i,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},e.ImageUtils={crossOrigin:void 0,loadTexture:function(t,r,n,i){var o=new e.ImageLoader;o.crossOrigin=this.crossOrigin;var a=new e.Texture(void 0,r);return o.load(t,function(t){a.image=t,a.needsUpdate=!0,n&&n(a)},void 0,function(t){i&&i(t)}),a.sourceFile=t,a},loadTextureCube:function(t,r,n,i){var o=[],a=new e.ImageLoader;a.crossOrigin=this.crossOrigin;for(var s=new e.CubeTexture(o,r),h=0,u=function(e){a.load(t[e],function(t){s.images[e]=t,h+=1,6===h&&(s.needsUpdate=!0,n&&n(s))},void 0,i)},c=0,l=t.length;l>c;++c)u(c);return s},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(t,e){var r=function(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]},n=function(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2]]},i=function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);return[t[0]/e,t[1]/e,t[2]/e]};e=1|e;var o=t.width,a=t.height,s=document.createElement("canvas");s.width=o,s.height=a;var h=s.getContext("2d");h.drawImage(t,0,0);for(var u=h.getImageData(0,0,o,a).data,c=h.createImageData(o,a),l=c.data,p=0;o>p;p++)for(var f=0;a>f;f++){var d=0>f-1?0:f-1,m=f+1>a-1?a-1:f+1,g=0>p-1?0:p-1,y=p+1>o-1?o-1:p+1,v=[],_=[0,0,u[4*(f*o+p)]/255*e];v.push([-1,0,u[4*(f*o+g)]/255*e]),v.push([-1,-1,u[4*(d*o+g)]/255*e]),v.push([0,-1,u[4*(d*o+p)]/255*e]),v.push([1,-1,u[4*(d*o+y)]/255*e]),v.push([1,0,u[4*(f*o+y)]/255*e]),v.push([1,1,u[4*(m*o+y)]/255*e]),v.push([0,1,u[4*(m*o+p)]/255*e]),v.push([-1,1,u[4*(m*o+g)]/255*e]);for(var x=[],b=v.length,w=0;b>w;w++){var S=v[w],M=v[(w+1)%b];S=n(S,_),M=n(M,_),x.push(i(r(S,M)))}for(var T=[0,0,0],w=0;w<x.length;w++)T[0]+=x[w][0],T[1]+=x[w][1],T[2]+=x[w][2];T[0]/=x.length,T[1]/=x.length,T[2]/=x.length;var E=4*(f*o+p);l[E]=(T[0]+1)/2*255|0,l[E+1]=(T[1]+1)/2*255|0,l[E+2]=255*T[2]|0,l[E+3]=255}return h.putImageData(c,0,0),s},generateDataTexture:function(t,r,n){for(var i=t*r,o=new Uint8Array(3*i),a=Math.floor(255*n.r),s=Math.floor(255*n.g),h=Math.floor(255*n.b),u=0;i>u;u++)o[3*u]=a,o[3*u+1]=s,o[3*u+2]=h;var c=new e.DataTexture(o,t,r,e.RGBFormat);return c.needsUpdate=!0,c}},e.SceneUtils={createMultiMaterialObject:function(t,r){for(var n=new e.Group,i=0,o=r.length;o>i;i++)n.add(new e.Mesh(t,r[i]));return n},detach:function(t,e,r){t.applyMatrix(e.matrixWorld),e.remove(t),r.add(t)},attach:function(t,r,n){var i=new e.Matrix4;i.getInverse(n.matrixWorld),t.applyMatrix(i),r.remove(t),n.add(t)}},e.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face.toLowerCase()][this.weight][this.style]}catch(t){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(t){var e=t.familyName.toLowerCase(),r=this;return r.faces[e]=r.faces[e]||{},r.faces[e][t.cssFontWeight]=r.faces[e][t.cssFontWeight]||{},r.faces[e][t.cssFontWeight][t.cssFontStyle]=t,r.faces[e][t.cssFontWeight][t.cssFontStyle]=t,t},drawText:function(t){var r,n=this.getFace(),i=this.size/n.resolution,o=0,a=String(t).split(""),s=a.length,h=[];for(r=0;s>r;r++){var u=new e.Path,c=this.extractGlyphPoints(a[r],n,i,o,u);o+=c.offset,h.push(c.path)}var l=o/2;return{paths:h,offset:l}},extractGlyphPoints:function(t,r,n,i,o){var a,s,h,u,c,l,p,f,d,m,g,y,v,_,x,b,w,S,M,T=[],E=r.glyphs[t]||r.glyphs["?"];if(E){if(E.o)for(u=E._cachedOutline||(E._cachedOutline=E.o.split(" ")),l=u.length,p=n,f=n,a=0;l>a;)switch(c=u[a++]){case"m":d=u[a++]*p+i,m=u[a++]*f,o.moveTo(d,m);break;case"l":d=u[a++]*p+i,m=u[a++]*f,o.lineTo(d,m);break;case"q":if(g=u[a++]*p+i,y=u[a++]*f,x=u[a++]*p+i,b=u[a++]*f,o.quadraticCurveTo(x,b,g,y),M=T[T.length-1])for(v=M.x,_=M.y,s=1,h=this.divisions;h>=s;s++){var C=s/h;e.Shape.Utils.b2(C,v,x,g),e.Shape.Utils.b2(C,_,b,y)}break;case"b":if(g=u[a++]*p+i,y=u[a++]*f,x=u[a++]*p+i,b=u[a++]*f,w=u[a++]*p+i,S=u[a++]*f,o.bezierCurveTo(x,b,w,S,g,y),M=T[T.length-1])for(v=M.x,_=M.y,s=1,h=this.divisions;h>=s;s++){var C=s/h;e.Shape.Utils.b3(C,v,x,w,g),e.Shape.Utils.b3(C,_,b,S,y)}}return{offset:E.ha*n,path:o}}}},e.FontUtils.generateShapes=function(t,r){r=r||{};var n=void 0!==r.size?r.size:100,i=void 0!==r.curveSegments?r.curveSegments:4,o=void 0!==r.font?r.font:"helvetiker",a=void 0!==r.weight?r.weight:"normal",s=void 0!==r.style?r.style:"normal";e.FontUtils.size=n,e.FontUtils.divisions=i,e.FontUtils.face=o,e.FontUtils.weight=a,e.FontUtils.style=s;for(var h=e.FontUtils.drawText(t),u=h.paths,c=[],l=0,p=u.length;p>l;l++)Array.prototype.push.apply(c,u[l].toShapes());return c},function(t){var e=1e-10,r=function(t,e){var r=t.length;if(3>r)return null;var o,a,s,h=[],u=[],c=[];if(n(t)>0)for(a=0;r>a;a++)u[a]=a;else for(a=0;r>a;a++)u[a]=r-1-a;var l=r,p=2*l;for(a=l-1;l>2;){if(p--<=0)return console.warn("THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()"),e?c:h;if(o=a,o>=l&&(o=0),a=o+1,a>=l&&(a=0),s=a+1,s>=l&&(s=0),i(t,o,a,s,l,u)){var f,d,m,g,y;for(f=u[o],d=u[a],m=u[s],h.push([t[f],t[d],t[m]]),c.push([u[o],u[a],u[s]]),g=a,y=a+1;l>y;g++,y++)u[g]=u[y];l--,p=2*l}}return e?c:h},n=function(t){for(var e=t.length,r=0,n=e-1,i=0;e>i;n=i++)r+=t[n].x*t[i].y-t[i].x*t[n].y;return.5*r},i=function(t,r,n,i,o,a){var s,h,u,c,l,p,f,d,m;if(h=t[a[r]].x,u=t[a[r]].y,c=t[a[n]].x,l=t[a[n]].y,p=t[a[i]].x,f=t[a[i]].y,e>(c-h)*(f-u)-(l-u)*(p-h))return!1;var g,y,v,_,x,b,w,S,M,T,E,C,A,R,P;for(g=p-c,y=f-l,v=h-p,_=u-f,x=c-h,b=l-u,s=0;o>s;s++)if(d=t[a[s]].x,m=t[a[s]].y,!(d===h&&m===u||d===c&&m===l||d===p&&m===f)&&(w=d-h,S=m-u,M=d-c,T=m-l,E=d-p,C=m-f,P=g*T-y*M,A=x*S-b*w,R=v*C-_*E,P>=-e&&R>=-e&&A>=-e))return!1;return!0};return t.Triangulate=r,t.Triangulate.area=n,t}(e.FontUtils),e.typeface_js={faces:e.FontUtils.faces,loadFace:e.FontUtils.loadFace},"undefined"!=typeof self&&(self._typeface_js=e.typeface_js),e.Audio=function(t){e.Object3D.call(this),this.type="Audio",this.context=t.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.panner=this.context.createPanner(),this.panner.connect(this.gain),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1},e.Audio.prototype=Object.create(e.Object3D.prototype),e.Audio.prototype.constructor=e.Audio,e.Audio.prototype.load=function(t){var e=this,r=new XMLHttpRequest;return r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=function(t){e.context.decodeAudioData(this.response,function(t){e.source.buffer=t,e.autoplay&&e.play()})},r.send(),this},e.Audio.prototype.play=function(){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");var t=this.context.createBufferSource();t.buffer=this.source.buffer,t.loop=this.source.loop,t.onended=this.source.onended,t.start(0,this.startTime),t.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=t,this.connect()},e.Audio.prototype.pause=function(){this.source.stop(),this.startTime=this.context.currentTime},e.Audio.prototype.stop=function(){this.source.stop(),this.startTime=0},e.Audio.prototype.connect=function(){void 0!==this.filter?(this.source.connect(this.filter),this.filter.connect(this.panner)):this.source.connect(this.panner)},e.Audio.prototype.disconnect=function(){void 0!==this.filter?(this.source.disconnect(this.filter),this.filter.disconnect(this.panner)):this.source.disconnect(this.panner)},e.Audio.prototype.setFilter=function(t){this.isPlaying===!0?(this.disconnect(),this.filter=t,this.connect()):this.filter=t},e.Audio.prototype.getFilter=function(){return this.filter},e.Audio.prototype.setPlaybackRate=function(t){this.playbackRate=t,this.isPlaying===!0&&(this.source.playbackRate.value=this.playbackRate)},e.Audio.prototype.getPlaybackRate=function(){return this.playbackRate},e.Audio.prototype.onEnded=function(){this.isPlaying=!1},e.Audio.prototype.setLoop=function(t){this.source.loop=t},e.Audio.prototype.getLoop=function(){return this.source.loop},e.Audio.prototype.setRefDistance=function(t){this.panner.refDistance=t},e.Audio.prototype.getRefDistance=function(){return this.panner.refDistance},e.Audio.prototype.setRolloffFactor=function(t){this.panner.rolloffFactor=t},e.Audio.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor},e.Audio.prototype.setVolume=function(t){this.gain.gain.value=t},e.Audio.prototype.getVolume=function(){return this.gain.gain.value},e.Audio.prototype.updateMatrixWorld=function(){var t=new e.Vector3;return function(r){e.Object3D.prototype.updateMatrixWorld.call(this,r),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}(),e.AudioListener=function(){e.Object3D.call(this),this.type="AudioListener",this.context=new(window.AudioContext||window.webkitAudioContext)},e.AudioListener.prototype=Object.create(e.Object3D.prototype),e.AudioListener.prototype.constructor=e.AudioListener,e.AudioListener.prototype.updateMatrixWorld=function(){var t=new e.Vector3,r=new e.Quaternion,n=new e.Vector3,i=new e.Vector3;return function(o){e.Object3D.prototype.updateMatrixWorld.call(this,o);var a=this.context.listener,s=this.up;this.matrixWorld.decompose(t,r,n),i.set(0,0,-1).applyQuaternion(r),a.setPosition(t.x,t.y,t.z),a.setOrientation(i.x,i.y,i.z,s.x,s.y,s.z)}}(),e.Curve=function(){},e.Curve.prototype.getPoint=function(t){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},e.Curve.prototype.getPointAt=function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},e.Curve.prototype.getPoints=function(t){t||(t=5);var e,r=[];for(e=0;t>=e;e++)r.push(this.getPoint(e/t));return r},e.Curve.prototype.getSpacedPoints=function(t){t||(t=5);var e,r=[];for(e=0;t>=e;e++)r.push(this.getPointAt(e/t));return r},e.Curve.prototype.getLength=function(){var t=this.getLengths();return t[t.length-1]},e.Curve.prototype.getLengths=function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,r,n=[],i=this.getPoint(0),o=0;for(n.push(0),r=1;t>=r;r++)e=this.getPoint(r/t),o+=e.distanceTo(i),n.push(o),i=e;return this.cacheArcLengths=n,n},e.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},e.Curve.prototype.getUtoTmapping=function(t,e){var r,n=this.getLengths(),i=0,o=n.length;r=e?e:t*n[o-1];for(var a,s=0,h=o-1;h>=s;)if(i=Math.floor(s+(h-s)/2),a=n[i]-r,0>a)s=i+1;else{if(!(a>0)){h=i;break}h=i-1}if(i=h,n[i]===r){var u=i/(o-1);return u}var c=n[i],l=n[i+1],p=l-c,f=(r-c)/p,u=(i+f)/(o-1);return u},e.Curve.prototype.getTangent=function(t){var e=1e-4,r=t-e,n=t+e;0>r&&(r=0),n>1&&(n=1);var i=this.getPoint(r),o=this.getPoint(n),a=o.clone().sub(i);return a.normalize()},e.Curve.prototype.getTangentAt=function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},e.Curve.Utils={tangentQuadraticBezier:function(t,e,r,n){return 2*(1-t)*(r-e)+2*t*(n-r)},tangentCubicBezier:function(t,e,r,n,i){return-3*e*(1-t)*(1-t)+3*r*(1-t)*(1-t)-6*t*r*(1-t)+6*t*n*(1-t)-3*t*t*n+3*t*t*i},tangentSpline:function(t,e,r,n,i){var o=6*t*t-6*t,a=3*t*t-4*t+1,s=-6*t*t+6*t,h=3*t*t-2*t;return o+a+s+h},interpolate:function(t,e,r,n,i){var o=.5*(r-t),a=.5*(n-e),s=i*i,h=i*s;return(2*e-2*r+o+a)*h+(-3*e+3*r-2*o-a)*s+o*i+e}},e.Curve.create=function(t,r){return t.prototype=Object.create(e.Curve.prototype),t.prototype.constructor=t,t.prototype.getPoint=r,t},e.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},e.CurvePath.prototype=Object.create(e.Curve.prototype),e.CurvePath.prototype.constructor=e.CurvePath,e.CurvePath.prototype.add=function(t){this.curves.push(t)},e.CurvePath.prototype.checkConnection=function(){},e.CurvePath.prototype.closePath=function(){var t=this.curves[0].getPoint(0),r=this.curves[this.curves.length-1].getPoint(1);t.equals(r)||this.curves.push(new e.LineCurve(r,t))},e.CurvePath.prototype.getPoint=function(t){for(var e,r,n=t*this.getLength(),i=this.getCurveLengths(),o=0;o<i.length;){if(i[o]>=n){e=i[o]-n,r=this.curves[o];var a=1-e/r.getLength();return r.getPointAt(a)}o++}return null},e.CurvePath.prototype.getLength=function(){var t=this.getCurveLengths();return t[t.length-1]},e.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;var t,e=[],r=0,n=this.curves.length;for(t=0;n>t;t++)r+=this.curves[t].getLength(),e.push(r);return this.cacheLengths=e,e},e.CurvePath.prototype.getBoundingBox=function(){var t,r,n,i,o,a,s=this.getPoints();t=r=Number.NEGATIVE_INFINITY,i=o=Number.POSITIVE_INFINITY;var h,u,c,l,p=s[0]instanceof e.Vector3;for(l=p?new e.Vector3:new e.Vector2,u=0,c=s.length;c>u;u++)h=s[u],h.x>t?t=h.x:h.x<i&&(i=h.x),h.y>r?r=h.y:h.y<o&&(o=h.y),p&&(h.z>n?n=h.z:h.z<a&&(a=h.z)),l.add(h);var f={minX:i,minY:o,maxX:t,maxY:r};return p&&(f.maxZ=n,f.minZ=a),f},e.CurvePath.prototype.createPointsGeometry=function(t){var e=this.getPoints(t,!0);return this.createGeometry(e)},e.CurvePath.prototype.createSpacedPointsGeometry=function(t){var e=this.getSpacedPoints(t,!0);return this.createGeometry(e)},e.CurvePath.prototype.createGeometry=function(t){for(var r=new e.Geometry,n=0;n<t.length;n++)r.vertices.push(new e.Vector3(t[n].x,t[n].y,t[n].z||0));return r},e.CurvePath.prototype.addWrapPath=function(t){this.bends.push(t)},e.CurvePath.prototype.getTransformedPoints=function(t,e){var r,n,i=this.getPoints(t);for(e||(e=this.bends),r=0,n=e.length;n>r;r++)i=this.getWrapPoints(i,e[r]);return i},e.CurvePath.prototype.getTransformedSpacedPoints=function(t,e){var r,n,i=this.getSpacedPoints(t);for(e||(e=this.bends),r=0,n=e.length;n>r;r++)i=this.getWrapPoints(i,e[r]);return i},e.CurvePath.prototype.getWrapPoints=function(t,e){var r,n,i,o,a,s,h=this.getBoundingBox();for(r=0,n=t.length;n>r;r++){i=t[r],o=i.x,a=i.y,s=o/h.maxX,s=e.getUtoTmapping(s,o);var u=e.getPoint(s),c=e.getTangent(s);c.set(-c.y,c.x).multiplyScalar(a),i.x=u.x+c.x,i.y=u.y+c.y}return t},e.Path=function(t){e.CurvePath.call(this),this.actions=[],t&&this.fromPoints(t)},e.Path.prototype=Object.create(e.CurvePath.prototype),e.Path.prototype.constructor=e.Path,e.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},e.Path.prototype.fromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,r=t.length;r>e;e++)this.lineTo(t[e].x,t[e].y)},e.Path.prototype.moveTo=function(t,r){var n=Array.prototype.slice.call(arguments);this.actions.push({action:e.PathActions.MOVE_TO,args:n})},e.Path.prototype.lineTo=function(t,r){var n=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,o=i[i.length-2],a=i[i.length-1],s=new e.LineCurve(new e.Vector2(o,a),new e.Vector2(t,r));this.curves.push(s),this.actions.push({action:e.PathActions.LINE_TO,args:n})},e.Path.prototype.quadraticCurveTo=function(t,r,n,i){var o=Array.prototype.slice.call(arguments),a=this.actions[this.actions.length-1].args,s=a[a.length-2],h=a[a.length-1],u=new e.QuadraticBezierCurve(new e.Vector2(s,h),new e.Vector2(t,r),new e.Vector2(n,i));
this.curves.push(u),this.actions.push({action:e.PathActions.QUADRATIC_CURVE_TO,args:o})},e.Path.prototype.bezierCurveTo=function(t,r,n,i,o,a){var s=Array.prototype.slice.call(arguments),h=this.actions[this.actions.length-1].args,u=h[h.length-2],c=h[h.length-1],l=new e.CubicBezierCurve(new e.Vector2(u,c),new e.Vector2(t,r),new e.Vector2(n,i),new e.Vector2(o,a));this.curves.push(l),this.actions.push({action:e.PathActions.BEZIER_CURVE_TO,args:s})},e.Path.prototype.splineThru=function(t){var r=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,i=n[n.length-2],o=n[n.length-1],a=[new e.Vector2(i,o)];Array.prototype.push.apply(a,t);var s=new e.SplineCurve(a);this.curves.push(s),this.actions.push({action:e.PathActions.CSPLINE_THRU,args:r})},e.Path.prototype.arc=function(t,e,r,n,i,o){var a=this.actions[this.actions.length-1].args,s=a[a.length-2],h=a[a.length-1];this.absarc(t+s,e+h,r,n,i,o)},e.Path.prototype.absarc=function(t,e,r,n,i,o){this.absellipse(t,e,r,r,n,i,o)},e.Path.prototype.ellipse=function(t,e,r,n,i,o,a,s){var h=this.actions[this.actions.length-1].args,u=h[h.length-2],c=h[h.length-1];this.absellipse(t+u,e+c,r,n,i,o,a,s)},e.Path.prototype.absellipse=function(t,r,n,i,o,a,s,h){var u=[t,r,n,i,o,a,s,h||0],c=new e.EllipseCurve(t,r,n,i,o,a,s,h);this.curves.push(c);var l=c.getPoint(1);u.push(l.x),u.push(l.y),this.actions.push({action:e.PathActions.ELLIPSE,args:u})},e.Path.prototype.getSpacedPoints=function(t,e){t||(t=40);for(var r=[],n=0;t>n;n++)r.push(this.getPoint(n/t));return r},e.Path.prototype.getPoints=function(t,r){if(this.useSpacedPoints)return this.getSpacedPoints(t,r);t=t||12;var n,i,o,a,s,h,u,c,l,p,f,d,m,g,y,v,_,x,b=[];for(n=0,i=this.actions.length;i>n;n++)switch(o=this.actions[n],a=o.action,s=o.args,a){case e.PathActions.MOVE_TO:b.push(new e.Vector2(s[0],s[1]));break;case e.PathActions.LINE_TO:b.push(new e.Vector2(s[0],s[1]));break;case e.PathActions.QUADRATIC_CURVE_TO:for(h=s[2],u=s[3],p=s[0],f=s[1],b.length>0?(g=b[b.length-1],d=g.x,m=g.y):(g=this.actions[n-1].args,d=g[g.length-2],m=g[g.length-1]),y=1;t>=y;y++)v=y/t,_=e.Shape.Utils.b2(v,d,p,h),x=e.Shape.Utils.b2(v,m,f,u),b.push(new e.Vector2(_,x));break;case e.PathActions.BEZIER_CURVE_TO:for(h=s[4],u=s[5],p=s[0],f=s[1],c=s[2],l=s[3],b.length>0?(g=b[b.length-1],d=g.x,m=g.y):(g=this.actions[n-1].args,d=g[g.length-2],m=g[g.length-1]),y=1;t>=y;y++)v=y/t,_=e.Shape.Utils.b3(v,d,p,c,h),x=e.Shape.Utils.b3(v,m,f,l,u),b.push(new e.Vector2(_,x));break;case e.PathActions.CSPLINE_THRU:g=this.actions[n-1].args;var w=new e.Vector2(g[g.length-2],g[g.length-1]),S=[w],M=t*s[0].length;S=S.concat(s[0]);var T=new e.SplineCurve(S);for(y=1;M>=y;y++)b.push(T.getPointAt(y/M));break;case e.PathActions.ARC:var E,C=s[0],A=s[1],R=s[2],P=s[3],L=s[4],O=!!s[5],D=L-P,k=2*t;for(y=1;k>=y;y++)v=y/k,O||(v=1-v),E=P+v*D,_=C+R*Math.cos(E),x=A+R*Math.sin(E),b.push(new e.Vector2(_,x));break;case e.PathActions.ELLIPSE:var E,F,N,C=s[0],A=s[1],I=s[2],U=s[3],P=s[4],L=s[5],O=!!s[6],B=s[7],D=L-P,k=2*t;for(0!==B&&(F=Math.cos(B),N=Math.sin(B)),y=1;k>=y;y++){if(v=y/k,O||(v=1-v),E=P+v*D,_=C+I*Math.cos(E),x=A+U*Math.sin(E),0!==B){var V=_,G=x;_=(V-C)*F-(G-A)*N+C,x=(V-C)*N+(G-A)*F+A}b.push(new e.Vector2(_,x))}}var z=b[b.length-1],H=1e-10;return Math.abs(z.x-b[0].x)<H&&Math.abs(z.y-b[0].y)<H&&b.splice(b.length-1,1),r&&b.push(b[0]),b},e.Path.prototype.toShapes=function(t,r){function n(t){var r,n,i,o,a,s=[],h=new e.Path;for(r=0,n=t.length;n>r;r++)i=t[r],a=i.args,o=i.action,o===e.PathActions.MOVE_TO&&0!==h.actions.length&&(s.push(h),h=new e.Path),h[o].apply(h,a);return 0!==h.actions.length&&s.push(h),s}function i(t){for(var r=[],n=0,i=t.length;i>n;n++){var o=t[n],a=new e.Shape;a.actions=o.actions,a.curves=o.curves,r.push(a)}return r}function o(t,e){for(var r=1e-10,n=e.length,i=!1,o=n-1,a=0;n>a;o=a++){var s=e[o],h=e[a],u=h.x-s.x,c=h.y-s.y;if(Math.abs(c)>r){if(0>c&&(s=e[a],u=-u,h=e[o],c=-c),t.y<s.y||t.y>h.y)continue;if(t.y===s.y){if(t.x===s.x)return!0}else{var l=c*(t.x-s.x)-u*(t.y-s.y);if(0===l)return!0;if(0>l)continue;i=!i}}else{if(t.y!==s.y)continue;if(h.x<=t.x&&t.x<=s.x||s.x<=t.x&&t.x<=h.x)return!0}}return i}var a=n(this.actions);if(0===a.length)return[];if(r===!0)return i(a);var s,h,u,c=[];if(1===a.length)return h=a[0],u=new e.Shape,u.actions=h.actions,u.curves=h.curves,c.push(u),c;var l=!e.Shape.Utils.isClockWise(a[0].getPoints());l=t?!l:l;var p,f=[],d=[],m=[],g=0;d[g]=void 0,m[g]=[];var y,v;for(y=0,v=a.length;v>y;y++)h=a[y],p=h.getPoints(),s=e.Shape.Utils.isClockWise(p),s=t?!s:s,s?(!l&&d[g]&&g++,d[g]={s:new e.Shape,p:p},d[g].s.actions=h.actions,d[g].s.curves=h.curves,l&&g++,m[g]=[]):m[g].push({h:h,p:p[0]});if(!d[0])return i(a);if(d.length>1){for(var _=!1,x=[],b=0,w=d.length;w>b;b++)f[b]=[];for(var b=0,w=d.length;w>b;b++)for(var S=m[b],M=0;M<S.length;M++){for(var T=S[M],E=!0,C=0;C<d.length;C++)o(T.p,d[C].p)&&(b!==C&&x.push({froms:b,tos:C,hole:M}),E?(E=!1,f[C].push(T)):_=!0);E&&f[b].push(T)}x.length>0&&(_||(m=f))}var A,R,P;for(y=0,v=d.length;v>y;y++)for(u=d[y].s,c.push(u),A=m[y],R=0,P=A.length;P>R;R++)u.holes.push(A[R].h);return c},e.Shape=function(){e.Path.apply(this,arguments),this.holes=[]},e.Shape.prototype=Object.create(e.Path.prototype),e.Shape.prototype.constructor=e.Shape,e.Shape.prototype.extrude=function(t){var r=new e.ExtrudeGeometry(this,t);return r},e.Shape.prototype.makeGeometry=function(t){var r=new e.ShapeGeometry(this,t);return r},e.Shape.prototype.getPointsHoles=function(t){var e,r=this.holes.length,n=[];for(e=0;r>e;e++)n[e]=this.holes[e].getTransformedPoints(t,this.bends);return n},e.Shape.prototype.getSpacedPointsHoles=function(t){var e,r=this.holes.length,n=[];for(e=0;r>e;e++)n[e]=this.holes[e].getTransformedSpacedPoints(t,this.bends);return n},e.Shape.prototype.extractAllPoints=function(t){return{shape:this.getTransformedPoints(t),holes:this.getPointsHoles(t)}},e.Shape.prototype.extractPoints=function(t){return this.useSpacedPoints?this.extractAllSpacedPoints(t):this.extractAllPoints(t)},e.Shape.prototype.extractAllSpacedPoints=function(t){return{shape:this.getTransformedSpacedPoints(t),holes:this.getSpacedPointsHoles(t)}},e.Shape.Utils={triangulateShape:function(t,r){function n(t,e,r){return t.x!==e.x?t.x<e.x?t.x<=r.x&&r.x<=e.x:e.x<=r.x&&r.x<=t.x:t.y<e.y?t.y<=r.y&&r.y<=e.y:e.y<=r.y&&r.y<=t.y}function i(t,e,r,i,o){var a=1e-10,s=e.x-t.x,h=e.y-t.y,u=i.x-r.x,c=i.y-r.y,l=t.x-r.x,p=t.y-r.y,f=h*u-s*c,d=h*l-s*p;if(Math.abs(f)>a){var m;if(f>0){if(0>d||d>f)return[];if(m=c*l-u*p,0>m||m>f)return[]}else{if(d>0||f>d)return[];if(m=c*l-u*p,m>0||f>m)return[]}if(0===m)return!o||0!==d&&d!==f?[t]:[];if(m===f)return!o||0!==d&&d!==f?[e]:[];if(0===d)return[r];if(d===f)return[i];var g=m/f;return[{x:t.x+g*s,y:t.y+g*h}]}if(0!==d||c*l!==u*p)return[];var y=0===s&&0===h,v=0===u&&0===c;if(y&&v)return t.x!==r.x||t.y!==r.y?[]:[t];if(y)return n(r,i,t)?[t]:[];if(v)return n(t,e,r)?[r]:[];var _,x,b,w,S,M,T,E;return 0!==s?(t.x<e.x?(_=t,b=t.x,x=e,w=e.x):(_=e,b=e.x,x=t,w=t.x),r.x<i.x?(S=r,T=r.x,M=i,E=i.x):(S=i,T=i.x,M=r,E=r.x)):(t.y<e.y?(_=t,b=t.y,x=e,w=e.y):(_=e,b=e.y,x=t,w=t.y),r.y<i.y?(S=r,T=r.y,M=i,E=i.y):(S=i,T=i.y,M=r,E=r.y)),T>=b?T>w?[]:w===T?o?[]:[S]:E>=w?[S,x]:[S,M]:b>E?[]:b===E?o?[]:[_]:E>=w?[_,x]:[_,M]}function o(t,e,r,n){var i=1e-10,o=e.x-t.x,a=e.y-t.y,s=r.x-t.x,h=r.y-t.y,u=n.x-t.x,c=n.y-t.y,l=o*h-a*s,p=o*c-a*u;if(Math.abs(l)>i){var f=u*h-c*s;return l>0?p>=0&&f>=0:p>=0||f>=0}return p>0}function a(t,e){function r(t,e){var r=v.length-1,n=t-1;0>n&&(n=r);var i=t+1;i>r&&(i=0);var a=o(v[t],v[n],v[i],s[e]);if(!a)return!1;var h=s.length-1,u=e-1;0>u&&(u=h);var c=e+1;return c>h&&(c=0),a=o(s[e],s[u],s[c],v[t]),a?!0:!1}function n(t,e){var r,n,o;for(r=0;r<v.length;r++)if(n=r+1,n%=v.length,o=i(t,e,v[r],v[n],!0),o.length>0)return!0;return!1}function a(t,r){var n,o,a,s,h;for(n=0;n<_.length;n++)for(o=e[_[n]],a=0;a<o.length;a++)if(s=a+1,s%=o.length,h=i(t,r,o[a],o[s],!0),h.length>0)return!0;return!1}for(var s,h,u,c,l,p,f,d,m,g,y,v=t.concat(),_=[],x=[],b=0,w=e.length;w>b;b++)_.push(b);for(var S=0,M=2*_.length;_.length>0;){if(M--,0>M){console.log("Infinite Loop! Holes left:"+_.length+", Probably Hole outside Shape!");break}for(u=S;u<v.length;u++){c=v[u],h=-1;for(var b=0;b<_.length;b++)if(p=_[b],f=c.x+":"+c.y+":"+p,void 0===x[f]){s=e[p];for(var T=0;T<s.length;T++)if(l=s[T],r(u,T)&&!n(c,l)&&!a(c,l)){h=T,_.splice(b,1),d=v.slice(0,u+1),m=v.slice(u),g=s.slice(h),y=s.slice(0,h+1),v=d.concat(g).concat(y).concat(m),S=u;break}if(h>=0)break;x[f]=!0}if(h>=0)break}}return v}for(var s,h,u,c,l,p,f={},d=t.concat(),m=0,g=r.length;g>m;m++)Array.prototype.push.apply(d,r[m]);for(s=0,h=d.length;h>s;s++)l=d[s].x+":"+d[s].y,void 0!==f[l]&&console.warn("THREE.Shape: Duplicate point",l),f[l]=s;var y=a(t,r),v=e.FontUtils.Triangulate(y,!1);for(s=0,h=v.length;h>s;s++)for(c=v[s],u=0;3>u;u++)l=c[u].x+":"+c[u].y,p=f[l],void 0!==p&&(c[u]=p);return v.concat()},isClockWise:function(t){return e.FontUtils.Triangulate.area(t)<0},b2p0:function(t,e){var r=1-t;return r*r*e},b2p1:function(t,e){return 2*(1-t)*t*e},b2p2:function(t,e){return t*t*e},b2:function(t,e,r,n){return this.b2p0(t,e)+this.b2p1(t,r)+this.b2p2(t,n)},b3p0:function(t,e){var r=1-t;return r*r*r*e},b3p1:function(t,e){var r=1-t;return 3*r*r*t*e},b3p2:function(t,e){var r=1-t;return 3*r*t*t*e},b3p3:function(t,e){return t*t*t*e},b3:function(t,e,r,n,i){return this.b3p0(t,e)+this.b3p1(t,r)+this.b3p2(t,n)+this.b3p3(t,i)}},e.LineCurve=function(t,e){this.v1=t,this.v2=e},e.LineCurve.prototype=Object.create(e.Curve.prototype),e.LineCurve.prototype.constructor=e.LineCurve,e.LineCurve.prototype.getPoint=function(t){var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},e.LineCurve.prototype.getPointAt=function(t){return this.getPoint(t)},e.LineCurve.prototype.getTangent=function(t){var e=this.v2.clone().sub(this.v1);return e.normalize()},e.QuadraticBezierCurve=function(t,e,r){this.v0=t,this.v1=e,this.v2=r},e.QuadraticBezierCurve.prototype=Object.create(e.Curve.prototype),e.QuadraticBezierCurve.prototype.constructor=e.QuadraticBezierCurve,e.QuadraticBezierCurve.prototype.getPoint=function(t){var r=new e.Vector2;return r.x=e.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x),r.y=e.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y),r},e.QuadraticBezierCurve.prototype.getTangent=function(t){var r=new e.Vector2;return r.x=e.Curve.Utils.tangentQuadraticBezier(t,this.v0.x,this.v1.x,this.v2.x),r.y=e.Curve.Utils.tangentQuadraticBezier(t,this.v0.y,this.v1.y,this.v2.y),r.normalize()},e.CubicBezierCurve=function(t,e,r,n){this.v0=t,this.v1=e,this.v2=r,this.v3=n},e.CubicBezierCurve.prototype=Object.create(e.Curve.prototype),e.CubicBezierCurve.prototype.constructor=e.CubicBezierCurve,e.CubicBezierCurve.prototype.getPoint=function(t){var r,n;return r=e.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=e.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new e.Vector2(r,n)},e.CubicBezierCurve.prototype.getTangent=function(t){var r,n;r=e.Curve.Utils.tangentCubicBezier(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=e.Curve.Utils.tangentCubicBezier(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var i=new e.Vector2(r,n);return i.normalize(),i},e.SplineCurve=function(t){this.points=void 0==t?[]:t},e.SplineCurve.prototype=Object.create(e.Curve.prototype),e.SplineCurve.prototype.constructor=e.SplineCurve,e.SplineCurve.prototype.getPoint=function(t){var r=this.points,n=(r.length-1)*t,i=Math.floor(n),o=n-i,a=r[0===i?i:i-1],s=r[i],h=r[i>r.length-2?r.length-1:i+1],u=r[i>r.length-3?r.length-1:i+2],c=new e.Vector2;return c.x=e.Curve.Utils.interpolate(a.x,s.x,h.x,u.x,o),c.y=e.Curve.Utils.interpolate(a.y,s.y,h.y,u.y,o),c},e.EllipseCurve=function(t,e,r,n,i,o,a,s){this.aX=t,this.aY=e,this.xRadius=r,this.yRadius=n,this.aStartAngle=i,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s||0},e.EllipseCurve.prototype=Object.create(e.Curve.prototype),e.EllipseCurve.prototype.constructor=e.EllipseCurve,e.EllipseCurve.prototype.getPoint=function(t){var r=this.aEndAngle-this.aStartAngle;0>r&&(r+=2*Math.PI),r>2*Math.PI&&(r-=2*Math.PI);var n;n=this.aClockwise===!0?this.aEndAngle+(1-t)*(2*Math.PI-r):this.aStartAngle+t*r;var i=this.aX+this.xRadius*Math.cos(n),o=this.aY+this.yRadius*Math.sin(n);if(0!==this.aRotation){var a=Math.cos(this.aRotation),s=Math.sin(this.aRotation),h=i,u=o;i=(h-this.aX)*a-(u-this.aY)*s+this.aX,o=(h-this.aX)*s+(u-this.aY)*a+this.aY}return new e.Vector2(i,o)},e.ArcCurve=function(t,r,n,i,o,a){e.EllipseCurve.call(this,t,r,n,n,i,o,a)},e.ArcCurve.prototype=Object.create(e.EllipseCurve.prototype),e.ArcCurve.prototype.constructor=e.ArcCurve,e.LineCurve3=e.Curve.create(function(t,e){this.v1=t,this.v2=e},function(t){var r=new e.Vector3;return r.subVectors(this.v2,this.v1),r.multiplyScalar(t),r.add(this.v1),r}),e.QuadraticBezierCurve3=e.Curve.create(function(t,e,r){this.v0=t,this.v1=e,this.v2=r},function(t){var r=new e.Vector3;return r.x=e.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x),r.y=e.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y),r.z=e.Shape.Utils.b2(t,this.v0.z,this.v1.z,this.v2.z),r}),e.CubicBezierCurve3=e.Curve.create(function(t,e,r,n){this.v0=t,this.v1=e,this.v2=r,this.v3=n},function(t){var r=new e.Vector3;return r.x=e.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),r.y=e.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),r.z=e.Shape.Utils.b3(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z),r}),e.SplineCurve3=e.Curve.create(function(t){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=void 0==t?[]:t},function(t){var r=this.points,n=(r.length-1)*t,i=Math.floor(n),o=n-i,a=r[0==i?i:i-1],s=r[i],h=r[i>r.length-2?r.length-1:i+1],u=r[i>r.length-3?r.length-1:i+2],c=new e.Vector3;return c.x=e.Curve.Utils.interpolate(a.x,s.x,h.x,u.x,o),c.y=e.Curve.Utils.interpolate(a.y,s.y,h.y,u.y,o),c.z=e.Curve.Utils.interpolate(a.z,s.z,h.z,u.z,o),c}),e.CatmullRomCurve3=function(){function t(){}var r=new e.Vector3,n=new t,i=new t,o=new t;return t.prototype.init=function(t,e,r,n){this.c0=t,this.c1=r,this.c2=-3*t+3*e-2*r-n,this.c3=2*t-2*e+r+n},t.prototype.initNonuniformCatmullRom=function(t,e,r,n,i,o,a){var s=(e-t)/i-(r-t)/(i+o)+(r-e)/o,h=(r-e)/o-(n-e)/(o+a)+(n-r)/a;s*=o,h*=o,this.init(e,r,s,h)},t.prototype.initCatmullRom=function(t,e,r,n,i){this.init(e,r,i*(r-t),i*(n-e))},t.prototype.calc=function(t){var e=t*t,r=e*t;return this.c0+this.c1*t+this.c2*e+this.c3*r},e.Curve.create(function(t){this.points=t||[]},function(t){var a,s,h,u,c=this.points;u=c.length,2>u&&console.log("duh, you need at least 2 points"),a=(u-1)*t,s=Math.floor(a),h=a-s,0===h&&s===u-1&&(s=u-2,h=1);var l,p,f,d;if(0===s?(r.subVectors(c[0],c[1]).add(c[0]),l=r):l=c[s-1],p=c[s],f=c[s+1],u>s+2?d=c[s+2]:(r.subVectors(c[u-1],c[u-2]).add(c[u-2]),d=r),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var m="chordal"===this.type?.5:.25,g=Math.pow(l.distanceToSquared(p),m),y=Math.pow(p.distanceToSquared(f),m),v=Math.pow(f.distanceToSquared(d),m);1e-4>y&&(y=1),1e-4>g&&(g=y),1e-4>v&&(v=y),n.initNonuniformCatmullRom(l.x,p.x,f.x,d.x,g,y,v),i.initNonuniformCatmullRom(l.y,p.y,f.y,d.y,g,y,v),o.initNonuniformCatmullRom(l.z,p.z,f.z,d.z,g,y,v)}else if("catmullrom"===this.type){var _=void 0!==this.tension?this.tension:.5;n.initCatmullRom(l.x,p.x,f.x,d.x,_),i.initCatmullRom(l.y,p.y,f.y,d.y,_),o.initCatmullRom(l.z,p.z,f.z,d.z,_)}var x=new e.Vector3(n.calc(h),i.calc(h),o.calc(h));return x})}(),e.ClosedSplineCurve3=e.Curve.create(function(t){this.points=void 0==t?[]:t},function(t){var r=this.points,n=(r.length-0)*t,i=Math.floor(n),o=n-i;i+=i>0?0:(Math.floor(Math.abs(i)/r.length)+1)*r.length;var a=r[(i-1)%r.length],s=r[i%r.length],h=r[(i+1)%r.length],u=r[(i+2)%r.length],c=new e.Vector3;return c.x=e.Curve.Utils.interpolate(a.x,s.x,h.x,u.x,o),c.y=e.Curve.Utils.interpolate(a.y,s.y,h.y,u.y,o),c.z=e.Curve.Utils.interpolate(a.z,s.z,h.z,u.z,o),c}),e.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){console.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){console.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){console.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(t){if(t.initialized===!0)return t;for(var r=0;r<t.hierarchy.length;r++){for(var n=0;n<t.hierarchy[r].keys.length;n++)if(t.hierarchy[r].keys[n].time<0&&(t.hierarchy[r].keys[n].time=0),void 0!==t.hierarchy[r].keys[n].rot&&!(t.hierarchy[r].keys[n].rot instanceof e.Quaternion)){var i=t.hierarchy[r].keys[n].rot;t.hierarchy[r].keys[n].rot=(new e.Quaternion).fromArray(i)}if(t.hierarchy[r].keys.length&&void 0!==t.hierarchy[r].keys[0].morphTargets){for(var o={},n=0;n<t.hierarchy[r].keys.length;n++)for(var a=0;a<t.hierarchy[r].keys[n].morphTargets.length;a++){var s=t.hierarchy[r].keys[n].morphTargets[a];o[s]=-1}t.hierarchy[r].usedMorphTargets=o;for(var n=0;n<t.hierarchy[r].keys.length;n++){var h={};for(var s in o){for(var a=0;a<t.hierarchy[r].keys[n].morphTargets.length;a++)if(t.hierarchy[r].keys[n].morphTargets[a]===s){h[s]=t.hierarchy[r].keys[n].morphTargetsInfluences[a];break}a===t.hierarchy[r].keys[n].morphTargets.length&&(h[s]=0)}t.hierarchy[r].keys[n].morphTargetsInfluences=h}}for(var n=1;n<t.hierarchy[r].keys.length;n++)t.hierarchy[r].keys[n].time===t.hierarchy[r].keys[n-1].time&&(t.hierarchy[r].keys.splice(n,1),n--);for(var n=0;n<t.hierarchy[r].keys.length;n++)t.hierarchy[r].keys[n].index=n}return t.initialized=!0,t},parse:function(t){var r=function(t,e){e.push(t);for(var n=0;n<t.children.length;n++)r(t.children[n],e)},n=[];if(t instanceof e.SkinnedMesh)for(var i=0;i<t.skeleton.bones.length;i++)n.push(t.skeleton.bones[i]);else r(t,n);return n},play:function(t){-1===this.animations.indexOf(t)&&this.animations.push(t)},stop:function(t){var e=this.animations.indexOf(t);-1!==e&&this.animations.splice(e,1)},update:function(t){for(var e=0;e<this.animations.length;e++)this.animations[e].resetBlendWeights();for(var e=0;e<this.animations.length;e++)this.animations[e].update(t)}},e.Animation=function(t,r){this.root=t,this.data=e.AnimationHandler.init(r),this.hierarchy=e.AnimationHandler.parse(t),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.loop=!0,this.weight=0,this.interpolationType=e.AnimationHandler.LINEAR},e.Animation.prototype={constructor:e.Animation,keyTypes:["pos","rot","scl"],play:function(t,r){this.currentTime=void 0!==t?t:0,this.weight=void 0!==r?r:1,this.isPlaying=!0,this.reset(),e.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,e.AnimationHandler.stop(this)},reset:function(){for(var t=0,e=this.hierarchy.length;e>t;t++){var r=this.hierarchy[t];void 0===r.animationCache&&(r.animationCache={animations:{},blending:{positionWeight:0,quaternionWeight:0,scaleWeight:0}});var n=this.data.name,i=r.animationCache.animations,o=i[n];void 0===o&&(o={prevKey:{pos:0,rot:0,scl:0},nextKey:{pos:0,rot:0,scl:0},originalMatrix:r.matrix},i[n]=o);for(var a=0;3>a;a++){for(var s=this.keyTypes[a],h=this.data.hierarchy[t].keys[0],u=this.getNextKeyWith(s,t,1);u.time<this.currentTime&&u.index>h.index;)h=u,u=this.getNextKeyWith(s,t,u.index+1);o.prevKey[s]=h,o.nextKey[s]=u}}},resetBlendWeights:function(){for(var t=0,e=this.hierarchy.length;e>t;t++){var r=this.hierarchy[t],n=r.animationCache;if(void 0!==n){var i=n.blending;i.positionWeight=0,i.quaternionWeight=0,i.scaleWeight=0}}},update:function(){var t=[],r=new e.Vector3,n=new e.Vector3,i=new e.Quaternion,o=function(t,e){var r,n,i,o,s,h,u,c,l,p=[],f=[];return r=(t.length-1)*e,n=Math.floor(r),i=r-n,p[0]=0===n?n:n-1,p[1]=n,p[2]=n>t.length-2?n:n+1,p[3]=n>t.length-3?n:n+2,h=t[p[0]],u=t[p[1]],c=t[p[2]],l=t[p[3]],o=i*i,s=i*o,f[0]=a(h[0],u[0],c[0],l[0],i,o,s),f[1]=a(h[1],u[1],c[1],l[1],i,o,s),f[2]=a(h[2],u[2],c[2],l[2],i,o,s),f},a=function(t,e,r,n,i,o,a){var s=.5*(r-t),h=.5*(n-e);return(2*(e-r)+s+h)*a+(-3*(e-r)-2*s-h)*o+s*i+e};return function(a){if(this.isPlaying!==!1&&(this.currentTime+=a*this.timeScale,0!==this.weight)){var s=this.data.length;(this.currentTime>s||this.currentTime<0)&&(this.loop?(this.currentTime%=s,this.currentTime<0&&(this.currentTime+=s),this.reset()):this.stop());for(var h=0,u=this.hierarchy.length;u>h;h++)for(var c=this.hierarchy[h],l=c.animationCache.animations[this.data.name],p=c.animationCache.blending,f=0;3>f;f++){var d=this.keyTypes[f],m=l.prevKey[d],g=l.nextKey[d];if(this.timeScale>0&&g.time<=this.currentTime||this.timeScale<0&&m.time>=this.currentTime){for(m=this.data.hierarchy[h].keys[0],g=this.getNextKeyWith(d,h,1);g.time<this.currentTime&&g.index>m.index;)m=g,g=this.getNextKeyWith(d,h,g.index+1);l.prevKey[d]=m,l.nextKey[d]=g}var y=(this.currentTime-m.time)/(g.time-m.time),v=m[d],_=g[d];if(0>y&&(y=0),y>1&&(y=1),"pos"===d){if(this.interpolationType===e.AnimationHandler.LINEAR){n.x=v[0]+(_[0]-v[0])*y,n.y=v[1]+(_[1]-v[1])*y,n.z=v[2]+(_[2]-v[2])*y;var x=this.weight/(this.weight+p.positionWeight);c.position.lerp(n,x),p.positionWeight+=this.weight}else if(this.interpolationType===e.AnimationHandler.CATMULLROM||this.interpolationType===e.AnimationHandler.CATMULLROM_FORWARD){t[0]=this.getPrevKeyWith("pos",h,m.index-1).pos,t[1]=v,t[2]=_,t[3]=this.getNextKeyWith("pos",h,g.index+1).pos,y=.33*y+.33;var b=o(t,y),x=this.weight/(this.weight+p.positionWeight);p.positionWeight+=this.weight;var w=c.position;if(w.x=w.x+(b[0]-w.x)*x,w.y=w.y+(b[1]-w.y)*x,w.z=w.z+(b[2]-w.z)*x,this.interpolationType===e.AnimationHandler.CATMULLROM_FORWARD){var S=o(t,1.01*y);r.set(S[0],S[1],S[2]),r.sub(w),r.y=0,r.normalize();var M=Math.atan2(r.x,r.z);c.rotation.set(0,M,0)}}}else if("rot"===d)if(e.Quaternion.slerp(v,_,i,y),0===p.quaternionWeight)c.quaternion.copy(i),p.quaternionWeight=this.weight;else{var x=this.weight/(this.weight+p.quaternionWeight);e.Quaternion.slerp(c.quaternion,i,c.quaternion,x),p.quaternionWeight+=this.weight}else if("scl"===d){n.x=v[0]+(_[0]-v[0])*y,n.y=v[1]+(_[1]-v[1])*y,n.z=v[2]+(_[2]-v[2])*y;var x=this.weight/(this.weight+p.scaleWeight);c.scale.lerp(n,x),p.scaleWeight+=this.weight}}return!0}}}(),getNextKeyWith:function(t,r,n){var i=this.data.hierarchy[r].keys;for(this.interpolationType===e.AnimationHandler.CATMULLROM||this.interpolationType===e.AnimationHandler.CATMULLROM_FORWARD?n=n<i.length-1?n:i.length-1:n%=i.length;n<i.length;n++)if(void 0!==i[n][t])return i[n];return this.data.hierarchy[r].keys[0]},getPrevKeyWith:function(t,r,n){var i=this.data.hierarchy[r].keys;for(n=this.interpolationType===e.AnimationHandler.CATMULLROM||this.interpolationType===e.AnimationHandler.CATMULLROM_FORWARD?n>0?n:0:n>=0?n:n+i.length;n>=0;n--)if(void 0!==i[n][t])return i[n];return this.data.hierarchy[r].keys[i.length-1]}},e.KeyFrameAnimation=function(t){this.root=t.node,this.data=e.AnimationHandler.init(t),this.hierarchy=e.AnimationHandler.parse(this.root),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.isPaused=!0,this.loop=!0;for(var r=0,n=this.hierarchy.length;n>r;r++){var i=this.data.hierarchy[r].keys,o=this.data.hierarchy[r].sids,a=this.hierarchy[r];if(i.length&&o){for(var s=0;s<o.length;s++){var h=o[s],u=this.getNextKeyWith(h,r,0);u&&u.apply(h)}a.matrixAutoUpdate=!1,this.data.hierarchy[r].node.updateMatrix(),a.matrixWorldNeedsUpdate=!0}}},e.KeyFrameAnimation.prototype={constructor:e.KeyFrameAnimation,play:function(t){if(this.currentTime=void 0!==t?t:0,this.isPlaying===!1){this.isPlaying=!0;var r,n,i,o=this.hierarchy.length;for(r=0;o>r;r++){n=this.hierarchy[r],i=this.data.hierarchy[r],void 0===i.animationCache&&(i.animationCache={},i.animationCache.prevKey=null,i.animationCache.nextKey=null,i.animationCache.originalMatrix=n.matrix);var a=this.data.hierarchy[r].keys;a.length&&(i.animationCache.prevKey=a[0],i.animationCache.nextKey=a[1],this.startTime=Math.min(a[0].time,this.startTime),this.endTime=Math.max(a[a.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1,e.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,this.isPaused=!1,e.AnimationHandler.stop(this);for(var t=0;t<this.data.hierarchy.length;t++){var r=this.hierarchy[t],n=this.data.hierarchy[t];if(void 0!==n.animationCache){var i=n.animationCache.originalMatrix;i.copy(r.matrix),r.matrix=i,delete n.animationCache}}},update:function(t){if(this.isPlaying!==!1){this.currentTime+=t*this.timeScale;var e=this.data.length;this.loop===!0&&this.currentTime>e&&(this.currentTime%=e),this.currentTime=Math.min(this.currentTime,e);for(var r=0,n=this.hierarchy.length;n>r;r++){var i=this.hierarchy[r],o=this.data.hierarchy[r],a=o.keys,s=o.animationCache;if(a.length){var h=s.prevKey,u=s.nextKey;if(u.time<=this.currentTime){for(;u.time<this.currentTime&&u.index>h.index;)h=u,u=a[h.index+1];s.prevKey=h,s.nextKey=u}u.time>=this.currentTime?h.interpolate(u,this.currentTime):h.interpolate(u,u.time),this.data.hierarchy[r].node.updateMatrix(),i.matrixWorldNeedsUpdate=!0}}}},getNextKeyWith:function(t,e,r){var n=this.data.hierarchy[e].keys;for(r%=n.length;r<n.length;r++)if(n[r].hasTarget(t))return n[r];return n[0]},getPrevKeyWith:function(t,e,r){var n=this.data.hierarchy[e].keys;for(r=r>=0?r:r+n.length;r>=0;r--)if(n[r].hasTarget(t))return n[r];return n[n.length-1]}},e.MorphAnimation=function(t){this.mesh=t,this.frames=t.morphTargetInfluences.length,this.currentTime=0,this.duration=1e3,this.loop=!0,this.lastFrame=0,this.currentFrame=0,this.isPlaying=!1},e.MorphAnimation.prototype={constructor:e.MorphAnimation,play:function(){this.isPlaying=!0},pause:function(){this.isPlaying=!1},update:function(t){if(this.isPlaying!==!1){this.currentTime+=t,this.loop===!0&&this.currentTime>this.duration&&(this.currentTime%=this.duration),this.currentTime=Math.min(this.currentTime,this.duration);var e=this.duration/this.frames,r=Math.floor(this.currentTime/e),n=this.mesh.morphTargetInfluences;r!==this.currentFrame&&(n[this.lastFrame]=0,n[this.currentFrame]=1,n[r]=0,this.lastFrame=this.currentFrame,this.currentFrame=r);var i=this.currentTime%e/e;n[r]=i,n[this.lastFrame]=1-i}}},e.BoxGeometry=function(t,r,n,i,o,a){function s(t,r,n,i,o,a,s,u){var c,l,p,f=h.widthSegments,d=h.heightSegments,m=o/2,g=a/2,y=h.vertices.length;"x"===t&&"y"===r||"y"===t&&"x"===r?c="z":"x"===t&&"z"===r||"z"===t&&"x"===r?(c="y",d=h.depthSegments):("z"===t&&"y"===r||"y"===t&&"z"===r)&&(c="x",f=h.depthSegments);var v=f+1,_=d+1,x=o/f,b=a/d,w=new e.Vector3;for(w[c]=s>0?1:-1,p=0;_>p;p++)for(l=0;v>l;l++){var S=new e.Vector3;S[t]=(l*x-m)*n,S[r]=(p*b-g)*i,S[c]=s,h.vertices.push(S)}for(p=0;d>p;p++)for(l=0;f>l;l++){var M=l+v*p,T=l+v*(p+1),E=l+1+v*(p+1),C=l+1+v*p,A=new e.Vector2(l/f,1-p/d),R=new e.Vector2(l/f,1-(p+1)/d),P=new e.Vector2((l+1)/f,1-(p+1)/d),L=new e.Vector2((l+1)/f,1-p/d),O=new e.Face3(M+y,T+y,C+y);O.normal.copy(w),O.vertexNormals.push(w.clone(),w.clone(),w.clone()),O.materialIndex=u,h.faces.push(O),h.faceVertexUvs[0].push([A,R,L]),O=new e.Face3(T+y,E+y,C+y),O.normal.copy(w),O.vertexNormals.push(w.clone(),w.clone(),w.clone()),O.materialIndex=u,h.faces.push(O),h.faceVertexUvs[0].push([R.clone(),P,L.clone()])}}e.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:t,height:r,depth:n,widthSegments:i,heightSegments:o,depthSegments:a},this.widthSegments=i||1,this.heightSegments=o||1,this.depthSegments=a||1;var h=this,u=t/2,c=r/2,l=n/2;s("z","y",-1,-1,n,r,u,0),s("z","y",1,-1,n,r,-u,1),s("x","z",1,1,t,n,c,2),s("x","z",1,-1,t,n,-c,3),s("x","y",1,-1,t,r,l,4),s("x","y",-1,-1,t,r,-l,5),this.mergeVertices()},e.BoxGeometry.prototype=Object.create(e.Geometry.prototype),e.BoxGeometry.prototype.constructor=e.BoxGeometry,e.BoxGeometry.prototype.clone=function(){var t=new e.BoxGeometry(this.parameters.width,this.parameters.height,this.parameters.depth,this.parameters.widthSegments,this.parameters.heightSegments,this.parameters.depthSegments);return t},e.CubeGeometry=e.BoxGeometry,e.CircleGeometry=function(t,r,n,i){e.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:r,thetaStart:n,thetaLength:i},t=t||50,r=void 0!==r?Math.max(3,r):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var o,a=[],s=new e.Vector3,h=new e.Vector2(.5,.5);for(this.vertices.push(s),a.push(h),o=0;r>=o;o++){var u=new e.Vector3,c=n+o/r*i;u.x=t*Math.cos(c),u.y=t*Math.sin(c),this.vertices.push(u),a.push(new e.Vector2((u.x/t+1)/2,(u.y/t+1)/2))}var l=new e.Vector3(0,0,1);for(o=1;r>=o;o++)this.faces.push(new e.Face3(o,o+1,0,[l.clone(),l.clone(),l.clone()])),this.faceVertexUvs[0].push([a[o].clone(),a[o+1].clone(),h.clone()]);this.computeFaceNormals(),this.boundingSphere=new e.Sphere(new e.Vector3,t)},e.CircleGeometry.prototype=Object.create(e.Geometry.prototype),e.CircleGeometry.prototype.constructor=e.CircleGeometry,e.CircleGeometry.prototype.clone=function(){var t=new e.CircleGeometry(this.parameters.radius,this.parameters.segments,this.parameters.thetaStart,this.parameters.thetaLength);return t},e.CircleBufferGeometry=function(t,r,n,i){e.BufferGeometry.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:r,thetaStart:n,thetaLength:i},t=t||50,r=void 0!==r?Math.max(3,r):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var o=r+2,a=new Float32Array(3*o),s=new Float32Array(3*o),h=new Float32Array(2*o);s[3]=1,h[0]=.5,h[1]=.5;for(var u=0,c=3,l=2;r>=u;u++,c+=3,l+=2){var p=n+u/r*i;a[c]=t*Math.cos(p),a[c+1]=t*Math.sin(p),s[c+2]=1,h[l]=(a[c]/t+1)/2,h[l+1]=(a[c+1]/t+1)/2}for(var f=[],c=1;r>=c;c++)f.push(c),f.push(c+1),f.push(0);this.setIndex(new e.BufferAttribute(new Uint16Array(f),1)),this.addAttribute("position",new e.BufferAttribute(a,3)),this.addAttribute("normal",new e.BufferAttribute(s,3)),this.addAttribute("uv",new e.BufferAttribute(h,2)),this.boundingSphere=new e.Sphere(new e.Vector3,t)},e.CircleBufferGeometry.prototype=Object.create(e.BufferGeometry.prototype),e.CircleBufferGeometry.prototype.constructor=e.CircleBufferGeometry,e.CircleBufferGeometry.prototype.clone=function(){var t=new e.CircleBufferGeometry(this.parameters.radius,this.parameters.segments,this.parameters.thetaStart,this.parameters.thetaLength);return t.copy(this),t},e.CylinderGeometry=function(t,r,n,i,o,a,s,h){e.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:r,height:n,radialSegments:i,heightSegments:o,openEnded:a,thetaStart:s,thetaLength:h},t=void 0!==t?t:20,r=void 0!==r?r:20,n=void 0!==n?n:100,i=i||8,o=o||1,a=void 0!==a?a:!1,s=void 0!==s?s:0,h=void 0!==h?h:2*Math.PI;var u,c,l=n/2,p=[],f=[];for(c=0;o>=c;c++){var d=[],m=[],g=c/o,y=g*(r-t)+t;for(u=0;i>=u;u++){var v=u/i,_=new e.Vector3;_.x=y*Math.sin(v*h+s),_.y=-g*n+l,_.z=y*Math.cos(v*h+s),this.vertices.push(_),d.push(this.vertices.length-1),m.push(new e.Vector2(v,1-g))}p.push(d),f.push(m)}var x,b,w=(r-t)/n;for(u=0;i>u;u++)for(0!==t?(x=this.vertices[p[0][u]].clone(),b=this.vertices[p[0][u+1]].clone()):(x=this.vertices[p[1][u]].clone(),b=this.vertices[p[1][u+1]].clone()),x.setY(Math.sqrt(x.x*x.x+x.z*x.z)*w).normalize(),b.setY(Math.sqrt(b.x*b.x+b.z*b.z)*w).normalize(),c=0;o>c;c++){var S=p[c][u],M=p[c+1][u],T=p[c+1][u+1],E=p[c][u+1],C=x.clone(),A=x.clone(),R=b.clone(),P=b.clone(),L=f[c][u].clone(),O=f[c+1][u].clone(),D=f[c+1][u+1].clone(),k=f[c][u+1].clone();this.faces.push(new e.Face3(S,M,E,[C,A,P])),this.faceVertexUvs[0].push([L,O,k]),this.faces.push(new e.Face3(M,T,E,[A.clone(),R,P.clone()])),this.faceVertexUvs[0].push([O.clone(),D,k.clone()])}if(a===!1&&t>0)for(this.vertices.push(new e.Vector3(0,l,0)),u=0;i>u;u++){var S=p[0][u],M=p[0][u+1],T=this.vertices.length-1,C=new e.Vector3(0,1,0),A=new e.Vector3(0,1,0),R=new e.Vector3(0,1,0),L=f[0][u].clone(),O=f[0][u+1].clone(),D=new e.Vector2(O.x,0);this.faces.push(new e.Face3(S,M,T,[C,A,R],void 0,1)),this.faceVertexUvs[0].push([L,O,D])}if(a===!1&&r>0)for(this.vertices.push(new e.Vector3(0,-l,0)),u=0;i>u;u++){var S=p[o][u+1],M=p[o][u],T=this.vertices.length-1,C=new e.Vector3(0,-1,0),A=new e.Vector3(0,-1,0),R=new e.Vector3(0,-1,0),L=f[o][u+1].clone(),O=f[o][u].clone(),D=new e.Vector2(O.x,1);this.faces.push(new e.Face3(S,M,T,[C,A,R],void 0,2)),this.faceVertexUvs[0].push([L,O,D])}this.computeFaceNormals()},e.CylinderGeometry.prototype=Object.create(e.Geometry.prototype),e.CylinderGeometry.prototype.constructor=e.CylinderGeometry,e.CylinderGeometry.prototype.clone=function(){var t=new e.CylinderGeometry(this.parameters.radiusTop,this.parameters.radiusBottom,this.parameters.height,this.parameters.radialSegments,this.parameters.heightSegments,this.parameters.openEnded,this.parameters.thetaStart,this.parameters.thetaLength);
return t},e.EdgesGeometry=function(t,r){e.BufferGeometry.call(this),r=void 0!==r?r:1;var n,i=Math.cos(e.Math.degToRad(r)),o=[0,0],a={},s=function(t,e){return t-e},h=["a","b","c"];t instanceof e.BufferGeometry?(n=new e.Geometry,n.fromBufferGeometry(t)):n=t.clone(),n.mergeVertices(),n.computeFaceNormals();for(var u=n.vertices,c=n.faces,l=0,p=c.length;p>l;l++)for(var f=c[l],d=0;3>d;d++){o[0]=f[h[d]],o[1]=f[h[(d+1)%3]],o.sort(s);var m=o.toString();void 0===a[m]?a[m]={vert1:o[0],vert2:o[1],face1:l,face2:void 0}:a[m].face2=l}var g=[];for(var m in a){var y=a[m];if(void 0===y.face2||c[y.face1].normal.dot(c[y.face2].normal)<=i){var v=u[y.vert1];g.push(v.x),g.push(v.y),g.push(v.z),v=u[y.vert2],g.push(v.x),g.push(v.y),g.push(v.z)}}this.addAttribute("position",new e.BufferAttribute(new Float32Array(g),3))},e.EdgesGeometry.prototype=Object.create(e.BufferGeometry.prototype),e.EdgesGeometry.prototype.constructor=e.EdgesGeometry,e.ExtrudeGeometry=function(t,r){return"undefined"==typeof t?void(t=[]):(e.Geometry.call(this),this.type="ExtrudeGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,r),void this.computeFaceNormals())},e.ExtrudeGeometry.prototype=Object.create(e.Geometry.prototype),e.ExtrudeGeometry.prototype.constructor=e.ExtrudeGeometry,e.ExtrudeGeometry.prototype.addShapeList=function(t,e){for(var r=t.length,n=0;r>n;n++){var i=t[n];this.addShape(i,e)}},e.ExtrudeGeometry.prototype.addShape=function(t,r){function n(t,e,r){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(r).add(t)}function i(t,r,n){var i,o,a=1e-10,s=1,h=t.x-r.x,u=t.y-r.y,c=n.x-t.x,l=n.y-t.y,p=h*h+u*u,f=h*l-u*c;if(Math.abs(f)>a){var d=Math.sqrt(p),m=Math.sqrt(c*c+l*l),g=r.x-u/d,y=r.y+h/d,v=n.x-l/m,_=n.y+c/m,x=((v-g)*l-(_-y)*c)/(h*l-u*c);i=g+h*x-t.x,o=y+u*x-t.y;var b=i*i+o*o;if(2>=b)return new e.Vector2(i,o);s=Math.sqrt(b/2)}else{var w=!1;h>a?c>a&&(w=!0):-a>h?-a>c&&(w=!0):Math.sign(u)===Math.sign(l)&&(w=!0),w?(i=-u,o=h,s=Math.sqrt(p)):(i=h,o=u,s=Math.sqrt(p/2))}return new e.Vector2(i/s,o/s)}function o(){if(x){var t=0,e=H*t;for(X=0;j>X;X++)z=F[X],u(z[2]+e,z[1]+e,z[0]+e);for(t=w+2*_,e=H*t,X=0;j>X;X++)z=F[X],u(z[0]+e,z[1]+e,z[2]+e)}else{for(X=0;j>X;X++)z=F[X],u(z[2],z[1],z[0]);for(X=0;j>X;X++)z=F[X],u(z[0]+H*w,z[1]+H*w,z[2]+H*w)}}function a(){var t=0;for(s(N,t),t+=N.length,C=0,A=D.length;A>C;C++)E=D[C],s(E,t),t+=E.length}function s(t,e){var r,n;for(X=t.length;--X>=0;){r=X,n=X-1,0>n&&(n=t.length-1);var i=0,o=w+2*_;for(i=0;o>i;i++){var a=H*i,s=H*(i+1),h=e+r+a,u=e+n+a,l=e+n+s,p=e+r+s;c(h,u,l,p,t,i,o,r,n)}}}function h(t,r,n){R.vertices.push(new e.Vector3(t,r,n))}function u(t,r,n){t+=P,r+=P,n+=P,R.faces.push(new e.Face3(t,r,n));var i=T.generateTopUV(R,t,r,n);R.faceVertexUvs[0].push(i)}function c(t,r,n,i,o,a,s,h,u){t+=P,r+=P,n+=P,i+=P,R.faces.push(new e.Face3(t,r,i)),R.faces.push(new e.Face3(r,n,i));var c=T.generateSideWallUV(R,t,r,n,i);R.faceVertexUvs[0].push([c[0],c[1],c[3]]),R.faceVertexUvs[0].push([c[1],c[2],c[3]])}var l,p,f,d,m,g=void 0!==r.amount?r.amount:100,y=void 0!==r.bevelThickness?r.bevelThickness:6,v=void 0!==r.bevelSize?r.bevelSize:y-2,_=void 0!==r.bevelSegments?r.bevelSegments:3,x=void 0!==r.bevelEnabled?r.bevelEnabled:!0,b=void 0!==r.curveSegments?r.curveSegments:12,w=void 0!==r.steps?r.steps:1,S=r.extrudePath,M=!1,T=void 0!==r.UVGenerator?r.UVGenerator:e.ExtrudeGeometry.WorldUVGenerator;S&&(l=S.getSpacedPoints(w),M=!0,x=!1,p=void 0!==r.frames?r.frames:new e.TubeGeometry.FrenetFrames(S,w,!1),f=new e.Vector3,d=new e.Vector3,m=new e.Vector3),x||(_=0,y=0,v=0);var E,C,A,R=this,P=this.vertices.length,L=t.extractPoints(b),O=L.shape,D=L.holes,k=!e.Shape.Utils.isClockWise(O);if(k){for(O=O.reverse(),C=0,A=D.length;A>C;C++)E=D[C],e.Shape.Utils.isClockWise(E)&&(D[C]=E.reverse());k=!1}var F=e.Shape.Utils.triangulateShape(O,D),N=O;for(C=0,A=D.length;A>C;C++)E=D[C],O=O.concat(E);for(var I,U,B,V,G,z,H=O.length,j=F.length,W=[],X=0,q=N.length,Y=q-1,Z=X+1;q>X;X++,Y++,Z++)Y===q&&(Y=0),Z===q&&(Z=0),W[X]=i(N[X],N[Y],N[Z]);var K,Q=[],J=W.concat();for(C=0,A=D.length;A>C;C++){for(E=D[C],K=[],X=0,q=E.length,Y=q-1,Z=X+1;q>X;X++,Y++,Z++)Y===q&&(Y=0),Z===q&&(Z=0),K[X]=i(E[X],E[Y],E[Z]);Q.push(K),J=J.concat(K)}for(I=0;_>I;I++){for(B=I/_,V=y*(1-B),U=v*Math.sin(B*Math.PI/2),X=0,q=N.length;q>X;X++)G=n(N[X],W[X],U),h(G.x,G.y,-V);for(C=0,A=D.length;A>C;C++)for(E=D[C],K=Q[C],X=0,q=E.length;q>X;X++)G=n(E[X],K[X],U),h(G.x,G.y,-V)}for(U=v,X=0;H>X;X++)G=x?n(O[X],J[X],U):O[X],M?(d.copy(p.normals[0]).multiplyScalar(G.x),f.copy(p.binormals[0]).multiplyScalar(G.y),m.copy(l[0]).add(d).add(f),h(m.x,m.y,m.z)):h(G.x,G.y,0);var $;for($=1;w>=$;$++)for(X=0;H>X;X++)G=x?n(O[X],J[X],U):O[X],M?(d.copy(p.normals[$]).multiplyScalar(G.x),f.copy(p.binormals[$]).multiplyScalar(G.y),m.copy(l[$]).add(d).add(f),h(m.x,m.y,m.z)):h(G.x,G.y,g/w*$);for(I=_-1;I>=0;I--){for(B=I/_,V=y*(1-B),U=v*Math.sin(B*Math.PI/2),X=0,q=N.length;q>X;X++)G=n(N[X],W[X],U),h(G.x,G.y,g+V);for(C=0,A=D.length;A>C;C++)for(E=D[C],K=Q[C],X=0,q=E.length;q>X;X++)G=n(E[X],K[X],U),M?h(G.x,G.y+l[w-1].y,l[w-1].x+V):h(G.x,G.y,g+V)}o(),a()},e.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(t,r,n,i){var o=t.vertices,a=o[r],s=o[n],h=o[i];return[new e.Vector2(a.x,a.y),new e.Vector2(s.x,s.y),new e.Vector2(h.x,h.y)]},generateSideWallUV:function(t,r,n,i,o){var a=t.vertices,s=a[r],h=a[n],u=a[i],c=a[o];return Math.abs(s.y-h.y)<.01?[new e.Vector2(s.x,1-s.z),new e.Vector2(h.x,1-h.z),new e.Vector2(u.x,1-u.z),new e.Vector2(c.x,1-c.z)]:[new e.Vector2(s.y,1-s.z),new e.Vector2(h.y,1-h.z),new e.Vector2(u.y,1-u.z),new e.Vector2(c.y,1-c.z)]}},e.ShapeGeometry=function(t,r){e.Geometry.call(this),this.type="ShapeGeometry",Array.isArray(t)===!1&&(t=[t]),this.addShapeList(t,r),this.computeFaceNormals()},e.ShapeGeometry.prototype=Object.create(e.Geometry.prototype),e.ShapeGeometry.prototype.constructor=e.ShapeGeometry,e.ShapeGeometry.prototype.addShapeList=function(t,e){for(var r=0,n=t.length;n>r;r++)this.addShape(t[r],e);return this},e.ShapeGeometry.prototype.addShape=function(t,r){void 0===r&&(r={});var n,i,o,a=void 0!==r.curveSegments?r.curveSegments:12,s=r.material,h=void 0===r.UVGenerator?e.ExtrudeGeometry.WorldUVGenerator:r.UVGenerator,u=this.vertices.length,c=t.extractPoints(a),l=c.shape,p=c.holes,f=!e.Shape.Utils.isClockWise(l);if(f){for(l=l.reverse(),n=0,i=p.length;i>n;n++)o=p[n],e.Shape.Utils.isClockWise(o)&&(p[n]=o.reverse());f=!1}var d=e.Shape.Utils.triangulateShape(l,p);for(n=0,i=p.length;i>n;n++)o=p[n],l=l.concat(o);var m,g,y=l.length,v=d.length;for(n=0;y>n;n++)m=l[n],this.vertices.push(new e.Vector3(m.x,m.y,0));for(n=0;v>n;n++){g=d[n];var _=g[0]+u,x=g[1]+u,b=g[2]+u;this.faces.push(new e.Face3(_,x,b,null,null,s)),this.faceVertexUvs[0].push(h.generateTopUV(this,_,x,b))}},e.LatheGeometry=function(t,r,n,i){e.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:r,phiStart:n,phiLength:i},r=r||12,n=n||0,i=i||2*Math.PI;for(var o=1/(t.length-1),a=1/r,s=0,h=r;h>=s;s++)for(var u=n+s*a*i,c=Math.cos(u),l=Math.sin(u),p=0,f=t.length;f>p;p++){var d=t[p],m=new e.Vector3;m.x=c*d.x-l*d.y,m.y=l*d.x+c*d.y,m.z=d.z,this.vertices.push(m)}for(var g=t.length,s=0,h=r;h>s;s++)for(var p=0,f=t.length-1;f>p;p++){var y=p+g*s,v=y,_=y+g,c=y+1+g,x=y+1,b=s*a,w=p*o,S=b+a,M=w+o;this.faces.push(new e.Face3(v,_,x)),this.faceVertexUvs[0].push([new e.Vector2(b,w),new e.Vector2(S,w),new e.Vector2(b,M)]),this.faces.push(new e.Face3(_,c,x)),this.faceVertexUvs[0].push([new e.Vector2(S,w),new e.Vector2(S,M),new e.Vector2(b,M)])}this.mergeVertices(),this.computeFaceNormals(),this.computeVertexNormals()},e.LatheGeometry.prototype=Object.create(e.Geometry.prototype),e.LatheGeometry.prototype.constructor=e.LatheGeometry,e.PlaneGeometry=function(t,r,n,i){e.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:r,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new e.PlaneBufferGeometry(t,r,n,i))},e.PlaneGeometry.prototype=Object.create(e.Geometry.prototype),e.PlaneGeometry.prototype.constructor=e.PlaneGeometry,e.PlaneGeometry.prototype.clone=function(){var t=new e.PlaneGeometry(this.parameters.width,this.parameters.height,this.parameters.widthSegments,this.parameters.heightSegments);return t},e.PlaneBufferGeometry=function(t,r,n,i){e.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:r,widthSegments:n,heightSegments:i};for(var o=t/2,a=r/2,s=Math.floor(n)||1,h=Math.floor(i)||1,u=s+1,c=h+1,l=t/s,p=r/h,f=new Float32Array(u*c*3),d=new Float32Array(u*c*3),m=new Float32Array(u*c*2),g=0,y=0,v=0;c>v;v++)for(var _=v*p-a,x=0;u>x;x++){var b=x*l-o;f[g]=b,f[g+1]=-_,d[g+2]=1,m[y]=x/s,m[y+1]=1-v/h,g+=3,y+=2}g=0;for(var w=new(f.length/3>65535?Uint32Array:Uint16Array)(s*h*6),v=0;h>v;v++)for(var x=0;s>x;x++){var S=x+u*v,M=x+u*(v+1),T=x+1+u*(v+1),E=x+1+u*v;w[g]=S,w[g+1]=M,w[g+2]=E,w[g+3]=M,w[g+4]=T,w[g+5]=E,g+=6}this.setIndex(new e.BufferAttribute(w,1)),this.addAttribute("position",new e.BufferAttribute(f,3)),this.addAttribute("normal",new e.BufferAttribute(d,3)),this.addAttribute("uv",new e.BufferAttribute(m,2))},e.PlaneBufferGeometry.prototype=Object.create(e.BufferGeometry.prototype),e.PlaneBufferGeometry.prototype.constructor=e.PlaneBufferGeometry,e.PlaneBufferGeometry.prototype.clone=function(){var t=new e.PlaneBufferGeometry(this.parameters.width,this.parameters.height,this.parameters.widthSegments,this.parameters.heightSegments);return t.copy(this),t},e.RingGeometry=function(t,r,n,i,o,a){e.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:r,thetaSegments:n,phiSegments:i,thetaStart:o,thetaLength:a},t=t||0,r=r||50,o=void 0!==o?o:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8,i=void 0!==i?Math.max(1,i):8;var s,h,u=[],c=t,l=(r-t)/i;for(s=0;i+1>s;s++){for(h=0;n+1>h;h++){var p=new e.Vector3,f=o+h/n*a;p.x=c*Math.cos(f),p.y=c*Math.sin(f),this.vertices.push(p),u.push(new e.Vector2((p.x/r+1)/2,(p.y/r+1)/2))}c+=l}var d=new e.Vector3(0,0,1);for(s=0;i>s;s++){var m=s*(n+1);for(h=0;n>h;h++){var f=h+m,g=f,y=f+n+1,v=f+n+2;this.faces.push(new e.Face3(g,y,v,[d.clone(),d.clone(),d.clone()])),this.faceVertexUvs[0].push([u[g].clone(),u[y].clone(),u[v].clone()]),g=f,y=f+n+2,v=f+1,this.faces.push(new e.Face3(g,y,v,[d.clone(),d.clone(),d.clone()])),this.faceVertexUvs[0].push([u[g].clone(),u[y].clone(),u[v].clone()])}}this.computeFaceNormals(),this.boundingSphere=new e.Sphere(new e.Vector3,c)},e.RingGeometry.prototype=Object.create(e.Geometry.prototype),e.RingGeometry.prototype.constructor=e.RingGeometry,e.RingGeometry.prototype.clone=function(){var t=new e.RingGeometry(this.parameters.innerRadius,this.parameters.outerRadius,this.parameters.thetaSegments,this.parameters.phiSegments,this.parameters.thetaStart,this.parameters.thetaLength);return t},e.SphereGeometry=function(t,r,n,i,o,a,s){e.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:r,heightSegments:n,phiStart:i,phiLength:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new e.SphereBufferGeometry(t,r,n,i,o,a,s))},e.SphereGeometry.prototype=Object.create(e.Geometry.prototype),e.SphereGeometry.prototype.constructor=e.SphereGeometry,e.SphereGeometry.prototype.clone=function(){var t=new e.SphereGeometry(this.parameters.radius,this.parameters.widthSegments,this.parameters.heightSegments,this.parameters.phiStart,this.parameters.phiLength,this.parameters.thetaStart,this.parameters.thetaLength);return t},e.SphereBufferGeometry=function(t,r,n,i,o,a,s){e.BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:r,heightSegments:n,phiStart:i,phiLength:o,thetaStart:a,thetaLength:s},t=t||50,r=Math.max(3,Math.floor(r)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,a=void 0!==a?a:0,s=void 0!==s?s:Math.PI;for(var h=a+s,u=(r+1)*(n+1),c=new e.BufferAttribute(new Float32Array(3*u),3),l=new e.BufferAttribute(new Float32Array(3*u),3),p=new e.BufferAttribute(new Float32Array(2*u),2),f=0,d=[],m=new e.Vector3,g=0;n>=g;g++){for(var y=[],v=g/n,_=0;r>=_;_++){var x=_/r,b=-t*Math.cos(i+x*o)*Math.sin(a+v*s),w=t*Math.cos(a+v*s),S=t*Math.sin(i+x*o)*Math.sin(a+v*s);m.set(b,w,S).normalize(),c.setXYZ(f,b,w,S),l.setXYZ(f,m.x,m.y,m.z),p.setXY(f,x,1-v),y.push(f),f++}d.push(y)}for(var M=[],g=0;n>g;g++)for(var _=0;r>_;_++){var T=d[g][_+1],E=d[g][_],C=d[g+1][_],A=d[g+1][_+1];(0!==g||a>0)&&M.push(T,E,A),(g!==n-1||h<Math.PI)&&M.push(E,C,A)}this.setIndex(new e.BufferAttribute(new Uint16Array(M),1)),this.addAttribute("position",c),this.addAttribute("normal",l),this.addAttribute("uv",p),this.boundingSphere=new e.Sphere(new e.Vector3,t)},e.SphereBufferGeometry.prototype=Object.create(e.BufferGeometry.prototype),e.SphereBufferGeometry.prototype.constructor=e.SphereBufferGeometry,e.SphereBufferGeometry.prototype.clone=function(){var t=new e.SphereBufferGeometry(this.parameters.radius,this.parameters.widthSegments,this.parameters.heightSegments,this.parameters.phiStart,this.parameters.phiLength,this.parameters.thetaStart,this.parameters.thetaLength);return t.copy(this),t},e.TextGeometry=function(t,r){r=r||{};var n=e.FontUtils.generateShapes(t,r);r.amount=void 0!==r.height?r.height:50,void 0===r.bevelThickness&&(r.bevelThickness=10),void 0===r.bevelSize&&(r.bevelSize=8),void 0===r.bevelEnabled&&(r.bevelEnabled=!1),e.ExtrudeGeometry.call(this,n,r),this.type="TextGeometry"},e.TextGeometry.prototype=Object.create(e.ExtrudeGeometry.prototype),e.TextGeometry.prototype.constructor=e.TextGeometry,e.TorusGeometry=function(t,r,n,i,o){e.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:r,radialSegments:n,tubularSegments:i,arc:o},t=t||100,r=r||40,n=n||8,i=i||6,o=o||2*Math.PI;for(var a=new e.Vector3,s=[],h=[],u=0;n>=u;u++)for(var c=0;i>=c;c++){var l=c/i*o,p=u/n*Math.PI*2;a.x=t*Math.cos(l),a.y=t*Math.sin(l);var f=new e.Vector3;f.x=(t+r*Math.cos(p))*Math.cos(l),f.y=(t+r*Math.cos(p))*Math.sin(l),f.z=r*Math.sin(p),this.vertices.push(f),s.push(new e.Vector2(c/i,u/n)),h.push(f.clone().sub(a).normalize())}for(var u=1;n>=u;u++)for(var c=1;i>=c;c++){var d=(i+1)*u+c-1,m=(i+1)*(u-1)+c-1,g=(i+1)*(u-1)+c,y=(i+1)*u+c,v=new e.Face3(d,m,y,[h[d].clone(),h[m].clone(),h[y].clone()]);this.faces.push(v),this.faceVertexUvs[0].push([s[d].clone(),s[m].clone(),s[y].clone()]),v=new e.Face3(m,g,y,[h[m].clone(),h[g].clone(),h[y].clone()]),this.faces.push(v),this.faceVertexUvs[0].push([s[m].clone(),s[g].clone(),s[y].clone()])}this.computeFaceNormals()},e.TorusGeometry.prototype=Object.create(e.Geometry.prototype),e.TorusGeometry.prototype.constructor=e.TorusGeometry,e.TorusGeometry.prototype.clone=function(){var t=new e.TorusGeometry(this.parameters.radius,this.parameters.tube,this.parameters.radialSegments,this.parameters.tubularSegments,this.parameters.arc);return t},e.TorusKnotGeometry=function(t,r,n,i,o,a,s){function h(t,r,n,i,o){var a=Math.cos(t),s=Math.sin(t),h=r/n*t,u=Math.cos(h),c=i*(2+u)*.5*a,l=i*(2+u)*s*.5,p=o*i*Math.sin(h)*.5;return new e.Vector3(c,l,p)}e.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:r,radialSegments:n,tubularSegments:i,p:o,q:a,heightScale:s},t=t||100,r=r||40,n=n||64,i=i||8,o=o||2,a=a||3,s=s||1;for(var u=new Array(n),c=new e.Vector3,l=new e.Vector3,p=new e.Vector3,f=0;n>f;++f){u[f]=new Array(i);var d=f/n*2*o*Math.PI,m=h(d,a,o,t,s),g=h(d+.01,a,o,t,s);c.subVectors(g,m),l.addVectors(g,m),p.crossVectors(c,l),l.crossVectors(p,c),p.normalize(),l.normalize();for(var y=0;i>y;++y){var v=y/i*2*Math.PI,_=-r*Math.cos(v),x=r*Math.sin(v),b=new e.Vector3;b.x=m.x+_*l.x+x*p.x,b.y=m.y+_*l.y+x*p.y,b.z=m.z+_*l.z+x*p.z,u[f][y]=this.vertices.push(b)-1}}for(var f=0;n>f;++f)for(var y=0;i>y;++y){var w=(f+1)%n,S=(y+1)%i,M=u[f][y],T=u[w][y],E=u[w][S],C=u[f][S],A=new e.Vector2(f/n,y/i),R=new e.Vector2((f+1)/n,y/i),P=new e.Vector2((f+1)/n,(y+1)/i),L=new e.Vector2(f/n,(y+1)/i);this.faces.push(new e.Face3(M,T,C)),this.faceVertexUvs[0].push([A,R,L]),this.faces.push(new e.Face3(T,E,C)),this.faceVertexUvs[0].push([R.clone(),P,L.clone()])}this.computeFaceNormals(),this.computeVertexNormals()},e.TorusKnotGeometry.prototype=Object.create(e.Geometry.prototype),e.TorusKnotGeometry.prototype.constructor=e.TorusKnotGeometry,e.TorusKnotGeometry.prototype.clone=function(){var t=new e.TorusKnotGeometry(this.parameters.radius,this.parameters.tube,this.parameters.radialSegments,this.parameters.tubularSegments,this.parameters.p,this.parameters.q,this.parameters.heightScale);return t},e.TubeGeometry=function(t,r,n,i,o,a){function s(t,r,n){return P.vertices.push(new e.Vector3(t,r,n))-1}e.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:t,segments:r,radius:n,radialSegments:i,closed:o},r=r||64,n=n||1,i=i||8,o=o||!1,a=a||e.TubeGeometry.NoTaper;var h,u,c,l,p,f,d,m,g,y,v,_,x,b,w,S,M,T,E,C,A,R=[],P=this,L=r+1,O=new e.Vector3,D=new e.TubeGeometry.FrenetFrames(t,r,o),k=D.tangents,F=D.normals,N=D.binormals;for(this.tangents=k,this.normals=F,this.binormals=N,y=0;L>y;y++)for(R[y]=[],l=y/(L-1),g=t.getPointAt(l),h=k[y],u=F[y],c=N[y],f=n*a(l),v=0;i>v;v++)p=v/i*2*Math.PI,d=-f*Math.cos(p),m=f*Math.sin(p),O.copy(g),O.x+=d*u.x+m*c.x,O.y+=d*u.y+m*c.y,O.z+=d*u.z+m*c.z,R[y][v]=s(O.x,O.y,O.z);for(y=0;r>y;y++)for(v=0;i>v;v++)_=o?(y+1)%r:y+1,x=(v+1)%i,b=R[y][v],w=R[_][v],S=R[_][x],M=R[y][x],T=new e.Vector2(y/r,v/i),E=new e.Vector2((y+1)/r,v/i),C=new e.Vector2((y+1)/r,(v+1)/i),A=new e.Vector2(y/r,(v+1)/i),this.faces.push(new e.Face3(b,w,M)),this.faceVertexUvs[0].push([T,E,A]),this.faces.push(new e.Face3(w,S,M)),this.faceVertexUvs[0].push([E.clone(),C,A.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},e.TubeGeometry.prototype=Object.create(e.Geometry.prototype),e.TubeGeometry.prototype.constructor=e.TubeGeometry,e.TubeGeometry.NoTaper=function(t){return 1},e.TubeGeometry.SinusoidalTaper=function(t){return Math.sin(Math.PI*t)},e.TubeGeometry.FrenetFrames=function(t,r,n){function i(){d[0]=new e.Vector3,m[0]=new e.Vector3,a=Number.MAX_VALUE,s=Math.abs(f[0].x),h=Math.abs(f[0].y),u=Math.abs(f[0].z),a>=s&&(a=s,p.set(1,0,0)),a>=h&&(a=h,p.set(0,1,0)),a>=u&&p.set(0,0,1),g.crossVectors(f[0],p).normalize(),d[0].crossVectors(f[0],g),m[0].crossVectors(f[0],d[0])}var o,a,s,h,u,c,l,p=new e.Vector3,f=[],d=[],m=[],g=new e.Vector3,y=new e.Matrix4,v=r+1,_=1e-4;for(this.tangents=f,this.normals=d,this.binormals=m,c=0;v>c;c++)l=c/(v-1),f[c]=t.getTangentAt(l),f[c].normalize();for(i(),c=1;v>c;c++)d[c]=d[c-1].clone(),m[c]=m[c-1].clone(),g.crossVectors(f[c-1],f[c]),g.length()>_&&(g.normalize(),o=Math.acos(e.Math.clamp(f[c-1].dot(f[c]),-1,1)),d[c].applyMatrix4(y.makeRotationAxis(g,o))),m[c].crossVectors(f[c],d[c]);if(n)for(o=Math.acos(e.Math.clamp(d[0].dot(d[v-1]),-1,1)),o/=v-1,f[0].dot(g.crossVectors(d[0],d[v-1]))>0&&(o=-o),c=1;v>c;c++)d[c].applyMatrix4(y.makeRotationAxis(f[c],o*c)),m[c].crossVectors(f[c],d[c])},e.PolyhedronGeometry=function(t,r,n,i){function o(t){var r=t.normalize().clone();r.index=l.vertices.push(r)-1;var n=h(t)/2/Math.PI+.5,i=u(t)/Math.PI+.5;return r.uv=new e.Vector2(n,1-i),r}function a(t,r,n,i){var o=new e.Face3(t.index,r.index,n.index,[t.clone(),r.clone(),n.clone()],void 0,i);l.faces.push(o),x.copy(t).add(r).add(n).divideScalar(3);var a=h(x);l.faceVertexUvs[0].push([c(t.uv,t,a),c(r.uv,r,a),c(n.uv,n,a)])}function s(t,e){for(var r=Math.pow(2,e),n=o(l.vertices[t.a]),i=o(l.vertices[t.b]),s=o(l.vertices[t.c]),h=[],u=t.materialIndex,c=0;r>=c;c++){h[c]=[];for(var p=o(n.clone().lerp(s,c/r)),f=o(i.clone().lerp(s,c/r)),d=r-c,m=0;d>=m;m++)0===m&&c===r?h[c][m]=p:h[c][m]=o(p.clone().lerp(f,m/d))}for(var c=0;r>c;c++)for(var m=0;2*(r-c)-1>m;m++){var g=Math.floor(m/2);m%2===0?a(h[c][g+1],h[c+1][g],h[c][g],u):a(h[c][g+1],h[c+1][g+1],h[c+1][g],u)}}function h(t){return Math.atan2(t.z,-t.x)}function u(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}function c(t,r,n){return 0>n&&1===t.x&&(t=new e.Vector2(t.x-1,t.y)),0===r.x&&0===r.z&&(t=new e.Vector2(n/2/Math.PI+.5,t.y)),t.clone()}e.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:r,radius:n,detail:i},n=n||1,i=i||0;for(var l=this,p=0,f=t.length;f>p;p+=3)o(new e.Vector3(t[p],t[p+1],t[p+2]));for(var d=this.vertices,m=[],p=0,g=0,f=r.length;f>p;p+=3,g++){var y=d[r[p]],v=d[r[p+1]],_=d[r[p+2]];m[g]=new e.Face3(y.index,v.index,_.index,[y.clone(),v.clone(),_.clone()],void 0,g)}for(var x=new e.Vector3,p=0,f=m.length;f>p;p++)s(m[p],i);for(var p=0,f=this.faceVertexUvs[0].length;f>p;p++){var b=this.faceVertexUvs[0][p],w=b[0].x,S=b[1].x,M=b[2].x,T=Math.max(w,Math.max(S,M)),E=Math.min(w,Math.min(S,M));T>.9&&.1>E&&(.2>w&&(b[0].x+=1),.2>S&&(b[1].x+=1),.2>M&&(b[2].x+=1))}for(var p=0,f=this.vertices.length;f>p;p++)this.vertices[p].multiplyScalar(n);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new e.Sphere(new e.Vector3,n)},e.PolyhedronGeometry.prototype=Object.create(e.Geometry.prototype),e.PolyhedronGeometry.prototype.constructor=e.PolyhedronGeometry,e.PolyhedronGeometry.prototype.clone=function(){var t=new e.PolyhedronGeometry(this.parameters.vertices,this.parameters.indices,this.parameters.radius,this.parameters.detail);return t.copy(this)},e.PolyhedronGeometry.prototype.copy=function(t){return e.Geometry.prototype.copy.call(this,t),this},e.DodecahedronGeometry=function(t,r){var n=(1+Math.sqrt(5))/2,i=1/n,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];e.PolyhedronGeometry.call(this,o,a,t,r),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:r}},e.DodecahedronGeometry.prototype=Object.create(e.PolyhedronGeometry.prototype),e.DodecahedronGeometry.prototype.constructor=e.DodecahedronGeometry,e.DodecahedronGeometry.prototype.clone=function(){var t=new e.DodecahedronGeometry(this.parameters.radius,this.parameters.detail);return t.copy(this),t},e.IcosahedronGeometry=function(t,r){var n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],o=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];e.PolyhedronGeometry.call(this,i,o,t,r),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:r}},e.IcosahedronGeometry.prototype=Object.create(e.PolyhedronGeometry.prototype),e.IcosahedronGeometry.prototype.constructor=e.IcosahedronGeometry,e.IcosahedronGeometry.prototype.clone=function(){var t=new e.IcosahedronGeometry(this.parameters.radius,this.parameters.detail);return t.copy(this),t},e.OctahedronGeometry=function(t,r){var n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];e.PolyhedronGeometry.call(this,n,i,t,r),this.type="OctahedronGeometry",this.parameters={radius:t,detail:r}},e.OctahedronGeometry.prototype=Object.create(e.PolyhedronGeometry.prototype),e.OctahedronGeometry.prototype.constructor=e.OctahedronGeometry,e.OctahedronGeometry.prototype.clone=function(){var t=new e.OctahedronGeometry(this.parameters.radius,this.parameters.detail);return t.copy(this),t},e.TetrahedronGeometry=function(t,r){var n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];e.PolyhedronGeometry.call(this,n,i,t,r),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:r}},e.TetrahedronGeometry.prototype=Object.create(e.PolyhedronGeometry.prototype),e.TetrahedronGeometry.prototype.constructor=e.TetrahedronGeometry,e.TetrahedronGeometry.prototype.clone=function(){var t=new e.TetrahedronGeometry(this.parameters.radius,this.parameters.detail);return t.copy(this),t},e.ParametricGeometry=function(t,r,n){e.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:r,stacks:n};var i,o,a,s,h,u=this.vertices,c=this.faces,l=this.faceVertexUvs[0],p=r+1;for(i=0;n>=i;i++)for(h=i/n,o=0;r>=o;o++)s=o/r,a=t(s,h),u.push(a);var f,d,m,g,y,v,_,x;for(i=0;n>i;i++)for(o=0;r>o;o++)f=i*p+o,d=i*p+o+1,m=(i+1)*p+o+1,g=(i+1)*p+o,y=new e.Vector2(o/r,i/n),v=new e.Vector2((o+1)/r,i/n),_=new e.Vector2((o+1)/r,(i+1)/n),x=new e.Vector2(o/r,(i+1)/n),c.push(new e.Face3(f,d,g)),l.push([y,v,x]),c.push(new e.Face3(d,m,g)),l.push([v.clone(),_,x.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},e.ParametricGeometry.prototype=Object.create(e.Geometry.prototype),e.ParametricGeometry.prototype.constructor=e.ParametricGeometry,e.WireframeGeometry=function(t){e.BufferGeometry.call(this);var r=[0,0],n={},i=function(t,e){return t-e},o=["a","b","c"];if(t instanceof e.Geometry){for(var a=t.vertices,s=t.faces,h=0,u=new Uint32Array(6*s.length),c=0,l=s.length;l>c;c++)for(var p=s[c],f=0;3>f;f++){r[0]=p[o[f]],r[1]=p[o[(f+1)%3]],r.sort(i);var d=r.toString();void 0===n[d]&&(u[2*h]=r[0],u[2*h+1]=r[1],n[d]=!0,h++)}for(var m=new Float32Array(2*h*3),c=0,l=h;l>c;c++)for(var f=0;2>f;f++){var g=a[u[2*c+f]],y=6*c+3*f;m[y+0]=g.x,m[y+1]=g.y,m[y+2]=g.z}this.addAttribute("position",new e.BufferAttribute(m,3))}else if(t instanceof e.BufferGeometry)if(null!==t.index){var v=t.index.array,a=t.attributes.position,_=t.drawcalls,h=0;0===_.length&&t.addDrawCall(0,v.length);for(var u=new Uint32Array(2*v.length),x=0,b=_.length;b>x;++x)for(var w=_[x],S=w.start,M=w.count,c=S,T=S+M;T>c;c+=3)for(var f=0;3>f;f++){r[0]=v[c+f],r[1]=v[c+(f+1)%3],r.sort(i);var d=r.toString();void 0===n[d]&&(u[2*h]=r[0],u[2*h+1]=r[1],n[d]=!0,h++)}for(var m=new Float32Array(2*h*3),c=0,l=h;l>c;c++)for(var f=0;2>f;f++){var y=6*c+3*f,E=u[2*c+f];m[y+0]=a.getX(E),m[y+1]=a.getY(E),m[y+2]=a.getZ(E)}this.addAttribute("position",new e.BufferAttribute(m,3))}else{for(var a=t.attributes.position.array,h=a.length/3,C=h/3,m=new Float32Array(2*h*3),c=0,l=C;l>c;c++)for(var f=0;3>f;f++){var y=18*c+6*f,A=9*c+3*f;m[y+0]=a[A],m[y+1]=a[A+1],m[y+2]=a[A+2];var E=9*c+3*((f+1)%3);m[y+3]=a[E],m[y+4]=a[E+1],m[y+5]=a[E+2]}this.addAttribute("position",new e.BufferAttribute(m,3))}},e.WireframeGeometry.prototype=Object.create(e.BufferGeometry.prototype),e.WireframeGeometry.prototype.constructor=e.WireframeGeometry,e.AxisHelper=function(t){t=t||1;var r=new Float32Array([0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t]),n=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),i=new e.BufferGeometry;i.addAttribute("position",new e.BufferAttribute(r,3)),i.addAttribute("color",new e.BufferAttribute(n,3));var o=new e.LineBasicMaterial({vertexColors:e.VertexColors});e.LineSegments.call(this,i,o)},e.AxisHelper.prototype=Object.create(e.LineSegments.prototype),e.AxisHelper.prototype.constructor=e.AxisHelper,e.ArrowHelper=function(){var t=new e.Geometry;t.vertices.push(new e.Vector3(0,0,0),new e.Vector3(0,1,0));var r=new e.CylinderGeometry(0,.5,1,5,1);return r.translate(0,-.5,0),function(n,i,o,a,s,h){e.Object3D.call(this),void 0===a&&(a=16776960),void 0===o&&(o=1),void 0===s&&(s=.2*o),void 0===h&&(h=.2*s),this.position.copy(i),o>s&&(this.line=new e.Line(t,new e.LineBasicMaterial({color:a})),this.line.matrixAutoUpdate=!1,this.add(this.line)),this.cone=new e.Mesh(r,new e.MeshBasicMaterial({color:a})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(n),this.setLength(o,s,h)}}(),e.ArrowHelper.prototype=Object.create(e.Object3D.prototype),e.ArrowHelper.prototype.constructor=e.ArrowHelper,e.ArrowHelper.prototype.setDirection=function(){var t,r=new e.Vector3;return function(e){e.y>.99999?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(r.set(e.z,0,-e.x).normalize(),t=Math.acos(e.y),this.quaternion.setFromAxisAngle(r,t))}}(),e.ArrowHelper.prototype.setLength=function(t,e,r){void 0===e&&(e=.2*t),void 0===r&&(r=.2*e),t>e&&(this.line.scale.set(1,t-e,1),this.line.updateMatrix()),this.cone.scale.set(r,e,r),this.cone.position.y=t,this.cone.updateMatrix()},e.ArrowHelper.prototype.setColor=function(t){void 0!==this.line&&this.line.material.color.set(t),this.cone.material.color.set(t)},e.BoxHelper=function(t){var r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new e.BufferGeometry;i.setIndex(new e.BufferAttribute(r,1)),i.addAttribute("position",new e.BufferAttribute(n,3)),e.LineSegments.call(this,i,new e.LineBasicMaterial({color:16776960})),void 0!==t&&this.update(t)},e.BoxHelper.prototype=Object.create(e.LineSegments.prototype),e.BoxHelper.prototype.constructor=e.BoxHelper,e.BoxHelper.prototype.update=function(){var t=new e.Box3;return function(e){if(t.setFromObject(e),!t.empty()){var r=t.min,n=t.max,i=this.geometry.attributes.position,o=i.array;o[0]=n.x,o[1]=n.y,o[2]=n.z,o[3]=r.x,o[4]=n.y,o[5]=n.z,o[6]=r.x,o[7]=r.y,o[8]=n.z,o[9]=n.x,o[10]=r.y,o[11]=n.z,o[12]=n.x,o[13]=n.y,o[14]=r.z,o[15]=r.x,o[16]=n.y,o[17]=r.z,o[18]=r.x,o[19]=r.y,o[20]=r.z,o[21]=n.x,o[22]=r.y,o[23]=r.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),e.BoundingBoxHelper=function(t,r){var n=void 0!==r?r:8947848;this.object=t,this.box=new e.Box3,e.Mesh.call(this,new e.BoxGeometry(1,1,1),new e.MeshBasicMaterial({color:n,wireframe:!0}))},e.BoundingBoxHelper.prototype=Object.create(e.Mesh.prototype),e.BoundingBoxHelper.prototype.constructor=e.BoundingBoxHelper,e.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},e.CameraHelper=function(t){function r(t,e,r){n(t,r),n(e,r)}function n(t,r){i.vertices.push(new e.Vector3),i.colors.push(new e.Color(r)),void 0===a[t]&&(a[t]=[]),a[t].push(i.vertices.length-1)}var i=new e.Geometry,o=new e.LineBasicMaterial({color:16777215,vertexColors:e.FaceColors}),a={},s=16755200,h=16711680,u=43775,c=16777215,l=3355443;r("n1","n2",s),r("n2","n4",s),r("n4","n3",s),r("n3","n1",s),r("f1","f2",s),r("f2","f4",s),r("f4","f3",s),r("f3","f1",s),r("n1","f1",s),r("n2","f2",s),r("n3","f3",s),r("n4","f4",s),r("p","n1",h),r("p","n2",h),r("p","n3",h),r("p","n4",h),r("u1","u2",u),r("u2","u3",u),r("u3","u1",u),r("c","t",c),r("p","c",l),r("cn1","cn2",l),r("cn3","cn4",l),r("cf1","cf2",l),r("cf3","cf4",l),e.LineSegments.call(this,i,o),this.camera=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()},e.CameraHelper.prototype=Object.create(e.LineSegments.prototype),e.CameraHelper.prototype.constructor=e.CameraHelper,e.CameraHelper.prototype.update=function(){var t,r,n=new e.Vector3,i=new e.Camera,o=function(e,o,a,s){n.set(o,a,s).unproject(i);var h=r[e];if(void 0!==h)for(var u=0,c=h.length;c>u;u++)t.vertices[h[u]].copy(n)};return function(){t=this.geometry,r=this.pointMap;var e=1,n=1;i.projectionMatrix.copy(this.camera.projectionMatrix),o("c",0,0,-1),o("t",0,0,1),o("n1",-e,-n,-1),o("n2",e,-n,-1),o("n3",-e,n,-1),o("n4",e,n,-1),o("f1",-e,-n,1),o("f2",e,-n,1),o("f3",-e,n,1),o("f4",e,n,1),o("u1",.7*e,1.1*n,-1),o("u2",.7*-e,1.1*n,-1),o("u3",0,2*n,-1),o("cf1",-e,0,1),o("cf2",e,0,1),o("cf3",0,-n,1),o("cf4",0,n,1),o("cn1",-e,0,-1),o("cn2",e,0,-1),o("cn3",0,-n,-1),o("cn4",0,n,-1),t.verticesNeedUpdate=!0}}(),e.DirectionalLightHelper=function(t,r){e.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,r=r||1;var n=new e.Geometry;n.vertices.push(new e.Vector3(-r,r,0),new e.Vector3(r,r,0),new e.Vector3(r,-r,0),new e.Vector3(-r,-r,0),new e.Vector3(-r,r,0));var i=new e.LineBasicMaterial({fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new e.Line(n,i),this.add(this.lightPlane),n=new e.Geometry,n.vertices.push(new e.Vector3,new e.Vector3),i=new e.LineBasicMaterial({fog:!1}),i.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new e.Line(n,i),this.add(this.targetLine),this.update()},e.DirectionalLightHelper.prototype=Object.create(e.Object3D.prototype),e.DirectionalLightHelper.prototype.constructor=e.DirectionalLightHelper,e.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose();
},e.DirectionalLightHelper.prototype.update=function(){var t=new e.Vector3,r=new e.Vector3,n=new e.Vector3;return function(){t.setFromMatrixPosition(this.light.matrixWorld),r.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(r,t),this.lightPlane.lookAt(n),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(n),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),e.EdgesHelper=function(t,r,n){var i=void 0!==r?r:16777215;e.LineSegments.call(this,new e.EdgesGeometry(t.geometry,n),new e.LineBasicMaterial({color:i})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},e.EdgesHelper.prototype=Object.create(e.LineSegments.prototype),e.EdgesHelper.prototype.constructor=e.EdgesHelper,e.FaceNormalsHelper=function(t,r,n,i){this.object=t,this.size=void 0!==r?r:1;var o=void 0!==n?n:16776960,a=void 0!==i?i:1,s=0,h=this.object.geometry;h instanceof e.Geometry?s=h.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var u=new e.BufferGeometry,c=new e.Float32Attribute(2*s*3,3);u.addAttribute("position",c),e.LineSegments.call(this,u,new e.LineBasicMaterial({color:o,linewidth:a})),this.matrixAutoUpdate=!1,this.update()},e.FaceNormalsHelper.prototype=Object.create(e.LineSegments.prototype),e.FaceNormalsHelper.prototype.constructor=e.FaceNormalsHelper,e.FaceNormalsHelper.prototype.update=function(){var t=new e.Vector3,r=new e.Vector3,n=new e.Matrix3;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var e=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,h=0,u=0,c=s.length;c>u;u++){var l=s[u],p=l.normal;t.copy(a[l.a]).add(a[l.b]).add(a[l.c]).divideScalar(3).applyMatrix4(e),r.copy(p).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),i.setXYZ(h,t.x,t.y,t.z),h+=1,i.setXYZ(h,r.x,r.y,r.z),h+=1}return i.needsUpdate=!0,this}}(),e.GridHelper=function(t,r){var n=new e.Geometry,i=new e.LineBasicMaterial({vertexColors:e.VertexColors});this.color1=new e.Color(4473924),this.color2=new e.Color(8947848);for(var o=-t;t>=o;o+=r){n.vertices.push(new e.Vector3(-t,0,o),new e.Vector3(t,0,o),new e.Vector3(o,0,-t),new e.Vector3(o,0,t));var a=0===o?this.color1:this.color2;n.colors.push(a,a,a,a)}e.LineSegments.call(this,n,i)},e.GridHelper.prototype=Object.create(e.LineSegments.prototype),e.GridHelper.prototype.constructor=e.GridHelper,e.GridHelper.prototype.setColors=function(t,e){this.color1.set(t),this.color2.set(e),this.geometry.colorsNeedUpdate=!0},e.HemisphereLightHelper=function(t,r){e.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new e.Color,new e.Color];var n=new e.SphereGeometry(r,4,2);n.rotateX(-Math.PI/2);for(var i=0,o=8;o>i;i++)n.faces[i].color=this.colors[4>i?0:1];var a=new e.MeshBasicMaterial({vertexColors:e.FaceColors,wireframe:!0});this.lightSphere=new e.Mesh(n,a),this.add(this.lightSphere),this.update()},e.HemisphereLightHelper.prototype=Object.create(e.Object3D.prototype),e.HemisphereLightHelper.prototype.constructor=e.HemisphereLightHelper,e.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},e.HemisphereLightHelper.prototype.update=function(){var t=new e.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),e.PointLightHelper=function(t,r){this.light=t,this.light.updateMatrixWorld();var n=new e.SphereGeometry(r,4,2),i=new e.MeshBasicMaterial({wireframe:!0,fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),e.Mesh.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},e.PointLightHelper.prototype=Object.create(e.Mesh.prototype),e.PointLightHelper.prototype.constructor=e.PointLightHelper,e.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},e.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},e.SkeletonHelper=function(t){this.bones=this.getBoneList(t);for(var r=new e.Geometry,n=0;n<this.bones.length;n++){var i=this.bones[n];i.parent instanceof e.Bone&&(r.vertices.push(new e.Vector3),r.vertices.push(new e.Vector3),r.colors.push(new e.Color(0,0,1)),r.colors.push(new e.Color(0,1,0)))}r.dynamic=!0;var o=new e.LineBasicMaterial({vertexColors:e.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});e.LineSegments.call(this,r,o),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update()},e.SkeletonHelper.prototype=Object.create(e.LineSegments.prototype),e.SkeletonHelper.prototype.constructor=e.SkeletonHelper,e.SkeletonHelper.prototype.getBoneList=function(t){var r=[];t instanceof e.Bone&&r.push(t);for(var n=0;n<t.children.length;n++)r.push.apply(r,this.getBoneList(t.children[n]));return r},e.SkeletonHelper.prototype.update=function(){for(var t=this.geometry,r=(new e.Matrix4).getInverse(this.root.matrixWorld),n=new e.Matrix4,i=0,o=0;o<this.bones.length;o++){var a=this.bones[o];a.parent instanceof e.Bone&&(n.multiplyMatrices(r,a.matrixWorld),t.vertices[i].setFromMatrixPosition(n),n.multiplyMatrices(r,a.parent.matrixWorld),t.vertices[i+1].setFromMatrixPosition(n),i+=2)}t.verticesNeedUpdate=!0,t.computeBoundingSphere()},e.SpotLightHelper=function(t){e.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;var r=new e.CylinderGeometry(0,1,1,8,1,!0);r.translate(0,-.5,0),r.rotateX(-Math.PI/2);var n=new e.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new e.Mesh(r,n),this.add(this.cone),this.update()},e.SpotLightHelper.prototype=Object.create(e.Object3D.prototype),e.SpotLightHelper.prototype.constructor=e.SpotLightHelper,e.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},e.SpotLightHelper.prototype.update=function(){var t=new e.Vector3,r=new e.Vector3;return function(){var e=this.light.distance?this.light.distance:1e4,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),t.setFromMatrixPosition(this.light.matrixWorld),r.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(r.sub(t)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),e.VertexNormalsHelper=function(t,r,n,i){this.object=t,this.size=void 0!==r?r:1;var o=void 0!==n?n:16711680,a=void 0!==i?i:1,s=0,h=this.object.geometry;h instanceof e.Geometry?s=3*h.faces.length:h instanceof e.BufferGeometry&&(s=h.attributes.normal.count);var u=new e.BufferGeometry,c=new e.Float32Attribute(2*s*3,3);u.addAttribute("position",c),e.LineSegments.call(this,u,new e.LineBasicMaterial({color:o,linewidth:a})),this.matrixAutoUpdate=!1,this.update()},e.VertexNormalsHelper.prototype=Object.create(e.LineSegments.prototype),e.VertexNormalsHelper.prototype.constructor=e.VertexNormalsHelper,e.VertexNormalsHelper.prototype.update=function(){var t=new e.Vector3,r=new e.Vector3,n=new e.Matrix3;return function(){var i=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var o=this.object.matrixWorld,a=this.geometry.attributes.position,s=this.object.geometry;if(s instanceof e.Geometry)for(var h=s.vertices,u=s.faces,c=0,l=0,p=u.length;p>l;l++)for(var f=u[l],d=0,m=f.vertexNormals.length;m>d;d++){var g=h[f[i[d]]],y=f.vertexNormals[d];t.copy(g).applyMatrix4(o),r.copy(y).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),a.setXYZ(c,t.x,t.y,t.z),c+=1,a.setXYZ(c,r.x,r.y,r.z),c+=1}else if(s instanceof e.BufferGeometry)for(var v=s.attributes.position,_=s.attributes.normal,c=0,d=0,m=v.count;m>d;d++)t.set(v.getX(d),v.getY(d),v.getZ(d)).applyMatrix4(o),r.set(_.getX(d),_.getY(d),_.getZ(d)),r.applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),a.setXYZ(c,t.x,t.y,t.z),c+=1,a.setXYZ(c,r.x,r.y,r.z),c+=1;return a.needsUpdate=!0,this}}(),e.WireframeHelper=function(t,r){var n=void 0!==r?r:16777215;e.LineSegments.call(this,new e.WireframeGeometry(t.geometry),new e.LineBasicMaterial({color:n})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},e.WireframeHelper.prototype=Object.create(e.LineSegments.prototype),e.WireframeHelper.prototype.constructor=e.WireframeHelper,e.ImmediateRenderObject=function(){e.Object3D.call(this),this.render=function(t){}},e.ImmediateRenderObject.prototype=Object.create(e.Object3D.prototype),e.ImmediateRenderObject.prototype.constructor=e.ImmediateRenderObject,e.MorphBlendMesh=function(t,r){e.Mesh.call(this,t,r),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length,i="__default",o=0,a=n-1,s=n/1;this.createAnimation(i,o,a,s),this.setAnimationWeight(i,1)},e.MorphBlendMesh.prototype=Object.create(e.Mesh.prototype),e.MorphBlendMesh.prototype.constructor=e.MorphBlendMesh,e.MorphBlendMesh.prototype.createAnimation=function(t,e,r,n){var i={start:e,end:r,length:r-e+1,fps:n,duration:(r-e)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[t]=i,this.animationsList.push(i)},e.MorphBlendMesh.prototype.autoCreateAnimations=function(t){for(var e,r=/([a-z]+)_?(\d+)/,n={},i=this.geometry,o=0,a=i.morphTargets.length;a>o;o++){var s=i.morphTargets[o],h=s.name.match(r);if(h&&h.length>1){var u=h[1];n[u]||(n[u]={start:1/0,end:-(1/0)});var c=n[u];o<c.start&&(c.start=o),o>c.end&&(c.end=o),e||(e=u)}}for(var u in n){var c=n[u];this.createAnimation(u,c.start,c.end,t)}this.firstAnimation=e},e.MorphBlendMesh.prototype.setAnimationDirectionForward=function(t){var e=this.animationsMap[t];e&&(e.direction=1,e.directionBackwards=!1)},e.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(t){var e=this.animationsMap[t];e&&(e.direction=-1,e.directionBackwards=!0)},e.MorphBlendMesh.prototype.setAnimationFPS=function(t,e){var r=this.animationsMap[t];r&&(r.fps=e,r.duration=(r.end-r.start)/r.fps)},e.MorphBlendMesh.prototype.setAnimationDuration=function(t,e){var r=this.animationsMap[t];r&&(r.duration=e,r.fps=(r.end-r.start)/r.duration)},e.MorphBlendMesh.prototype.setAnimationWeight=function(t,e){var r=this.animationsMap[t];r&&(r.weight=e)},e.MorphBlendMesh.prototype.setAnimationTime=function(t,e){var r=this.animationsMap[t];r&&(r.time=e)},e.MorphBlendMesh.prototype.getAnimationTime=function(t){var e=0,r=this.animationsMap[t];return r&&(e=r.time),e},e.MorphBlendMesh.prototype.getAnimationDuration=function(t){var e=-1,r=this.animationsMap[t];return r&&(e=r.duration),e},e.MorphBlendMesh.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("THREE.MorphBlendMesh: animation["+t+"] undefined in .playAnimation()")},e.MorphBlendMesh.prototype.stopAnimation=function(t){var e=this.animationsMap[t];e&&(e.active=!1)},e.MorphBlendMesh.prototype.update=function(t){for(var r=0,n=this.animationsList.length;n>r;r++){var i=this.animationsList[r];if(i.active){var o=i.duration/i.length;i.time+=i.direction*t,i.mirroredLoop?(i.time>i.duration||i.time<0)&&(i.direction*=-1,i.time>i.duration&&(i.time=i.duration,i.directionBackwards=!0),i.time<0&&(i.time=0,i.directionBackwards=!1)):(i.time=i.time%i.duration,i.time<0&&(i.time+=i.duration));var a=i.start+e.Math.clamp(Math.floor(i.time/o),0,i.length-1),s=i.weight;a!==i.currentFrame&&(this.morphTargetInfluences[i.lastFrame]=0,this.morphTargetInfluences[i.currentFrame]=1*s,this.morphTargetInfluences[a]=0,i.lastFrame=i.currentFrame,i.currentFrame=a);var h=i.time%o/o;i.directionBackwards&&(h=1-h),i.currentFrame!==i.lastFrame?(this.morphTargetInfluences[i.currentFrame]=h*s,this.morphTargetInfluences[i.lastFrame]=(1-h)*s):this.morphTargetInfluences[i.currentFrame]=s}}},t.THREE=e}.apply(t,arguments)})}(this),function(){function t(r,n){if(r=r?r:"",n=n||{},r instanceof t)return r;if(!(this instanceof t))return new t(r,n);var i=e(r);this._originalInput=r,this._r=i.r,this._g=i.g,this._b=i.b,this._a=i.a,this._roundA=B(100*this._a)/100,this._format=n.format||i.format,this._gradientType=n.gradientType,this._r<1&&(this._r=B(this._r)),this._g<1&&(this._g=B(this._g)),this._b<1&&(this._b=B(this._b)),this._ok=i.ok,this._tc_id=I++}function e(t){var e={r:0,g:0,b:0},n=1,o=!1,s=!1;return"string"==typeof t&&(t=D(t)),"object"==typeof t&&(t.hasOwnProperty("r")&&t.hasOwnProperty("g")&&t.hasOwnProperty("b")?(e=r(t.r,t.g,t.b),o=!0,s="%"===String(t.r).substr(-1)?"prgb":"rgb"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("v")?(t.s=P(t.s),t.v=P(t.v),e=a(t.h,t.s,t.v),o=!0,s="hsv"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("l")&&(t.s=P(t.s),t.l=P(t.l),e=i(t.h,t.s,t.l),o=!0,s="hsl"),t.hasOwnProperty("a")&&(n=t.a)),n=S(n),{ok:o,format:t.format||s,r:V(255,G(e.r,0)),g:V(255,G(e.g,0)),b:V(255,G(e.b,0)),a:n}}function r(t,e,r){return{r:255*M(t,255),g:255*M(e,255),b:255*M(r,255)}}function n(t,e,r){t=M(t,255),e=M(e,255),r=M(r,255);var n,i,o=G(t,e,r),a=V(t,e,r),s=(o+a)/2;if(o==a)n=i=0;else{var h=o-a;switch(i=s>.5?h/(2-o-a):h/(o+a),o){case t:n=(e-r)/h+(r>e?6:0);break;case e:n=(r-t)/h+2;break;case r:n=(t-e)/h+4}n/=6}return{h:n,s:i,l:s}}function i(t,e,r){function n(t,e,r){return 0>r&&(r+=1),r>1&&(r-=1),1/6>r?t+6*(e-t)*r:.5>r?e:2/3>r?t+(e-t)*(2/3-r)*6:t}var i,o,a;if(t=M(t,360),e=M(e,100),r=M(r,100),0===e)i=o=a=r;else{var s=.5>r?r*(1+e):r+e-r*e,h=2*r-s;i=n(h,s,t+1/3),o=n(h,s,t),a=n(h,s,t-1/3)}return{r:255*i,g:255*o,b:255*a}}function o(t,e,r){t=M(t,255),e=M(e,255),r=M(r,255);var n,i,o=G(t,e,r),a=V(t,e,r),s=o,h=o-a;if(i=0===o?0:h/o,o==a)n=0;else{switch(o){case t:n=(e-r)/h+(r>e?6:0);break;case e:n=(r-t)/h+2;break;case r:n=(t-e)/h+4}n/=6}return{h:n,s:i,v:s}}function a(t,e,r){t=6*M(t,360),e=M(e,100),r=M(r,100);var n=U.floor(t),i=t-n,o=r*(1-e),a=r*(1-i*e),s=r*(1-(1-i)*e),h=n%6,u=[r,a,o,o,s,r][h],c=[s,r,r,a,o,o][h],l=[o,o,s,r,r,a][h];return{r:255*u,g:255*c,b:255*l}}function s(t,e,r,n){var i=[R(B(t).toString(16)),R(B(e).toString(16)),R(B(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function h(t,e,r,n){var i=[R(L(n)),R(B(t).toString(16)),R(B(e).toString(16)),R(B(r).toString(16))];return i.join("")}function u(e,r){r=0===r?0:r||10;var n=t(e).toHsl();return n.s-=r/100,n.s=T(n.s),t(n)}function c(e,r){r=0===r?0:r||10;var n=t(e).toHsl();return n.s+=r/100,n.s=T(n.s),t(n)}function l(e){return t(e).desaturate(100)}function p(e,r){r=0===r?0:r||10;var n=t(e).toHsl();return n.l+=r/100,n.l=T(n.l),t(n)}function f(e,r){r=0===r?0:r||10;var n=t(e).toRgb();return n.r=G(0,V(255,n.r-B(255*-(r/100)))),n.g=G(0,V(255,n.g-B(255*-(r/100)))),n.b=G(0,V(255,n.b-B(255*-(r/100)))),t(n)}function d(e,r){r=0===r?0:r||10;var n=t(e).toHsl();return n.l-=r/100,n.l=T(n.l),t(n)}function m(e,r){var n=t(e).toHsl(),i=(n.h+r)%360;return n.h=0>i?360+i:i,t(n)}function g(e){var r=t(e).toHsl();return r.h=(r.h+180)%360,t(r)}function y(e){var r=t(e).toHsl(),n=r.h;return[t(e),t({h:(n+120)%360,s:r.s,l:r.l}),t({h:(n+240)%360,s:r.s,l:r.l})]}function v(e){var r=t(e).toHsl(),n=r.h;return[t(e),t({h:(n+90)%360,s:r.s,l:r.l}),t({h:(n+180)%360,s:r.s,l:r.l}),t({h:(n+270)%360,s:r.s,l:r.l})]}function _(e){var r=t(e).toHsl(),n=r.h;return[t(e),t({h:(n+72)%360,s:r.s,l:r.l}),t({h:(n+216)%360,s:r.s,l:r.l})]}function x(e,r,n){r=r||6,n=n||30;var i=t(e).toHsl(),o=360/n,a=[t(e)];for(i.h=(i.h-(o*r>>1)+720)%360;--r;)i.h=(i.h+o)%360,a.push(t(i));return a}function b(e,r){r=r||6;for(var n=t(e).toHsv(),i=n.h,o=n.s,a=n.v,s=[],h=1/r;r--;)s.push(t({h:i,s:o,v:a})),a=(a+h)%1;return s}function w(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}function S(t){return t=parseFloat(t),(isNaN(t)||0>t||t>1)&&(t=1),t}function M(t,e){C(t)&&(t="100%");var r=A(t);return t=V(e,G(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),U.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function T(t){return V(1,G(0,t))}function E(t){return parseInt(t,16)}function C(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)}function A(t){return"string"==typeof t&&-1!=t.indexOf("%")}function R(t){return 1==t.length?"0"+t:""+t}function P(t){return 1>=t&&(t=100*t+"%"),t}function L(t){return Math.round(255*parseFloat(t)).toString(16)}function O(t){return E(t)/255}function D(t){t=t.replace(F,"").replace(N,"").toLowerCase();var e=!1;if(H[t])t=H[t],e=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=W.rgb.exec(t))?{r:r[1],g:r[2],b:r[3]}:(r=W.rgba.exec(t))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=W.hsl.exec(t))?{h:r[1],s:r[2],l:r[3]}:(r=W.hsla.exec(t))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=W.hsv.exec(t))?{h:r[1],s:r[2],v:r[3]}:(r=W.hsva.exec(t))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=W.hex8.exec(t))?{a:O(r[1]),r:E(r[2]),g:E(r[3]),b:E(r[4]),format:e?"name":"hex8"}:(r=W.hex6.exec(t))?{r:E(r[1]),g:E(r[2]),b:E(r[3]),format:e?"name":"hex"}:(r=W.hex3.exec(t))?{r:E(r[1]+""+r[1]),g:E(r[2]+""+r[2]),b:E(r[3]+""+r[3]),format:e?"name":"hex"}:!1}function k(t){var e,r;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),r=(t.size||"small").toLowerCase(),"AA"!==e&&"AAA"!==e&&(e="AA"),"small"!==r&&"large"!==r&&(r="small"),{level:e,size:r}}var F=/^[\s,#]+/,N=/\s+$/,I=0,U=Math,B=U.round,V=U.min,G=U.max,z=U.random;t.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t,e,r,n,i,o,a=this.toRgb();return t=a.r/255,e=a.g/255,r=a.b/255,n=.03928>=t?t/12.92:Math.pow((t+.055)/1.055,2.4),i=.03928>=e?e/12.92:Math.pow((e+.055)/1.055,2.4),o=.03928>=r?r/12.92:Math.pow((r+.055)/1.055,2.4),.2126*n+.7152*i+.0722*o},setAlpha:function(t){return this._a=S(t),this._roundA=B(100*this._a)/100,this},toHsv:function(){var t=o(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=o(this._r,this._g,this._b),e=B(360*t.h),r=B(100*t.s),n=B(100*t.v);return 1==this._a?"hsv("+e+", "+r+"%, "+n+"%)":"hsva("+e+", "+r+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var t=n(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=n(this._r,this._g,this._b),e=B(360*t.h),r=B(100*t.s),i=B(100*t.l);return 1==this._a?"hsl("+e+", "+r+"%, "+i+"%)":"hsla("+e+", "+r+"%, "+i+"%, "+this._roundA+")"},toHex:function(t){return s(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return h(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:B(this._r),g:B(this._g),b:B(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+B(this._r)+", "+B(this._g)+", "+B(this._b)+")":"rgba("+B(this._r)+", "+B(this._g)+", "+B(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:B(100*M(this._r,255))+"%",g:B(100*M(this._g,255))+"%",b:B(100*M(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+B(100*M(this._r,255))+"%, "+B(100*M(this._g,255))+"%, "+B(100*M(this._b,255))+"%)":"rgba("+B(100*M(this._r,255))+"%, "+B(100*M(this._g,255))+"%, "+B(100*M(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:j[s(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var r="#"+h(this._r,this._g,this._b,this._a),n=r,i=this._gradientType?"GradientType = 1, ":"";if(e){var o=t(e);n=o.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+r+",endColorstr="+n+")"},toString:function(t){var e=!!t;t=t||this._format;var r=!1,n=this._a<1&&this._a>=0,i=!e&&n&&("hex"===t||"hex6"===t||"hex3"===t||"name"===t);return i?"name"===t&&0===this._a?this.toName():this.toRgbString():("rgb"===t&&(r=this.toRgbString()),"prgb"===t&&(r=this.toPercentageRgbString()),("hex"===t||"hex6"===t)&&(r=this.toHexString()),"hex3"===t&&(r=this.toHexString(!0)),"hex8"===t&&(r=this.toHex8String()),"name"===t&&(r=this.toName()),"hsl"===t&&(r=this.toHslString()),"hsv"===t&&(r=this.toHsvString()),r||this.toHexString())},_applyModification:function(t,e){var r=t.apply(null,[this].concat([].slice.call(e)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(p,arguments)},brighten:function(){return this._applyModification(f,arguments)},darken:function(){return this._applyModification(d,arguments)},desaturate:function(){return this._applyModification(u,arguments)},saturate:function(){return this._applyModification(c,arguments)},greyscale:function(){return this._applyModification(l,arguments)},spin:function(){return this._applyModification(m,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(x,arguments)},complement:function(){return this._applyCombination(g,arguments)},monochromatic:function(){return this._applyCombination(b,arguments)},splitcomplement:function(){return this._applyCombination(_,arguments)},triad:function(){return this._applyCombination(y,arguments)},tetrad:function(){return this._applyCombination(v,arguments)}},t.fromRatio=function(e,r){if("object"==typeof e){var n={};for(var i in e)e.hasOwnProperty(i)&&("a"===i?n[i]=e[i]:n[i]=P(e[i]));e=n}return t(e,r)},t.equals=function(e,r){return e&&r?t(e).toRgbString()==t(r).toRgbString():!1},t.random=function(){return t.fromRatio({r:z(),g:z(),b:z()})},t.mix=function(e,r,n){n=0===n?0:n||50;var i,o=t(e).toRgb(),a=t(r).toRgb(),s=n/100,h=2*s-1,u=a.a-o.a;i=h*u==-1?h:(h+u)/(1+h*u),i=(i+1)/2;var c=1-i,l={r:a.r*i+o.r*c,g:a.g*i+o.g*c,b:a.b*i+o.b*c,a:a.a*s+o.a*(1-s)};return t(l)},t.readability=function(e,r){var n=t(e),i=t(r);return(Math.max(n.getLuminance(),i.getLuminance())+.05)/(Math.min(n.getLuminance(),i.getLuminance())+.05)},t.isReadable=function(e,r,n){var i,o,a=t.readability(e,r);switch(o=!1,i=k(n),i.level+i.size){case"AAsmall":case"AAAlarge":o=a>=4.5;break;case"AAlarge":o=a>=3;break;case"AAAsmall":o=a>=7}return o},t.mostReadable=function(e,r,n){var i,o,a,s,h=null,u=0;n=n||{},o=n.includeFallbackColors,a=n.level,s=n.size;for(var c=0;c<r.length;c++)i=t.readability(e,r[c]),i>u&&(u=i,h=t(r[c]));return t.isReadable(e,h,{level:a,size:s})||!o?h:(n.includeFallbackColors=!1,t.mostReadable(e,["#fff","#000"],n))};var H=t.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},j=t.hexNames=w(H),W=function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",r="(?:"+e+")|(?:"+t+")",n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+i),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();"undefined"!=typeof module&&module.exports?module.exports=t:"function"==typeof define&&define.amd?define("tinycolor",[],function(){return t}):window.tinycolor=t}(),define("effect",["exports","module"],function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(){r(this,t)}return t.prototype.update=function(){},t.prototype.destroy=function(){},t}();e.exports=n}),define("effects/cube/cube",["exports","module","threejs","effect"],function(t,e,r,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=i(r),s=(i(n),void 0),h=void 0,u=void 0,c=void 0,l=void 0,p=function(){function t(e){o(this,t),h=e,s=h.gl.scene,u=new a["default"].BoxGeometry(150,150,150);for(var r=0;r<u.faces.length;r+=2){var n=16777215*Math.random();u.faces[r].color.setHex(n),u.faces[r+1].color.setHex(n)}l=new a["default"].MeshBasicMaterial({vertexColors:a["default"].FaceColors,overdraw:.5}),c=new a["default"].Mesh(u,l),s.add(c),h.gl.camera.lookAt(c.position),h.gl.cube=c,this.prev_dsum=0}return t.prototype.update=function(t){for(var e=0,r=0;r<t.depth.length;r+=1)e+=t.depth[r];var n=(e-this.prev_dsum)/5e7;c.rotation.y+=n,this.prev_dsum=e},t.prototype.destroy=function(){},t}();e.exports=p}),define("handtracking",["exports","module"],function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=600,i=700,o=.4,a=function(){function t(e){r(this,t),e.hand={},this.prevhand={x:0,y:0},this.avgx=0,this.avgy=0,e.conf.gui.add(this,"avgx").name("Hand x").listen(),e.conf.gui.add(this,"avgy").name("Hand y").listen()}return t.prototype.update=function(t){for(var e=0,r=0,a=0,s=0;s<t.depth.length;++s){var h=s%t.conf.kinect.res.width,u=t.conf.kinect.res.height-Math.floor(s/t.conf.kinect.res.width);t.depth[s]>n&&t.depth[s]<i&&(e+=h,r+=u,a+=1)}a>0&&(this.avgx=t.conf.kinect.res.width-e/a,this.avgy=r/a,this.rescale(t),t.hand.x=this.prevhand.x*(1-o)+this.avgx*o,t.hand.y=this.prevhand.y*(1-o)+this.avgy*o,this.prevhand.x=t.hand.x,this.prevhand.y=t.hand.y)},t.prototype.rescale=function(t){},t.prototype.destroy=function(t){delete t.hand},t}();e.exports=a}),define("effects/handtracking2d/handtracking2d",["exports","module","handtracking"],function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(r),s=function(t){function e(){i(this,e),t.apply(this,arguments)}return o(e,t),e.prototype.rescale=function(t){this.avgx*=window.innerWidth/t.conf.kinect.res.width,this.avgy=t.conf.kinect.res.height-this.avgy,this.avgy*=window.innerHeight/t.conf.kinect.res.height},e}(a["default"]);e.exports=s}),define("effects/handtracking3d/handtracking3d",["exports","module","handtracking"],function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(r),s=function(t){function e(){i(this,e),t.apply(this,arguments)}return o(e,t),e.prototype.rescale=function(t){this.avgx-=t.conf.kinect.res.width/2,this.avgy-=t.conf.kinect.res.height/2},e}(a["default"]);e.exports=s}),define("text",["module"],function(t){"use strict";var e,r,n,i,o,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,h=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,u="undefined"!=typeof location&&location.href,c=u&&location.protocol&&location.protocol.replace(/\:/,""),l=u&&location.hostname,p=u&&(location.port||void 0),f={},d=t.config&&t.config()||{};return e={version:"2.0.14",strip:function(t){if(t){t=t.replace(s,"");var e=t.match(h);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var t,e,r;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;3>e;e+=1){r=a[e];try{t=new ActiveXObject(r)}catch(n){}if(t){a=[r];break}}return t},parseName:function(t){var e,r,n,i=!1,o=t.lastIndexOf("."),a=0===t.indexOf("./")||0===t.indexOf("../");return-1!==o&&(!a||o>1)?(e=t.substring(0,o),r=t.substring(o+1)):e=t,n=r||e,o=n.indexOf("!"),-1!==o&&(i="strip"===n.substring(o+1),n=n.substring(0,o),r?r=n:e=n),{moduleName:e,ext:r,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,r,n,i){var o,a,s,h=e.xdRegExp.exec(t);return h?(o=h[2],a=h[3],a=a.split(":"),s=a[1],a=a[0],!(o&&o!==r||a&&a.toLowerCase()!==n.toLowerCase()||(s||a)&&s!==i)):!0},finishLoad:function(t,r,n,i){n=r?e.strip(n):n,d.isBuild&&(f[t]=n),i(n)},load:function(t,r,n,i){if(i&&i.isBuild&&!i.inlineText)return void n();d.isBuild=i&&i.isBuild;var o=e.parseName(t),a=o.moduleName+(o.ext?"."+o.ext:""),s=r.toUrl(a),h=d.useXhr||e.useXhr;return 0===s.indexOf("empty:")?void n():void(!u||h(s,c,l,p)?e.get(s,function(r){e.finishLoad(t,o.strip,r,n);
},function(t){n.error&&n.error(t)}):r([a],function(t){e.finishLoad(o.moduleName+"."+o.ext,o.strip,t,n)}))},write:function(t,r,n,i){if(f.hasOwnProperty(r)){var o=e.jsEscape(f[r]);n.asModule(t+"!"+r,"define(function () { return '"+o+"';});\n")}},writeFile:function(t,r,n,i,o){var a=e.parseName(r),s=a.ext?"."+a.ext:"",h=a.moduleName+s,u=n.toUrl(a.moduleName+s)+".js";e.load(h,n,function(r){var n=function(t){return i(u,t)};n.asModule=function(t,e){return i.asModule(t,u,e)},e.write(t,h,n,o)},o)}},"node"===d.env||!d.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(r=require.nodeRequire("fs"),e.get=function(t,e,n){try{var i=r.readFileSync(t,"utf8");"\ufeff"===i[0]&&(i=i.substring(1)),e(i)}catch(o){n&&n(o)}}):"xhr"===d.env||!d.env&&e.createXhr()?e.get=function(t,r,n,i){var o,a=e.createXhr();if(a.open("GET",t,!0),i)for(o in i)i.hasOwnProperty(o)&&a.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(a,t),a.onreadystatechange=function(e){var i,o;4===a.readyState&&(i=a.status||0,i>399&&600>i?(o=new Error(t+" HTTP status: "+i),o.xhr=a,n&&n(o)):r(a.responseText),d.onXhrComplete&&d.onXhrComplete(a,t))},a.send(null)}:"rhino"===d.env||!d.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,e){var r,n,i="utf-8",o=new java.io.File(t),a=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),i)),h="";try{for(r=new java.lang.StringBuffer,n=s.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&r.append(n);null!==(n=s.readLine());)r.append(a),r.append(n);h=String(r.toString())}finally{s.close()}e(h)}:("xpconnect"===d.env||!d.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in n,e.get=function(t,e){var r,a,s,h={};o&&(t=t.replace(/\//g,"\\")),s=new FileUtils.File(t);try{r=n["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),r.init(s,1,0,!1),a=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),a.init(r,"utf-8",r.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(r.available(),h),a.close(),r.close(),e(h.value)}catch(u){throw new Error((s&&s.path||"")+": "+u)}}),e}),define("text!effects/particles/shaders/particle.frag",[],function(){return"#define PI2 6.283185\n#define MIN_Z 440.0\n#define MAX_Z 1100.0\n\n#define NEAR_Z 760.0\n#define MID_Z ((MAX_Z + NEAR_Z) / 2.0)\n#define FAR_Z 1100.0\n\n#define MIN_HAND_Z 600.0\n#define MAX_HAND_Z 700.0\n\nuniform vec3 near_color;\nuniform vec3 mid_color;\nuniform vec3 far_color;\nuniform sampler2D texture;\n\nvarying vec3 pos;\nvarying float z;\n\nvec3 color;\nfloat v;\n\nfloat lerp(float n, float low, float high) {\n    return clamp((n - low) / (high - low), 0.0, 1.0);\n}\n\nvoid main() {\n\n    float alpha = 1.0;\n\n    if ( z <= MID_Z ) {\n        float ns = lerp(z, NEAR_Z, MID_Z);\n        color = ( 1.0-ns ) * near_color + ns * mid_color;\n    }\n    else {\n        float fs = lerp(z, MID_Z, FAR_Z);\n        color = ( 1.0-fs ) * mid_color + fs * far_color;\n    }\n\n    if ( z > MAX_Z )\n        alpha = 0.0;\n\n    gl_FragColor = vec4(color, alpha) * texture2D( texture, gl_PointCoord );\n\n    /* Interpolate from near color to far color. */\n\n    /* float near_factor  = min((pos.z - MIN_Z) / (MAX_Z - MIN_Z) - DEPTH_COLOR_OFFSET, 1.0); */\n    /* float far_factor = 1.0 - near_factor; */\n\n    /* cycler = vec4(near_factor * near_color + far_factor * far_color, 1.0); */\n\n    /* cycler.a = pos.z; */\n\n    /* if (pos.z > MAX_Z) { */\n    /*     cycler = vec4(1.0, 1.0, 1.0, 0.0); */\n    /* } */\n\n    /* Cycle through colors. */\n\n    /* v = vColor * PI2; */\n    /* cycler = vec3(v*1.0/3.0, v*2.0/3.0, v); */\n    /* cycler = cos(cycler); */\n    /* cycler += 1.0; */\n    /* cycler /= 2.0; */\n\n    /* gl_FragColor = cycler * texture2D( texture, gl_PointCoord ); */\n    /* gl_FragColor = cycler; //cycler * texture2D( texture, gl_PointCoord ); */\n\n}\n"}),define("text!effects/particles/shaders/vertex.vert",[],function(){return"#define MIN_Z 440.0\n#define MAX_Z 1100.0\n\nuniform float particle_size;\n\nvarying vec3 pos;\nvarying float z;\n\nvoid main() {\n\n    pos = position;\n    z = pos.z;\n    if (pos.z <= MAX_Z) {\n        pos.z = 200.0;\n    }\n\n    gl_Position  = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n    gl_PointSize = particle_size;\n\n}\n\n"}),define("effects/particles/particles",["exports","module","threejs","effect","text!./shaders/particle.frag","text!./shaders/vertex.vert"],function(t,e,r,n,i,o){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t){this.name="NaNPositionError",this.message=t||""}var u=Function.prototype.bind,c=a(r),l=(a(n),function(){function t(e){s(this,t),this.gfx=e,this.scene=this.gfx.gl.scene,this.camera=this.gfx.gl.camera,this.conf=this.gfx.conf,this.size=2,this.default_colors={near_color:"#4C2A3B",mid_color:"#36C6A2",far_color:"#EFE2BF"},this.gfx.gl.renderer.setClearColor(new c["default"].Color(this.default_colors.far_color)),this.gfx.gl.particles=this,this.gfx.conf.gui.addColor(this.default_colors,"near_color").listen().onChange(this.set_near_color.bind(this)),this.gfx.conf.gui.addColor(this.default_colors,"mid_color").listen().onChange(this.set_mid_color.bind(this)),this.gfx.conf.gui.addColor(this.default_colors,"far_color").listen().onChange(this.set_far_color.bind(this)),this.gfx.conf.gui.add(this,"size",1,64).step(1).onChange(this.set_particle_size.bind(this)),this.add_particle_system()}return t.prototype.update=function(t){this.update_positions(t.depth)},t.prototype.destroy=function(){},t.prototype.get_uniforms=function(){return{near_color:{type:"c",value:new c["default"].Color(this.default_colors.near_color)},mid_color:{type:"c",value:new c["default"].Color(this.default_colors.mid_color)},far_color:{type:"c",value:new c["default"].Color(this.default_colors.far_color)},particle_size:{type:"f",value:this.size},texture:{type:"t",value:c["default"].ImageUtils.loadTexture("images/circle.png")}}},t.prototype.get_attributes=function(){return{}},t.prototype.add_particle_system=function(){this.geometry=new c["default"].BufferGeometry,this.material=new c["default"].ShaderMaterial({uniforms:this.get_uniforms(),attributes:this.get_attributes(),vertexShader:o,fragmentShader:i,blending:c["default"].NormalBlending,depthTest:!1,transparent:!0}),this.add_particle_system_attributes(this.geometry,307200),this.system=new c["default"].PointCloud(this.geometry,this.material),this.system.sortParticles=!0,this.system.rotateY(Math.PI),this.gfx.gl.scene.add(this.system)},t.prototype.add_particle_system_attributes=function(t,e){this.positions=this.get_initial_particle_positions(e),this.colors=new Float32Array(e),t.addAttribute("position",new c["default"].BufferAttribute(this.positions,3))},t.prototype.get_initial_particle_positions=function(t){this.positions=new Float32Array(3*t);for(var e=void 0,r=void 0,n=void 0,i=this.conf.kinect.res.width,o=this.conf.kinect.res.height,a=i/2,s=o/2,h=0;h<this.positions.length;h+=3)n=Math.floor(h/3),e=n%this.conf.kinect.res.width,r=this.conf.kinect.res.height-Math.floor(n/this.conf.kinect.res.width),this.positions[h]=e-a,this.positions[h+1]=r-s,this.positions[h+2]=0;return this.positions},t.prototype.update_positions=function(t){for(var e=this.geometry.attributes.position.array,r=0,n=0,i=2;i<e.length;i+=3)n=Math.floor(i/3),r=t[n],e[i]=r;this.geometry.attributes.position.needsUpdate=!0},t.prototype.set_color=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;e>n;n++)r[n-1]=arguments[n];var i=new(u.apply(c["default"].Color,[null].concat(r)));this.material.uniforms[t].value=i,this.default_colors[t]="#"+i.getHexString(),"far_color"===t&&this.gfx.gl.renderer.setClearColor(i)},t.prototype.set_near_color=function(){for(var t=arguments.length,e=Array(t),r=0;t>r;r++)e[r]=arguments[r];this.set_color.apply(this,["near_color"].concat(e))},t.prototype.set_mid_color=function(){for(var t=arguments.length,e=Array(t),r=0;t>r;r++)e[r]=arguments[r];this.set_color.apply(this,["mid_color"].concat(e))},t.prototype.set_far_color=function(){for(var t=arguments.length,e=Array(t),r=0;t>r;r++)e[r]=arguments[r];this.set_color.apply(this,["far_color"].concat(e))},t.prototype.set_particle_size=function(t){this.material.uniforms.particle_size.value=t},t}());e.exports=l,h.prototype=Error.prototype}),define("effects/torus/torus",["exports","module","threejs","effect","lodash"],function(t,e,r,n,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=o(r),h=(o(n),void 0),u=void 0,c=void 0,l=void 0,p=void 0,f=function(){function t(e){a(this,t),u=e,h=u.gl.scene,c=new s["default"].TorusKnotGeometry(150,30,100,16),p=new s["default"].MeshBasicMaterial({vertexColors:s["default"].FaceColors,overdraw:.5}),l=new s["default"].Mesh(c,p),h.add(l),u.gl.camera.lookAt(l.position),console.log(l.position),u.gl.material=p,u.gl.geometry=c,u.gl.torus=l}return t.prototype.update=function(t){},t.prototype.destroy=function(){},t}();e.exports=f}),define("effects",["exports","./effects/cube/cube","./effects/handtracking2d/handtracking2d","./effects/handtracking3d/handtracking3d","./effects/particles/particles","./effects/torus/torus"],function(t,e,r,n,i,o){"use strict";function a(t){return t&&t.__esModule?t["default"]:t}t.__esModule=!0,t.cube=a(e),t.handtracking2d=a(r),t.handtracking3d=a(n),t.particles=a(i),t.torus=a(o)}),define("mod",["exports","module","effects","lodash"],function(t,e,r,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(e){i(this,t),this.author="",this.title="",this.effects=[],this.gfx=e}return t.prototype.update=function(t){n.invoke(this.effects,"update",t)},t.prototype.destroy=function(t){for(var e=t.conf.gui.__controllers.length-1;e>=0;e-=1)t.conf.gui.remove(t.conf.gui.__controllers[e])},t.prototype.add_effect=function(t){var e=new r[t](this.gfx);this.effects.push(e)},t}();e.exports=o}),define("text!mods/colorcycle/shaders/particle.frag",[],function(){return"#define PI2 6.283185\n#define MIN_Z 440.0\n#define MAX_Z 1100.0\n\n#define NEAR_Z 760.0\n#define MID_Z ((MAX_Z + NEAR_Z) / 2.0)\n#define FAR_Z 1100.0\n\nuniform vec3 near_color;\nuniform vec3 mid_color;\nuniform vec3 far_color;\nuniform sampler2D texture;\n\nvarying vec3 pos;\nvarying float z;\n\nvec3 color;\nfloat v;\n\nfloat lerp(float n, float low, float high) {\n    return clamp((n - low) / (high - low), 0.0, 1.0);\n}\n\nvoid main() {\n\n    float alpha = 1.0;\n\n    if ( z <= MID_Z ) {\n        float ns = lerp(z, NEAR_Z, MID_Z);\n        color = ( 1.0-ns ) * near_color + ns * mid_color;\n    }\n    else { // z must be between MID_Z and FAR_Z\n        float fs = lerp(z, MID_Z, FAR_Z);\n        color = ( 1.0-fs ) * mid_color + fs * far_color;\n    }\n\n    if ( z > MAX_Z )\n        alpha = 0.0;\n\n    gl_FragColor = vec4(color, alpha);\n\n}\n\n"}),define("text!mods/colorcycle/shaders/vertex.vert",[],function(){return"#define MIN_Z 440.0\n#define MAX_Z 1100.0\n\nuniform float particle_size;\n\nvarying vec3 pos;\nvarying float z;\n\nvoid main() {\n\n    pos = position;\n    z = pos.z;\n    if (pos.z <= MAX_Z) {\n        pos.z = 200.0;\n        /* pos.z = MAX_Z - pos.z + MIN_Z; */\n    }\n\n    gl_Position  = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n    /* gl_Position.z /= 4.0; // moved /4 scale here instead of CPU */\n    gl_PointSize = particle_size;\n\n}\n"}),define("mods/colorcycle/colorcycle",["exports","module","threejs","tinycolor","mod","text!./shaders/particle.frag","text!./shaders/vertex.vert"],function(t,e,r,n,i,o,a){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=(s(r),s(n)),l=s(i),p=function(t){function e(r){h(this,e),t.call(this,r),r.set(this,"3d"),this.author="Michael Clayton",this.title="Color Cycle",this.add_effect("particles"),r.gl.particles.material.vertexShader=a,r.gl.particles.material.fragmentShader=o,r.gl.particles.set_near_color("#e60073"),r.gl.particles.set_mid_color("#004116"),r.gl.particles.set_far_color("#110c00")}return u(e,t),e.prototype.update=function(e){var r=c["default"].fromRatio(e.gl.particles.material.uniforms.near_color.value),n=c["default"].fromRatio(e.gl.particles.material.uniforms.mid_color.value),i=c["default"].fromRatio(e.gl.particles.material.uniforms.far_color.value);r=r.spin(.6),n=n.spin(.6),i=i.spin(.6),e.gl.particles.set_near_color(r._r/255,r._g/255,r._b/255),e.gl.particles.set_mid_color(n._r/255,n._g/255,n._b/255),e.gl.particles.set_far_color(i._r/255,i._g/255,i._b/255),t.prototype.update.call(this,e)},e}(l["default"]);e.exports=p}),define("mods/cube/cube",["exports","module","mod"],function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(r),s=33792e4,h=function(t){function e(r){i(this,e),t.call(this,r),r.set(this,"3d"),this.author="Michael Clayton",this.title="Cube",this.add_effect("cube");for(var n=0;n<r.gl.cube.geometry.faces.length;n+=2){var o=16777215*Math.random();r.gl.cube.geometry.faces[n].color.setHex(o),r.gl.cube.geometry.faces[n+1].color.setHex(o)}this.spin=0}return o(e,t),e.prototype.update=function(e){for(var r=0,n=0,i=0;i<e.depth.length;i+=e.conf.kinect.res.width){for(var o=0;o<e.conf.kinect.res.width/2;++o)r+=e.depth[o];for(var o=e.conf.kinect.res.width/2;o<e.conf.kinect.res.width;++o)n+=e.depth[o]}r/=2*s,n/=2*s,this.spin=.99*this.spin+.01*(n-r),e.gl.cube.rotation.y+=this.spin,t.prototype.update.call(this,e)},e}(a["default"]);e.exports=h}),define("mods/example/example",["exports","module","threejs","mod"],function(t,e,r,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=i(r),h=i(n),u=function(t){function e(r){o(this,e),t.call(this,r),r.set(this,"3d"),this.author="Your Name",this.title="example";var n=new s["default"].BoxGeometry(150,150,150),i=new s["default"].MeshBasicMaterial({wireframe:!0});this.cube=new s["default"].Mesh(n,i),r.gl.scene.add(this.cube),r.gl.camera.lookAt(this.cube.position)}return a(e,t),e.prototype.update=function(e){this.cube.rotation.x+=.001,this.cube.rotation.y+=.01,this.cube.rotation.z+=1e-4,t.prototype.update.call(this,e)},e}(h["default"]);e.exports=u}),define("mods/example2d/example2d",["exports","module","threejs","mod"],function(t,e,r,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=(i(r),i(n)),h=function(t){function e(r){o(this,e),t.call(this,r),r.set(this,"2d"),this.add_effect("handtracking2d"),this.author="Your Name",this.title="example",background(255),fill(255),stroke(0)}return a(e,t),e.prototype.update=function(e){e.hand.x&&e.hand.y&&rect(e.hand.x,e.hand.y,60,60),t.prototype.update.call(this,e)},e}(s["default"]);e.exports=h}),define("mods/fish/utils.js",["exports"],function(t){"use strict";function e(t,e){return Math.floor(Math.random()*(e-t+1))+t}t.__esModule=!0,t.randomIntInclusive=e}),define("mods/fish/Sprite",["exports","module","mods/fish/utils.js"],function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(){n(this,t),this.id="Sprite-"+r.randomIntInclusive(1,1e3),this.img_path,this.img_height=0,this.img_width=0,this.x=0,this.y=0,this.img=null}return t.prototype.centerX=function(){return this.x+this.img_width/2},t.prototype.centerY=function(){return this.y+this.img_height/2},t.prototype.logInfo=function(){console.log("Sprite: "+this.id+" "+this.x+" "+this.y)},t}();e.exports=i}),define("mods/fish/consts.js",["exports"],function(t){"use strict";t.__esModule=!0;var e=0;t.LEFT=e;var r=1;t.RIGHT=r;var n="blue";t.BLUE=n;var i="red";t.RED=i;var o="purple";t.PURPLE=o;var a="gold";t.GOLD=a;var s="shark";t.SHARK=s;var h=10;t.HAND_IMG_SWAP_DELAY=h;var u=100;t.MESSAGE_FRAMES=u;var c=50;t.WAIT_SOUND_LOAD_FRAMES=c;var l=70;t.TIME_LIMIT=l;var p=10;t.HIGHSCORE_TIME=p}),define("mods/fish/FishSprite",["exports","module","mods/fish/Sprite","mods/fish/utils.js","mods/fish/consts.js"],function(t,e,r,n,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var h=o(r),u=function(t){function e(){a(this,e),t.call(this),this.max_speed=25,this.min_speed=2,this.speed=-10,this.direction=i.RIGHT,this.x=-1e3,this.y=500}return s(e,t),e.prototype.resetOffScreen=function(t,e){this.direction=n.randomIntInclusive(i.LEFT,i.RIGHT),this.direction==i.LEFT?this.x=n.randomIntInclusive(t+this.img_width+100+this.min_outer_x,t+this.max_outer_x):this.x=n.randomIntInclusive(0-this.max_outer_x,0-this.img_width-100-this.min_outer_x),this.setSpeed(),this.setImagePath(),this.y=n.randomIntInclusive(10,e-this.img_height)},e.prototype.logInfo=function(){console.log("FishSprite: "+this.id+" "+this.type+" "+this.x+" "+this.y+" "+this.speed)},e.prototype.setImagePath=function(){this.img_path="mods/fish/assets/fish_"+this.type+"_"+(this.direction==i.LEFT?"left":"right")+".png"},e.prototype.setSpeed=function(){var t=n.randomIntInclusive(this.min_speed,this.max_speed);this.direction==i.LEFT?this.speed=t:this.speed=-t},e}(h["default"]);e.exports=u}),define("mods/fish/BlueFishSprite",["exports","module","mods/fish/FishSprite","mods/fish/utils.js","mods/fish/consts.js"],function(t,e,r,n,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var h=o(r),u=function(t){function e(){a(this,e),t.call(this),this.type=i.BLUE,this.max_outer_x=600,this.min_outer_x=0,this.img_height=222,this.img_width=299,this.max_speed=6,this.min_speed=2,this.coin_num=1}return s(e,t),e}(h["default"]);e.exports=u}),define("mods/fish/RedFishSprite",["exports","module","mods/fish/FishSprite","mods/fish/utils.js","mods/fish/consts.js"],function(t,e,r,n,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var h=o(r),u=function(t){function e(){a(this,e),t.call(this),this.type=i.RED,this.max_outer_x=2e3,this.min_outer_x=0,this.img_height=222,this.img_width=299,this.max_speed=18,this.min_speed=15,this.coin_num=5}return s(e,t),e}(h["default"]);e.exports=u}),define("mods/fish/GoldFishSprite",["exports","module","mods/fish/FishSprite","mods/fish/utils.js","mods/fish/consts.js"],function(t,e,r,n,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var h=o(r),u=function(t){function e(){a(this,e),t.call(this),this.type=i.GOLD,this.max_outer_x=8e3,this.min_outer_x=5e3,this.img_height=222,this.img_width=299,this.max_speed=16,this.min_speed=11,this.coin_num=10,this.value=1e3}return s(e,t),e}(h["default"]);e.exports=u}),define("mods/fish/PurpleFishSprite",["exports","module","mods/fish/FishSprite","mods/fish/utils.js","mods/fish/consts.js"],function(t,e,r,n,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var h=o(r),u=function(t){function e(){a(this,e),t.call(this),this.type=i.PURPLE,this.max_outer_x=2e3,this.min_outer_x=0,this.img_height=222,this.img_width=299,this.max_speed=14,this.min_speed=7,this.coin_num=2}return s(e,t),e}(h["default"]);e.exports=u}),define("mods/fish/SharkFishSprite",["exports","module","mods/fish/FishSprite","mods/fish/utils.js","mods/fish/consts.js"],function(t,e,r,n,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var h=o(r),u=function(t){function e(){a(this,e),t.call(this),this.type=i.SHARK,this.max_outer_x=8e3,this.min_outer_x=5e3,this.img_height=204,this.img_width=500,this.max_speed=20,this.min_speed=10,this.value=-100,this.coin_penalty=10}return s(e,t),e}(h["default"]);e.exports=u}),define("mods/fish/HandSprite",["exports","module","mods/fish/Sprite","mods/fish/consts.js"],function(t,e,r,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=i(r),h=function(t){function e(){o(this,e),t.call(this),this.img_path="mods/fish/assets/hand.png",this.img_height=299,this.img_width=282,this.recentSharkBite=!1,this.img_red_path="mods/fish/assets/hand_red.png",this.img_red=null,this.img_swap_count=n.HAND_IMG_SWAP_DELAY,this.is_red=!1,this.img_red_animated=this.img,this.toggle_frames=0}return a(e,t),e.prototype.setRed=function(){this.is_red=!0,this.img_red_animated=this.img_red},e.prototype.setYellow=function(){this.is_red=!1,this.img_red_animated=this.img},e.prototype.toggleRedAnimatedImg=function(){this.is_red?this.setYellow():this.setRed()},e.prototype.resetState=function(){this.recentSharkBite=!1,this.img_swap_count=n.HAND_IMG_SWAP_DELAY,this.setYellow()},e}(s["default"]);e.exports=h}),define("mods/fish/Particle",["exports","module"],function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function i(t,e,n){r(this,i),this.position=t,this.acceleration=e,this.velocity=n};e.exports=n}),define("mods/fish/CoinParticle",["exports","module","mods/fish/Particle"],function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(r),s=function(t){function e(r,n,o){i(this,e),t.call(this,r,n,o),this.value=200,this.img_height=196,this.img_width=200,this.x=r.x,this.y=r.y}return o(e,t),e.prototype.update=function(){this.velocity.add(this.acceleration),this.position.add(this.velocity),this.x=this.position.x,this.y=this.position.y},e}(a["default"]);e.exports=s}),define("mods/fish/ChestSprite",["exports","module","mods/fish/Sprite"],function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(r),s=function(t){function e(){i(this,e),t.call(this),this.x=500,this.y=50,this.img_path="mods/fish/assets/chest.png",this.img_height=70,this.img_width=70}return o(e,t),e}(a["default"]);e.exports=s}),define("mods/fish/fish",["exports","module","threejs","mod","mods/fish/Sprite","mods/fish/FishSprite","mods/fish/BlueFishSprite","mods/fish/RedFishSprite","mods/fish/GoldFishSprite","mods/fish/PurpleFishSprite","mods/fish/SharkFishSprite","mods/fish/HandSprite","mods/fish/CoinParticle","mods/fish/ChestSprite","mods/fish/consts.js"],function(t,e,r,n,i,o,a,s,h,u,c,l,p,f,d){"use strict";function m(t){return t&&t.__esModule?t:{"default":t}}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function v(t,e,r){console.log("changeFishes type: "+t+" "+e);for(var n=F.length-1;n>=0;n--){var i=F[n];i.type==t&&F.splice(n,1)}for(var n=0;e>n;n++){var o=new r;o.resetOffScreen(width,height),o.img=loadImage(o.img_path),o.logInfo(),F.push(o)}}var _,x,b,w,S,M,T,E=(m(r),m(n)),C=(m(i),m(o),m(a)),A=m(s),R=m(h),P=m(u),L=m(c),O=m(l),D=m(p),k=m(f),F=[],N=0,I={enableApi:!0,apiHost:"localhost",numSharks:2,numGolden:2,numBlue:3,numPurple:2,numRed:1,fishSpeed:1},U=d.WAIT_SOUND_LOAD_FRAMES,B=!1,V=function(t){function e(r){g(this,e),t.call(this,r),r.set(this,"2d"),r.conf.gui.add(I,"enableApi").name("Use API"),r.conf.gui.add(I,"apiHost").name("API Host"),this.addFishSliderGUI(r,"numSharks","Num Sharks",d.SHARK,L["default"]),this.addFishSliderGUI(r,"numGolden","Num Golden",d.GOLD,R["default"]),this.addFishSliderGUI(r,"numBlue","Num Blue",d.BLUE,C["default"]),this.addFishSliderGUI(r,"numPurple","Num Purple",d.PURPLE,P["default"]),this.addFishSliderGUI(r,"numRed","Num Red",d.RED,A["default"]),r.conf.gui.add(I,"fishSpeed",0,10).step(.1).name("Fish Speed"),this.add_effect("handtracking2d"),this.author="Jared Sprague",this.title="Fish",B=!1,U=d.WAIT_SOUND_LOAD_FRAMES,this.resetGameVars(),this.hand=new O["default"],this.chest=new k["default"],v(d.SHARK,I.numSharks,L["default"]),v(d.GOLD,I.numGolden,R["default"]),v(d.BLUE,I.numBlue,C["default"]),v(d.PURPLE,I.numPurple,P["default"]),v(d.RED,I.numRed,A["default"]),this.initFish(),this.water_img=loadImage("mods/fish/assets/underwater1.jpg"),this.hand.img=loadImage(this.hand.img_path),this.hand.img_red=loadImage(this.hand.img_red_path),this.hand.resetState(),this.coin_img=loadImage("mods/fish/assets/coin.png"),this.chest.img=loadImage(this.chest.img_path),this.chest.x=width/2-150,this.chest.y=5,_=loadSound("mods/fish/assets/sounds/underwater_amp.ogg"),x=loadSound("mods/fish/assets/sounds/bite.ogg"),b=loadSound("mods/fish/assets/sounds/whscream.ogg"),w=loadSound("mods/fish/assets/sounds/coin.ogg"),S=loadSound("mods/fish/assets/sounds/level_up.ogg"),M=loadSound("mods/fish/assets/sounds/over9000.ogg"),T=loadSound("mods/fish/assets/sounds/cheer.ogg"),console.log("Catch Some Fish!"),console.log("height: "+height),console.log("width: "+width),this.drawStaticElements()}return y(e,t),e.prototype.update=function(e){if(t.prototype.update.call(this,e),this.totalFrames++,this.remaining=this.getTimeRemaining(e),clear(),this.drawStaticElements(),U>0)return void U--;if(B||(_.loop(),B=!0),this.remaining-d.HIGHSCORE_TIME<=30&&"none"==this.gameEndingWarning)this.gameEndingWarning="display";else{if(this.remaining<=d.HIGHSCORE_TIME&&"none"==this.showHighScoreTable&&I.enableApi)return _.stop(),T.play(),this.postScore(),this.getHighScores(),this.showHighScoreTable="display",void this.displayMessages();if("display"==this.showHighScoreTable)return this.displayMessages(),void(!e.conf.timer.enabled&&this.remaining<=0&&this.resetGameState())}this.updateFish(),this.updateCoins(this.coins,function(t){return t.y>0-t.img_height},this.updateScore),this.updateCoins(this.negativeCoins,function(t){return t.y<height},function(){}),this.updateHand(e);for(var r=0;r<F.length;++r){var n=F[r];if(this.detectIntersect(n))if(n.type==d.SHARK)this.handleSharkBite(n);else{n.type==d.GOLD?S.play():w.play();for(var i=0;i<n.coin_num;i++){var o=this.createCoinParticle(n.x,n.y,0,-.2,random(-5,5),random(-.5,3.5));this.coins.push(o)}this.resetFish(n)}}this.drawScore(),this.displayMessages()},e.prototype.resetGameVars=function(){N=0,this.coins=[],this.negativeCoins=[],this.over9000AchievedState="none",this.gameEndingWarning="none",this.showHighScoreTable="none",this.displayMessageFrames=0,this.highScores=null,this.totalFrames=0,this.remaining=d.TIME_LIMIT},e.prototype.resetGameState=function(){this.resetGameVars(),_.loop(),this.hand.resetState(),this.initFish()},e.prototype.getTimeRemaining=function(t){var e=void 0;return e=t.conf.timer.enabled?floor(60*t.conf.timer.remaining):floor((60*d.TIME_LIMIT-this.totalFrames)/60),
0>e&&(e=0),e},e.prototype.updateHand=function(t){this.hand.x=t.hand.x,this.hand.y=t.hand.y,this.hand.toggle_frames>0?(this.hand.img_swap_count>0?this.hand.img_swap_count--:(this.hand.img_swap_count=d.HAND_IMG_SWAP_DELAY,this.hand.toggleRedAnimatedImg()),this.hand.toggle_frames--):this.hand.recentSharkBite&&this.hand.resetState(),image(this.hand.img_red_animated,this.hand.x,this.hand.y)},e.prototype.detectIntersect=function(t){return Math.abs(this.hand.centerX()-t.centerX())<=100&&Math.abs(this.hand.centerY()-t.centerY())<=100},e.prototype.initFish=function(){for(var t=0;t<F.length;++t){var e=F[t];this.resetFish(e)}},e.prototype.drawStaticElements=function(){background(this.water_img),image(this.chest.img,this.chest.x,this.chest.y),this.drawScore(),this.drawTimeRemaining()},e.prototype.updateFish=function(){for(var t=0;t<F.length;++t){var e=F[t];image(e.img,e.x-=e.speed*I.fishSpeed,e.y),e.direction==d.LEFT&&e.x+e.img_width<=0?this.resetFish(e):e.direction==d.RIGHT&&e.x>width+10&&this.resetFish(e)}},e.prototype.createCoinParticle=function(t,e,r,n,i,o){var a=createVector(t,e),s=createVector(r,n),h=createVector(i,o);return new D["default"](a,s,h)},e.prototype.resetFish=function(t){t.resetOffScreen(width,height),t.img=loadImage(t.img_path)},e.prototype.updateScore=function(t){N+=t.value},e.prototype.displayMessages=function(){var t=width/2-300;textSize(70),fill(255),0>=t&&(t=10),N>9e3&&"none"==this.over9000AchievedState&&(this.over9000AchievedState="display",M.play()),"display"==this.over9000AchievedState?(text("IT'S OVER 9000!!!!",t,height/2),this.over9000AchievedState=this.updateMessageFrames()):"display"==this.gameEndingWarning?(text("30 SECONDS LEFT!",t,height/2),this.gameEndingWarning=this.updateMessageFrames()):this.highScoresReady()&&this.drawHighScores()},e.prototype.setTextSize=function(t){this.text_height=t,textSize(t)},e.prototype.drawHighScores=function(){var t=width/2-300,e=100,r=this.highScores.length>10?10:this.highScores.length;this.setTextSize(70),text("  WHO'S NEXT?",t,e+=this.text_height),this.setTextSize(20),text(" ",t,e+=this.text_height),this.setTextSize(60),text("HIGH SCORES",t,e+=this.text_height),this.setTextSize(55);for(var n=!1,i=0;r>i;i++){var o=this.highScores[i],a=o.score;!n&&N>=a&&(fill(255,204,0),text(N+"  <-- YOUR SCORE!",t,e+=this.text_height),n=!0,fill(255),N==a)||text(a,t,e+=this.text_height)}},e.prototype.highScoresReady=function(){return"display"==this.showHighScoreTable&&this.highScores&&this.highScores.constructor===Array&&this.highScores.length>0},e.prototype.updateMessageFrames=function(){return this.displayMessageFrames++,this.displayMessageFrames>=d.MESSAGE_FRAMES?(this.displayMessageFrames=0,"done"):"display"},e.prototype.drawScore=function(){this.setTextSize(55),fill(255),text(N,this.chest.x+this.chest.img_width+10,this.text_height+5)},e.prototype.drawTimeRemaining=function(){this.setTextSize(55),fill(255);var t=this.remaining-d.HIGHSCORE_TIME;0>t&&(t=0),text("TIME: "+t,this.chest.x+400,this.text_height+5)},e.prototype.handleSharkBite=function(t){if(!(this.hand.recentSharkBite||0>=N)){this.hand.recentSharkBite=!0,this.hand.toggle_frames=100,this.hand.setRed(),x.play(),b.play(.5);for(var e=0;e<t.coin_penalty;e++){var r=this.createCoinParticle(this.chest.x,this.chest.y,0,.1,random(-2,2),random(-.1,11));N-=r.value,this.negativeCoins.push(r)}0>N&&(N=0)}},e.prototype.updateCoins=function(t,e,r){for(var n=t.length-1;n>=0;n--){var i=t[n];e(i)?(i.update(),image(this.coin_img,i.x,i.y)):(r(i),t.splice(n,1))}},e.prototype.addFishSliderGUI=function(t,e,r,n,i){t.conf.gui.add(I,e,0,5).step(1).name(r).onChange(function(t){v(n,t,i)})},e.prototype.postScore=function(){httpPost("http://"+I.apiHost+"/fishapi/highscores/",{score:N},"json")},e.prototype.getHighScores=function(){this.highScores=loadJSON("http://"+I.apiHost+"/fishapi/highscores/")},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),_.stop();for(var r=0;r<F.length;r++)F[r]=null;F=[];for(var r=0;r<this.coins.length;r++)this.coins[r]=null;this.coins=null;for(var r=0;r<this.negativeCoins.length;r++)this.negativeCoins[r]=null;this.negativeCoins=null},e}(E["default"]);e.exports=V}),define("mods/flow_field/flow_field",["exports","module","threejs","mod"],function(t,e,r,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=(i(r),i(n)),h=10,u=3,c=function(t){function e(r){o(this,e),t.call(this,r),r.set(this,"2d"),this.add_effect("handtracking2d"),this.author="Harvey Moon & Michael Clayton",this.title="Flow Field",this.Particle=function(t,e,r){this.nowPos=createVector(t.x,t.y),this.acc=createVector(e.x,e.y),this.lifeCount=random(100,400),this.colorN=r},this.Particle.prototype.update=function(){this.lifeCount--,this.nowPos.add(this.acc)},this.Particle.prototype.draw=function(){fill(this.colorN),ellipse(this.nowPos.x,this.nowPos.y,u,u)},this.particles=[],noStroke(),fill(0),rectMode(CENTER),background(0),this.handpos=createVector(0,0),this.MnowPos=createVector(500,500),this.Macc=createVector(2,-2),colorMode(HSB,360,100,100,1)}return a(e,t),e.prototype.update=function(e){this.handpos.set(e.hand.x,e.hand.y);for(var r=0;r<this.particles.length;r++){this.particles[r].update(),this.particles[r].draw();var n=map(noise(.006*this.particles[r].nowPos.x,.006*this.particles[r].nowPos.y),.2,.8,0,2*PI);this.particles[r].acc.set(3*cos(n),3*sin(n))}this.particles.length<500&&(this.MnowPos.set(this.handpos),this.MnowPos.add(random(-h,h),random(-h,h)),this.particles[r]=new this.Particle(this.MnowPos,this.Macc,color(e.hand.x/width*360,100,100,.2)));for(var i=0;i<this.particles.length;i++)(this.particles[i].nowPos.x>=width-h||this.particles[i].nowPos.x<=h||this.particles[i].nowPos.y>=height-h||this.particles[i].nowPos.y<=h||this.particles[i].lifeCount<=0)&&this.particles.splice(i,1);t.prototype.update.call(this,e)},e}(s["default"]);e.exports=c}),define("mods/graph/graph",["exports","module","threejs","mod"],function(t,e,r,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=(i(r),i(n)),h={x:400,y:100},u=8,c={x:h.x+u,y:h.y+u},l={x:h.x+2*u,y:h.y+2*u},p={},f={},d=function(t){function e(r){o(this,e),t.call(this,r),this.author="Michael Clayton",this.title="Graph",r.set(this,"2d"),this.add_effect("handtracking2d"),p={x:c.x,y:c.y,w:width-2*c.x,h:height-2*c.y},f={x:l.x,y:l.y,w:width-2*l.x,h:height-2*l.y},background(255),noStroke(),fill(0),noiseDetail(2,.2);for(var n=h.x;n<width-h.x;n+=3)ellipse(n,height-h.y+noise(n),u,u);for(var i=h.y;i<height-h.y;i+=3)ellipse(h.x+noise(i),i,u,u);this.ticker=0}return a(e,t),e.prototype.update=function(e){this.ticker+=1,4===this.ticker&&(fill(255,255,255,8),rect(p.x,p.y,p.w,p.h),this.ticker=0),fill(0);var r=f.x+f.w*(e.hand.x/width),n=f.y+f.h*(e.hand.y/height);ellipse(r,n,u,u),t.prototype.update.call(this,e)},e}(s["default"]);e.exports=d}),define("mods/handcube/handcube",["exports","module","mod"],function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(r),s=600,h=700,u=function(t){function e(r){i(this,e),t.call(this,r),r.set(this,"3d"),this.author="Michael Clayton",this.title="Hand Cube",this.add_effect("cube");for(var n=0;n<r.gl.cube.geometry.faces.length;n+=2){var o=16777215*Math.random();r.gl.cube.geometry.faces[n].color.setHex(o),r.gl.cube.geometry.faces[n+1].color.setHex(o)}this.prev_x=0,this.prev_y=0,this.prev_vel_x=0,this.prev_vel_y=0}return o(e,t),e.prototype.update=function(e){for(var r=0,n=0,i=0,o=0;o<e.depth.length;++o){var a=o%e.conf.kinect.res.width,u=e.conf.kinect.res.height-Math.floor(o/e.conf.kinect.res.width);e.depth[o]>s&&e.depth[o]<h&&(r+=a,n+=u,i+=1)}var c=r/i,l=n/i;this.prev_x-c,this.prev_y-l;e.gl.cube.rotation.x=Math.log(this.velocity_x),e.gl.cube.rotation.y=Math.log(this.velocity_x),t.prototype.update.call(this,e)},e}(a["default"]);e.exports=u}),define("text!mods/handtrack/shaders/particle.frag",[],function(){return"uniform vec3 near_color;\nuniform vec3 mid_color;\nuniform vec3 far_color;\nuniform sampler2D texture;\n\nvarying vec3 pos;\n\nfloat v;\n\nfloat lerp(float n, float low, float high) {\n    return clamp((n - low) / (high - low), 0.0, 1.0);\n}\n\nvoid main() {\n\n    float alpha = 1.0;\n\n    vec3 color = vec3(1.0, 1.0, 1.0);\n\n    if ( pos.z == -1.0)\n        alpha = 0.0;\n\n    gl_FragColor = vec4(color, alpha) * texture2D( texture, gl_PointCoord );\n\n}\n"}),define("text!mods/handtrack/shaders/vertex.vert",[],function(){return"#define MIN_Z 440.0\n#define MAX_Z 1100.0\n\nuniform float particle_size;\n\nvarying vec3 pos;\n\nvoid main() {\n\n    pos = position;\n\n    if ( pos.z < 600.0 || pos.z > 700.0 )\n        pos.z = -1.0; // frag shader knows not to display these\n    else\n        pos.z = 0.0; // frag shader knows TO display these\n\n    gl_Position  = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n    gl_PointSize = particle_size;\n\n}\n"}),define("mods/handtrack/handtrack",["exports","module","threejs","mod","text!./shaders/particle.frag","text!./shaders/vertex.vert"],function(t,e,r,n,i,o){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=a(r),c=a(n),l=function(t){function e(r){s(this,e),t.call(this,r),r.set(this,"3d"),this.author="Michael Clayton",this.title="handtrack",this.add_effect("particles"),this.add_effect("handtracking3d");var n=new u["default"].SphereGeometry(20,62,62),a=new u["default"].MeshBasicMaterial({color:16776960});this.sphere=new u["default"].Mesh(n,a),this.sphere.position.z=0,r.gl.scene.add(this.sphere),r.gl.particles.material.vertexShader=o,r.gl.particles.material.fragmentShader=i}return h(e,t),e.prototype.update=function(e){this.sphere.position.x=e.hand.x,this.sphere.position.y=e.hand.y,t.prototype.update.call(this,e)},e}(c["default"]);e.exports=l}),define("text!mods/handviz/shaders/particle.frag",[],function(){return"#define PI2 6.283185\n#define MIN_Z 440.0\n#define MAX_Z 1100.0\n\n#define NEAR_Z 760.0\n#define MID_Z ((MAX_Z + NEAR_Z) / 2.0)\n#define FAR_Z 1100.0\n\n#define MIN_HAND_Z 600.0\n#define MAX_HAND_Z 700.0\n\nuniform vec3 near_color;\nuniform vec3 mid_color;\nuniform vec3 far_color;\nuniform sampler2D texture;\n\nvarying vec3 pos;\nvarying float z;\n\nvec3 color;\nfloat v;\n\nfloat lerp(float n, float low, float high) {\n    return clamp((n - low) / (high - low), 0.0, 1.0);\n}\n\nvoid main() {\n\n    float alpha = 1.0;\n\n    if ( z <= MID_Z ) {\n        float ns = lerp(z, NEAR_Z, MID_Z);\n        color = ( 1.0-ns ) * near_color + ns * mid_color;\n    }\n    else {\n        float fs = lerp(z, MID_Z, FAR_Z);\n        color = ( 1.0-fs ) * mid_color + fs * far_color;\n    }\n\n    if ( z < MAX_HAND_Z && z > MIN_HAND_Z ) {\n        color = vec3(1.0, 1.0, 0.0);\n    }\n\n    if ( z > MAX_Z )\n        alpha = 0.0;\n\n    gl_FragColor = vec4(color, alpha) * texture2D( texture, gl_PointCoord );\n\n    /* Interpolate from near color to far color. */\n\n    /* float near_factor  = min((pos.z - MIN_Z) / (MAX_Z - MIN_Z) - DEPTH_COLOR_OFFSET, 1.0); */\n    /* float far_factor = 1.0 - near_factor; */\n\n    /* cycler = vec4(near_factor * near_color + far_factor * far_color, 1.0); */\n\n    /* cycler.a = pos.z; */\n\n    /* if (pos.z > MAX_Z) { */\n    /*     cycler = vec4(1.0, 1.0, 1.0, 0.0); */\n    /* } */\n\n    /* Cycle through colors. */\n\n    /* v = vColor * PI2; */\n    /* cycler = vec3(v*1.0/3.0, v*2.0/3.0, v); */\n    /* cycler = cos(cycler); */\n    /* cycler += 1.0; */\n    /* cycler /= 2.0; */\n\n    /* gl_FragColor = cycler * texture2D( texture, gl_PointCoord ); */\n    /* gl_FragColor = cycler; //cycler * texture2D( texture, gl_PointCoord ); */\n\n}\n\n"}),define("text!mods/handviz/shaders/vertex.vert",[],function(){return"#define MIN_Z 440.0\n#define MAX_Z 1100.0\n\nuniform float particle_size;\n\nvarying vec3 pos;\nvarying float z;\n\nvoid main() {\n\n    pos = position;\n    z = pos.z;\n    if (pos.z <= MAX_Z) {\n        /* pos.z = MAX_Z - pos.z + MIN_Z; */\n        pos.z = 0.0;\n    }\n\n\n    gl_Position  = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n    gl_PointSize = particle_size;\n\n}\n"}),define("mods/handviz/handviz",["exports","module","mod","text!./shaders/particle.frag","text!./shaders/vertex.vert"],function(t,e,r,n,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var h=o(r),u=function(t){function e(r){a(this,e),t.call(this,r),r.set(this,"3d"),this.author="Michael Clayton",this.title="Hand Viz",this.add_effect("particles"),r.gl.particles.material.vertexShader=i,r.gl.particles.material.fragmentShader=n,r.gl.particles.set_near_color("#C5C5C5"),r.gl.particles.set_mid_color("#000000"),r.gl.particles.set_far_color("#000000")}return s(e,t),e.prototype.update=function(e){t.prototype.update.call(this,e)},e}(h["default"]);e.exports=u}),define("mods/particles/particles",["exports","module","mod"],function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(r),s=function(t){function e(r){i(this,e),t.call(this,r),r.set(this,"3d"),this.author="Michael Clayton",this.title="Particles",this.add_effect("particles")}return o(e,t),e.prototype.update=function(e){t.prototype.update.call(this,e)},e}(a["default"]);e.exports=s}),define("text!mods/portal/shaders/particle.frag",[],function(){return"uniform vec3 near_color;\nuniform vec3 mid_color;\nuniform vec3 overlay_color;\n\nuniform float spot_radius;\nuniform float spot_brightness;\nuniform float background_alpha;\n\n\nuniform float spot_0_x;\nuniform float spot_0_y;\nuniform float spot_1_x;\nuniform float spot_1_y;\n\nvarying vec3 pos;\nvarying float z;\n\nvoid main() {\n    float intensity = 1.0 - z;\n\n    vec3 spot_0_color = near_color;\n    vec3 spot_1_color = mid_color;\n\n    float distance_0 = distance(vec2(pos), vec2(spot_0_x, spot_0_y));\n    float spot_0_intensity = clamp(1.0 - distance_0/spot_radius, 0.0, 1.0);\n\n    float distance_1 = distance(vec2(pos), vec2(spot_1_x, spot_1_y));\n    float spot_1_intensity = clamp(1.0 - distance_1/spot_radius, 0.0, 1.0);\n\n    vec3 color = min(1.0 - spot_0_intensity, 1.0 - spot_1_intensity)*overlay_color + spot_0_intensity*spot_brightness*spot_0_color + spot_1_intensity*spot_brightness*spot_1_color;\n\n    gl_FragColor = vec4(intensity*color, background_alpha + max(spot_0_intensity, spot_1_intensity));\n}\n"}),define("text!mods/portal/shaders/vertex.vert",[],function(){return"#define MIN_Z 500.0\n#define MAX_Z 1100.0\n\nuniform float particle_size;\n\nvarying float z;\nvarying vec3 pos;\n\nfloat lerp(float n, float low, float high) {\n  return clamp((n - low) / (high - low), 0.0, 1.0);\n}\n\nvoid main() {\n    z = lerp(position.z, MIN_Z, MAX_Z);\n    pos = position;\n\n    gl_Position  = projectionMatrix * modelViewMatrix * vec4(position.x, position.y, 0.0, 1.0);\n    gl_PointSize = particle_size;\n\n}\n"}),define("mods/portal/portal",["exports","module","threejs","mod","text!./shaders/particle.frag","text!./shaders/vertex.vert"],function(t,e,r,n,i,o){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t,e){for(var r=arguments.length<=2||void 0===arguments[2]?.5:arguments[2],n=0;n<t.length;n+=1)t[n]=r*t[n]+(1-r)*e[n]}var c=Function.prototype.bind,l=a(r),p=a(n),f={spot_0_speed:.5,spot_1_speed:1,spot_radius:100,spot_brightness:10,background_alpha:0,overlay_color:"#FFFFFF",storminess:.5},d=function(t){function e(r){s(this,e),t.call(this,r),r.set(this,"3d"),this.author="Densaugeo & MC",this.title="Portal",r.conf.gui.add(f,"spot_0_speed",.1,10).step(.1).name("Spot 0 Speed"),r.conf.gui.add(f,"spot_1_speed",.1,10).step(.1).name("Spot 1 Speed"),r.conf.gui.add(f,"spot_radius",0,200).step(1).name("Spot Radius"),r.conf.gui.add(f,"spot_brightness",0,10).step(.1).name("Spot Bright"),r.conf.gui.add(f,"background_alpha",0,1).step(.01).name("Back Alpha"),this.add_effect("particles"),r.gl.particles.material.vertexShader=o,r.gl.particles.material.fragmentShader=i,r.gl.particles.set_particle_size(8),r.gl.particles.material.uniforms.spot_radius={type:"f",value:f.spot_radius},r.gl.particles.material.uniforms.spot_brightness={type:"f",value:f.spot_brightness},r.gl.particles.material.uniforms.background_alpha={type:"f",value:f.background_alpha},r.gl.particles.material.uniforms.overlay_color={type:"c",value:new l["default"].Color(f.overlay_color)},r.conf.gui.addColor(f,"overlay_color").onChange(this.set_overlay_color.bind(this)),r.gl.particles.material.uniforms.spot_0_x={type:"f",value:0},r.gl.particles.material.uniforms.spot_0_y={type:"f",value:0},r.gl.particles.material.uniforms.spot_1_x={type:"f",value:0},r.gl.particles.material.uniforms.spot_1_y={type:"f",value:0},r.gl.particles.set_near_color("#2679C3"),r.gl.particles.set_mid_color("#DC9C26"),r.gl.particles.set_far_color("#FFFFFF"),this.prev_depth=r.depth}return h(e,t),e.prototype.set_overlay_color=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;e>n;n++)r[n-1]=arguments[n];var i=new(c.apply(l["default"].Color,[null].concat(r)));this.gfx.gl.particles.material.uniforms.overlay_color.value=i,f.overlay_color="#"+i.getHexString()},e.prototype.update=function(e){u(e.depth,this.prev_depth,1-f.storminess),this.prev_depth=e.depth,e.gl.particles.material.uniforms.spot_radius.value=f.spot_radius,e.gl.particles.material.uniforms.spot_brightness.value=f.spot_brightness,e.gl.particles.material.uniforms.background_alpha.value=f.background_alpha,e.gl.particles.material.uniforms.spot_0_x.value=150*Math.sin(Date.now()/1e3*f.spot_0_speed)+100,e.gl.particles.material.uniforms.spot_0_y.value=150*Math.cos(Date.now()/1e3*f.spot_0_speed),e.gl.particles.material.uniforms.spot_1_x.value=150*Math.sin(Date.now()/1e3*f.spot_1_speed)-100,e.gl.particles.material.uniforms.spot_1_y.value=150*Math.cos(Date.now()/1e3*f.spot_1_speed),t.prototype.update.call(this,e)},e}(p["default"]);e.exports=d}),define("text!mods/sandstorm/shaders/particle.frag",[],function(){return"#define PI2 6.283185\n#define MIN_Z 440.0\n#define MAX_Z 1100.0\n\n#define NEAR_Z 760.0\n#define MID_Z ((MAX_Z + NEAR_Z) / 2.0)\n#define FAR_Z 1100.0\n\nuniform vec3 near_color;\nuniform vec3 mid_color;\nuniform vec3 far_color;\nuniform sampler2D texture;\n\nvarying vec3 pos;\nvarying float z;\n\nvec3 color;\nfloat v;\n\nfloat lerp(float n, float low, float high) {\n    return clamp((n - low) / (high - low), 0.0, 1.0);\n}\n\nvoid main() {\n\n    float alpha = 1.0;\n\n    if ( z <= MID_Z ) {\n        float ns = lerp(z, NEAR_Z, MID_Z);\n        color = ( 1.0-ns ) * near_color + ns * mid_color;\n    }\n    else { // z must be between MID_Z and FAR_Z\n        float fs = lerp(z, MID_Z, FAR_Z);\n        color = ( 1.0-fs ) * mid_color + fs * far_color;\n    }\n\n    alpha = 1.0 - lerp(z, MIN_Z, MAX_Z);\n\n    if ( z <= -MIN_Z )\n        alpha = 0.0;\n\n    gl_FragColor = vec4(color, alpha) * texture2D( texture, gl_PointCoord );\n\n}\n"}),define("text!mods/sandstorm/shaders/vertex.vert",[],function(){return"#define MIN_Z 440.0\n#define MAX_Z 1100.0\n\nuniform float particle_size;\n\nvarying vec3 pos;\nvarying float z;\n\nvoid main() {\n\n    pos = position;\n    z = pos.z;\n\n    // move the particles a little closer to the camera\n    pos.z -= 2.0*MIN_Z;\n\n    gl_Position  = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n    gl_PointSize = particle_size;\n\n}\n"}),define("mods/sandstorm/sandstorm",["exports","module","threejs","mod","text!./shaders/particle.frag","text!./shaders/vertex.vert"],function(t,e,r,n,i,o){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t,e){for(var r=arguments.length<=2||void 0===arguments[2]?.5:arguments[2],n=0;n<t.length;n+=1)t[n]=r*t[n]+(1-r)*e[n]}var c=a(r),l=a(n),p={storminess:.9},f=function(t){function e(r){s(this,e),t.call(this,r),r.set(this,"3d"),r.conf.gui.add(p,"storminess",0,.99).step(.01).name("storminess"),this.author="Michael Clayton",this.title="Sandstorm",this.add_effect("particles"),this.add_effect("handtracking3d"),r.gl.particles.material.vertexShader=o,r.gl.particles.material.fragmentShader=i,r.gl.particles.material.blending=c["default"].AdditiveBlending,r.gl.particles.set_near_color("#e56b00"),r.gl.particles.set_mid_color("#280072"),r.gl.particles.set_far_color("#02020c"),r.gl.particles.set_particle_size(3),this.prev_depth=r.depth,this.prevpos={x:0,y:0},this.avgx=0,this.avgy=0}return h(e,t),e.prototype.update=function(e){u(e.depth,this.prev_depth,1-p.storminess),this.prev_depth=e.depth,t.prototype.update.call(this,e)},e}(l["default"]);e.exports=f}),define("text!mods/snake/shaders/particle.frag",[],function(){return"uniform vec3 near_color;\nuniform vec3 mid_color;\nuniform vec3 far_color;\nuniform sampler2D texture;\n\nvarying vec3 pos;\nvarying float z;\n\nfloat v;\n\nfloat lerp(float n, float low, float high) {\n    return clamp((n - low) / (high - low), 0.0, 1.0);\n}\n\nvoid main() {\n\n    float alpha = 1.0;\n\n    vec3 color = vec3(1.0, 1.0, 1.0);\n\n    if ( z < 600.0 || z > 700.0 )\n        alpha = 0.0;\n\n    gl_FragColor = vec4(color, alpha) * texture2D( texture, gl_PointCoord );\n\n}\n"}),define("text!mods/snake/shaders/vertex.vert",[],function(){return"#define MIN_Z 440.0\n#define MAX_Z 1100.0\n\nuniform float particle_size;\n\nvarying vec3 pos;\nvarying float z;\n\nvoid main() {\n\n    pos = position;\n    z = pos.z;\n\n    gl_Position  = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n    gl_PointSize = particle_size;\n\n}\n"}),define("mods/snake/snake",["exports","module","threejs","mod","text!./shaders/particle.frag","text!./shaders/vertex.vert"],function(t,e,r,n,i,o){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=a(r),c=a(n),l=4,p=5,f=10,d=function(t){function e(r){s(this,e),t.call(this,r),this.author="Ben Pritchett",r.set(this,"3d"),this.title="snake",this.add_effect("particles"),this.add_effect("handtracking3d");var n=void 0,a=void 0,h=void 0;this.spheres={};var c=new u["default"].AmbientLight(0);r.gl.scene.add(c);var d=[];n=new u["default"].Geometry;for(var m=0;1e4>m;m++){var g=new u["default"].Vector3;g.x=u["default"].Math.randFloatSpread(2e3),g.y=u["default"].Math.randFloatSpread(2e3),g.z=u["default"].Math.randFloatSpread(2e3),n.vertices.push(g)}var y=new u["default"].PointCloud(n,new u["default"].PointCloudMaterial({color:8947848}));r.gl.scene.add(y),r.gl.renderer.setClearColor(new u["default"].Color("#0d0c0b")),d[0]=new u["default"].PointLight(16777215,1,0),d[1]=new u["default"].PointLight(16777215,1,0),d[2]=new u["default"].PointLight(16777215,1,0),d[0].position.set(0,200,0),d[1].position.set(100,200,100),d[2].position.set(-100,-200,-100),this.lights=d,r.gl.scene.add(d[0]),r.gl.scene.add(d[1]),r.gl.scene.add(d[2]);for(var m=0;l-1>=m;m++){n=new u["default"].SphereGeometry(10,32,32),h=16777214*Math.random()+1,a=new u["default"].MeshLambertMaterial({color:h}),this.spheres["sphere"+m]=new u["default"].Mesh(n,a),r.gl.scene.add(this.spheres["sphere"+m]);for(var v=p;v>0;v--)n=new u["default"].SphereGeometry(5,32,32),a=new u["default"].MeshLambertMaterial({color:h}),this.spheres["sphere"+m]["sphere"+v]=new u["default"].Mesh(n,a),this.spheres["sphere"+m]["sphere"+v].position.x=this.spheres["sphere"+m].position.x+25*Math.cos(2*Math.PI/p*v),this.spheres["sphere"+m]["sphere"+v].position.y=this.spheres["sphere"+m].position.y+25*Math.sin(2*Math.PI/p*v),r.gl.scene.add(this.spheres["sphere"+m]["sphere"+v])}r.gl.camera.rotation.order="YXZ",this.num_spheres=l,n=new u["default"].SphereGeometry(10,32,32),h=16777214*Math.random()+1,a=new u["default"].MeshLambertMaterial({color:h}),this.objective=new u["default"].Mesh(n,a),this.objective.position.x=100,this.objective.position.y=100,r.gl.scene.add(this.objective);for(var v=p;v>0;v--)n=new u["default"].SphereGeometry(5,32,32),a=new u["default"].MeshLambertMaterial({color:h}),this.objective["sphere"+v]=new u["default"].Mesh(n,a),this.objective["sphere"+v].position.x=this.objective.position.x+25*Math.sin(2*Math.PI/p*v)*Math.cos(2*Math.PI/p*v),this.objective["sphere"+v].position.y=this.objective.position.y+25*Math.sin(2*Math.PI/p*v),this.objective["sphere"+v].position.z=this.objective.position.z+25*Math.cos(2*Math.PI/p*v),r.gl.scene.add(this.objective["sphere"+v]);r.gl.particles.material.vertexShader=o,r.gl.particles.material.fragmentShader=i,this.waittimer=f}return h(e,t),e.prototype.update=function(e){this.waittimer--;var r=(new Date).getTime()/1e3;this.waittimer<0&&(this.waittimer=0);var n=0;this.spheres["sphere"+n].position.x=e.hand.x,this.spheres["sphere"+n].position.y=e.hand.y;for(var i=p;i>0;i--)this.spheres["sphere"+n]["sphere"+i].position.x=this.spheres["sphere"+n].position.x+25*Math.sin(2*Math.PI/p*i*r)*Math.cos(2*Math.PI/p*i*r),this.spheres["sphere"+n]["sphere"+i].position.y=this.spheres["sphere"+n].position.y+25*Math.sin(2*Math.PI/p*i*r),this.spheres["sphere"+n]["sphere"+i].position.z=this.spheres["sphere"+n].position.z+25*Math.cos(2*Math.PI/p*i*r);var o=void 0,a=void 0,s=void 0,h=void 0,c=void 0,l=void 0,d=void 0;if(this.objective!==!1&&(c=this.objective.position.x*-.001,this.objective.position.x=this.objective.position.x+c,l=this.objective.position.y*-.001,this.objective.position.y=this.objective.position.y+l,o=this.spheres["sphere"+n].position.distanceTo(this.objective.position)),30>=o&&0==this.waittimer&&(this.spheres["sphere"+this.num_spheres]=this.objective,e.gl.scene.remove(this.objective),e.gl.scene.add(this.spheres["sphere"+this.num_spheres]),this.num_spheres++,this.objective=!1,this.waittimer=f),this.objective===!1&&0==this.waittimer){a=new u["default"].SphereGeometry(10,32,32),h=16777214*Math.random()+1,s=new u["default"].MeshLambertMaterial({color:h}),this.objective=new u["default"].Mesh(a,s),this.objective.position.x=Math.random()*e.conf.kinect.res.width-e.conf.kinect.res.width/2,this.objective.position.y=Math.random()*e.conf.kinect.res.height-e.conf.kinect.res.height/2,e.gl.scene.add(this.objective);for(var i=p;i>0;i--)a=new u["default"].SphereGeometry(5,32,32),s=new u["default"].MeshLambertMaterial({color:h}),this.objective["sphere"+i]=new u["default"].Mesh(a,s),this.objective["sphere"+i].position.x=this.objective.position.x+25*Math.cos(2*Math.PI/p*i),this.objective["sphere"+i].position.y=this.objective.position.y+25*Math.sin(2*Math.PI/p*i),e.gl.scene.add(this.objective["sphere"+i])}for(var m=1;m<=this.num_spheres-1;m++){d=m-1,c=(this.spheres["sphere"+m].position.x-this.spheres["sphere"+d].position.x)*-.2,this.spheres["sphere"+m].position.x=this.spheres["sphere"+m].position.x+c,l=(this.spheres["sphere"+m].position.y-this.spheres["sphere"+d].position.y)*-.2,this.spheres["sphere"+m].position.y=this.spheres["sphere"+m].position.y+l,this.spheres["sphere"+m].position.x>320&&(this.spheres["sphere"+m].position.x=320),this.spheres["sphere"+m].position.x<-320&&(this.spheres["sphere"+m].position.x=-320),this.spheres["sphere"+m].position.y>240&&(this.spheres["sphere"+m].position.y=240),this.spheres["sphere"+m].position.y<-240&&(this.spheres["sphere"+m].position.y=-240),isNaN(this.spheres["sphere"+m].position.x)&&(this.spheres["sphere"+m].position.x=0),isNaN(this.spheres["sphere"+m].position.y)&&(this.spheres["sphere"+m].position.y=0);for(var i=p;i>0;i--)this.spheres["sphere"+m]["sphere"+i].position.x=this.spheres["sphere"+m].position.x+25*Math.sin(2*Math.PI/p*i*r)*Math.cos(2*Math.PI/p*i*r),this.spheres["sphere"+m]["sphere"+i].position.y=this.spheres["sphere"+m].position.y+25*Math.sin(2*Math.PI/p*i*r),this.spheres["sphere"+m]["sphere"+i].position.z=this.spheres["sphere"+m].position.z+25*Math.cos(2*Math.PI/p*i*r)}for(var i=p;i>0;i--)this.objective["sphere"+i].position.x=this.objective.position.x+25*Math.sin(2*Math.PI/p*i*r)*Math.cos(2*Math.PI/p*i*r),this.objective["sphere"+i].position.y=this.objective.position.y+25*Math.sin(2*Math.PI/p*i*r),this.objective["sphere"+i].position.z=this.objective.position.z+25*Math.cos(2*Math.PI/p*i*r);var g=400*Math.cos(r)-200,y=400*Math.cos(r)-200,v=200*Math.cos(r);this.lights[0].position.set(g,y,v),g=400*Math.sin(r)-200,y=400*Math.sin(r)-200,v=200*Math.sin(r),this.lights[1].position.set(g,y,v),g=-1*Math.cos(r)*400+200,y=-1*Math.cos(r)*400+200,v=200*Math.cos(r),this.lights[2].position.set(g,y,v),t.prototype.update.call(this,e)},e}(c["default"]);e.exports=d}),define("text!mods/spiral/shaders/particle.frag",[],function(){return"#define PI2 6.283185\n#define MIN_Z 440.0\n#define MAX_Z 1100.0\n\n#define NEAR_Z 760.0\n#define MID_Z ((MAX_Z + NEAR_Z) / 2.0)\n#define FAR_Z 1100.0\n\nuniform vec3 near_color;\nuniform vec3 mid_color;\nuniform vec3 far_color;\nuniform sampler2D texture;\n\nvarying vec3 pos;\nvarying float z;\n\nvec3 color;\nfloat v;\n\nfloat lerp(float n, float low, float high) {\n    return clamp((n - low) / (high - low), 0.0, 1.0);\n}\n\nvoid main() {\n    float alpha = 1.0;\n\n    if ( z <= MID_Z ) {\n        float ns = lerp(z, NEAR_Z, MID_Z);\n        color = ( 1.0-ns ) * near_color + ns * mid_color;\n    }\n    else { // z must be between MID_Z and FAR_Z\n        float fs = lerp(z, MID_Z, FAR_Z);\n        color = ( 1.0-fs ) * mid_color + fs * far_color;\n    }\n\n    if ( z > MAX_Z )\n        alpha = 0.0;\n\n    gl_FragColor = vec4(color, alpha);\n}\n";
}),define("text!mods/spiral/shaders/vertex.vert",[],function(){return"#define MIN_Z 440.0\n#define MAX_Z 1100.0\n\nuniform float particle_size;\nuniform float spiral_strength;\n\nvarying vec3 pos;\nvarying float z;\n\nfloat lerp(float n, float low, float high) {\n    return clamp((n - low) / (high - low), 0.0, 1.0);\n}\n\nvoid main() {\n    pos = position;\n    float normalized_z = 1.0 - lerp(pos.z, MIN_Z, MAX_Z); \n    z = pos.z;\n    if (pos.z <= MAX_Z) {\n        pos.z = 200.0;\n        /* pos.z = MAX_Z - pos.z + MIN_Z; */\n    }\n    mat4 rotation = mat4(mat2(\n        cos(spiral_strength * normalized_z), sin(spiral_strength * normalized_z),\n        -sin(spiral_strength * normalized_z), cos(spiral_strength * normalized_z)\n    ));\n\n    gl_Position  = projectionMatrix * rotation * modelViewMatrix * vec4(pos, 1.0);\n    /* gl_Position.z /= 4.0; // moved /4 scale here instead of CPU */\n    gl_PointSize = particle_size;\n\n}\n"}),define("mods/spiral/spiral",["exports","module","threejs","mod","lodash","text!./shaders/particle.frag","text!./shaders/vertex.vert"],function(t,e,r,n,i,o,a){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function c(t,e){for(var r=arguments.length<=2||void 0===arguments[2]?.5:arguments[2],n=0;n<t.length;n+=1)t[n]=r*t[n]+(1-r)*e[n]}var l=s(r),p=s(n),f={spiral_strength:40,smoothing:.5},d=function(t){function e(r){h(this,e),t.call(this,r),r.set(this,"3d"),r.conf.gui.add(f,"spiral_strength",0,500).step(1).name("Spiral Strength").onChange(i.partial(this.updateUniform,r)),r.conf.gui.add(f,"smoothing",0,.99).step(.01).name("Smoothing"),this.author="Kevin Howell",this.title="Spiral",this.add_effect("particles"),this.updateUniform(r),r.gl.particles.material.vertexShader=a,r.gl.particles.material.fragmentShader=o,r.gl.particles.material.blending=l["default"].AdditiveBlending,r.gl.particles.set_near_color("#e56b00"),r.gl.particles.set_mid_color("#280072"),r.gl.particles.set_far_color("#02020c"),this.prev_depth=r.depth}return u(e,t),e.prototype.updateUniform=function(t){t.gl.particles.system.material.uniforms.spiral_strength={type:"f",value:f.spiral_strength},t.gl.particles.system.material.needsUpdate=!0},e.prototype.update=function(e){c(e.depth,this.prev_depth,1-f.smoothing),this.prev_depth=e.depth,t.prototype.update.call(this,e)},e}(p["default"]);e.exports=d}),define("text!mods/spotlights/shaders/particle.frag",[],function(){return"uniform vec3 near_color;\nuniform vec3 mid_color;\n\nuniform float spot_radius;\nuniform float spot_brightness;\nuniform float background_alpha;\n\nuniform float spot_0_x;\nuniform float spot_0_y;\nuniform float spot_1_x;\nuniform float spot_1_y;\n\nvarying vec3 pos;\nvarying float z;\n\nvoid main() {\n    float intensity = 1.0 - z;\n    \n    vec3 overlay_color = abs(sin(vec3(pos.x, pos.y, 0.0)/50.0));\n    \n    vec3 spot_0_color = near_color;\n    vec3 spot_1_color = mid_color;\n    \n    float distance_0 = distance(vec2(pos), vec2(spot_0_x, spot_0_y));\n    float spot_0_intensity = clamp(1.0 - distance_0/spot_radius, 0.0, 1.0);\n    \n    float distance_1 = distance(vec2(pos), vec2(spot_1_x, spot_1_y));\n    float spot_1_intensity = clamp(1.0 - distance_1/spot_radius, 0.0, 1.0);\n    \n    vec3 color = min(1.0 - spot_0_intensity, 1.0 - spot_1_intensity)*overlay_color + spot_0_intensity*spot_brightness*spot_0_color + spot_1_intensity*spot_brightness*spot_1_color;\n    \n    gl_FragColor = vec4(intensity*color, background_alpha + max(spot_0_intensity, spot_1_intensity));\n}\n"}),define("text!mods/spotlights/shaders/vertex.vert",[],function(){return"#define MIN_Z 500.0\n#define MAX_Z 1100.0\n\nuniform float particle_size;\n\nvarying float z;\nvarying vec3 pos;\n\nfloat lerp(float n, float low, float high) {\n  return clamp((n - low) / (high - low), 0.0, 1.0);\n}\n\nvoid main() {\n    z = lerp(position.z, MIN_Z, MAX_Z);\n    pos = position;\n\n    gl_Position  = projectionMatrix * modelViewMatrix * vec4(position.x, position.y, 200.0, 1.0);\n    gl_PointSize = particle_size;\n\n}\n"}),define("mods/spotlights/spotlights",["exports","module","threejs","mod","text!./shaders/particle.frag","text!./shaders/vertex.vert"],function(t,e,r,n,i,o){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=(a(r),a(n)),c={spot_0_speed:1,spot_1_speed:1.1,spot_radius:50,spot_brightness:2,background_alpha:.2},l=function(t){function e(r){s(this,e),t.call(this,r),r.set(this,"3d"),this.author="Densaugeo",this.title="spotlights",r.conf.gui.add(c,"spot_0_speed",.1,10).step(.1).name("Spot 0 Speed"),r.conf.gui.add(c,"spot_1_speed",.1,10).step(.1).name("Spot 1 Speed"),r.conf.gui.add(c,"spot_radius",0,100).step(1).name("Spot Radius"),r.conf.gui.add(c,"spot_brightness",0,10).step(.1).name("Spot Bright"),r.conf.gui.add(c,"background_alpha",0,1).step(.01).name("Back Alpha"),this.add_effect("particles"),r.gl.particles.material.vertexShader=o,r.gl.particles.material.fragmentShader=i,r.gl.particles.material.uniforms.spot_radius={type:"f",value:c.spot_radius},r.gl.particles.material.uniforms.spot_brightness={type:"f",value:c.spot_brightness},r.gl.particles.material.uniforms.background_alpha={type:"f",value:c.background_alpha},r.gl.particles.material.uniforms.spot_0_x={type:"f",value:0},r.gl.particles.material.uniforms.spot_0_y={type:"f",value:0},r.gl.particles.material.uniforms.spot_1_x={type:"f",value:0},r.gl.particles.material.uniforms.spot_1_y={type:"f",value:0},r.gl.particles.set_near_color("#FFFFFF"),r.gl.particles.set_mid_color("#00FFFF"),r.gl.particles.set_far_color("#000000")}return h(e,t),e.prototype.update=function(e){e.gl.particles.material.uniforms.spot_radius.value=c.spot_radius,e.gl.particles.material.uniforms.spot_brightness.value=c.spot_brightness,e.gl.particles.material.uniforms.background_alpha.value=c.background_alpha,e.gl.particles.material.uniforms.spot_0_x.value=150*Math.sin(Date.now()/1e3*c.spot_0_speed)+100,e.gl.particles.material.uniforms.spot_0_y.value=150*Math.cos(Date.now()/1e3*c.spot_0_speed),e.gl.particles.material.uniforms.spot_1_x.value=150*Math.sin(Date.now()/1e3*c.spot_1_speed)-100,e.gl.particles.material.uniforms.spot_1_y.value=150*Math.cos(Date.now()/1e3*c.spot_1_speed),t.prototype.update.call(this,e)},e}(u["default"]);e.exports=l}),define("text!mods/storm/shaders/particle.frag",[],function(){return"#define PI2 6.283185\n#define MIN_Z 440.0\n#define MAX_Z 1100.0\n\n#define NEAR_Z 760.0\n#define MID_Z ((MAX_Z + NEAR_Z) / 2.0)\n#define FAR_Z 1100.0\n\nuniform vec3 near_color;\nuniform vec3 mid_color;\nuniform vec3 far_color;\nuniform sampler2D texture;\n\nvarying vec3 pos;\nvarying float z;\n\nvec3 color;\nfloat v;\n\nfloat lerp(float n, float low, float high) {\n    return clamp((n - low) / (high - low), 0.0, 1.0);\n}\n\nvoid main() {\n\n    float alpha = 1.0;\n\n    if ( z <= MID_Z ) {\n        float ns = lerp(z, NEAR_Z, MID_Z);\n        color = ( 1.0-ns ) * near_color + ns * mid_color;\n    }\n    else { // z must be between MID_Z and FAR_Z\n        float fs = lerp(z, MID_Z, FAR_Z);\n        color = ( 1.0-fs ) * mid_color + fs * far_color;\n    }\n\n    if ( z > MAX_Z )\n        alpha = 0.0;\n\n    gl_FragColor = vec4(color, alpha) * texture2D( texture, gl_PointCoord );\n\n    /* Interpolate from near color to far color. */\n\n    /* float near_factor  = min((pos.z - MIN_Z) / (MAX_Z - MIN_Z) - DEPTH_COLOR_OFFSET, 1.0); */\n    /* float far_factor = 1.0 - near_factor; */\n\n    /* cycler = vec4(near_factor * near_color + far_factor * far_color, 1.0); */\n\n    /* cycler.a = pos.z; */\n\n    /* if (pos.z > MAX_Z) { */\n    /*     cycler = vec4(1.0, 1.0, 1.0, 0.0); */\n    /* } */\n\n    /* Cycle through colors. */\n\n    /* v = vColor * PI2; */\n    /* cycler = vec3(v*1.0/3.0, v*2.0/3.0, v); */\n    /* cycler = cos(cycler); */\n    /* cycler += 1.0; */\n    /* cycler /= 2.0; */\n\n    /* gl_FragColor = cycler * texture2D( texture, gl_PointCoord ); */\n    /* gl_FragColor = cycler; //cycler * texture2D( texture, gl_PointCoord ); */\n\n}\n\n"}),define("text!mods/storm/shaders/vertex.vert",[],function(){return"#define MIN_Z 440.0\n#define MAX_Z 1100.0\n\nuniform float particle_size;\n\nvarying vec3 pos;\nvarying float z;\n\nvoid main() {\n\n    pos = position;\n    z = pos.z;\n    if (pos.z <= MAX_Z) {\n        pos.z = 200.0;\n        /* pos.z = MAX_Z - pos.z + MIN_Z; */\n    }\n\n    gl_Position  = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n    /* gl_Position.z /= 4.0; // moved /4 scale here instead of CPU */\n    gl_PointSize = particle_size;\n\n}\n"}),define("mods/storm/storm",["exports","module","mod","text!./shaders/particle.frag","text!./shaders/vertex.vert"],function(t,e,r,n,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function h(t,e){for(var r=arguments.length<=2||void 0===arguments[2]?.5:arguments[2],n=0;n<t.length;n+=1)t[n]=r*t[n]+(1-r)*e[n]}var u=o(r),c={storminess:.5},l=function(t){function e(r){a(this,e),t.call(this,r),r.set(this,"3d"),r.conf.gui.add(c,"storminess",0,.99).step(.01).name("storminess"),this.author="Michael Clayton",this.title="Storm",this.add_effect("particles"),r.gl.particles.material.vertexShader=i,r.gl.particles.material.fragmentShader=n,this.prev_depth=r.depth}return s(e,t),e.prototype.update=function(e){h(e.depth,this.prev_depth,1-c.storminess),this.prev_depth=e.depth,t.prototype.update.call(this,e)},e}(u["default"]);e.exports=l}),define("mods/torus/torus",["exports","module","mod"],function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(r),s=function(t){function e(r){i(this,e),t.call(this,r),r.set(this,"3d"),this.author="Michael Clayton",this.title="Torus",this.add_effect("torus");for(var n=0;n<r.gl.geometry.faces.length;n+=2){var o=16777215*Math.random();r.gl.geometry.faces[n].color.setHex(o),r.gl.geometry.faces[n+1].color.setHex(o)}this.last_depth=r.depth,this.rotation=.01}return o(e,t),e.prototype.update=function(e){for(var r=.1,n=0,i=0;i<e.depth.length;i+=1)n+=Math.abs(this.last_depth[i]-e.depth[i]);this.rotation=(1-r)*this.rotation+r*n/1e8,e.gl.torus.rotation.y+=this.rotation,e.gl.torus.rotation.x+=this.rotation,this.last_depth=e.depth,t.prototype.update.call(this,e)},e}(a["default"]);e.exports=s}),define("mods/wallflower/wallflower",["exports","module","mod"],function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(r),s=function(t){function e(r){i(this,e),t.call(this,r),r.set(this,"3d"),this.author="Michael Clayton",this.title="Wallflower",this.add_effect("particles"),r.gl.particles.set_near_color("#ffc200"),r.gl.particles.set_mid_color("#36b5c6"),r.gl.particles.set_far_color("#000000"),r.gl.camera.position.set(192.70423995625987,70.11605779737478,-151.04933163228134),r.gl.camera.rotation.set(-.05518793935426329,.9692560264330574,.04551531481164122,"XYZ"),r.gl.particles.set_particle_size(8)}return o(e,t),e.prototype.update=function(e){t.prototype.update.call(this,e)},e}(a["default"]);e.exports=s}),define("mods",["exports","./mods/colorcycle/colorcycle","./mods/cube/cube","./mods/example/example","./mods/example2d/example2d","./mods/fish/fish","./mods/flow_field/flow_field","./mods/graph/graph","./mods/handcube/handcube","./mods/handtrack/handtrack","./mods/handviz/handviz","./mods/particles/particles","./mods/portal/portal","./mods/sandstorm/sandstorm","./mods/snake/snake","./mods/spiral/spiral","./mods/spotlights/spotlights","./mods/storm/storm","./mods/torus/torus","./mods/wallflower/wallflower"],function(t,e,r,n,i,o,a,s,h,u,c,l,p,f,d,m,g,y,v,_){"use strict";function x(t){return t&&t.__esModule?t["default"]:t}t.__esModule=!0,t.colorcycle=x(e),t.cube=x(r),t.example=x(n),t.example2d=x(i),t.fish=x(o),t.flow_field=x(a),t.graph=x(s),t.handcube=x(h),t.handtrack=x(u),t.handviz=x(c),t.particles=x(l),t.portal=x(p),t.sandstorm=x(f),t.snake=x(d),t.spiral=x(m),t.spotlights=x(g),t.storm=x(y),t.torus=x(v),t.wallflower=x(_)}),define("text!blacklist.json",[],function(){return'[\n    "example",\n    "cube",\n    "torus",\n    "handcube",\n    "handtrack"\n]\n'}),define("modctrl",["exports","zepto","lodash","mods","text!blacklist.json"],function(t,e,r,n,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function a(){g+=1,g%=m,s(d[g])}function s(t){g=r.indexOf(d,t),y.destroy(v),v.reset(),l(v),location.hash=t}function h(){return r.without.apply(void 0,[r.keys(n),"__esModule"].concat(f))}function u(){return y}function c(t){y.update(v)}function l(t){var e=arguments.length<=1||void 0===arguments[1]?d[g]:arguments[1];console.log("Activating mod: "+e),r.contains(d,e)?(v=t,y=new n[e](v)):(v=t,y=new n[d[g]](v),location.hash=d[g]),_.text(y.title),x.text(y.author)}t.__esModule=!0;var p=o(e),f=JSON.parse(i),d=h(),m=r.size(d),g=Math.max(0,d.indexOf(location.hash.slice(1))),y=void 0,v=void 0,_=p["default"]("#nowplaying #title"),x=p["default"]("#nowplaying #author");t.next=a,t.get=u,t.set=s,t.names=h,t.update=c,t.create=l}),function(t){define("threejs_orbit_controls",["threejs"],function(){return function(){!function(){function t(t){this.object=t,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25;var e,r,n=this,i=1e-6,o=0,a=0,s=1,h=new THREE.Vector3,u=!1;this.getPolarAngle=function(){return r},this.getAzimuthalAngle=function(){return e},this.rotateLeft=function(t){a-=t},this.rotateUp=function(t){o-=t},this.panLeft=function(){var t=new THREE.Vector3;return function(e){var r=this.object.matrix.elements;t.set(r[0],r[1],r[2]),t.multiplyScalar(-e),h.add(t)}}(),this.panUp=function(){var t=new THREE.Vector3;return function(e){var r=this.object.matrix.elements;t.set(r[4],r[5],r[6]),t.multiplyScalar(e),h.add(t)}}(),this.pan=function(t,e,r,i){if(n.object instanceof THREE.PerspectiveCamera){var o=n.object.position,a=o.clone().sub(n.target),s=a.length();s*=Math.tan(n.object.fov/2*Math.PI/180),n.panLeft(2*t*s/i),n.panUp(2*e*s/i)}else n.object instanceof THREE.OrthographicCamera?(n.panLeft(t*(n.object.right-n.object.left)/r),n.panUp(e*(n.object.top-n.object.bottom)/i)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){n.object instanceof THREE.PerspectiveCamera?s/=t:n.object instanceof THREE.OrthographicCamera?(n.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),n.object.updateProjectionMatrix(),u=!0):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(t){n.object instanceof THREE.PerspectiveCamera?s*=t:n.object instanceof THREE.OrthographicCamera?(n.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),n.object.updateProjectionMatrix(),u=!0):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=function(){var n=new THREE.Vector3,c=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),l=c.clone().inverse(),p=new THREE.Vector3,f=new THREE.Quaternion;return function(){var t=this.object.position;n.copy(t).sub(this.target),n.applyQuaternion(c),e=Math.atan2(n.x,n.z),r=Math.atan2(Math.sqrt(n.x*n.x+n.z*n.z),n.y),e+=a,r+=o,e=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,e)),r=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,r)),r=Math.max(i,Math.min(Math.PI-i,r));var d=n.length()*s;return d=Math.max(this.minDistance,Math.min(this.maxDistance,d)),this.target.add(h),n.x=d*Math.sin(r)*Math.sin(e),n.y=d*Math.cos(r),n.z=d*Math.sin(r)*Math.cos(e),n.applyQuaternion(l),t.copy(this.target).add(n),this.object.lookAt(this.target),this.enableDamping===!0?(a*=1-this.dampingFactor,o*=1-this.dampingFactor):(a=0,o=0),s=1,h.set(0,0,0),u||p.distanceToSquared(this.object.position)>i||8*(1-f.dot(this.object.quaternion))>i?(p.copy(this.object.position),f.copy(this.object.quaternion),u=!1,!0):!1}}()}THREE.OrbitControls=function(e,r){function n(t,e){var r=g.domElement===document?g.domElement.body:g.domElement;m.pan(t,e,r.clientWidth,r.clientHeight)}function i(){return 2*Math.PI/60/60*g.autoRotateSpeed}function o(){return Math.pow(.95,g.zoomSpeed)}function a(t){if(g.enabled!==!1){if(t.preventDefault(),t.button===g.mouseButtons.ORBIT){if(g.enableRotate===!1)return;C=E.ROTATE,y.set(t.clientX,t.clientY)}else if(t.button===g.mouseButtons.ZOOM){if(g.enableZoom===!1)return;C=E.DOLLY,S.set(t.clientX,t.clientY)}else if(t.button===g.mouseButtons.PAN){if(g.enablePan===!1)return;C=E.PAN,x.set(t.clientX,t.clientY)}C!==E.NONE&&(document.addEventListener("mousemove",s,!1),document.addEventListener("mouseup",h,!1),g.dispatchEvent(R))}}function s(t){if(g.enabled!==!1){t.preventDefault();var e=g.domElement===document?g.domElement.body:g.domElement;if(C===E.ROTATE){if(g.enableRotate===!1)return;v.set(t.clientX,t.clientY),_.subVectors(v,y),m.rotateLeft(2*Math.PI*_.x/e.clientWidth*g.rotateSpeed),m.rotateUp(2*Math.PI*_.y/e.clientHeight*g.rotateSpeed),y.copy(v)}else if(C===E.DOLLY){if(g.enableZoom===!1)return;M.set(t.clientX,t.clientY),T.subVectors(M,S),T.y>0?m.dollyIn(o()):T.y<0&&m.dollyOut(o()),S.copy(M)}else if(C===E.PAN){if(g.enablePan===!1)return;b.set(t.clientX,t.clientY),w.subVectors(b,x),n(w.x,w.y),x.copy(b)}C!==E.NONE&&g.update()}}function h(){g.enabled!==!1&&(document.removeEventListener("mousemove",s,!1),document.removeEventListener("mouseup",h,!1),g.dispatchEvent(P),C=E.NONE)}function u(t){if(g.enabled!==!1&&g.enableZoom!==!1&&C===E.NONE){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?m.dollyOut(o()):0>e&&m.dollyIn(o()),g.update(),g.dispatchEvent(R),g.dispatchEvent(P)}}function c(t){if(g.enabled!==!1&&g.enableKeys!==!1&&g.enablePan!==!1)switch(t.keyCode){case g.keys.UP:n(0,g.keyPanSpeed),g.update();break;case g.keys.BOTTOM:n(0,-g.keyPanSpeed),g.update();break;case g.keys.LEFT:n(g.keyPanSpeed,0),g.update();break;case g.keys.RIGHT:n(-g.keyPanSpeed,0),g.update()}}function l(t){if(g.enabled!==!1){switch(t.touches.length){case 1:if(g.enableRotate===!1)return;C=E.TOUCH_ROTATE,y.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(g.enableZoom===!1)return;C=E.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,r=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+r*r);S.set(0,n);break;case 3:if(g.enablePan===!1)return;C=E.TOUCH_PAN,x.set(t.touches[0].pageX,t.touches[0].pageY);break;default:C=E.NONE}C!==E.NONE&&g.dispatchEvent(R)}}function p(t){if(g.enabled!==!1){t.preventDefault(),t.stopPropagation();var e=g.domElement===document?g.domElement.body:g.domElement;switch(t.touches.length){case 1:if(g.enableRotate===!1)return;if(C!==E.TOUCH_ROTATE)return;v.set(t.touches[0].pageX,t.touches[0].pageY),_.subVectors(v,y),m.rotateLeft(2*Math.PI*_.x/e.clientWidth*g.rotateSpeed),m.rotateUp(2*Math.PI*_.y/e.clientHeight*g.rotateSpeed),y.copy(v),g.update();break;case 2:if(g.enableZoom===!1)return;if(C!==E.TOUCH_DOLLY)return;var r=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,a=Math.sqrt(r*r+i*i);M.set(0,a),T.subVectors(M,S),T.y>0?m.dollyOut(o()):T.y<0&&m.dollyIn(o()),S.copy(M),g.update();break;case 3:if(g.enablePan===!1)return;if(C!==E.TOUCH_PAN)return;b.set(t.touches[0].pageX,t.touches[0].pageY),w.subVectors(b,x),n(w.x,w.y),x.copy(b),g.update();break;default:C=E.NONE}}}function f(){g.enabled!==!1&&(g.dispatchEvent(P),C=E.NONE)}function d(t){t.preventDefault()}var m=new t(e);this.domElement=void 0!==r?r:document,Object.defineProperty(this,"constraint",{get:function(){return m}}),this.getPolarAngle=function(){return m.getPolarAngle()},this.getAzimuthalAngle=function(){return m.getAzimuthalAngle()},this.enabled=!0,this.center=this.target,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var g=this,y=new THREE.Vector2,v=new THREE.Vector2,_=new THREE.Vector2,x=new THREE.Vector2,b=new THREE.Vector2,w=new THREE.Vector2,S=new THREE.Vector2,M=new THREE.Vector2,T=new THREE.Vector2,E={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},C=E.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var A={type:"change"},R={type:"start"},P={type:"end"};this.update=function(){this.autoRotate&&C===E.NONE&&m.rotateLeft(i()),m.update()===!0&&this.dispatchEvent(A)},this.reset=function(){C=E.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(A),this.update()},this.dispose=function(){this.domElement.removeEventListener("contextmenu",d,!1),this.domElement.removeEventListener("mousedown",a,!1),this.domElement.removeEventListener("mousewheel",u,!1),this.domElement.removeEventListener("DOMMouseScroll",u,!1),this.domElement.removeEventListener("touchstart",l,!1),this.domElement.removeEventListener("touchend",f,!1),this.domElement.removeEventListener("touchmove",p,!1),document.removeEventListener("mousemove",s,!1),document.removeEventListener("mouseup",h,!1),window.removeEventListener("keydown",c,!1)},this.domElement.addEventListener("contextmenu",d,!1),this.domElement.addEventListener("mousedown",a,!1),this.domElement.addEventListener("mousewheel",u,!1),this.domElement.addEventListener("DOMMouseScroll",u,!1),this.domElement.addEventListener("touchstart",l,!1),this.domElement.addEventListener("touchend",f,!1),this.domElement.addEventListener("touchmove",p,!1),window.addEventListener("keydown",c,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{object:{get:function(){return this.constraint.object}},target:{get:function(){return this.constraint.target},set:function(t){console.warn("THREE.OrbitControls: target is now immutable. Use target.set() instead."),this.constraint.target.copy(t)}},minDistance:{get:function(){return this.constraint.minDistance},set:function(t){this.constraint.minDistance=t}},maxDistance:{get:function(){return this.constraint.maxDistance},set:function(t){this.constraint.maxDistance=t}},minZoom:{get:function(){return this.constraint.minZoom},set:function(t){this.constraint.minZoom=t}},maxZoom:{get:function(){return this.constraint.maxZoom},set:function(t){this.constraint.maxZoom=t}},minPolarAngle:{get:function(){return this.constraint.minPolarAngle},set:function(t){this.constraint.minPolarAngle=t}},maxPolarAngle:{get:function(){return this.constraint.maxPolarAngle},set:function(t){this.constraint.maxPolarAngle=t}},minAzimuthAngle:{get:function(){return this.constraint.minAzimuthAngle},set:function(t){this.constraint.minAzimuthAngle=t}},maxAzimuthAngle:{get:function(){return this.constraint.maxAzimuthAngle},set:function(t){this.constraint.maxAzimuthAngle=t}},enableDamping:{get:function(){return this.constraint.enableDamping},set:function(t){this.constraint.enableDamping=t}},dampingFactor:{get:function(){return this.constraint.dampingFactor},set:function(t){this.constraint.dampingFactor=t}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(t){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!t}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(t){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!t}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(t){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!t}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(t){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!t}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.constraint.enableDamping},set:function(t){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.constraint.enableDamping=!t}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.constraint.dampingFactor},set:function(t){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.constraint.dampingFactor=t}}})}()}.apply(t,arguments)})}(this),!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define("p5",[],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.p5=t()}}(function(){var define,module,exports;return function t(e,r,n){function i(a,s){if(!r[a]){if(!e[a]){var h="function"==typeof require&&require;if(!s&&h)return h(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[a]={exports:{}};e[a][0].call(c.exports,function(t){var r=e[a][1][t];return i(r?r:t)},c,c.exports,t,e,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(t,e,r){},{}],2:[function(t,e,r){"use strict";r.argument=function(t,e){if(!t)throw new Error(e)},r.assert=r.argument},{}],3:[function(t,e,r){"use strict";function n(t,e,r,n,i){t.beginPath(),t.moveTo(e,r),t.lineTo(n,i),t.stroke()}r.line=n},{}],4:[function(t,e,r){"use strict";function n(t){this.font=t}function i(t){this.cmap=t}function o(t,e){this.encoding=t,this.charset=e}function a(t){var e;switch(t.version){case 1:this.names=r.standardNames.slice();break;case 2:for(this.names=new Array(t.numberOfGlyphs),e=0;e<t.numberOfGlyphs;e++)t.glyphNameIndex[e]<r.standardNames.length?this.names[e]=r.standardNames[t.glyphNameIndex[e]]:this.names[e]=t.names[t.glyphNameIndex[e]-r.standardNames.length];break;case 2.5:for(this.names=new Array(t.numberOfGlyphs),e=0;e<t.numberOfGlyphs;e++)this.names[e]=r.standardNames[e+t.glyphNameIndex[e]];break;case 3:this.names=[]}}function s(t){for(var e,r=t.tables.cmap.glyphIndexMap,n=Object.keys(r),i=0;i<n.length;i+=1){var o=n[i],a=r[o];e=t.glyphs.get(a),e.addUnicode(parseInt(o))}for(i=0;i<t.glyphs.length;i+=1)e=t.glyphs.get(i),t.cffEncoding?e.name=t.cffEncoding.charset[i]:e.name=t.glyphNames.glyphIndexToName(i)}var h=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],u=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],c=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],l=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];
n.prototype.charToGlyphIndex=function(t){var e=t.charCodeAt(0),r=this.font.glyphs;if(!r)return null;for(var n=0;n<r.length;n+=1)for(var i=r.get(n),o=0;o<i.unicodes.length;o+=1)if(i.unicodes[o]===e)return n},i.prototype.charToGlyphIndex=function(t){return this.cmap.glyphIndexMap[t.charCodeAt(0)]||0},o.prototype.charToGlyphIndex=function(t){var e=t.charCodeAt(0),r=this.encoding[e];return this.charset.indexOf(r)},a.prototype.nameToGlyphIndex=function(t){return this.names.indexOf(t)},a.prototype.glyphIndexToName=function(t){return this.names[t]},r.cffStandardStrings=h,r.cffStandardEncoding=u,r.cffExpertEncoding=c,r.standardNames=l,r.DefaultEncoding=n,r.CmapEncoding=i,r.CffEncoding=o,r.GlyphNames=a,r.addGlyphNames=s},{}],5:[function(t,e,r){"use strict";function n(t){t=t||{},this.familyName=t.familyName||" ",this.styleName=t.styleName||" ",this.designer=t.designer||" ",this.designerURL=t.designerURL||" ",this.manufacturer=t.manufacturer||" ",this.manufacturerURL=t.manufacturerURL||" ",this.license=t.license||" ",this.licenseURL=t.licenseURL||" ",this.version=t.version||"Version 0.1",this.description=t.description||" ",this.copyright=t.copyright||" ",this.trademark=t.trademark||" ",this.unitsPerEm=t.unitsPerEm||1e3,this.ascender=t.ascender,this.descender=t.descender,this.supported=!0,this.glyphs=new s.GlyphSet(this,t.glyphs||[]),this.encoding=new a.DefaultEncoding(this),this.tables={}}var i=t("./path"),o=t("./tables/sfnt"),a=t("./encoding"),s=t("./glyphset");n.prototype.hasChar=function(t){return null!==this.encoding.charToGlyphIndex(t)},n.prototype.charToGlyphIndex=function(t){return this.encoding.charToGlyphIndex(t)},n.prototype.charToGlyph=function(t){var e=this.charToGlyphIndex(t),r=this.glyphs.get(e);return r||(r=this.glyphs.get(0)),r},n.prototype.stringToGlyphs=function(t){for(var e=[],r=0;r<t.length;r+=1){var n=t[r];e.push(this.charToGlyph(n))}return e},n.prototype.nameToGlyphIndex=function(t){return this.glyphNames.nameToGlyphIndex(t)},n.prototype.nameToGlyph=function(t){var e=this.nametoGlyphIndex(t),r=this.glyphs.get(e);return r||(r=this.glyphs.get(0)),r},n.prototype.glyphIndexToName=function(t){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(t):""},n.prototype.getKerningValue=function(t,e){t=t.index||t,e=e.index||e;var r=this.getGposKerningValue;return r?r(t,e):this.kerningPairs[t+","+e]||0},n.prototype.forEachGlyph=function(t,e,r,n,i,o){if(this.supported){e=void 0!==e?e:0,r=void 0!==r?r:0,n=void 0!==n?n:72,i=i||{};for(var a=void 0===i.kerning?!0:i.kerning,s=1/this.unitsPerEm*n,h=this.stringToGlyphs(t),u=0;u<h.length;u+=1){var c=h[u];if(o(c,e,r,n,i),c.advanceWidth&&(e+=c.advanceWidth*s),a&&u<h.length-1){var l=this.getKerningValue(c,h[u+1]);e+=l*s}}}},n.prototype.getPath=function(t,e,r,n,o){var a=new i.Path;return this.forEachGlyph(t,e,r,n,o,function(t,e,r,n){var i=t.getPath(e,r,n);a.extend(i)}),a},n.prototype.draw=function(t,e,r,n,i,o){this.getPath(e,r,n,i,o).draw(t)},n.prototype.drawPoints=function(t,e,r,n,i,o){this.forEachGlyph(e,r,n,i,o,function(e,r,n,i){e.drawPoints(t,r,n,i)})},n.prototype.drawMetrics=function(t,e,r,n,i,o){this.forEachGlyph(e,r,n,i,o,function(e,r,n,i){e.drawMetrics(t,r,n,i)})},n.prototype.validate=function(){function t(t,e){t||r.push(e)}function e(e){t(n[e]&&n[e].trim().length>0,"No "+e+" specified.")}var r=[],n=this;e("familyName"),e("weightName"),e("manufacturer"),e("copyright"),e("version"),t(this.unitsPerEm>0,"No unitsPerEm specified.")},n.prototype.toTables=function(){return o.fontToTable(this)},n.prototype.toBuffer=function(){for(var t=this.toTables(),e=t.encode(),r=new ArrayBuffer(e.length),n=new Uint8Array(r),i=0;i<e.length;i++)n[i]=e[i];return r},n.prototype.download=function(){var t=this.familyName.replace(/\s/g,"")+"-"+this.styleName+".otf",e=this.toBuffer();window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,e.byteLength,function(r){r.root.getFile(t,{create:!0},function(t){t.createWriter(function(r){var n=new DataView(e),i=new Blob([n],{type:"font/opentype"});r.write(i),r.addEventListener("writeend",function(){location.href=t.toURL()},!1)})})},function(t){throw t})},r.Font=n},{"./encoding":4,"./glyphset":7,"./path":10,"./tables/sfnt":25}],6:[function(t,e,r){"use strict";function n(t,e){var r=e||{commands:[]};return{configurable:!0,get:function(){return"function"==typeof r&&(r=r()),r},set:function(t){r=t}}}function i(t){this.bindConstructorValues(t)}var o=t("./check"),a=t("./draw"),s=t("./path");i.prototype.bindConstructorValues=function(t){this.index=t.index||0,this.name=t.name||null,this.unicode=t.unicode||void 0,this.unicodes=t.unicodes||void 0!==t.unicode?[t.unicode]:[],t.xMin&&(this.xMin=t.xMin),t.yMin&&(this.yMin=t.yMin),t.xMax&&(this.xMax=t.xMax),t.yMax&&(this.yMax=t.yMax),t.advanceWidth&&(this.advanceWidth=t.advanceWidth),Object.defineProperty(this,"path",n(this,t.path))},i.prototype.addUnicode=function(t){0===this.unicodes.length&&(this.unicode=t),this.unicodes.push(t)},i.prototype.getPath=function(t,e,r){t=void 0!==t?t:0,e=void 0!==e?e:0,r=void 0!==r?r:72;for(var n=1/this.path.unitsPerEm*r,i=new s.Path,o=this.path.commands,a=0;a<o.length;a+=1){var h=o[a];"M"===h.type?i.moveTo(t+h.x*n,e+-h.y*n):"L"===h.type?i.lineTo(t+h.x*n,e+-h.y*n):"Q"===h.type?i.quadraticCurveTo(t+h.x1*n,e+-h.y1*n,t+h.x*n,e+-h.y*n):"C"===h.type?i.curveTo(t+h.x1*n,e+-h.y1*n,t+h.x2*n,e+-h.y2*n,t+h.x*n,e+-h.y*n):"Z"===h.type&&i.closePath()}return i},i.prototype.getContours=function(){if(void 0===this.points)return[];for(var t=[],e=[],r=0;r<this.points.length;r+=1){var n=this.points[r];e.push(n),n.lastPointOfContour&&(t.push(e),e=[])}return o.argument(0===e.length,"There are still points left in the current contour."),t},i.prototype.getMetrics=function(){for(var t=this.path.commands,e=[],r=[],n=0;n<t.length;n+=1){var i=t[n];"Z"!==i.type&&(e.push(i.x),r.push(i.y)),("Q"===i.type||"C"===i.type)&&(e.push(i.x1),r.push(i.y1)),"C"===i.type&&(e.push(i.x2),r.push(i.y2))}var o={xMin:Math.min.apply(null,e),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,e),yMax:Math.max.apply(null,r),leftSideBearing:0};return o.rightSideBearing=this.advanceWidth-o.leftSideBearing-(o.xMax-o.xMin),o},i.prototype.draw=function(t,e,r,n){this.getPath(e,r,n).draw(t)},i.prototype.drawPoints=function(t,e,r,n){function i(e,r,n,i){var o=2*Math.PI;t.beginPath();for(var a=0;a<e.length;a+=1)t.moveTo(r+e[a].x*i,n+e[a].y*i),t.arc(r+e[a].x*i,n+e[a].y*i,2,0,o,!1);t.closePath(),t.fill()}e=void 0!==e?e:0,r=void 0!==r?r:0,n=void 0!==n?n:24;for(var o=1/this.path.unitsPerEm*n,a=[],s=[],h=this.path,u=0;u<h.commands.length;u+=1){var c=h.commands[u];void 0!==c.x&&a.push({x:c.x,y:-c.y}),void 0!==c.x1&&s.push({x:c.x1,y:-c.y1}),void 0!==c.x2&&s.push({x:c.x2,y:-c.y2})}t.fillStyle="blue",i(a,e,r,o),t.fillStyle="red",i(s,e,r,o)},i.prototype.drawMetrics=function(t,e,r,n){var i;e=void 0!==e?e:0,r=void 0!==r?r:0,n=void 0!==n?n:24,i=1/this.path.unitsPerEm*n,t.lineWidth=1,t.strokeStyle="black",a.line(t,e,-1e4,e,1e4),a.line(t,-1e4,r,1e4,r);var o=this.xMin||0,s=this.yMin||0,h=this.xMax||0,u=this.yMax||0,c=this.advanceWidth||0;t.strokeStyle="blue",a.line(t,e+o*i,-1e4,e+o*i,1e4),a.line(t,e+h*i,-1e4,e+h*i,1e4),a.line(t,-1e4,r+-s*i,1e4,r+-s*i),a.line(t,-1e4,r+-u*i,1e4,r+-u*i),t.strokeStyle="green",a.line(t,e+c*i,-1e4,e+c*i,1e4)},r.Glyph=i},{"./check":2,"./draw":3,"./path":10}],7:[function(t,e,r){"use strict";function n(t,e){if(this.font=t,this.glyphs={},Array.isArray(e))for(var r=0;r<e.length;r++)this.glyphs[r]=e[r];this.length=e&&e.length||0}function i(t,e){return new s.Glyph({index:e,font:t})}function o(t,e,r,n,i,o){return function(){var a=new s.Glyph({index:e,font:t});return a.path=function(){r(a,n,i);var e=o(t.glyphs,a);return e.unitsPerEm=t.unitsPerEm,e},a}}function a(t,e,r,n){return function(){var i=new s.Glyph({index:e,font:t});return i.path=function(){var e=r(t,i,n);return e.unitsPerEm=t.unitsPerEm,e},i}}var s=t("./glyph");n.prototype.get=function(t){return"function"==typeof this.glyphs[t]&&(this.glyphs[t]=this.glyphs[t]()),this.glyphs[t]},n.prototype.push=function(t,e){this.glyphs[t]=e,this.length++},r.GlyphSet=n,r.glyphLoader=i,r.ttfGlyphLoader=o,r.cffGlyphLoader=a},{"./glyph":6}],8:[function(t,e,r){"use strict";function n(t){for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n<t.length;n+=1)r[n]=t[n];return e}function i(e,r){var i=t("fs");i.readFile(e,function(t,e){return t?r(t.message):void r(null,n(e))})}function o(t,e){var r=new XMLHttpRequest;r.open("get",t,!0),r.responseType="arraybuffer",r.onload=function(){return 200!==r.status?e("Font could not be loaded: "+r.statusText):e(null,r.response)},r.send()}function a(t){var e,r,n,i,o,a,s,c=new u.Font,p=new DataView(t,0),E=l.getFixed(p,0);if(1===E)c.outlinesFormat="truetype";else{if(E=l.getTag(p,0),"OTTO"!==E)throw new Error("Unsupported OpenType version "+E);c.outlinesFormat="cff"}for(var C=l.getUShort(p,4),A=12,R=0;C>R;R+=1){var P=l.getTag(p,A),L=l.getULong(p,A+8);switch(P){case"cmap":c.tables.cmap=f.parse(p,L),c.encoding=new h.CmapEncoding(c.tables.cmap),c.encoding||(c.supported=!1);break;case"head":c.tables.head=y.parse(p,L),c.unitsPerEm=c.tables.head.unitsPerEm,e=c.tables.head.indexToLocFormat;break;case"hhea":c.tables.hhea=v.parse(p,L),c.ascender=c.tables.hhea.ascender,c.descender=c.tables.hhea.descender,c.numberOfHMetrics=c.tables.hhea.numberOfHMetrics;break;case"hmtx":r=L;break;case"maxp":c.tables.maxp=w.parse(p,L),c.numGlyphs=c.tables.maxp.numGlyphs;break;case"name":c.tables.name=S.parse(p,L),c.familyName=c.tables.name.fontFamily,c.styleName=c.tables.name.fontSubfamily;break;case"OS/2":c.tables.os2=M.parse(p,L);break;case"post":c.tables.post=T.parse(p,L),c.glyphNames=new h.GlyphNames(c.tables.post);break;case"glyf":n=L;break;case"loca":i=L;break;case"CFF ":o=L;break;case"kern":a=L;break;case"GPOS":s=L}A+=16}if(n&&i){var O=0===e,D=b.parse(p,i,c.numGlyphs,O);c.glyphs=m.parse(p,n,D,c),_.parse(p,r,c.numberOfHMetrics,c.numGlyphs,c.glyphs),h.addGlyphNames(c)}else o?(d.parse(p,o,c),h.addGlyphNames(c)):c.supported=!1;return c.supported&&(a?c.kerningPairs=x.parse(p,a):c.kerningPairs={},s&&g.parse(p,s,c)),c}function s(t,e){var r="undefined"==typeof window,n=r?i:o;n(t,function(t,r){if(t)return e(t);var n=a(r);return n.supported?e(null,n):e("Font is not supported (is this a Postscript font?)")})}var h=t("./encoding"),u=t("./font"),c=t("./glyph"),l=t("./parse"),p=t("./path"),f=t("./tables/cmap"),d=t("./tables/cff"),m=t("./tables/glyf"),g=t("./tables/gpos"),y=t("./tables/head"),v=t("./tables/hhea"),_=t("./tables/hmtx"),x=t("./tables/kern"),b=t("./tables/loca"),w=t("./tables/maxp"),S=t("./tables/name"),M=t("./tables/os2"),T=t("./tables/post");r._parse=l,r.Font=u.Font,r.Glyph=c.Glyph,r.Path=p.Path,r.parse=a,r.load=s},{"./encoding":4,"./font":5,"./glyph":6,"./parse":9,"./path":10,"./tables/cff":12,"./tables/cmap":13,"./tables/glyf":14,"./tables/gpos":15,"./tables/head":16,"./tables/hhea":17,"./tables/hmtx":18,"./tables/kern":19,"./tables/loca":20,"./tables/maxp":21,"./tables/name":22,"./tables/os2":23,"./tables/post":24,fs:1}],9:[function(t,e,r){"use strict";function n(t,e){this.data=t,this.offset=e,this.relativeOffset=0}r.getByte=function(t,e){return t.getUint8(e)},r.getCard8=r.getByte,r.getUShort=function(t,e){return t.getUint16(e,!1)},r.getCard16=r.getUShort,r.getShort=function(t,e){return t.getInt16(e,!1)},r.getULong=function(t,e){return t.getUint32(e,!1)},r.getFixed=function(t,e){var r=t.getInt16(e,!1),n=t.getUint16(e+2,!1);return r+n/65535},r.getTag=function(t,e){for(var r="",n=e;e+4>n;n+=1)r+=String.fromCharCode(t.getInt8(n));return r},r.getOffset=function(t,e,r){for(var n=0,i=0;r>i;i+=1)n<<=8,n+=t.getUint8(e+i);return n},r.getBytes=function(t,e,r){for(var n=[],i=e;r>i;i+=1)n.push(t.getUint8(i));return n},r.bytesToString=function(t){for(var e="",r=0;r<t.length;r+=1)e+=String.fromCharCode(t[r]);return e};var i={"byte":1,uShort:2,"short":2,uLong:4,fixed:4,longDateTime:8,tag:4};n.prototype.parseByte=function(){var t=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},n.prototype.parseChar=function(){var t=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},n.prototype.parseCard8=n.prototype.parseByte,n.prototype.parseUShort=function(){var t=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},n.prototype.parseCard16=n.prototype.parseUShort,n.prototype.parseSID=n.prototype.parseUShort,n.prototype.parseOffset16=n.prototype.parseUShort,n.prototype.parseShort=function(){var t=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},n.prototype.parseF2Dot14=function(){var t=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,t},n.prototype.parseULong=function(){var t=r.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},n.prototype.parseFixed=function(){var t=r.getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},n.prototype.parseOffset16List=n.prototype.parseUShortList=function(t){for(var e=new Array(t),n=this.data,i=this.offset+this.relativeOffset,o=0;t>o;o++)e[o]=r.getUShort(n,i),i+=2;return this.relativeOffset+=2*t,e},n.prototype.parseString=function(t){var e=this.data,r=this.offset+this.relativeOffset,n="";this.relativeOffset+=t;for(var i=0;t>i;i++)n+=String.fromCharCode(e.getUint8(r+i));return n},n.prototype.parseTag=function(){return this.parseString(4)},n.prototype.parseLongDateTime=function(){var t=r.getULong(this.data,this.offset+this.relativeOffset+4);return this.relativeOffset+=8,t},n.prototype.parseFixed=function(){var t=r.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t/65536},n.prototype.parseVersion=function(){var t=r.getUShort(this.data,this.offset+this.relativeOffset),e=r.getUShort(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,t+e/4096/10},n.prototype.skip=function(t,e){void 0===e&&(e=1),this.relativeOffset+=i[t]*e},r.Parser=n},{}],10:[function(t,e,r){"use strict";function n(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}n.prototype.moveTo=function(t,e){this.commands.push({type:"M",x:t,y:e})},n.prototype.lineTo=function(t,e){this.commands.push({type:"L",x:t,y:e})},n.prototype.curveTo=n.prototype.bezierCurveTo=function(t,e,r,n,i,o){this.commands.push({type:"C",x1:t,y1:e,x2:r,y2:n,x:i,y:o})},n.prototype.quadTo=n.prototype.quadraticCurveTo=function(t,e,r,n){this.commands.push({type:"Q",x1:t,y1:e,x:r,y:n})},n.prototype.close=n.prototype.closePath=function(){this.commands.push({type:"Z"})},n.prototype.extend=function(t){t.commands&&(t=t.commands),Array.prototype.push.apply(this.commands,t)},n.prototype.draw=function(t){t.beginPath();for(var e=0;e<this.commands.length;e+=1){var r=this.commands[e];"M"===r.type?t.moveTo(r.x,r.y):"L"===r.type?t.lineTo(r.x,r.y):"C"===r.type?t.bezierCurveTo(r.x1,r.y1,r.x2,r.y2,r.x,r.y):"Q"===r.type?t.quadraticCurveTo(r.x1,r.y1,r.x,r.y):"Z"===r.type&&t.closePath()}this.fill&&(t.fillStyle=this.fill,t.fill()),this.stroke&&(t.strokeStyle=this.stroke,t.lineWidth=this.strokeWidth,t.stroke())},n.prototype.toPathData=function(t){function e(e){return Math.round(e)===e?""+Math.round(e):e.toFixed(t)}function r(){for(var t="",r=0;r<arguments.length;r+=1){var n=arguments[r];n>=0&&r>0&&(t+=" "),t+=e(n)}return t}t=void 0!==t?t:2;for(var n="",i=0;i<this.commands.length;i+=1){var o=this.commands[i];"M"===o.type?n+="M"+r(o.x,o.y):"L"===o.type?n+="L"+r(o.x,o.y):"C"===o.type?n+="C"+r(o.x1,o.y1,o.x2,o.y2,o.x,o.y):"Q"===o.type?n+="Q"+r(o.x1,o.y1,o.x,o.y):"Z"===o.type&&(n+="Z")}return n},n.prototype.toSVG=function(t){var e='<path d="';return e+=this.toPathData(t),e+='"',this.fill&"black"!==this.fill&&(e+=null===this.fill?' fill="none"':' fill="'+this.fill+'"'),this.stroke&&(e+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),e+="/>"},r.Path=n},{}],11:[function(t,e,r){"use strict";function n(t,e,r){var n;for(n=0;n<e.length;n+=1){var i=e[n];this[i.name]=i.value}if(this.tableName=t,this.fields=e,r){var o=Object.keys(r);for(n=0;n<o.length;n+=1){var a=o[n],s=r[a];void 0!==this[a]&&(this[a]=s)}}}var i=t("./check"),o=t("./types").encode,a=t("./types").sizeOf;n.prototype.sizeOf=function(){for(var t=0,e=0;e<this.fields.length;e+=1){var r=this.fields[e],n=this[r.name];if(void 0===n&&(n=r.value),"function"==typeof n.sizeOf)t+=n.sizeOf();else{var o=a[r.type];i.assert("function"==typeof o,"Could not find sizeOf function for field"+r.name),t+=o(n)}}return t},n.prototype.encode=function(){return o.TABLE(this)},r.Table=n},{"./check":2,"./types":26}],12:[function(t,e,r){"use strict";function n(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r+=1)if(!n(t[r],e[r]))return!1;return!0}return!1}function i(t,e,r){var n,i,o,a=[],s=[],h=F.getCard16(t,e);if(0!==h){var u=F.getByte(t,e+2);i=e+(h+1)*u+2;var c=e+3;for(n=0;h+1>n;n+=1)a.push(F.getOffset(t,c,u)),c+=u;o=i+a[h]}else o=e+2;for(n=0;n<a.length-1;n+=1){var l=F.getBytes(t,i+a[n],i+a[n+1]);r&&(l=r(l)),s.push(l)}return{objects:s,startOffset:e,endOffset:o}}function o(t){for(var e="",r=15,n=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var i=t.parseByte(),o=i>>4,a=15&i;if(o===r)break;if(e+=n[o],a===r)break;e+=n[a]}return parseFloat(e)}function a(t,e){var r,n,i,a;if(28===e)return r=t.parseByte(),n=t.parseByte(),r<<8|n;if(29===e)return r=t.parseByte(),n=t.parseByte(),i=t.parseByte(),a=t.parseByte(),r<<24|n<<16|i<<8|a;if(30===e)return o(t);if(e>=32&&246>=e)return e-139;if(e>=247&&250>=e)return r=t.parseByte(),256*(e-247)+r+108;if(e>=251&&254>=e)return r=t.parseByte(),256*-(e-251)-r-108;throw new Error("Invalid b0 "+e)}function s(t){for(var e={},r=0;r<t.length;r+=1){var n,i=t[r][0],o=t[r][1];if(n=1===o.length?o[0]:o,e.hasOwnProperty(i))throw new Error("Object "+e+" already has key "+i);e[i]=n}return e}function h(t,e,r){e=void 0!==e?e:0;var n=new F.Parser(t,e),i=[],o=[];for(r=void 0!==r?r:t.length;n.relativeOffset<r;){var h=n.parseByte();21>=h?(12===h&&(h=1200+n.parseByte()),i.push([h,o]),o=[]):o.push(a(n,h))}return s(i)}function u(t,e){return e=390>=e?D.cffStandardStrings[e]:t[e-391]}function c(t,e,r){for(var n={},i=0;i<e.length;i+=1){var o=e[i],a=t[o.op];void 0===a&&(a=void 0!==o.value?o.value:null),"SID"===o.type&&(a=u(r,a)),n[o.name]=a}return n}function l(t,e){var r={};return r.formatMajor=F.getCard8(t,e),r.formatMinor=F.getCard8(t,e+1),r.size=F.getCard8(t,e+2),r.offsetSize=F.getCard8(t,e+3),r.startOffset=e,r.endOffset=e+4,r}function p(t,e){var r=h(t,0,t.byteLength);return c(r,U,e)}function f(t,e,r,n){var i=h(t,e,r);return c(i,B,n)}function d(t,e,r,n){var i,o,a,s=new F.Parser(t,e);r-=1;var h=[".notdef"],c=s.parseCard8();if(0===c)for(i=0;r>i;i+=1)o=s.parseSID(),h.push(u(n,o));else if(1===c)for(;h.length<=r;)for(o=s.parseSID(),a=s.parseCard8(),i=0;a>=i;i+=1)h.push(u(n,o)),o+=1;else{if(2!==c)throw new Error("Unknown charset format "+c);for(;h.length<=r;)for(o=s.parseSID(),a=s.parseCard16(),i=0;a>=i;i+=1)h.push(u(n,o)),o+=1}return h}function m(t,e,r){var n,i,o={},a=new F.Parser(t,e),s=a.parseCard8();if(0===s){var h=a.parseCard8();for(n=0;h>n;n+=1)i=a.parseCard8(),o[i]=n}else{if(1!==s)throw new Error("Unknown encoding format "+s);var u=a.parseCard8();for(i=1,n=0;u>n;n+=1)for(var c=a.parseCard8(),l=a.parseCard8(),p=c;c+l>=p;p+=1)o[p]=i,i+=1}return new D.CffEncoding(o,r)}function g(t,e,r){function n(t,e){m&&c.closePath(),c.moveTo(t,e),m=!0}function i(){var e;e=l.length%2!==0,e&&!f&&(d=l.shift()+t.nominalWidthX),p+=l.length>>1,l.length=0,f=!0}function o(r){for(var v,_,x,b,w,S,M,T,E,C,A,R,P=0;P<r.length;){var L=r[P];switch(P+=1,L){case 1:i();break;case 3:i();break;case 4:l.length>1&&!f&&(d=l.shift()+t.nominalWidthX,f=!0),y+=l.pop(),n(g,y);break;case 5:for(;l.length>0;)g+=l.shift(),y+=l.shift(),c.lineTo(g,y);break;case 6:for(;l.length>0&&(g+=l.shift(),c.lineTo(g,y),0!==l.length);)y+=l.shift(),c.lineTo(g,y);break;case 7:for(;l.length>0&&(y+=l.shift(),c.lineTo(g,y),0!==l.length);)g+=l.shift(),c.lineTo(g,y);break;case 8:for(;l.length>0;)a=g+l.shift(),s=y+l.shift(),h=a+l.shift(),u=s+l.shift(),g=h+l.shift(),y=u+l.shift(),c.curveTo(a,s,h,u,g,y);break;case 10:w=l.pop()+t.subrsBias,S=t.subrs[w],S&&o(S);break;case 11:return;case 12:switch(L=r[P],P+=1,L){case 35:a=g+l.shift(),s=y+l.shift(),h=a+l.shift(),u=s+l.shift(),M=h+l.shift(),T=u+l.shift(),E=M+l.shift(),C=T+l.shift(),A=E+l.shift(),R=C+l.shift(),g=A+l.shift(),y=R+l.shift(),l.shift(),c.curveTo(a,s,h,u,M,T),c.curveTo(E,C,A,R,g,y);break;case 34:a=g+l.shift(),s=y,h=a+l.shift(),u=s+l.shift(),M=h+l.shift(),T=u,E=M+l.shift(),C=u,A=E+l.shift(),R=y,g=A+l.shift(),c.curveTo(a,s,h,u,M,T),c.curveTo(E,C,A,R,g,y);break;case 36:a=g+l.shift(),s=y+l.shift(),h=a+l.shift(),u=s+l.shift(),M=h+l.shift(),T=u,E=M+l.shift(),C=u,A=E+l.shift(),R=C+l.shift(),g=A+l.shift(),c.curveTo(a,s,h,u,M,T),c.curveTo(E,C,A,R,g,y);break;case 37:a=g+l.shift(),s=y+l.shift(),h=a+l.shift(),u=s+l.shift(),M=h+l.shift(),T=u+l.shift(),E=M+l.shift(),C=T+l.shift(),A=E+l.shift(),R=C+l.shift(),Math.abs(A-g)>Math.abs(R-y)?g=A+l.shift():y=R+l.shift(),c.curveTo(a,s,h,u,M,T),c.curveTo(E,C,A,R,g,y);break;default:console.log("Glyph "+e.index+": unknown operator 1200"+L),l.length=0}break;case 14:l.length>0&&!f&&(d=l.shift()+t.nominalWidthX,f=!0),m&&(c.closePath(),m=!1);break;case 18:i();break;case 19:case 20:i(),P+=p+7>>3;break;case 21:l.length>2&&!f&&(d=l.shift()+t.nominalWidthX,f=!0),y+=l.pop(),g+=l.pop(),n(g,y);break;case 22:l.length>1&&!f&&(d=l.shift()+t.nominalWidthX,f=!0),g+=l.pop(),n(g,y);break;case 23:i();break;case 24:for(;l.length>2;)a=g+l.shift(),s=y+l.shift(),h=a+l.shift(),u=s+l.shift(),g=h+l.shift(),y=u+l.shift(),c.curveTo(a,s,h,u,g,y);g+=l.shift(),y+=l.shift(),c.lineTo(g,y);break;case 25:for(;l.length>6;)g+=l.shift(),y+=l.shift(),c.lineTo(g,y);a=g+l.shift(),s=y+l.shift(),h=a+l.shift(),u=s+l.shift(),g=h+l.shift(),y=u+l.shift(),c.curveTo(a,s,h,u,g,y);break;case 26:for(l.length%2&&(g+=l.shift());l.length>0;)a=g,s=y+l.shift(),h=a+l.shift(),u=s+l.shift(),g=h,y=u+l.shift(),c.curveTo(a,s,h,u,g,y);break;case 27:for(l.length%2&&(y+=l.shift());l.length>0;)a=g+l.shift(),s=y,h=a+l.shift(),u=s+l.shift(),g=h+l.shift(),y=u,c.curveTo(a,s,h,u,g,y);break;case 28:v=r[P],_=r[P+1],l.push((v<<24|_<<16)>>16),P+=2;break;case 29:w=l.pop()+t.gsubrsBias,S=t.gsubrs[w],S&&o(S);break;case 30:for(;l.length>0&&(a=g,s=y+l.shift(),h=a+l.shift(),u=s+l.shift(),g=h+l.shift(),y=u+(1===l.length?l.shift():0),c.curveTo(a,s,h,u,g,y),0!==l.length);)a=g+l.shift(),s=y,h=a+l.shift(),u=s+l.shift(),y=u+l.shift(),g=h+(1===l.length?l.shift():0),c.curveTo(a,s,h,u,g,y);break;case 31:for(;l.length>0&&(a=g+l.shift(),s=y,h=a+l.shift(),u=s+l.shift(),y=u+l.shift(),g=h+(1===l.length?l.shift():0),c.curveTo(a,s,h,u,g,y),0!==l.length);)a=g,s=y+l.shift(),h=a+l.shift(),u=s+l.shift(),g=h+l.shift(),y=u+(1===l.length?l.shift():0),c.curveTo(a,s,h,u,g,y);break;default:32>L?console.log("Glyph "+e.index+": unknown operator "+L):247>L?l.push(L-139):251>L?(v=r[P],P+=1,l.push(256*(L-247)+v+108)):255>L?(v=r[P],P+=1,l.push(256*-(L-251)-v-108)):(v=r[P],_=r[P+1],x=r[P+2],b=r[P+3],P+=4,l.push((v<<24|_<<16|x<<8|b)/65536))}}}var a,s,h,u,c=new N.Path,l=[],p=0,f=!1,d=t.defaultWidthX,m=!1,g=0,y=0;return o(r),e.advanceWidth=d,c}function y(t){var e;return e=t.length<1240?107:t.length<33900?1131:32768}function v(t,e,r){r.tables.cff={};var n=l(t,e),o=i(t,n.endOffset,F.bytesToString),a=i(t,o.endOffset),s=i(t,a.endOffset,F.bytesToString),h=i(t,s.endOffset);r.gsubrs=h.objects,r.gsubrsBias=y(r.gsubrs);var u=new DataView(new Uint8Array(a.objects[0]).buffer),c=p(u,s.objects);r.tables.cff.topDict=c;var v=e+c["private"][1],_=f(t,v,c["private"][0],s.objects);if(r.defaultWidthX=_.defaultWidthX,r.nominalWidthX=_.nominalWidthX,0!==_.subrs){var x=v+_.subrs,b=i(t,x);r.subrs=b.objects,r.subrsBias=y(r.subrs)}else r.subrs=[],r.subrsBias=0;var w=i(t,e+c.charStrings);r.nGlyphs=w.objects.length;var S=d(t,e+c.charset,r.nGlyphs,s.objects);0===c.encoding?r.cffEncoding=new D.CffEncoding(D.cffStandardEncoding,S):1===c.encoding?r.cffEncoding=new D.CffEncoding(D.cffExpertEncoding,S):r.cffEncoding=m(t,e+c.encoding,S),r.encoding=r.encoding||r.cffEncoding,r.glyphs=new k.GlyphSet(r);for(var M=0;M<r.nGlyphs;M+=1){var T=w.objects[M];r.glyphs.push(M,k.cffGlyphLoader(r,M,g,T))}}function _(t,e){var r,n=D.cffStandardStrings.indexOf(t);return n>=0&&(r=n),n=e.indexOf(t),n>=0?r=n+D.cffStandardStrings.length:(r=D.cffStandardStrings.length+e.length,e.push(t)),r}function x(){return new I.Table("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function b(t){var e=new I.Table("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);e.names=[];for(var r=0;r<t.length;r+=1)e.names.push({name:"name_"+r,type:"NAME",value:t[r]});return e}function w(t,e,r){for(var i={},o=0;o<t.length;o+=1){var a=t[o],s=e[a.name];void 0===s||n(s,a.value)||("SID"===a.type&&(s=_(s,r)),i[a.op]={name:a.name,type:a.type,value:s})}return i}function S(t,e){var r=new I.Table("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=w(U,t,e),r}function M(t){var e=new I.Table("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return e.topDicts=[{name:"topDict_0",type:"TABLE",value:t}],e}function T(t){var e=new I.Table("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);e.strings=[];for(var r=0;r<t.length;r+=1)e.strings.push({name:"string_"+r,type:"STRING",value:t[r]});return e}function E(){return new I.Table("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function C(t,e){for(var r=new I.Table("Charsets",[{name:"format",type:"Card8",value:0}]),n=0;n<t.length;n+=1){var i=t[n],o=_(i,e);r.fields.push({name:"glyph_"+n,type:"SID",value:o})}return r}function A(t){var e=[],r=t.path;e.push({name:"width",type:"NUMBER",value:t.advanceWidth});for(var n=0,i=0,o=0;o<r.commands.length;o+=1){var a,s,h=r.commands[o];if("Q"===h.type){var u=1/3,c=2/3;h={type:"C",x:h.x,y:h.y,x1:u*n+c*h.x1,y1:u*i+c*h.y1,x2:u*h.x+c*h.x1,y2:u*h.y+c*h.y1}}if("M"===h.type)a=Math.round(h.x-n),s=Math.round(h.y-i),e.push({name:"dx",type:"NUMBER",value:a}),e.push({name:"dy",type:"NUMBER",value:s}),e.push({name:"rmoveto",type:"OP",value:21}),n=Math.round(h.x),i=Math.round(h.y);else if("L"===h.type)a=Math.round(h.x-n),s=Math.round(h.y-i),e.push({name:"dx",type:"NUMBER",value:a}),e.push({name:"dy",type:"NUMBER",value:s}),e.push({name:"rlineto",type:"OP",value:5}),n=Math.round(h.x),i=Math.round(h.y);else if("C"===h.type){var l=Math.round(h.x1-n),p=Math.round(h.y1-i),f=Math.round(h.x2-h.x1),d=Math.round(h.y2-h.y1);a=Math.round(h.x-h.x2),s=Math.round(h.y-h.y2),e.push({name:"dx1",type:"NUMBER",value:l}),e.push({name:"dy1",type:"NUMBER",value:p}),e.push({name:"dx2",type:"NUMBER",value:f}),e.push({name:"dy2",type:"NUMBER",value:d}),e.push({name:"dx",type:"NUMBER",value:a}),e.push({name:"dy",type:"NUMBER",value:s}),e.push({name:"rrcurveto",type:"OP",value:8}),n=Math.round(h.x),i=Math.round(h.y)}}return e.push({name:"endchar",type:"OP",value:14}),e}function R(t){for(var e=new I.Table("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),r=0;r<t.length;r+=1){var n=t.get(r),i=A(n);e.charStrings.push({name:n.name,type:"CHARSTRING",value:i})}return e}function P(t,e){var r=new I.Table("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=w(B,t,e),r}function L(t){var e=new I.Table("Private DICT INDEX",[{name:"privateDicts",type:"INDEX",value:[]}]);return e.privateDicts=[{name:"privateDict_0",type:"TABLE",value:t}],e}function O(t,e){for(var r,n=new I.Table("CFF ",[{name:"header",type:"TABLE"},{name:"nameIndex",type:"TABLE"},{name:"topDictIndex",type:"TABLE"},{name:"stringIndex",type:"TABLE"},{name:"globalSubrIndex",type:"TABLE"},{name:"charsets",type:"TABLE"},{name:"charStringsIndex",type:"TABLE"},{name:"privateDictIndex",type:"TABLE"}]),i=1/e.unitsPerEm,o={version:e.version,fullName:e.fullName,familyName:e.familyName,weight:e.weightName,fontMatrix:[i,0,0,i,0,0],charset:999,encoding:0,charStrings:999,"private":[0,999]},a={},s=[],h=1;h<t.length;h+=1)r=t.get(h),s.push(r.name);var u=[];n.header=x(),n.nameIndex=b([e.postScriptName]);var c=S(o,u);n.topDictIndex=M(c),n.globalSubrIndex=E(),n.charsets=C(s,u),n.charStringsIndex=R(t);var l=P(a,u);n.privateDictIndex=L(l),n.stringIndex=T(u);var p=n.header.sizeOf()+n.nameIndex.sizeOf()+n.topDictIndex.sizeOf()+n.stringIndex.sizeOf()+n.globalSubrIndex.sizeOf();return o.charset=p,o.encoding=0,o.charStrings=o.charset+n.charsets.sizeOf(),o["private"][1]=o.charStrings+n.charStringsIndex.sizeOf(),c=S(o,u),n.topDictIndex=M(c),n}var D=t("../encoding"),k=t("../glyphset"),F=t("../parse"),N=t("../path"),I=t("../table"),U=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]}],B=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];r.parse=v,r.make=O},{"../encoding":4,"../glyphset":7,"../parse":9,"../path":10,"../table":11}],13:[function(t,e,r){"use strict";function n(t,e){var r,n={};n.version=h.getUShort(t,e),s.argument(0===n.version,"cmap table version should be 0."),n.numTables=h.getUShort(t,e+2);var i=-1;for(r=0;r<n.numTables;r+=1){var o=h.getUShort(t,e+4+8*r),a=h.getUShort(t,e+4+8*r+2);if(3===o&&(1===a||0===a)){i=h.getULong(t,e+4+8*r+4);break}}if(-1===i)return null;var u=new h.Parser(t,e+i);n.format=u.parseUShort(),s.argument(4===n.format,"Only format 4 cmap tables are supported."),n.length=u.parseUShort(),n.language=u.parseUShort();var c;n.segCount=c=u.parseUShort()>>1,u.skip("uShort",3),n.glyphIndexMap={};var l=new h.Parser(t,e+i+14),p=new h.Parser(t,e+i+16+2*c),f=new h.Parser(t,e+i+16+4*c),d=new h.Parser(t,e+i+16+6*c),m=e+i+16+8*c;for(r=0;c-1>r;r+=1)for(var g,y=l.parseUShort(),v=p.parseUShort(),_=f.parseShort(),x=d.parseUShort(),b=v;y>=b;b+=1)0!==x?(m=d.offset+d.relativeOffset-2,m+=x,m+=2*(b-v),g=h.getUShort(t,m),0!==g&&(g=g+_&65535)):g=b+_&65535,n.glyphIndexMap[b]=g;return n}function i(t,e,r){t.segments.push({end:e,start:e,delta:-(e-r),offset:0})}function o(t){t.segments.push({end:65535,start:65535,delta:1,offset:0})}function a(t){var e,r=new u.Table("cmap",[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:1},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:12},{name:"format",type:"USHORT",value:4},{name:"length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);for(r.segments=[],e=0;e<t.length;e+=1){for(var n=t.get(e),a=0;a<n.unicodes.length;a+=1)i(r,n.unicodes[a],e);r.segments=r.segments.sort(function(t,e){return t.start-e.start})}o(r);var s;s=r.segments.length,r.segCountX2=2*s,r.searchRange=2*Math.pow(2,Math.floor(Math.log(s)/Math.log(2))),r.entrySelector=Math.log(r.searchRange/2)/Math.log(2),r.rangeShift=r.segCountX2-r.searchRange;
var h=[],c=[],l=[],p=[],f=[];for(e=0;s>e;e+=1){var d=r.segments[e];h=h.concat({name:"end_"+e,type:"USHORT",value:d.end}),c=c.concat({name:"start_"+e,type:"USHORT",value:d.start}),l=l.concat({name:"idDelta_"+e,type:"SHORT",value:d.delta}),p=p.concat({name:"idRangeOffset_"+e,type:"USHORT",value:d.offset}),void 0!==d.glyphId&&(f=f.concat({name:"glyph_"+e,type:"USHORT",value:d.glyphId}))}return r.fields=r.fields.concat(h),r.fields.push({name:"reservedPad",type:"USHORT",value:0}),r.fields=r.fields.concat(c),r.fields=r.fields.concat(l),r.fields=r.fields.concat(p),r.fields=r.fields.concat(f),r.length=14+2*h.length+2+2*c.length+2*l.length+2*p.length+2*f.length,r}var s=t("../check"),h=t("../parse"),u=t("../table");r.parse=n,r.make=a},{"../check":2,"../parse":9,"../table":11}],14:[function(t,e,r){"use strict";function n(t,e,r,n,i){var o;return(e&n)>0?(o=t.parseByte(),0===(e&i)&&(o=-o),o=r+o):o=(e&i)>0?r:r+t.parseShort(),o}function i(t,e,r){var i=new p.Parser(e,r);t.numberOfContours=i.parseShort(),t.xMin=i.parseShort(),t.yMin=i.parseShort(),t.xMax=i.parseShort(),t.yMax=i.parseShort();var o,a;if(t.numberOfContours>0){var s,h=t.endPointIndices=[];for(s=0;s<t.numberOfContours;s+=1)h.push(i.parseUShort());for(t.instructionLength=i.parseUShort(),t.instructions=[],s=0;s<t.instructionLength;s+=1)t.instructions.push(i.parseByte());var u=h[h.length-1]+1;for(o=[],s=0;u>s;s+=1)if(a=i.parseByte(),o.push(a),(8&a)>0)for(var l=i.parseByte(),f=0;l>f;f+=1)o.push(a),s+=1;if(c.argument(o.length===u,"Bad flags."),h.length>0){var d,m=[];if(u>0){for(s=0;u>s;s+=1)a=o[s],d={},d.onCurve=!!(1&a),d.lastPointOfContour=h.indexOf(s)>=0,m.push(d);var g=0;for(s=0;u>s;s+=1)a=o[s],d=m[s],d.x=n(i,a,g,2,16),g=d.x;var y=0;for(s=0;u>s;s+=1)a=o[s],d=m[s],d.y=n(i,a,y,4,32),y=d.y}t.points=m}else t.points=[]}else if(0===t.numberOfContours)t.points=[];else{t.isComposite=!0,t.points=[],t.components=[];for(var v=!0;v;){o=i.parseUShort();var _={glyphIndex:i.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&o)>0?(_.dx=i.parseShort(),_.dy=i.parseShort()):(_.dx=i.parseChar(),_.dy=i.parseChar()),(8&o)>0?_.xScale=_.yScale=i.parseF2Dot14():(64&o)>0?(_.xScale=i.parseF2Dot14(),_.yScale=i.parseF2Dot14()):(128&o)>0&&(_.xScale=i.parseF2Dot14(),_.scale01=i.parseF2Dot14(),_.scale10=i.parseF2Dot14(),_.yScale=i.parseF2Dot14()),t.components.push(_),v=!!(32&o)}}}function o(t,e){for(var r=[],n=0;n<t.length;n+=1){var i=t[n],o={x:e.xScale*i.x+e.scale01*i.y+e.dx,y:e.scale10*i.x+e.yScale*i.y+e.dy,onCurve:i.onCurve,lastPointOfContour:i.lastPointOfContour};r.push(o)}return r}function a(t){for(var e=[],r=[],n=0;n<t.length;n+=1){var i=t[n];r.push(i),i.lastPointOfContour&&(e.push(r),r=[])}return c.argument(0===r.length,"There are still points left in the current contour."),e}function s(t){var e=new f.Path;if(!t)return e;for(var r=a(t),n=0;n<r.length;n+=1){var i,o,s=r[n],h=s[0],u=s[s.length-1];h.onCurve?(i=null,o=!0):(h=u.onCurve?u:{x:(h.x+u.x)/2,y:(h.y+u.y)/2},i=h,o=!1),e.moveTo(h.x,h.y);for(var c=o?1:0;c<s.length;c+=1){var l=s[c],p=0===c?h:s[c-1];if(p.onCurve&&l.onCurve)e.lineTo(l.x,l.y);else if(p.onCurve&&!l.onCurve)i=l;else if(p.onCurve||l.onCurve){if(p.onCurve||!l.onCurve)throw new Error("Invalid state.");e.quadraticCurveTo(i.x,i.y,l.x,l.y),i=null}else{var d={x:(p.x+l.x)/2,y:(p.y+l.y)/2};e.quadraticCurveTo(p.x,p.y,d.x,d.y),i=l}}h!==u&&(i?e.quadraticCurveTo(i.x,i.y,h.x,h.y):e.lineTo(h.x,h.y))}return e.closePath(),e}function h(t,e){if(e.isComposite)for(var r=0;r<e.components.length;r+=1){var n=e.components[r],i=t.get(n.glyphIndex);if(i.points){var a=o(i.points,n);e.points=e.points.concat(a)}}return s(e.points)}function u(t,e,r,n){var o,a=new l.GlyphSet(n);for(o=0;o<r.length-1;o+=1){var s=r[o],u=r[o+1];s!==u?a.push(o,l.ttfGlyphLoader(n,o,i,t,e+s,h)):a.push(o,l.glyphLoader(n,o))}return a}var c=t("../check"),l=t("../glyphset"),p=t("../parse"),f=t("../path");r.parse=u},{"../check":2,"../glyphset":7,"../parse":9,"../path":10}],15:[function(t,e,r){"use strict";function n(t,e){for(var r=new c.Parser(t,e),n=r.parseUShort(),i=[],o=0;n>o;o++)i[r.parseTag()]={offset:r.parseUShort()};return i}function i(t,e){var r=new c.Parser(t,e),n=r.parseUShort(),i=r.parseUShort();if(1===n)return r.parseUShortList(i);if(2===n){for(var o=[];i--;)for(var a=r.parseUShort(),s=r.parseUShort(),h=r.parseUShort(),u=a;s>=u;u++)o[h++]=u;return o}}function o(t,e){var r=new c.Parser(t,e),n=r.parseUShort();if(1===n){var i=r.parseUShort(),o=r.parseUShort(),a=r.parseUShortList(o);return function(t){return a[t-i]||0}}if(2===n){for(var s=r.parseUShort(),h=[],u=[],l=[],p=0;s>p;p++)h[p]=r.parseUShort(),u[p]=r.parseUShort(),l[p]=r.parseUShort();return function(t){for(var e=0,r=h.length-1;r>e;){var n=e+r+1>>1;t<h[n]?r=n-1:e=n}return h[e]<=t&&t<=u[e]?l[e]||0:0}}}function a(t,e){var r,n,a=new c.Parser(t,e),s=a.parseUShort(),h=a.parseUShort(),u=i(t,e+h),l=a.parseUShort(),p=a.parseUShort();if(4===l&&0===p){var f={};if(1===s){for(var d=a.parseUShort(),m=[],g=a.parseOffset16List(d),y=0;d>y;y++){var v=g[y],_=f[v];if(!_){_={},a.relativeOffset=v;for(var x=a.parseUShort();x--;){var b=a.parseUShort();l&&(r=a.parseShort()),p&&(n=a.parseShort()),_[b]=r}}m[u[y]]=_}return function(t,e){var r=m[t];return r?r[e]:void 0}}if(2===s){for(var w=a.parseUShort(),S=a.parseUShort(),M=a.parseUShort(),T=a.parseUShort(),E=o(t,e+w),C=o(t,e+S),A=[],R=0;M>R;R++)for(var P=A[R]=[],L=0;T>L;L++)l&&(r=a.parseShort()),p&&(n=a.parseShort()),P[L]=r;var O={};for(R=0;R<u.length;R++)O[u[R]]=1;return function(t,e){if(O[t]){var r=E(t),n=C(e),i=A[r];return i?i[n]:void 0}}}}}function s(t,e){var r=new c.Parser(t,e),n=r.parseUShort(),i=r.parseUShort(),o=16&i,s=r.parseUShort(),h=r.parseOffset16List(s),u={lookupType:n,lookupFlag:i,markFilteringSet:o?r.parseUShort():-1};if(2===n){for(var l=[],p=0;s>p;p++)l.push(a(t,e+h[p]));u.getKerningValue=function(t,e){for(var r=l.length;r--;){var n=l[r](t,e);if(void 0!==n)return n}return 0}}return u}function h(t,e,r){var i=new c.Parser(t,e),o=i.parseFixed();u.argument(1===o,"Unsupported GPOS table version."),n(t,e+i.parseUShort()),n(t,e+i.parseUShort());var a=i.parseUShort();i.relativeOffset=a;for(var h=i.parseUShort(),l=i.parseOffset16List(h),p=e+a,f=0;h>f;f++){var d=s(t,p+l[f]);2!==d.lookupType||r.getGposKerningValue||(r.getGposKerningValue=d.getKerningValue)}}var u=t("../check"),c=t("../parse");r.parse=h},{"../check":2,"../parse":9}],16:[function(t,e,r){"use strict";function n(t,e){var r={},n=new a.Parser(t,e);return r.version=n.parseVersion(),r.fontRevision=Math.round(1e3*n.parseFixed())/1e3,r.checkSumAdjustment=n.parseULong(),r.magicNumber=n.parseULong(),o.argument(1594834165===r.magicNumber,"Font header has wrong magic number."),r.flags=n.parseUShort(),r.unitsPerEm=n.parseUShort(),r.created=n.parseLongDateTime(),r.modified=n.parseLongDateTime(),r.xMin=n.parseShort(),r.yMin=n.parseShort(),r.xMax=n.parseShort(),r.yMax=n.parseShort(),r.macStyle=n.parseUShort(),r.lowestRecPPEM=n.parseUShort(),r.fontDirectionHint=n.parseShort(),r.indexToLocFormat=n.parseShort(),r.glyphDataFormat=n.parseShort(),r}function i(t){return new s.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:0},{name:"modified",type:"LONGDATETIME",value:0},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],t)}var o=t("../check"),a=t("../parse"),s=t("../table");r.parse=n,r.make=i},{"../check":2,"../parse":9,"../table":11}],17:[function(t,e,r){"use strict";function n(t,e){var r={},n=new o.Parser(t,e);return r.version=n.parseVersion(),r.ascender=n.parseShort(),r.descender=n.parseShort(),r.lineGap=n.parseShort(),r.advanceWidthMax=n.parseUShort(),r.minLeftSideBearing=n.parseShort(),r.minRightSideBearing=n.parseShort(),r.xMaxExtent=n.parseShort(),r.caretSlopeRise=n.parseShort(),r.caretSlopeRun=n.parseShort(),r.caretOffset=n.parseShort(),n.relativeOffset+=8,r.metricDataFormat=n.parseShort(),r.numberOfHMetrics=n.parseUShort(),r}function i(t){return new a.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],t)}var o=t("../parse"),a=t("../table");r.parse=n,r.make=i},{"../parse":9,"../table":11}],18:[function(t,e,r){"use strict";function n(t,e,r,n,i){for(var a,s,h=new o.Parser(t,e),u=0;n>u;u+=1){r>u&&(a=h.parseUShort(),s=h.parseShort());var c=i.get(u);c.advanceWidth=a,c.leftSideBearing=s}}function i(t){for(var e=new a.Table("hmtx",[]),r=0;r<t.length;r+=1){var n=t.get(r),i=n.advanceWidth||0,o=n.leftSideBearing||0;e.fields.push({name:"advanceWidth_"+r,type:"USHORT",value:i}),e.fields.push({name:"leftSideBearing_"+r,type:"SHORT",value:o})}return e}var o=t("../parse"),a=t("../table");r.parse=n,r.make=i},{"../parse":9,"../table":11}],19:[function(t,e,r){"use strict";function n(t,e){var r={},n=new o.Parser(t,e),a=n.parseUShort();i.argument(0===a,"Unsupported kern table version."),n.skip("uShort",1);var s=n.parseUShort();i.argument(0===s,"Unsupported kern sub-table version."),n.skip("uShort",2);var h=n.parseUShort();n.skip("uShort",3);for(var u=0;h>u;u+=1){var c=n.parseUShort(),l=n.parseUShort(),p=n.parseShort();r[c+","+l]=p}return r}var i=t("../check"),o=t("../parse");r.parse=n},{"../check":2,"../parse":9}],20:[function(t,e,r){"use strict";function n(t,e,r,n){for(var o=new i.Parser(t,e),a=n?o.parseUShort:o.parseULong,s=[],h=0;r+1>h;h+=1){var u=a.call(o);n&&(u*=2),s.push(u)}return s}var i=t("../parse");r.parse=n},{"../parse":9}],21:[function(t,e,r){"use strict";function n(t,e){var r={},n=new o.Parser(t,e);return r.version=n.parseVersion(),r.numGlyphs=n.parseUShort(),1===r.version&&(r.maxPoints=n.parseUShort(),r.maxContours=n.parseUShort(),r.maxCompositePoints=n.parseUShort(),r.maxCompositeContours=n.parseUShort(),r.maxZones=n.parseUShort(),r.maxTwilightPoints=n.parseUShort(),r.maxStorage=n.parseUShort(),r.maxFunctionDefs=n.parseUShort(),r.maxInstructionDefs=n.parseUShort(),r.maxStackElements=n.parseUShort(),r.maxSizeOfInstructions=n.parseUShort(),r.maxComponentElements=n.parseUShort(),r.maxComponentDepth=n.parseUShort()),r}function i(t){return new a.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:t}])}var o=t("../parse"),a=t("../table");r.parse=n,r.make=i},{"../parse":9,"../table":11}],22:[function(t,e,r){"use strict";function n(t,e){var r={},n=new u.Parser(t,e);r.format=n.parseUShort();for(var i=n.parseUShort(),o=n.offset+n.parseUShort(),a=0,s=0;i>s;s++){var h=n.parseUShort(),c=n.parseUShort(),p=n.parseUShort(),f=n.parseUShort(),d=l[f],m=n.parseUShort(),g=n.parseUShort();if(3===h&&1===c&&1033===p){for(var y=[],v=m/2,_=0;v>_;_++,g+=2)y[_]=u.getShort(t,o+g);var x=String.fromCharCode.apply(null,y);d?r[d]=x:(a++,r["unknown"+a]=x)}}return 1===r.format&&(r.langTagCount=n.parseUShort()),r}function i(t,e,r,n,i,o){return new c.Table("NameRecord",[{name:"platformID",type:"USHORT",value:t},{name:"encodingID",type:"USHORT",value:e},{name:"languageID",type:"USHORT",value:r},{name:"nameID",type:"USHORT",value:n},{name:"length",type:"USHORT",value:i},{name:"offset",type:"USHORT",value:o}])}function o(t,e,r,n){var o=h.STRING(r);return t.records.push(i(1,0,0,e,o.length,n)),t.strings.push(o),n+=o.length}function a(t,e,r,n){var o=h.UTF16(r);return t.records.push(i(3,1,1033,e,o.length,n)),t.strings.push(o),n+=o.length}function s(t){var e=new c.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:0},{name:"stringOffset",type:"USHORT",value:0}]);e.records=[],e.strings=[];var r,n,i=0;for(r=0;r<l.length;r+=1)void 0!==t[l[r]]&&(n=t[l[r]],i=o(e,r,n,i));for(r=0;r<l.length;r+=1)void 0!==t[l[r]]&&(n=t[l[r]],i=a(e,r,n,i));for(e.count=e.records.length,e.stringOffset=6+12*e.count,r=0;r<e.records.length;r+=1)e.fields.push({name:"record_"+r,type:"TABLE",value:e.records[r]});for(r=0;r<e.strings.length;r+=1)e.fields.push({name:"string_"+r,type:"LITERAL",value:e.strings[r]});return e}var h=t("../types").encode,u=t("../parse"),c=t("../table"),l=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","licence","licenceURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"];r.parse=n,r.make=s},{"../parse":9,"../table":11,"../types":26}],23:[function(t,e,r){"use strict";function n(t){for(var e=0;e<h.length;e+=1){var r=h[e];if(t>=r.begin&&t<r.end)return e}return-1}function i(t,e){var r={},n=new a.Parser(t,e);r.version=n.parseUShort(),r.xAvgCharWidth=n.parseShort(),r.usWeightClass=n.parseUShort(),r.usWidthClass=n.parseUShort(),r.fsType=n.parseUShort(),r.ySubscriptXSize=n.parseShort(),r.ySubscriptYSize=n.parseShort(),r.ySubscriptXOffset=n.parseShort(),r.ySubscriptYOffset=n.parseShort(),r.ySuperscriptXSize=n.parseShort(),r.ySuperscriptYSize=n.parseShort(),r.ySuperscriptXOffset=n.parseShort(),r.ySuperscriptYOffset=n.parseShort(),r.yStrikeoutSize=n.parseShort(),r.yStrikeoutPosition=n.parseShort(),r.sFamilyClass=n.parseShort(),r.panose=[];for(var i=0;10>i;i++)r.panose[i]=n.parseByte();return r.ulUnicodeRange1=n.parseULong(),r.ulUnicodeRange2=n.parseULong(),r.ulUnicodeRange3=n.parseULong(),r.ulUnicodeRange4=n.parseULong(),r.achVendID=String.fromCharCode(n.parseByte(),n.parseByte(),n.parseByte(),n.parseByte()),r.fsSelection=n.parseUShort(),r.usFirstCharIndex=n.parseUShort(),r.usLastCharIndex=n.parseUShort(),r.sTypoAscender=n.parseShort(),r.sTypoDescender=n.parseShort(),r.sTypoLineGap=n.parseShort(),r.usWinAscent=n.parseUShort(),r.usWinDescent=n.parseUShort(),r.version>=1&&(r.ulCodePageRange1=n.parseULong(),r.ulCodePageRange2=n.parseULong()),r.version>=2&&(r.sxHeight=n.parseShort(),r.sCapHeight=n.parseShort(),r.usDefaultChar=n.parseUShort(),r.usBreakChar=n.parseUShort(),r.usMaxContent=n.parseUShort()),r}function o(t){return new s.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],t)}var a=t("../parse"),s=t("../table"),h=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];r.unicodeRanges=h,r.getUnicodeRange=n,r.parse=i,r.make=o},{"../parse":9,"../table":11}],24:[function(t,e,r){"use strict";function n(t,e){var r,n={},i=new a.Parser(t,e);switch(n.version=i.parseVersion(),n.italicAngle=i.parseFixed(),n.underlinePosition=i.parseShort(),n.underlineThickness=i.parseShort(),n.isFixedPitch=i.parseULong(),n.minMemType42=i.parseULong(),n.maxMemType42=i.parseULong(),n.minMemType1=i.parseULong(),n.maxMemType1=i.parseULong(),n.version){case 1:n.names=o.standardNames.slice();break;case 2:for(n.numberOfGlyphs=i.parseUShort(),n.glyphNameIndex=new Array(n.numberOfGlyphs),r=0;r<n.numberOfGlyphs;r++)n.glyphNameIndex[r]=i.parseUShort();for(n.names=[],r=0;r<n.numberOfGlyphs;r++)if(n.glyphNameIndex[r]>=o.standardNames.length){var s=i.parseChar();n.names.push(i.parseString(s))}break;case 2.5:for(n.numberOfGlyphs=i.parseUShort(),n.offset=new Array(n.numberOfGlyphs),r=0;r<n.numberOfGlyphs;r++)n.offset[r]=i.parseChar()}return n}function i(){return new s.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var o=t("../encoding"),a=t("../parse"),s=t("../table");r.parse=n,r.make=i},{"../encoding":4,"../parse":9,"../table":11}],25:[function(t,e,r){"use strict";function n(t){return Math.log(t)/Math.log(2)|0}function i(t){for(;t.length%4!==0;)t.push(0);for(var e=0,r=0;r<t.length;r+=4)e+=(t[r]<<24)+(t[r+1]<<16)+(t[r+2]<<8)+t[r+3];return e%=Math.pow(2,32)}function o(t,e,r,n){return new l.Table("Table Record",[{name:"tag",type:"TAG",value:void 0!==t?t:""},{name:"checkSum",type:"ULONG",value:void 0!==e?e:0},{name:"offset",type:"ULONG",value:void 0!==r?r:0},{name:"length",type:"ULONG",value:void 0!==n?n:0}])}function a(t){var e=new l.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);e.tables=t,e.numTables=t.length;var r=Math.pow(2,n(e.numTables));e.searchRange=16*r,e.entrySelector=n(r),e.rangeShift=16*e.numTables-e.searchRange;for(var a=[],s=[],h=e.sizeOf()+o().sizeOf()*e.numTables;h%4!==0;)h+=1,s.push({name:"padding",type:"BYTE",value:0});for(var u=0;u<t.length;u+=1){var p=t[u];c.argument(4===p.tableName.length,"Table name"+p.tableName+" is invalid.");var f=p.sizeOf(),d=o(p.tableName,i(p.encode()),h,f);for(a.push({name:d.tag+" Table Record",type:"TABLE",value:d}),s.push({name:p.tableName+" table",type:"TABLE",value:p}),h+=f,c.argument(!isNaN(h),"Something went wrong calculating the offset.");h%4!==0;)h+=1,s.push({name:"padding",type:"BYTE",value:0})}return a.sort(function(t,e){return t.value.tag>e.value.tag?1:-1}),e.fields=e.fields.concat(a),e.fields=e.fields.concat(s),e}function s(t,e,r){for(var n=0;n<e.length;n+=1){var i=t.charToGlyphIndex(e[n]);if(i>0){var o=t.glyphs.get(i);return o.getMetrics()}}return r}function h(t){for(var e=0,r=0;r<t.length;r+=1)e+=t[r];return e/t.length}function u(t){for(var e,r=[],n=[],o=[],u=[],c=[],l=[],b=[],w=0,S=0,M=0,T=0,E=0,C=0;C<t.glyphs.length;C+=1){var A=t.glyphs.get(C),R=0|A.unicode;(e>R||null===e)&&(e=R),R>w&&(w=R);var P=_.getUnicodeRange(R);if(32>P)S|=1<<P;else if(64>P)M|=1<<P-32;else if(96>P)T|=1<<P-64;else{if(!(123>P))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");E|=1<<P-96}if(".notdef"!==A.name){var L=A.getMetrics();r.push(L.xMin),n.push(L.yMin),o.push(L.xMax),u.push(L.yMax),l.push(L.leftSideBearing),b.push(L.rightSideBearing),c.push(A.advanceWidth)}}var O={xMin:Math.min.apply(null,r),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,o),yMax:Math.max.apply(null,u),advanceWidthMax:Math.max.apply(null,c),advanceWidthAvg:h(c),minLeftSideBearing:Math.min.apply(null,l),maxLeftSideBearing:Math.max.apply(null,l),minRightSideBearing:Math.min.apply(null,b)};O.ascender=void 0!==t.ascender?t.ascender:O.yMax,O.descender=void 0!==t.descender?t.descender:O.yMin;var D=d.make({unitsPerEm:t.unitsPerEm,xMin:O.xMin,yMin:O.yMin,xMax:O.xMax,yMax:O.yMax}),k=m.make({ascender:O.ascender,descender:O.descender,advanceWidthMax:O.advanceWidthMax,minLeftSideBearing:O.minLeftSideBearing,minRightSideBearing:O.minRightSideBearing,xMaxExtent:O.maxLeftSideBearing+(O.xMax-O.xMin),numberOfHMetrics:t.glyphs.length}),F=y.make(t.glyphs.length),N=_.make({xAvgCharWidth:Math.round(O.advanceWidthAvg),usWeightClass:500,usWidthClass:5,usFirstCharIndex:e,usLastCharIndex:w,ulUnicodeRange1:S,ulUnicodeRange2:M,ulUnicodeRange3:T,ulUnicodeRange4:E,sTypoAscender:O.ascender,sTypoDescender:O.descender,sTypoLineGap:0,usWinAscent:O.ascender,usWinDescent:-O.descender,sxHeight:s(t,"xyvw",{yMax:0}).yMax,sCapHeight:s(t,"HIKLEFJMNTZBDPRAGOQSUVWXY",O).yMax,usBreakChar:t.hasChar(" ")?32:0}),I=g.make(t.glyphs),U=p.make(t.glyphs),B=t.familyName+" "+t.styleName,V=t.familyName.replace(/\s/g,"")+"-"+t.styleName,G=v.make({copyright:t.copyright,fontFamily:t.familyName,fontSubfamily:t.styleName,uniqueID:t.manufacturer+":"+B,fullName:B,version:t.version,postScriptName:V,trademark:t.trademark,manufacturer:t.manufacturer,designer:t.designer,description:t.description,manufacturerURL:t.manufacturerURL,designerURL:t.designerURL,license:t.license,licenseURL:t.licenseURL,preferredFamily:t.familyName,preferredSubfamily:t.styleName}),z=x.make(),H=f.make(t.glyphs,{version:t.version,fullName:B,familyName:t.familyName,weightName:t.styleName,postScriptName:V,unitsPerEm:t.unitsPerEm}),j=[D,k,F,N,G,U,z,H,I],W=a(j),X=W.encode(),q=i(X),Y=W.fields,Z=!1;for(C=0;C<Y.length;C+=1)if("head table"===Y[C].name){Y[C].value.checkSumAdjustment=2981146554-q,Z=!0;break}if(!Z)throw new Error("Could not find head table with checkSum to adjust.");return W}var c=t("../check"),l=t("../table"),p=t("./cmap"),f=t("./cff"),d=t("./head"),m=t("./hhea"),g=t("./hmtx"),y=t("./maxp"),v=t("./name"),_=t("./os2"),x=t("./post");r.computeCheckSum=i,r.make=a,r.fontToTable=u},{"../check":2,"../table":11,"./cff":12,"./cmap":13,"./head":16,"./hhea":17,"./hmtx":18,"./maxp":21,"./name":22,"./os2":23,"./post":24}],26:[function(t,e,r){"use strict";function n(t){return function(){return t}}var i=t("./check"),o=32768,a=2147483648,s={},h={},u={};h.BYTE=function(t){return i.argument(t>=0&&255>=t,"Byte value should be between 0 and 255."),[t]},u.BYTE=n(1),h.CHAR=function(t){return[t.charCodeAt(0)]},u.BYTE=n(1),h.CHARARRAY=function(t){for(var e=[],r=0;r<t.length;r+=1)e.push(t.charCodeAt(r));return e},u.CHARARRAY=function(t){return t.length},h.USHORT=function(t){return[t>>8&255,255&t]},u.USHORT=n(2),h.SHORT=function(t){return t>=o&&(t=-(2*o-t)),[t>>8&255,255&t]},u.SHORT=n(2),h.UINT24=function(t){return[t>>16&255,t>>8&255,255&t]},u.UINT24=n(3),h.ULONG=function(t){return[t>>24&255,t>>16&255,t>>8&255,255&t]},u.ULONG=n(4),h.LONG=function(t){return t>=a&&(t=-(2*a-t)),[t>>24&255,t>>16&255,t>>8&255,255&t]},u.LONG=n(4),h.FIXED=h.ULONG,u.FIXED=u.ULONG,h.FWORD=h.SHORT,u.FWORD=u.SHORT,h.UFWORD=h.USHORT,u.UFWORD=u.USHORT,h.LONGDATETIME=function(){return[0,0,0,0,0,0,0,0]},u.LONGDATETIME=n(8),h.TAG=function(t){return i.argument(4===t.length,"Tag should be exactly 4 ASCII characters."),[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]},u.TAG=n(4),h.Card8=h.BYTE,u.Card8=u.BYTE,h.Card16=h.USHORT,u.Card16=u.USHORT,h.OffSize=h.BYTE,u.OffSize=u.BYTE,h.SID=h.USHORT,u.SID=u.USHORT,h.NUMBER=function(t){return t>=-107&&107>=t?[t+139]:t>=108&&1131>=t?(t-=108,[(t>>8)+247,255&t]):t>=-1131&&-108>=t?(t=-t-108,[(t>>8)+251,255&t]):t>=-32768&&32767>=t?h.NUMBER16(t):h.NUMBER32(t)},u.NUMBER=function(t){return h.NUMBER(t).length},h.NUMBER16=function(t){return[28,t>>8&255,255&t]},u.NUMBER16=n(2),h.NUMBER32=function(t){return[29,t>>24&255,t>>16&255,t>>8&255,255&t]},u.NUMBER32=n(4),h.REAL=function(t){var e=t.toString(),r=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(e);if(r){var n=parseFloat("1e"+((r[2]?+r[2]:0)+r[1].length));e=(Math.round(t*n)/n).toString()}var i,o,a="";for(i=0,o=e.length;o>i;i+=1){var s=e[i];a+="e"===s?"-"===e[++i]?"c":"b":"."===s?"a":"-"===s?"e":s}a+=1&a.length?"f":"ff";var h=[30];for(i=0,o=a.length;o>i;i+=2)h.push(parseInt(a.substr(i,2),16));return h},u.REAL=function(t){return h.REAL(t).length},h.NAME=h.CHARARRAY,u.NAME=u.CHARARRAY,h.STRING=h.CHARARRAY,u.STRING=u.CHARARRAY,h.UTF16=function(t){for(var e=[],r=0;r<t.length;r+=1)e.push(0),e.push(t.charCodeAt(r));return e},u.UTF16=function(t){return 2*t.length},h.INDEX=function(t){var e,r=1,n=[r],i=[],o=0;for(e=0;e<t.length;e+=1){var a=h.OBJECT(t[e]);Array.prototype.push.apply(i,a),o+=a.length,r+=a.length,n.push(r)}if(0===i.length)return[0,0];var s=[],u=1+Math.floor(Math.log(o)/Math.log(2))/8|0,c=[void 0,h.BYTE,h.USHORT,h.UINT24,h.ULONG][u];for(e=0;e<n.length;e+=1){var l=c(n[e]);Array.prototype.push.apply(s,l)}return Array.prototype.concat(h.Card16(t.length),h.OffSize(u),s,i)},u.INDEX=function(t){return h.INDEX(t).length},h.DICT=function(t){for(var e=[],r=Object.keys(t),n=r.length,i=0;n>i;i+=1){var o=parseInt(r[i],0),a=t[o];e=e.concat(h.OPERAND(a.value,a.type)),e=e.concat(h.OPERATOR(o))}return e},u.DICT=function(t){return h.DICT(t).length},h.OPERATOR=function(t){return 1200>t?[t]:[12,t-1200]},h.OPERAND=function(t,e){var r=[];if(Array.isArray(e))for(var n=0;n<e.length;n+=1)i.argument(t.length===e.length,"Not enough arguments given for type"+e),r=r.concat(h.OPERAND(t[n],e[n]));else if("SID"===e)r=r.concat(h.NUMBER(t));else if("offset"===e)r=r.concat(h.NUMBER32(t));else if("number"===e)r=r.concat(h.NUMBER(t));else{if("real"!==e)throw new Error("Unknown operand type "+e);r=r.concat(h.REAL(t))}return r},h.OP=h.BYTE,u.OP=u.BYTE;var c="function"==typeof WeakMap&&new WeakMap;h.CHARSTRING=function(t){if(c&&c.has(t))return c.get(t);for(var e=[],r=t.length,n=0;r>n;n+=1){var i=t[n];e=e.concat(h[i.type](i.value))}return c&&c.set(t,e),e},u.CHARSTRING=function(t){return h.CHARSTRING(t).length},h.OBJECT=function(t){var e=h[t.type];return i.argument(void 0!==e,"No encoding function for type "+t.type),e(t.value)},h.TABLE=function(t){for(var e=[],r=t.fields.length,n=0;r>n;n+=1){var o=t.fields[n],a=h[o.type];i.argument(void 0!==a,"No encoding function for field type "+o.type);var s=t[o.name];void 0===s&&(s=o.value);var u=a(s);e=e.concat(u)}return e},h.LITERAL=function(t){return t},u.LITERAL=function(t){return t.length},r.decode=s,r.encode=h,r.sizeOf=u},{"./check":2}],27:[function(_dereq_,module,exports){!function(t,e,r){"undefined"!=typeof module&&module.exports?module.exports=r():"function"==typeof define&&define.amd?define(r):e[t]=r()}("reqwest",this,function(){function succeed(t){var e=protocolRe.exec(t.url);return e=e&&e[1]||window.location.protocol,httpsRe.test(e)?twoHundo.test(t.request.status):!!t.request.response}function handleReadyState(t,e,r){return function(){return t._aborted?r(t.request):t._timedOut?r(t.request,"Request is aborted: timeout"):void(t.request&&4==t.request[readyState]&&(t.request.onreadystatechange=noop,succeed(t)?e(t.request):r(t.request)))}}function setHeaders(t,e){var r,n=e.headers||{};n.Accept=n.Accept||defaultHeaders.accept[e.type]||defaultHeaders.accept["*"];var i="function"==typeof FormData&&e.data instanceof FormData;e.crossOrigin||n[requestedWith]||(n[requestedWith]=defaultHeaders.requestedWith),n[contentType]||i||(n[contentType]=e.contentType||defaultHeaders.contentType);for(r in n)n.hasOwnProperty(r)&&"setRequestHeader"in t&&t.setRequestHeader(r,n[r])}function setCredentials(t,e){"undefined"!=typeof e.withCredentials&&"undefined"!=typeof t.withCredentials&&(t.withCredentials=!!e.withCredentials)}function generalCallback(t){lastValue=t}function urlappend(t,e){return t+(/\?/.test(t)?"&":"?")+e}function handleJsonp(t,e,r,n){var i=uniqid++,o=t.jsonpCallback||"callback",a=t.jsonpCallbackName||reqwest.getcallbackPrefix(i),s=new RegExp("((^|\\?|&)"+o+")=([^&]+)"),h=n.match(s),u=doc.createElement("script"),c=0,l=-1!==navigator.userAgent.indexOf("MSIE 10.0");return h?"?"===h[3]?n=n.replace(s,"$1="+a):a=h[3]:n=urlappend(n,o+"="+a),
win[a]=generalCallback,u.type="text/javascript",u.src=n,u.async=!0,"undefined"==typeof u.onreadystatechange||l||(u.htmlFor=u.id="_reqwest_"+i),u.onload=u.onreadystatechange=function(){return u[readyState]&&"complete"!==u[readyState]&&"loaded"!==u[readyState]||c?!1:(u.onload=u.onreadystatechange=null,u.onclick&&u.onclick(),e(lastValue),lastValue=void 0,head.removeChild(u),void(c=1))},head.appendChild(u),{abort:function(){u.onload=u.onreadystatechange=null,r({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(u),c=1}}}function getRequest(t,e){var r,n=this.o,i=(n.method||"GET").toUpperCase(),o="string"==typeof n?n:n.url,a=n.processData!==!1&&n.data&&"string"!=typeof n.data?reqwest.toQueryString(n.data):n.data||null,s=!1;return"jsonp"!=n.type&&"GET"!=i||!a||(o=urlappend(o,a),a=null),"jsonp"==n.type?handleJsonp(n,t,e,o):(r=n.xhr&&n.xhr(n)||xhr(n),r.open(i,o,n.async===!1?!1:!0),setHeaders(r,n),setCredentials(r,n),win[xDomainRequest]&&r instanceof win[xDomainRequest]?(r.onload=t,r.onerror=e,r.onprogress=function(){},s=!0):r.onreadystatechange=handleReadyState(this,t,e),n.before&&n.before(r),s?setTimeout(function(){r.send(a)},200):r.send(a),r)}function Reqwest(t,e){this.o=t,this.fn=e,init.apply(this,arguments)}function setType(t){return t.match("json")?"json":t.match("javascript")?"js":t.match("text")?"html":t.match("xml")?"xml":void 0}function init(o,fn){function complete(t){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(t)}function success(resp){var type=o.type||resp&&setType(resp.getResponseHeader("Content-Type"));resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}function timedOut(){self._timedOut=!0,self.request.abort()}function error(t,e,r){for(t=self.request,self._responseArgs.resp=t,self._responseArgs.msg=e,self._responseArgs.t=r,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(t,e,r);complete(t)}this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){timedOut()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(t,e){return new Reqwest(t,e)}function normalize(t){return t?t.replace(/\r?\n/g,"\r\n"):""}function serial(t,e){var r,n,i,o,a=t.name,s=t.tagName.toLowerCase(),h=function(t){t&&!t.disabled&&e(a,normalize(t.attributes.value&&t.attributes.value.specified?t.value:t.text))};if(!t.disabled&&a)switch(s){case"input":/reset|button|image|file/i.test(t.type)||(r=/checkbox/i.test(t.type),n=/radio/i.test(t.type),i=t.value,(!(r||n)||t.checked)&&e(a,normalize(r&&""===i?"on":i)));break;case"textarea":e(a,normalize(t.value));break;case"select":if("select-one"===t.type.toLowerCase())h(t.selectedIndex>=0?t.options[t.selectedIndex]:null);else for(o=0;t.length&&o<t.length;o++)t.options[o].selected&&h(t.options[o])}}function eachFormElement(){var t,e,r=this,n=function(t,e){var n,i,o;for(n=0;n<e.length;n++)for(o=t[byTag](e[n]),i=0;i<o.length;i++)serial(o[i],r)};for(e=0;e<arguments.length;e++)t=arguments[e],/input|select|textarea/i.test(t.tagName)&&serial(t,r),n(t,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var t={};return eachFormElement.apply(function(e,r){e in t?(t[e]&&!isArray(t[e])&&(t[e]=[t[e]]),t[e].push(r)):t[e]=r},arguments),t}function buildParams(t,e,r,n){var i,o,a,s=/\[\]$/;if(isArray(e))for(o=0;e&&o<e.length;o++)a=e[o],r||s.test(t)?n(t,a):buildParams(t+"["+("object"==typeof a?o:"")+"]",a,r,n);else if(e&&"[object Object]"===e.toString())for(i in e)buildParams(t+"["+i+"]",e[i],r,n);else n(t,e)}var win=window,doc=document,httpsRe=/^http/,protocolRe=/(^\w+):\/\//,twoHundo=/^(20\d|1223)$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(t){return t instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(t){if(t.crossOrigin===!0){var e=win[xmlHttpRequest]?new XMLHttpRequest:null;if(e&&"withCredentials"in e)return e;if(win[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return win[xmlHttpRequest]?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(t){return t}};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(t,e){return t=t||function(){},e=e||function(){},this._fulfilled?this._responseArgs.resp=t(this._responseArgs.resp):this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(t),this._errorHandlers.push(e)),this},always:function(t){return this._fulfilled||this._erred?t(this._responseArgs.resp):this._completeHandlers.push(t),this},fail:function(t){return this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(t),this},"catch":function(t){return this.fail(t)}},reqwest.serializeArray=function(){var t=[];return eachFormElement.apply(function(e,r){t.push({name:e,value:r})},arguments),t},reqwest.serialize=function(){if(0===arguments.length)return"";var t,e,r=Array.prototype.slice.call(arguments,0);return t=r.pop(),t&&t.nodeType&&r.push(t)&&(t=null),t&&(t=t.type),e="map"==t?serializeHash:"array"==t?reqwest.serializeArray:serializeQueryString,e.apply(null,r)},reqwest.toQueryString=function(t,e){var r,n,i=e||!1,o=[],a=encodeURIComponent,s=function(t,e){e="function"==typeof e?e():null==e?"":e,o[o.length]=a(t)+"="+a(e)};if(isArray(t))for(n=0;t&&n<t.length;n++)s(t[n].name,t[n].value);else for(r in t)t.hasOwnProperty(r)&&buildParams(r,t[r],i,s);return o.join("&").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(t,e){return t&&(t.type&&(t.method=t.type)&&delete t.type,t.dataType&&(t.type=t.dataType),t.jsonpCallback&&(t.jsonpCallbackName=t.jsonpCallback)&&delete t.jsonpCallback,t.jsonp&&(t.jsonpCallback=t.jsonp)),new Reqwest(t,e)},reqwest.ajaxSetup=function(t){t=t||{};for(var e in t)globalSetupOptions[e]=t[e]},reqwest})},{}],28:[function(t,e,r){"use strict";var n=t("../core/core");t("./p5.Geometry3D"),n.prototype.plane=function(t,e){t=t||50,e=e||50;var r=typeof arguments[2]===Number?arguments[2]:1,i=typeof arguments[3]===Number?arguments[3]:1,o="plane|"+t+"|"+e+"|"+r+"|"+i;if(!this._renderer.geometryInHash(o)){var a=new n.Geometry3D,s=function(r,i){var o=2*t*r-t,a=2*e*i-e,s=0;return new n.Vector(o,a,s)};a.parametricGeometry(s,r,i);var h=a.generateObj();this._renderer.initBuffer(o,h)}this._renderer.drawBuffer(o)},n.prototype.sphere=function(t,e){t=t||50;var r=e||24,i=e||16,o="sphere|"+t+"|"+r+"|"+i;if(!this._renderer.geometryInHash(o)){var a=new n.Geometry3D,s=function(e,r){var i=2*Math.PI*e,o=Math.PI*r-Math.PI/2,a=t*Math.cos(o)*Math.sin(i),s=t*Math.sin(o),h=t*Math.cos(o)*Math.cos(i);return new n.Vector(a,s,h)};a.parametricGeometry(s,r,i);var h=a.generateObj();this._renderer.initBuffer(o,h)}return this._renderer.drawBuffer(o),this},n.prototype.cylinder=function(t,e,r){t=t||50,e=e||50;var i=r||24,o=r||16,a="cylinder|"+t+"|"+e+"|"+i+"|"+o;if(!this._renderer.geometryInHash(a)){var s=new n.Geometry3D,h=function(r,i){var o=2*Math.PI*r,a=t*Math.sin(o),s=2*e*i-e,h=t*Math.cos(o);return new n.Vector(a,s,h)};s.parametricGeometry(h,i,o),s.mergeVertices();var u=function(r,i){var o=2*Math.PI*r,a=t*Math.sin(-o),s=e,h=t*Math.cos(o);return 0===i?new n.Vector(0,e,0):new n.Vector(a,s,h)};s.parametricGeometry(u,i,1,s.vertices.length);var c=function(r,i){var o=2*Math.PI*r,a=t*Math.sin(o),s=-e,h=t*Math.cos(o);return 0===i?new n.Vector(0,-e,0):new n.Vector(a,s,h)};s.parametricGeometry(c,i,1,s.vertices.length);var l=s.generateObj(!0);this._renderer.initBuffer(a,l)}return this._renderer.drawBuffer(a),this},n.prototype.cone=function(t,e,r){t=t||50,e=e||50;var i=r||24,o=r||16,a="cone|"+t+"|"+e+"|"+i+"|"+o;if(!this._renderer.geometryInHash(a)){var s=new n.Geometry3D,h=function(r,i){var o=2*Math.PI*r,a=t*(1-i)*Math.sin(o),s=2*e*i-e,h=t*(1-i)*Math.cos(o);return new n.Vector(a,s,h)};s.parametricGeometry(h,i,o),s.mergeVertices();var u=function(r,i){var o=2*Math.PI*r,a=t*(1-i)*Math.sin(-o),s=-e,h=t*(1-i)*Math.cos(o);return new n.Vector(a,s,h)};s.parametricGeometry(u,i,1,s.vertices.length);var c=s.generateObj(!0);this._renderer.initBuffer(a,c)}return this._renderer.drawBuffer(a),this},n.prototype.torus=function(t,e,r){t=t||50,e=e||10;var i=r||24,o=r||16,a="torus|"+t+"|"+e+"|"+i+"|"+o;if(!this._renderer.geometryInHash(a)){var s=new n.Geometry3D,h=function(r,i){var o=2*Math.PI*r,a=2*Math.PI*i,s=(t+e*Math.cos(a))*Math.cos(o),h=(t+e*Math.cos(a))*Math.sin(o),u=e*Math.sin(a);return new n.Vector(s,h,u)};s.parametricGeometry(h,i,o);var u=s.generateObj();this._renderer.initBuffer(a,u)}return this._renderer.drawBuffer(a),this},n.prototype.box=function(t,e,r){t=t||50,e=e||t,r=r||t;var i=typeof arguments[3]===Number?arguments[3]:1,o=typeof arguments[4]===Number?arguments[4]:1,a="cube|"+t+"|"+e+"|"+r+"|"+i+"|"+o;if(!this._renderer.geometryInHash(a)){var s=new n.Geometry3D,h=function(i,o){var a=2*t*i-t,s=2*e*o-e,h=r;return new n.Vector(a,s,h)},u=function(i,o){var a=2*t*(1-i)-t,s=2*e*o-e,h=-r;return new n.Vector(a,s,h)},c=function(i,o){var a=2*t*(1-i)-t,s=e,h=2*r*o-r;return new n.Vector(a,s,h)},l=function(i,o){var a=2*t*i-t,s=-e,h=2*r*o-r;return new n.Vector(a,s,h)},p=function(i,o){var a=t,s=2*e*i-e,h=2*r*o-r;return new n.Vector(a,s,h)},f=function(i,o){var a=-t,s=2*e*(1-i)-e,h=2*r*o-r;return new n.Vector(a,s,h)};s.parametricGeometry(h,i,o,s.vertices.length),s.parametricGeometry(u,i,o,s.vertices.length),s.parametricGeometry(c,i,o,s.vertices.length),s.parametricGeometry(l,i,o,s.vertices.length),s.parametricGeometry(p,i,o,s.vertices.length),s.parametricGeometry(f,i,o,s.vertices.length);var d=s.generateObj(!0);this._renderer.initBuffer(a,d)}return this._renderer.drawBuffer(a),this},e.exports=n},{"../core/core":48,"./p5.Geometry3D":34}],29:[function(t,e,r){"use strict";var n=t("../core/core");n.prototype.camera=function(t,e,r){this._validateParameters("camera",arguments,["Number","Number","Number"]),this._renderer.translate(-t,-e,-r)},n.prototype.perspective=function(t,e,r,i){this._validateParameters("perspective",arguments,["Number","Number","Number","Number"]),this._renderer.uPMatrix=n.Matrix.identity(),this._renderer.uPMatrix.perspective(t,e,r,i),this._renderer._setCamera=!0},n.prototype.ortho=function(t,e,r,i,o,a){this._validateParameters("ortho",arguments,["Number","Number","Number","Number","Number","Number"]),t/=this.width,e/=this.width,i/=this.height,r/=this.height,this._renderer.uPMatrix=n.Matrix.identity(),this._renderer.uPMatrix.ortho(t,e,r,i,o,a),this._renderer._setCamera=!0},e.exports=n},{"../core/core":48}],30:[function(t,e,r){"use strict";var n=t("../core/core");n.Renderer3D.prototype._primitives2D=function(t){this._setDefaultCamera();var e=this.GL,r=this._getColorVertexShader(),n=this.verticeBuffer;e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),e.vertexAttribPointer(r.vertexPositionAttribute,3,e.FLOAT,!1,0,0);var i=this.colorBuffer;e.bindBuffer(e.ARRAY_BUFFER,i);for(var o=this._getCurColor(),a=[],s=0;s<t.length/3;s++)a=a.concat(o);e.bufferData(e.ARRAY_BUFFER,new Float32Array(a),e.STATIC_DRAW),e.vertexAttribPointer(r.vertexColorAttribute,4,e.FLOAT,!1,0,0);var h="vertexColorVert|vertexColorFrag";this.setMatrixUniforms(h)},n.Renderer3D.prototype.point=function(t,e,r){var n=this.GL;return this._primitives2D([t,e,r]),n.drawArrays(n.POINTS,0,1),this},n.Renderer3D.prototype.line=function(t,e,r,n,i,o){var a=this.GL;return this._primitives2D([t,e,r,n,i,o]),a.drawArrays(a.LINES,0,2),this},n.Renderer3D.prototype.triangle=function(t,e,r,n,i,o,a,s,h){var u=this.GL;return this._primitives2D([t,e,r,n,i,o,a,s,h]),this._strokeCheck(),u.drawArrays(u.TRIANGLES,0,3),this},n.Renderer3D.prototype.quad=function(t,e,r,n,i,o,a,s,h,u,c,l){var p=this.GL;return this._primitives2D([t,e,r,n,i,o,a,s,h,u,c,l]),this._strokeCheck(),p.drawArrays(p.TRIANGLE_STRIP,0,4),this},n.Renderer3D.prototype.beginShape=function(t){return this.shapeMode=t,this.verticeStack=[],this},n.Renderer3D.prototype.vertex=function(t,e,r){return this.verticeStack.push(t,e,r),this},n.Renderer3D.prototype.endShape=function(){var t=this.GL;switch(this._primitives2D(this.verticeStack),this.verticeStack=[],this.shapeMode){case"POINTS":t.drawArrays(t.POINTS,0,1);break;case"LINES":t.drawArrays(t.LINES,0,2);break;case"TRIANGLES":this._strokeCheck(),t.drawArrays(t.TRIANGLES,0,3);break;case"TRIANGLE_STRIP":this._strokeCheck(),t.drawArrays(t.TRIANGLE_STRIP,0,4);break;default:this._strokeCheck(),t.drawArrays(t.TRIANGLES,0,3)}return this},n.Renderer3D.prototype._strokeCheck=function(){if("stroke"===this.drawMode)throw new Error("stroke for shapes in 3D not yet implemented, use fill for now :(")},n.Renderer3D.prototype.strokeWeight=function(){throw new Error("strokeWeight for 3d not yet implemented")},n.Renderer3D.prototype.fill=function(t,e,r,n){var i=this._pInst.color.apply(this._pInst,arguments),o=i._normalize();return this.curColor=o,this.drawMode="fill",this},n.Renderer3D.prototype.stroke=function(t,e,r,n){var i=this._pInst.color.apply(this._pInst,arguments),o=i._normalize();return this.curColor=o,this.drawMode="stroke",this},n.Renderer3D.prototype._getColorVertexShader=function(){var t,e=this.GL,r="vertexColorVert|vertexColorFrag";return this.materialInHash(r)?t=this.mHash[r]:(t=this.initShaders("vertexColorVert","vertexColorFrag",!0),this.mHash[r]=t,t.vertexColorAttribute=e.getAttribLocation(t,"aVertexColor"),e.enableVertexAttribArray(t.vertexColorAttribute)),t},e.exports=n.Renderer3D},{"../core/core":48}],31:[function(t,e,r){"use strict";var n=t("../core/core");n.prototype.orbitControl=function(){return this.mouseIsPressed&&(this.rotateY((this.mouseX-this.width/2)/(this.width/2)),this.rotateX((this.mouseY-this.height/2)/(this.width/2))),this},e.exports=n},{"../core/core":48}],32:[function(t,e,r){"use strict";var n=t("../core/core");n.prototype.ambientLight=function(t,e,r,n){var i=this._renderer.GL,o=this._renderer._getShader("lightVert","lightFrag");i.useProgram(o),o.uAmbientColor=i.getUniformLocation(o,"uAmbientColor["+this._renderer.ambientLightCount+"]");var a=this._renderer._pInst.color.apply(this._renderer._pInst,arguments),s=a._normalize();return i.uniform3f(o.uAmbientColor,s[0],s[1],s[2]),o.uMaterialColor=i.getUniformLocation(o,"uMaterialColor"),i.uniform4f(o.uMaterialColor,1,1,1,1),this._renderer.ambientLightCount++,o.uAmbientLightCount=i.getUniformLocation(o,"uAmbientLightCount"),i.uniform1i(o.uAmbientLightCount,this._renderer.ambientLightCount),this},n.prototype.directionalLight=function(t,e,r,n,i,o,a){var s=this._renderer.GL,h=this._renderer._getShader("lightVert","lightFrag");s.useProgram(h),h.uDirectionalColor=s.getUniformLocation(h,"uDirectionalColor["+this._renderer.directionalLightCount+"]");var u=this._renderer._pInst.color.apply(this._renderer._pInst,[t,e,r]),c=u._normalize();s.uniform3f(h.uDirectionalColor,c[0],c[1],c[2]);var l,p,f;if("number"==typeof arguments[arguments.length-1])l=arguments[arguments.length-3],p=arguments[arguments.length-2],f=arguments[arguments.length-1];else try{l=arguments[arguments.length-1].x,p=arguments[arguments.length-1].y,f=arguments[arguments.length-1].z}catch(d){throw d}return h.uLightingDirection=s.getUniformLocation(h,"uLightingDirection["+this._renderer.directionalLightCount+"]"),s.uniform3f(h.uLightingDirection,l,p,f),h.uMaterialColor=s.getUniformLocation(h,"uMaterialColor"),s.uniform4f(h.uMaterialColor,1,1,1,1),this._renderer.directionalLightCount++,h.uDirectionalLightCount=s.getUniformLocation(h,"uDirectionalLightCount"),s.uniform1i(h.uDirectionalLightCount,this._renderer.directionalLightCount),this},n.prototype.pointLight=function(t,e,r,n,i,o,a){var s=this._renderer.GL,h=this._renderer._getShader("lightVert","lightFrag");s.useProgram(h),h.uPointLightColor=s.getUniformLocation(h,"uPointLightColor["+this._renderer.pointLightCount+"]");var u=this._renderer._pInst.color.apply(this._renderer._pInst,[t,e,r]),c=u._normalize();s.uniform3f(h.uPointLightColor,c[0],c[1],c[2]);var l,p,f;if("number"==typeof arguments[arguments.length-1])l=arguments[arguments.length-3],p=arguments[arguments.length-2],f=arguments[arguments.length-1];else try{l=arguments[arguments.length-1].x,p=arguments[arguments.length-1].y,f=arguments[arguments.length-1].z}catch(d){throw d}return h.uPointLightLocation=s.getUniformLocation(h,"uPointLightLocation["+this._renderer.pointLightCount+"]"),s.uniform3f(h.uPointLightLocation,l,p,f),h.uMaterialColor=s.getUniformLocation(h,"uMaterialColor"),s.uniform4f(h.uMaterialColor,1,1,1,1),this._renderer.pointLightCount++,h.uPointLightCount=s.getUniformLocation(h,"uPointLightCount"),s.uniform1i(h.uPointLightCount,this._renderer.pointLightCount),this},e.exports=n},{"../core/core":48}],33:[function(t,e,r){"use strict";function n(t){return 0===(t&t-1)}function i(t){--t;for(var e=1;32>e;e<<=1)t|=t>>e;return t+1}var o=t("../core/core");o.prototype.normalMaterial=function(){return this._renderer._getShader("normalVert","normalFrag"),this},o.prototype.texture=function(t){var e=this._renderer.GL,r=this._renderer._getShader("normalVert","textureFrag");e.useProgram(r);var a=e.createTexture();if(e.bindTexture(e.TEXTURE_2D,a),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),t instanceof o.Image){t.loadPixels();var s=new Uint8Array(t.pixels);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t.width,t.height,0,e.RGBA,e.UNSIGNED_BYTE,s)}else if(t instanceof o.MediaElement){if(!t.loadedmetadata)return;e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.elt)}return n(t.width)&&n(t.height)?e.generateMipmap(e.TEXTURE_2D):(t.width=i(t.width),t.height=i(t.height),e.texParameteri(e.TETXURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TETXURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TETXURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)),e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,a),e.uniform1i(e.getUniformLocation(r,"uSampler"),0),this},o.prototype.basicMaterial=function(t,e,r,n){var i=this._renderer.GL,o=this._renderer._getShader("normalVert","basicFrag");i.useProgram(o),o.uMaterialColor=i.getUniformLocation(o,"uMaterialColor");var a=this._renderer._pInst.color.apply(this._renderer._pInst,arguments),s=a._normalize();return i.uniform4f(o.uMaterialColor,s[0],s[1],s[2],s[3]),this},o.prototype.ambientMaterial=function(t,e,r,n){var i=this._renderer.GL,o=this._renderer._getShader("lightVert","lightFrag");i.useProgram(o),o.uMaterialColor=i.getUniformLocation(o,"uMaterialColor");var a=this._renderer._pInst.color.apply(this._renderer._pInst,arguments),s=a._normalize();return i.uniform4f(o.uMaterialColor,s[0],s[1],s[2],s[3]),o.uSpecular=i.getUniformLocation(o,"uSpecular"),i.uniform1i(o.uSpecular,!1),this},o.prototype.specularMaterial=function(t,e,r,n){var i=this._renderer.GL,o=this._renderer._getShader("lightVert","lightFrag");i.useProgram(o),o.uMaterialColor=i.getUniformLocation(o,"uMaterialColor");var a=this._renderer._pInst.color.apply(this._renderer._pInst,arguments),s=a._normalize();return i.uniform4f(o.uMaterialColor,s[0],s[1],s[2],s[3]),o.uSpecular=i.getUniformLocation(o,"uSpecular"),i.uniform1i(o.uSpecular,!0),this},e.exports=o},{"../core/core":48}],34:[function(t,e,r){"use strict";function n(t){return t.reduce(function(t,e){return t.concat(e)})}function i(t){return n(t.map(function(t){return[t.x,t.y,t.z]}))}var o=t("../core/core");o.Geometry3D=function(){this.vertices=[],this.vertexNormals=[],this.faces=[],this.faceNormals=[],this.uvs=[]},o.Geometry3D.prototype.parametricGeometry=function(t,e,r,n){var i,o,a,s,h;n=n||0;var u=e+1;for(i=0;r>=i;i++)for(h=i/r,o=0;e>=o;o++)s=o/e,a=t(s,h),this.vertices.push(a);var c,l,p,f,d,m,g,y;for(i=0;r>i;i++)for(o=0;e>o;o++)c=i*u+o+n,l=i*u+o+1+n,p=(i+1)*u+o+1+n,f=(i+1)*u+o+n,d=[o/e,i/r],m=[(o+1)/e,i/r],g=[(o+1)/e,(i+1)/r],y=[o/e,(i+1)/r],this.faces.push([c,l,f]),this.uvs.push([d,m,y]),this.faces.push([l,p,f]),this.uvs.push([m,g,y])},o.Geometry3D.prototype.mergeVertices=function(){var t,e,r,n,i,o={},a=[],s=[],h=4,u=Math.pow(10,h);for(r=0;r<this.vertices.length;r++)t=this.vertices[r],e=Math.round(t.x*u)+"_"+Math.round(t.y*u)+"_"+Math.round(t.z*u),void 0===o[e]?(o[e]=r,a.push(this.vertices[r]),s[r]=a.length-1):s[r]=s[o[e]];var c=[];for(r=0;r<this.faces.length;r++){n=this.faces[r],n[0]=s[n[0]],n[1]=s[n[1]],n[2]=s[n[2]],i=[n[0],n[1],n[2]];for(var l=-1,p=0;3>p;p++)if(i[p]===i[(p+1)%3]){l=p,c.push(r);break}}for(r=c.length-1;r>=0;r--){var f=c[r];this.faces.splice(f,1)}var d=this.vertices.length-a.length;return this.vertices=a,d},o.Geometry3D.prototype.computeFaceNormals=function(){for(var t=new o.Vector,e=new o.Vector,r=0;r<this.faces.length;r++){var n=this.faces[r],i=this.vertices[n[0]],a=this.vertices[n[1]],s=this.vertices[n[2]];o.Vector.sub(s,a,t),o.Vector.sub(i,a,e);var h=o.Vector.cross(e,t);h.normalize(),h.mult(-1),this.faceNormals[r]=h}},o.Geometry3D.prototype.computeVertexNormals=function(){var t,e,r,n,i,a=[];for(i=new Array(this.vertices.length),t=0;t<this.vertices.length;t++)i[t]=new o.Vector;for(e=0;e<this.faces.length;e++)r=this.faces[e],n=this.faceNormals[e],i[r[0]].add(n),i[r[1]].add(n),i[r[2]].add(n);for(t=0;t<this.vertices.length;t++)i[t].normalize();for(e=0;e<this.faces.length;e++)r=this.faces[e],a[e]=[],a[e][0]=i[r[0]].copy(),a[e][1]=i[r[1]].copy(),a[e][2]=i[r[2]].copy();for(e=0;e<this.faces.length;e++)r=this.faces[e],n=this.faceNormals[e],this.vertexNormals[r[0]]=a[e][0],this.vertexNormals[r[1]]=a[e][1],this.vertexNormals[r[2]]=a[e][2]},o.Geometry3D.prototype.generateUV=function(t,e){t=n(t),e=n(e);var r=[];return t.forEach(function(t,n){r[t]=e[n]}),n(r)},o.Geometry3D.prototype.generateObj=function(t){t||this.mergeVertices(),this.computeFaceNormals(),this.computeVertexNormals();var e={vertices:i(this.vertices),vertexNormals:i(this.vertexNormals),uvs:this.generateUV(this.faces,this.uvs),faces:n(this.faces),len:3*this.faces.length};return e},e.exports=o.Geometry3D},{"../core/core":48}],35:[function(t,e,r){"use strict";var n=t("../core/core"),i=t("../math/polargeometry"),o=t("../core/constants"),a="undefined"!=typeof Float32Array?Float32Array:Array;n.Matrix=function(){return arguments[0]instanceof n?(this.p5=arguments[0],this.mat4=arguments[1]||new a([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])):this.mat4=arguments[0]||new a([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this},n.Matrix.prototype.set=function(t){return t instanceof n.Matrix?(this.mat4=t.mat4,this):t instanceof a?(this.mat4=t,this):this},n.Matrix.prototype.get=function(){return new n.Matrix(this.mat4)},n.Matrix.prototype.copy=function(){var t=new n.Matrix;return t.mat4[0]=this.mat4[0],t.mat4[1]=this.mat4[1],t.mat4[2]=this.mat4[2],t.mat4[3]=this.mat4[3],t.mat4[4]=this.mat4[4],t.mat4[5]=this.mat4[5],t.mat4[6]=this.mat4[6],t.mat4[7]=this.mat4[7],t.mat4[8]=this.mat4[8],t.mat4[9]=this.mat4[9],t.mat4[10]=this.mat4[10],t.mat4[11]=this.mat4[11],t.mat4[12]=this.mat4[12],t.mat4[13]=this.mat4[13],t.mat4[14]=this.mat4[14],t.mat4[15]=this.mat4[15],t},n.Matrix.identity=function(){return new n.Matrix},n.Matrix.prototype.transpose=function(t){var e,r,i,o,s,h;return t instanceof n.Matrix?(e=t.mat4[1],r=t.mat4[2],i=t.mat4[3],o=t.mat4[6],s=t.mat4[7],h=t.mat4[11],this.mat4[0]=t.mat4[0],this.mat4[1]=t.mat4[4],this.mat4[2]=t.mat4[8],this.mat4[3]=t.mat4[12],this.mat4[4]=e,this.mat4[5]=t.mat4[5],this.mat4[6]=t.mat4[9],this.mat4[7]=t.mat4[13],this.mat4[8]=r,this.mat4[9]=o,this.mat4[10]=t.mat4[10],this.mat4[11]=t.mat4[14],this.mat4[12]=i,this.mat4[13]=s,this.mat4[14]=h,this.mat4[15]=t.mat4[15]):t instanceof a&&(e=t[1],r=t[2],i=t[3],o=t[6],s=t[7],h=t[11],this.mat4[0]=t[0],this.mat4[1]=t[4],this.mat4[2]=t[8],this.mat4[3]=t[12],this.mat4[4]=e,this.mat4[5]=t[5],this.mat4[6]=t[9],this.mat4[7]=t[13],this.mat4[8]=r,this.mat4[9]=o,this.mat4[10]=t[10],this.mat4[11]=t[14],this.mat4[12]=i,this.mat4[13]=s,this.mat4[14]=h,this.mat4[15]=t[15]),this},n.Matrix.prototype.invert=function(t){var e,r,i,o,s,h,u,c,l,p,f,d,m,g,y,v;t instanceof n.Matrix?(e=t.mat4[0],r=t.mat4[1],i=t.mat4[2],o=t.mat4[3],s=t.mat4[4],h=t.mat4[5],u=t.mat4[6],c=t.mat4[7],l=t.mat4[8],p=t.mat4[9],f=t.mat4[10],d=t.mat4[11],m=t.mat4[12],g=t.mat4[13],y=t.mat4[14],v=t.mat4[15]):t instanceof a&&(e=t[0],r=t[1],i=t[2],o=t[3],s=t[4],h=t[5],u=t[6],c=t[7],l=t[8],p=t[9],f=t[10],d=t[11],m=t[12],g=t[13],y=t[14],v=t[15]);var _=e*h-r*s,x=e*u-i*s,b=e*c-o*s,w=r*u-i*h,S=r*c-o*h,M=i*c-o*u,T=l*g-p*m,E=l*y-f*m,C=l*v-d*m,A=p*y-f*g,R=p*v-d*g,P=f*v-d*y,L=_*P-x*R+b*A+w*C-S*E+M*T;return L?(L=1/L,this.mat4[0]=(h*P-u*R+c*A)*L,this.mat4[1]=(i*R-r*P-o*A)*L,this.mat4[2]=(g*M-y*S+v*w)*L,this.mat4[3]=(f*S-p*M-d*w)*L,this.mat4[4]=(u*C-s*P-c*E)*L,this.mat4[5]=(e*P-i*C+o*E)*L,this.mat4[6]=(y*b-m*M-v*x)*L,this.mat4[7]=(l*M-f*b+d*x)*L,this.mat4[8]=(s*R-h*C+c*T)*L,this.mat4[9]=(r*C-e*R-o*T)*L,this.mat4[10]=(m*S-g*b+v*_)*L,this.mat4[11]=(p*b-l*S-d*_)*L,this.mat4[12]=(h*E-s*A-u*T)*L,this.mat4[13]=(e*A-r*E+i*T)*L,this.mat4[14]=(g*x-m*w-y*_)*L,this.mat4[15]=(l*w-p*x+f*_)*L,this):null},n.Matrix.prototype.determinant=function(){var t=this.mat4[0]*this.mat4[5]-this.mat4[1]*this.mat4[4],e=this.mat4[0]*this.mat4[6]-this.mat4[2]*this.mat4[4],r=this.mat4[0]*this.mat4[7]-this.mat4[3]*this.mat4[4],n=this.mat4[1]*this.mat4[6]-this.mat4[2]*this.mat4[5],i=this.mat4[1]*this.mat4[7]-this.mat4[3]*this.mat4[5],o=this.mat4[2]*this.mat4[7]-this.mat4[3]*this.mat4[6],a=this.mat4[8]*this.mat4[13]-this.mat4[9]*this.mat4[12],s=this.mat4[8]*this.mat4[14]-this.mat4[10]*this.mat4[12],h=this.mat4[8]*this.mat4[15]-this.mat4[11]*this.mat4[12],u=this.mat4[9]*this.mat4[14]-this.mat4[10]*this.mat4[13],c=this.mat4[9]*this.mat4[15]-this.mat4[11]*this.mat4[13],l=this.mat4[10]*this.mat4[15]-this.mat4[11]*this.mat4[14];return t*l-e*c+r*u+n*h-i*s+o*a},n.Matrix.prototype.mult=function(t){var e=new a(16),r=new a(16);t instanceof n.Matrix?r=t.mat4:t instanceof a&&(r=t);var i=this.mat4[0],o=this.mat4[1],s=this.mat4[2],h=this.mat4[3];return e[0]=i*r[0]+o*r[4]+s*r[8]+h*r[12],e[1]=i*r[1]+o*r[5]+s*r[9]+h*r[13],e[2]=i*r[2]+o*r[6]+s*r[10]+h*r[14],e[3]=i*r[3]+o*r[7]+s*r[11]+h*r[15],i=this.mat4[4],o=this.mat4[5],s=this.mat4[6],h=this.mat4[7],e[4]=i*r[0]+o*r[4]+s*r[8]+h*r[12],e[5]=i*r[1]+o*r[5]+s*r[9]+h*r[13],e[6]=i*r[2]+o*r[6]+s*r[10]+h*r[14],e[7]=i*r[3]+o*r[7]+s*r[11]+h*r[15],i=this.mat4[8],o=this.mat4[9],s=this.mat4[10],h=this.mat4[11],e[8]=i*r[0]+o*r[4]+s*r[8]+h*r[12],e[9]=i*r[1]+o*r[5]+s*r[9]+h*r[13],e[10]=i*r[2]+o*r[6]+s*r[10]+h*r[14],e[11]=i*r[3]+o*r[7]+s*r[11]+h*r[15],i=this.mat4[12],o=this.mat4[13],s=this.mat4[14],h=this.mat4[15],e[12]=i*r[0]+o*r[4]+s*r[8]+h*r[12],e[13]=i*r[1]+o*r[5]+s*r[9]+h*r[13],e[14]=i*r[2]+o*r[6]+s*r[10]+h*r[14],e[15]=i*r[3]+o*r[7]+s*r[11]+h*r[15],this.mat4=e,this},n.Matrix.prototype.scale=function(){var t,e,r;arguments[0]instanceof n.Vector?(t=arguments[0].x,e=arguments[0].y,r=arguments[0].z):arguments[0]instanceof Array?(t=arguments[0][0],e=arguments[0][1],r=arguments[0][2]):(t=arguments[0]||1,e=arguments[1]||1,r=arguments[2]||1);for(var i=new a(16),o=0;o<this.mat4.length;o++){var s=o%4;switch(s){case 0:i[o]=this.mat4[o]*t;break;case 1:i[o]=this.mat4[o]*e;break;case 2:i[o]=this.mat4[o]*r;break;case 3:i[o]=this.mat4[o]}}return this.mat4=i,this},n.Matrix.prototype.rotate=function(t,e){var r,a,s,h,u;this.p5?this.p5._angleMode===o.DEGREES&&(h=i.degreesToRadians(t)):h=t,e instanceof n.Vector?(r=e.x,a=e.y,s=e.z):e instanceof Array&&(r=e[0],a=e[1],s=e[2]),u=Math.sqrt(r*r+a*a+s*s),r*=1/u,a*=1/u,s*=1/u;var c=this.mat4[0],l=this.mat4[1],p=this.mat4[2],f=this.mat4[3],d=this.mat4[4],m=this.mat4[5],g=this.mat4[6],y=this.mat4[7],v=this.mat4[8],_=this.mat4[9],x=this.mat4[10],b=this.mat4[11],w=Math.sin(h),S=Math.cos(h),M=1-S,T=r*r*M+S,E=a*r*M+s*w,C=s*r*M-a*w,A=r*a*M-s*w,R=a*a*M+S,P=s*a*M+r*w,L=r*s*M+a*w,O=a*s*M-r*w,D=s*s*M+S;return this.mat4[0]=c*T+d*E+v*C,this.mat4[1]=l*T+m*E+_*C,this.mat4[2]=p*T+g*E+x*C,this.mat4[3]=f*T+y*E+b*C,this.mat4[4]=c*A+d*R+v*P,this.mat4[5]=l*A+m*R+_*P,this.mat4[6]=p*A+g*R+x*P,this.mat4[7]=f*A+y*R+b*P,this.mat4[8]=c*L+d*O+v*D,this.mat4[9]=l*L+m*O+_*D,this.mat4[10]=p*L+g*O+x*D,this.mat4[11]=f*L+y*O+b*D,this},n.Matrix.prototype.translate=function(t){var e=t[0],r=t[1],n=t[2];this.mat4[12]=this.mat4[0]*e+this.mat4[4]*r+this.mat4[8]*n+this.mat4[12],this.mat4[13]=this.mat4[1]*e+this.mat4[5]*r+this.mat4[9]*n+this.mat4[13],this.mat4[14]=this.mat4[2]*e+this.mat4[6]*r+this.mat4[10]*n+this.mat4[14],this.mat4[15]=this.mat4[3]*e+this.mat4[7]*r+this.mat4[11]*n+this.mat4[15]},n.Matrix.prototype.rotateX=function(t){this.rotate(t,[1,0,0])},n.Matrix.prototype.rotateY=function(t){this.rotate(t,[0,1,0])},n.Matrix.prototype.rotateZ=function(t){this.rotate(t,[0,0,1])},n.Matrix.prototype.perspective=function(t,e,r,n){var i=1/Math.tan(t/2),o=1/(r-n);return this.mat4[0]=i/e,this.mat4[1]=0,this.mat4[2]=0,this.mat4[3]=0,this.mat4[4]=0,this.mat4[5]=i,this.mat4[6]=0,this.mat4[7]=0,this.mat4[8]=0,this.mat4[9]=0,this.mat4[10]=(n+r)*o,this.mat4[11]=-1,this.mat4[12]=0,this.mat4[13]=0,this.mat4[14]=2*n*r*o,this.mat4[15]=0,this},n.Matrix.prototype.ortho=function(t,e,r,n,i,o){var a=1/(t-e),s=1/(r-n),h=1/(i-o);return this.mat4[0]=-2*a,this.mat4[1]=0,this.mat4[2]=0,this.mat4[3]=0,this.mat4[4]=0,this.mat4[5]=-2*s,this.mat4[6]=0,this.mat4[7]=0,this.mat4[8]=0,this.mat4[9]=0,this.mat4[10]=2*h,this.mat4[11]=0,this.mat4[12]=(t+e)*a,this.mat4[13]=(n+r)*s,this.mat4[14]=(o+i)*h,this.mat4[15]=1,this},e.exports=n.Matrix},{"../core/constants":47,"../core/core":48,"../math/polargeometry":77}],36:[function(t,e,r){"use strict";var n=t("../core/core"),i=t("./shader");t("../core/p5.Renderer"),t("./p5.Matrix");var o=[],a=1e3,s={alpha:!1,depth:!0,stencil:!0,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1};n.Renderer3D=function(t,e,r){n.Renderer.call(this,t,e,r);try{if(this.drawingContext=this.canvas.getContext("webgl",s)||this.canvas.getContext("experimental-webgl",s),null===this.drawingContext)throw new Error("Error creating webgl context");console.log("p5.Renderer3D: enabled webgl context")}catch(i){throw new Error(i)}this.isP3D=!0,this.GL=this.drawingContext;var o=this.GL;return o.clearColor(1,1,1,1),o.clearDepth(1),o.enable(o.DEPTH_TEST),o.depthFunc(o.LEQUAL),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),o.viewport(0,0,o.drawingBufferWidth,o.drawingBufferHeight),this._init(),this},n.Renderer3D.prototype=Object.create(n.Renderer.prototype),n.Renderer3D.prototype._applyDefaults=function(){
return this},n.Renderer3D.prototype._init=function(t){var e=this.GL;this.initMatrix(),this.initHash(),this.verticeStack=[],this.verticeBuffer=e.createBuffer(),this.colorBuffer=e.createBuffer(),this._setCamera=!1,this.ambientLightCount=0,this.directionalLightCount=0,this.pointLightCount=0},n.Renderer3D.prototype._update=function(){this.resetMatrix(),this.translate(0,0,-800),this.ambientLightCount=0,this.directionalLightCount=0,this.pointLightCount=0,this.verticeStack=[]},n.Renderer3D.prototype.resize=function(t,e){var r=this.GL;n.Renderer.prototype.resize.call(this,t,e),r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight)},n.Renderer3D.prototype.background=function(){var t=this.GL,e=this._pInst.color.apply(this._pInst,arguments),r=e.rgba[0]/255,n=e.rgba[1]/255,i=e.rgba[2]/255,o=e.rgba[3]/255;t.clearColor(r,n,i,o),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)},n.Renderer3D.prototype.initShaders=function(t,e,r){var n=this.GL,o=n.createShader(n.VERTEX_SHADER);if(n.shaderSource(o,i[t]),n.compileShader(o),!n.getShaderParameter(o,n.COMPILE_STATUS))return alert("Yikes! An error occurred compiling the shaders:"+n.getShaderInfoLog(o)),null;var a=n.createShader(n.FRAGMENT_SHADER);if(n.shaderSource(a,i[e]),n.compileShader(a),!n.getShaderParameter(a,n.COMPILE_STATUS))return alert("Darn! An error occurred compiling the shaders:"+n.getShaderInfoLog(a)),null;var s=n.createProgram();return n.attachShader(s,o),n.attachShader(s,a),n.linkProgram(s),n.getProgramParameter(s,n.LINK_STATUS)||alert("Snap! Error linking shader program"),this._getLocation(s,r),s},n.Renderer3D.prototype._getLocation=function(t,e){var r=this.GL;r.useProgram(t),t.uResolution=r.getUniformLocation(t,"uResolution"),r.uniform1f(t.uResolution,a),t.vertexPositionAttribute=r.getAttribLocation(t,"aPosition"),r.enableVertexAttribArray(t.vertexPositionAttribute),t.uPMatrixUniform=r.getUniformLocation(t,"uProjectionMatrix"),t.uMVMatrixUniform=r.getUniformLocation(t,"uModelViewMatrix"),void 0===e&&(t.vertexNormalAttribute=r.getAttribLocation(t,"aNormal"),r.enableVertexAttribArray(t.vertexNormalAttribute),t.uNMatrixUniform=r.getUniformLocation(t,"uNormalMatrix"),t.textureCoordAttribute=r.getAttribLocation(t,"aTexCoord"),r.enableVertexAttribArray(t.textureCoordAttribute),t.samplerUniform=r.getUniformLocation(t,"uSampler"))},n.Renderer3D.prototype.setMatrixUniforms=function(t){var e=this.GL,r=this.mHash[t];e.useProgram(r),e.uniformMatrix4fv(r.uPMatrixUniform,!1,this.uPMatrix.mat4),e.uniformMatrix4fv(r.uMVMatrixUniform,!1,this.uMVMatrix.mat4),this.uNMatrix=new n.Matrix,this.uNMatrix.invert(this.uMVMatrix),this.uNMatrix.transpose(this.uNMatrix),e.uniformMatrix4fv(r.uNMatrixUniform,!1,this.uNMatrix.mat4)},n.Renderer3D.prototype._getShader=function(t,e,r){var n=t+"|"+e;if(!this.materialInHash(n)){var i=this.initShaders(t,e,r);this.mHash[n]=i}return this.curShaderId=n,this.mHash[this.curShaderId]},n.Renderer3D.prototype._getCurShaderId=function(){if(void 0===this.curShaderId){var t="normalVert|normalFrag",e=this.initShaders("normalVert","normalFrag");this.mHash[t]=e,this.curShaderId=t}return this.curShaderId},n.Renderer3D.prototype._getCurColor=function(){return void 0===this.curColor&&(this.curColor=[.5,.5,.5,1]),this.curColor},n.Renderer3D.prototype.initHash=function(){this.gHash={},this.mHash={}},n.Renderer3D.prototype.geometryInHash=function(t){return void 0!==this.gHash[t]},n.Renderer3D.prototype.materialInHash=function(t){return void 0!==this.mHash[t]},n.Renderer3D.prototype.initMatrix=function(){this.uMVMatrix=new n.Matrix,this.uPMatrix=new n.Matrix,this.uNMatrix=new n.Matrix},n.Renderer3D.prototype.resetMatrix=function(){this.uMVMatrix=n.Matrix.identity()},n.Renderer3D.prototype._setDefaultCamera=function(){if(!this._setCamera){var t=this.width,e=this.height;this.uPMatrix=n.Matrix.identity(),this.uPMatrix.perspective(60/180*Math.PI,t/e,.1,100),this._setCamera=!0}},n.Renderer3D.prototype.translate=function(t,e,r){return t/=a,e=-e/a,r/=a,this.uMVMatrix.translate([t,e,r]),this},n.Renderer3D.prototype.scale=function(t,e,r){return this.uMVMatrix.scale([t,e,r]),this},n.Renderer3D.prototype.rotate=function(t,e){return this.uMVMatrix.rotate(t,e),this},n.Renderer3D.prototype.rotateX=function(t){return this.uMVMatrix.rotateX(t),this},n.Renderer3D.prototype.rotateY=function(t){return this.uMVMatrix.rotateY(t),this},n.Renderer3D.prototype.rotateZ=function(t){return this.uMVMatrix.rotateZ(t),this},n.Renderer3D.prototype.push=function(){o.push(this.uMVMatrix.copy())},n.Renderer3D.prototype.pop=function(){if(0===o.length)throw new Error("Invalid popMatrix!");this.uMVMatrix=o.pop()},e.exports=n.Renderer3D},{"../core/core":48,"../core/p5.Renderer":54,"./p5.Matrix":35,"./shader":38}],37:[function(t,e,r){"use strict";var n=t("../core/core");n.Renderer3D.prototype.createBuffer=function(t,e){var r=this.GL;this.gHash[t]={},this.gHash[t].len=e.len,this.gHash[t].vertexBuffer=r.createBuffer(),this.gHash[t].normalBuffer=r.createBuffer(),this.gHash[t].uvBuffer=r.createBuffer(),this.gHash[t].indexBuffer=r.createBuffer()},n.Renderer3D.prototype.initBuffer=function(t,e){this._setDefaultCamera();var r=this.GL;this.createBuffer(t,e);var n=this.mHash[this._getCurShaderId()];r.bindBuffer(r.ARRAY_BUFFER,this.gHash[t].vertexBuffer),r.bufferData(r.ARRAY_BUFFER,new Float32Array(e.vertices),r.STATIC_DRAW),r.vertexAttribPointer(n.vertexPositionAttribute,3,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this.gHash[t].normalBuffer),r.bufferData(r.ARRAY_BUFFER,new Float32Array(e.vertexNormals),r.STATIC_DRAW),r.vertexAttribPointer(n.vertexNormalAttribute,3,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this.gHash[t].uvBuffer),r.bufferData(r.ARRAY_BUFFER,new Float32Array(e.uvs),r.STATIC_DRAW),r.vertexAttribPointer(n.textureCoordAttribute,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.gHash[t].indexBuffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint16Array(e.faces),r.STATIC_DRAW)},n.Renderer3D.prototype.drawBuffer=function(t){this._setDefaultCamera();var e=this.GL,r=this._getCurShaderId(),n=this.mHash[r];e.bindBuffer(e.ARRAY_BUFFER,this.gHash[t].vertexBuffer),e.vertexAttribPointer(n.vertexPositionAttribute,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.gHash[t].normalBuffer),e.vertexAttribPointer(n.vertexNormalAttribute,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.gHash[t].uvBuffer),e.vertexAttribPointer(n.textureCoordAttribute,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.gHash[t].indexBuffer),this.setMatrixUniforms(r),e.drawElements(e.TRIANGLES,this.gHash[t].len,e.UNSIGNED_SHORT,0)},e.exports=n.Renderer3D},{"../core/core":48}],38:[function(t,e,r){e.exports={vertexColorVert:"attribute vec3 aPosition;\nattribute vec4 aVertexColor;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform float uResolution;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  vec4 positionVec4 = vec4(aPosition / uResolution * vec3(1.0, -1.0, 1.0), 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vColor = aVertexColor;\n}",vertexColorFrag:"precision mediump float;\nvarying vec4 vColor;\nvoid main(void) {\n  gl_FragColor = vColor;\n}",normalVert:"attribute vec3 aPosition;\nattribute vec3 aNormal;\nattribute vec2 aTexCoord;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat4 uNormalMatrix;\nuniform float uResolution;\n\nvarying vec3 vVertexNormal;\nvarying highp vec2 vVertTexCoord;\n\nvoid main(void) {\n  vec4 positionVec4 = vec4(aPosition / uResolution, 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vVertexNormal = vec3( uNormalMatrix * vec4( aNormal, 1.0 ) );\n  vVertTexCoord = aTexCoord;\n}",normalFrag:"precision mediump float;\nvarying vec3 vVertexNormal;\nvoid main(void) {\n  gl_FragColor = vec4(vVertexNormal, 1.0);\n}",basicFrag:"precision mediump float;\nvarying vec3 vVertexNormal;\nuniform vec4 uMaterialColor;\nvoid main(void) {\n  gl_FragColor = uMaterialColor;\n}",textureFrag:"precision mediump float;\nvarying highp vec2 vVertTexCoord;\nuniform sampler2D uSampler;\nvoid main(void) {\n  gl_FragColor = texture2D(uSampler, vec2(vVertTexCoord.s,vVertTexCoord.t));\n}",lightVert:"attribute vec3 aPosition;\nattribute vec3 aNormal;\nattribute vec2 aTexCoord;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat4 uNormalMatrix;\nuniform float uResolution;\nuniform int uAmbientLightCount;\nuniform int uDirectionalLightCount;\nuniform int uPointLightCount;\n\nuniform vec3 uAmbientColor[8];\nuniform vec3 uLightingDirection[8];\nuniform vec3 uDirectionalColor[8];\nuniform vec3 uPointLightLocation[8];\nuniform vec3 uPointLightColor[8];\nuniform bool uSpecular;\n\nvarying vec3 vVertexNormal;\nvarying vec2 vVertTexCoord;\nvarying vec3 vLightWeighting;\n\nvec3 ambientLightFactor = vec3(0.0, 0.0, 0.0);\nvec3 directionalLightFactor = vec3(0.0, 0.0, 0.0);\nvec3 pointLightFactor = vec3(0.0, 0.0, 0.0);\nvec3 pointLightFactor2 = vec3(0.0, 0.0, 0.0);\n\nvoid main(void){\n\n  vec4 positionVec4 = vec4(aPosition / uResolution, 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n\n  vec3 vertexNormal = vec3( uNormalMatrix * vec4( aNormal, 1.0 ) );\n  vVertexNormal = vertexNormal;\n  vVertTexCoord = aTexCoord;\n\n  vec4 mvPosition = uModelViewMatrix * vec4(aPosition / uResolution, 1.0);\n  vec3 eyeDirection = normalize(-mvPosition.xyz);\n\n  float shininess = 32.0;\n  float specularFactor = 2.0;\n  float diffuseFactor = 0.3;\n\n  for(int i = 0; i < 8; i++){\n    if(uAmbientLightCount == i) break;\n    ambientLightFactor += uAmbientColor[i];\n  }\n\n  for(int j = 0; j < 8; j++){\n    if(uDirectionalLightCount == j) break;\n    vec3 dir = uLightingDirection[j];\n    float directionalLightWeighting = max(dot(vertexNormal, dir), 0.0);\n    directionalLightFactor += uDirectionalColor[j] * directionalLightWeighting;\n  }\n\n  for(int k = 0; k < 8; k++){\n    if(uPointLightCount == k) break;\n    vec3 loc = uPointLightLocation[k];\n    //loc = loc / uResolution;\n    vec3 lightDirection = normalize(loc - mvPosition.xyz);\n\n    float directionalLightWeighting = max(dot(vertexNormal, lightDirection), 0.0);\n    pointLightFactor += uPointLightColor[k] * directionalLightWeighting;\n\n    //factor2 for specular\n    vec3 reflectionDirection = reflect(-lightDirection, vertexNormal);\n    float specularLightWeighting = pow(max(dot(reflectionDirection, eyeDirection), 0.0), shininess);\n\n    pointLightFactor2 += uPointLightColor[k] * (specularFactor * specularLightWeighting\n      +  directionalLightWeighting * diffuseFactor);\n  }\n  \n  if(!uSpecular){\n    vLightWeighting =  ambientLightFactor + directionalLightFactor + pointLightFactor;\n  }else{\n    vLightWeighting = ambientLightFactor + directionalLightFactor + pointLightFactor2;\n  }\n\n}",lightFrag:"precision mediump float;\n\nuniform vec4 uMaterialColor;\nvarying vec3 vLightWeighting;\n\nvoid main(void) {\n  gl_FragColor = vec4(vec3(uMaterialColor.rgb * vLightWeighting), uMaterialColor.a);\n}"}},{}],39:[function(t,e,r){"use strict";var n=t("./core/core");t("./color/p5.Color"),t("./core/p5.Element"),t("./typography/p5.Font"),t("./core/p5.Graphics"),t("./core/p5.Renderer2D"),t("./image/p5.Image"),t("./math/p5.Vector"),t("./io/p5.TableRow"),t("./io/p5.Table"),t("./color/creating_reading"),t("./color/setting"),t("./core/constants"),t("./utilities/conversion"),t("./utilities/array_functions"),t("./utilities/string_functions"),t("./core/environment"),t("./image/image"),t("./image/loading_displaying"),t("./image/pixels"),t("./io/files"),t("./events/keyboard"),t("./events/acceleration"),t("./events/mouse"),t("./utilities/time_date"),t("./events/touch"),t("./math/math"),t("./math/calculation"),t("./math/random"),t("./math/noise"),t("./math/trigonometry"),t("./core/rendering"),t("./core/2d_primitives"),t("./core/attributes"),t("./core/curves"),t("./core/vertex"),t("./core/structure"),t("./core/transform"),t("./typography/attributes"),t("./typography/loading_displaying"),t("./3d/p5.Renderer3D"),t("./3d/p5.Geometry3D"),t("./3d/retainedMode3D"),t("./3d/immediateMode3D"),t("./3d/3d_primitives"),t("./3d/p5.Matrix"),t("./3d/material"),t("./3d/light"),t("./3d/shader"),t("./3d/camera"),t("./3d/interaction");var i=function(){window.PHANTOMJS||window.mocha||(window.setup&&"function"==typeof window.setup||window.draw&&"function"==typeof window.draw)&&new n};"complete"===document.readyState?i():window.addEventListener("load",i,!1),e.exports=n},{"./3d/3d_primitives":28,"./3d/camera":29,"./3d/immediateMode3D":30,"./3d/interaction":31,"./3d/light":32,"./3d/material":33,"./3d/p5.Geometry3D":34,"./3d/p5.Matrix":35,"./3d/p5.Renderer3D":36,"./3d/retainedMode3D":37,"./3d/shader":38,"./color/creating_reading":41,"./color/p5.Color":42,"./color/setting":43,"./core/2d_primitives":44,"./core/attributes":45,"./core/constants":47,"./core/core":48,"./core/curves":49,"./core/environment":50,"./core/p5.Element":52,"./core/p5.Graphics":53,"./core/p5.Renderer2D":55,"./core/rendering":56,"./core/structure":58,"./core/transform":59,"./core/vertex":60,"./events/acceleration":61,"./events/keyboard":62,"./events/mouse":63,"./events/touch":64,"./image/image":66,"./image/loading_displaying":67,"./image/p5.Image":68,"./image/pixels":69,"./io/files":70,"./io/p5.Table":71,"./io/p5.TableRow":72,"./math/calculation":73,"./math/math":74,"./math/noise":75,"./math/p5.Vector":76,"./math/random":78,"./math/trigonometry":79,"./typography/attributes":80,"./typography/loading_displaying":81,"./typography/p5.Font":82,"./utilities/array_functions":83,"./utilities/conversion":84,"./utilities/string_functions":85,"./utilities/time_date":86}],40:[function(t,e,r){var n=t("../core/core");n.ColorUtils={},n.ColorUtils.hsbaToRGBA=function(t){var e=t[0],r=t[1],n=t[2],i=t[3]||1,o=[];if(0===r)o=[n,n,n,i];else{var a=6*e;6===a&&(a=0);var s,h,u,c=Math.floor(a),l=n*(1-r),p=n*(1-r*(a-c)),f=n*(1-r*(1-(a-c)));0===c?(s=n,h=f,u=l):1===c?(s=p,h=n,u=l):2===c?(s=l,h=n,u=f):3===c?(s=l,h=p,u=n):4===c?(s=f,h=l,u=n):(s=n,h=l,u=p),o=[s,h,u,i]}return o},n.ColorUtils.rgbaToHSBA=function(t){var e,r,n=t[0],i=t[1],o=t[2],a=t[3]||1,s=Math.min(n,i,o),h=Math.max(n,i,o),u=h-s,c=h;if(0===u)e=0,r=0;else{r=u/h;var l=((h-n)/6+u/2)/u,p=((h-i)/6+u/2)/u,f=((h-o)/6+u/2)/u;n===h?e=f-p:i===h?e=1/3+l-f:o===h&&(e=2/3+p-l),0>e&&(e+=1),e>1&&(e-=1)}return[e,r,c,a]},n.ColorUtils.hslaToRGBA=function(t){var e=t[0],r=t[1],n=t[2],i=t[3]||1,o=[];if(0===r)o=[n,n,n,i];else{var a,s,h,u,c;s=.5>n?n*(1+r):n+r-r*n,a=2*n-s;var l=function(t,e,r){return 0>r?r+=1:r>1&&(r-=1),1>6*r?t+6*(e-t)*r:1>2*r?e:2>3*r?t+(e-t)*(2/3-r)*6:t};h=l(a,s,e+1/3),u=l(a,s,e),c=l(a,s,e-1/3),o=[h,u,c,i]}return o},n.ColorUtils.rgbaToHSLA=function(t){var e,r,n,i,o,a=t[0],s=t[1],h=t[2],u=t[3]||1,c=Math.min(a,s,h),l=Math.max(a,s,h),p=l-c,f=(l+c)/2;return 0===p?(e=0,r=0):(n=((l-a)/6+p/2)/p,i=((l-s)/6+p/2)/p,o=((l-h)/6+p/2)/p,a===l?e=o-i:s===l?e=1/3+n-o:h===l&&(e=2/3+i-n),0>e&&(e+=1),e>1&&(e-=1),r=.5>f?p/(l+c):p/(2-l-c)),[e,r,f,u]},n.ColorUtils.hslaToHSBA=function(t){var e,r=t[0],n=t[1],i=t[2],o=t[3]||1;return n*=.5>i?i:1-i,e=i+n,n=2*n/(i+n),[r,n,e,o]},n.ColorUtils.hsbaToHSLA=function(t){var e=t[0],r=t[1],n=t[2],i=t[3]||1,o=(2-r)*n/2;return 0!==o&&(1===o?r=0:.5>o?r/=2-r:r=r*n/(2-2*o)),[e,r,o,i]},e.exports=n.ColorUtils},{"../core/core":48}],41:[function(t,e,r){"use strict";var n=t("../core/core"),i=t("../core/constants");t("./p5.Color"),n.prototype.alpha=function(t){if(t instanceof n.Color||t instanceof Array)return this.color(t).getAlpha();throw new Error("Needs p5.Color or pixel array as argument.")},n.prototype.blue=function(t){if(t instanceof n.Color||t instanceof Array)return this.color(t).getBlue();throw new Error("Needs p5.Color or pixel array as argument.")},n.prototype.brightness=function(t){if(t instanceof n.Color||t instanceof Array)return this.color(t).getBrightness();throw new Error("Needs p5.Color or pixel array as argument.")},n.prototype.color=function(){if(arguments[0]instanceof n.Color)return arguments[0];if(arguments[0]instanceof Array)return new n.Color(this,arguments[0]);var t=Array.prototype.slice.call(arguments);return new n.Color(this,t)},n.prototype.green=function(t){if(t instanceof n.Color||t instanceof Array)return this.color(t).getGreen();throw new Error("Needs p5.Color or pixel array as argument.")},n.prototype.hue=function(t){if(!(t instanceof n.Color))throw new Error("Needs p5.Color as argument.");return t.getHue()},n.prototype.lerpColor=function(t,e,r){var n,o,a,s,h,u;if(this._renderer._colorMode===i.RGB)h=this.color(t).rgba,u=this.color(e).rgba;else if(this._renderer._colorMode===i.HSB)h=this.color(t).hsba,u=this.color(e).hsba;else{if(this._renderer._colorMode!==i.HSL)return;h=this.color(t).hsla,u=this.color(e).hsla}return n=this.lerp(h[0],u[0],r),o=this.lerp(h[1],u[1],r),a=this.lerp(h[2],u[2],r),s=this.lerp(h[3],u[3],r),this.color(n,o,a,s)},n.prototype.lightness=function(t){if(t instanceof n.Color||t instanceof Array)return this.color(t).getLightness();throw new Error("Needs p5.Color or pixel array as argument.")},n.prototype.red=function(t){if(t instanceof n.Color||t instanceof Array)return this.color(t).getRed();throw new Error("Needs p5.Color or pixel array as argument.")},n.prototype.saturation=function(t){if(!(t instanceof n.Color))throw new Error("Needs p5.Color as argument.");return t.getSaturation()},e.exports=n},{"../core/constants":47,"../core/core":48,"./p5.Color":42}],42:[function(t,e,r){var n=t("../core/core"),i=t("./color_utils"),o=t("../core/constants");n.Color=function(t,e){this.mode=t._renderer._colorMode,this.maxes=t._renderer._colorMaxes;var r=this.mode===o.HSB,a=this.mode===o.RGB,s=this.mode===o.HSL;if(a)this._array=n.Color._getFormattedColor.apply(t,e);else if(r)this.hsba=n.Color._getFormattedColor.apply(t,e),this._array=i.hsbaToRGBA(this.hsba);else{if(!s)throw new Error(t._renderer._colorMode+" is an invalid colorMode.");this.hsla=n.Color._getFormattedColor.apply(t,e),this._array=i.hslaToRGBA(this.hsla)}return this.rgba=[Math.round(255*this._array[0]),Math.round(255*this._array[1]),Math.round(255*this._array[2]),Math.round(255*this._array[3])],this},n.Color.prototype.getHue=function(){return this.hsla?this.hsla[0]*this.maxes[o.HSL][0]:this.hsba?this.hsba[0]*this.maxes[o.HSB][0]:(this.hsla=i.rgbaToHSLA(this._array),this.hsla[0]*this.maxes[o.HSL][0])},n.Color.prototype.getSaturation=function(){return this.hsba&&this.mode===o.HSB?this.hsba[1]*this.maxes[o.HSB][1]:(this.hsla||(this.hsla=i.rgbaToHSLA(this._array)),this.hsla[1]*this.maxes[o.HSL][1])},n.Color.prototype.getBrightness=function(){return this.hsba?this.hsba[2]*this.maxes[o.HSB][2]:(this.hsba=i.rgbaToHSBA(this._array),this.hsba[2]*this.maxes[o.HSB][2])},n.Color.prototype.getLightness=function(){return this.hsla?this.hsla[2]*this.maxes[o.HSL][2]:(this.hsla=i.rgbaToHSLA(this._array),this.hsla[2]*this.maxes[o.HSL][2])},n.Color.prototype.getRed=function(){return this._array[0]*this.maxes[o.RGB][0]},n.Color.prototype.getGreen=function(){return this._array[1]*this.maxes[o.RGB][1]},n.Color.prototype.getBlue=function(){return this._array[2]*this.maxes[o.RGB][2]},n.Color.prototype.getAlpha=function(){return this._array[3]*this.maxes[this.mode][3]},n.Color.prototype.toString=function(){var t=this.rgba;return t[3]=this._array[3],"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},n.Color.prototype._normalize=function(){var t=this.rgba.map(function(t){return t/255});return t};var a=/\s*/,s=/(\d{1,3})/,h=/((?:\d+(?:\.\d+)?)|(?:\.\d+))/,u=new RegExp(h.source+"%"),c={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},l={HEX3:/^#([a-f0-9])([a-f0-9])([a-f0-9])$/i,HEX6:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,RGB:new RegExp(["^rgb\\(",s.source,",",s.source,",",s.source,"\\)$"].join(a.source),"i"),RGB_PERCENT:new RegExp(["^rgb\\(",u.source,",",u.source,",",u.source,"\\)$"].join(a.source),"i"),RGBA:new RegExp(["^rgba\\(",s.source,",",s.source,",",s.source,",",h.source,"\\)$"].join(a.source),"i"),RGBA_PERCENT:new RegExp(["^rgba\\(",u.source,",",u.source,",",u.source,",",h.source,"\\)$"].join(a.source),"i"),HSL:new RegExp(["^hsl\\(",s.source,",",u.source,",",u.source,"\\)$"].join(a.source),"i"),HSLA:new RegExp(["^hsla\\(",s.source,",",u.source,",",u.source,",",h.source,"\\)$"].join(a.source),"i"),HSB:new RegExp(["^hsb\\(",s.source,",",u.source,",",u.source,"\\)$"].join(a.source),"i"),HSBA:new RegExp(["^hsba\\(",s.source,",",u.source,",",u.source,",",h.source,"\\)$"].join(a.source),"i")};n.Color._getFormattedColor=function(){var t=arguments.length,e=this._renderer._colorMode,r=this._renderer._colorMaxes[this._renderer._colorMode],a=[];if(t>=3)a[0]=arguments[0]/r[0],a[1]=arguments[1]/r[1],a[2]=arguments[2]/r[2],a[3]="number"==typeof arguments[3]?arguments[3]/r[3]:1;else if(1===t&&"string"==typeof arguments[0]){var s=arguments[0].trim().toLowerCase();if(c[s])return n.Color._getFormattedColor.apply(this,[c[s]]);if(l.HEX3.test(s)?(a=l.HEX3.exec(s).slice(1).map(function(t){return parseInt(t+t,16)/255}),a[3]=1):l.HEX6.test(s)?(a=l.HEX6.exec(s).slice(1).map(function(t){return parseInt(t,16)/255}),a[3]=1):l.RGB.test(s)?(a=l.RGB.exec(s).slice(1).map(function(t){return t/255}),a[3]=1):l.RGB_PERCENT.test(s)?(a=l.RGB_PERCENT.exec(s).slice(1).map(function(t){return parseFloat(t)/100}),a[3]=1):l.RGBA.test(s)?a=l.RGBA.exec(s).slice(1).map(function(t,e){return 3===e?parseFloat(t):t/255}):l.RGBA_PERCENT.test(s)&&(a=l.RGBA_PERCENT.exec(s).slice(1).map(function(t,e){return 3===e?parseFloat(t):parseFloat(t)/100})),a.length){if(e===o.RGB)return a;if(e===o.HSL)return i.rgbaToHSLA(a);if(e===o.HSB)return i.rgbaToHSBA(a)}if(l.HSL.test(s)?(a=l.HSL.exec(s).slice(1).map(function(t,e){return 0===e?parseInt(t,10)/360:parseInt(t,10)/100}),a[3]=1):l.HSLA.test(s)&&(a=l.HSLA.exec(s).slice(1).map(function(t,e){return 0===e?parseInt(t,10)/360:3===e?parseFloat(t):parseInt(t,10)/100})),a.length){if(e===o.RGB)return i.hslaToRGBA(a);if(e===o.HSL)return a;if(e===o.HSB)return i.hslaToHSBA(a)}if(l.HSB.test(s)?(a=l.HSB.exec(s).slice(1).map(function(t,e){return 0===e?parseInt(t,10)/360:parseInt(t,10)/100}),a[3]=1):l.HSBA.test(s)&&(a=l.HSBA.exec(s).slice(1).map(function(t,e){return 0===e?parseInt(t,10)/360:3===e?parseFloat(t):parseInt(t,10)/100})),a.length){if(e===o.RGB)return i.hsbaToRGBA(a);if(e===o.HSB)return a;if(e===o.HSL)return i.hsbaToHSLA(a)}a=[1,1,1,1]}else{if(1!==t&&2!==t||"number"!=typeof arguments[0])throw new Error(arguments+"is not a valid color representation.");e===o.RGB?(a[0]=arguments[0]/r[0],a[1]=arguments[0]/r[1],a[2]=arguments[0]/r[2],a[3]="number"==typeof arguments[1]?arguments[1]/r[3]:1):(a[0]=arguments[0],a[1]=arguments[0],a[2]=arguments[0]/r[2],a[3]="number"==typeof arguments[1]?arguments[1]/r[3]:1)}return a},e.exports=n.Color},{"../core/constants":47,"../core/core":48,"./color_utils":40}],43:[function(t,e,r){"use strict";var n=t("../core/core"),i=t("../core/constants");t("./p5.Color"),n.prototype.background=function(){return arguments[0]instanceof n.Image?this.image(arguments[0],0,0,this.width,this.height):this._renderer.background.apply(this._renderer,arguments),this},n.prototype.clear=function(){return this._renderer.clear(),this},n.prototype.colorMode=function(){if(arguments[0]===i.RGB||arguments[0]===i.HSB||arguments[0]===i.HSL){this._renderer._colorMode=arguments[0];var t=this._renderer._colorMaxes[this._renderer._colorMode];2===arguments.length?(t[0]=arguments[1],t[1]=arguments[1],t[2]=arguments[1],t[3]=arguments[1]):4===arguments.length&&(t[0]=arguments[1],t[1]=arguments[2],t[2]=arguments[3]),5===arguments.length&&(t[0]=arguments[1],t[1]=arguments[2],t[2]=arguments[3],t[3]=arguments[4])}return this},n.prototype.fill=function(){return this._renderer._setProperty("_fillSet",!0),this._renderer._setProperty("_doFill",!0),this._renderer.fill.apply(this._renderer,arguments),this},n.prototype.noFill=function(){return this._renderer._setProperty("_doFill",!1),this},n.prototype.noStroke=function(){return this._renderer._setProperty("_doStroke",!1),this},n.prototype.stroke=function(){return this._renderer._setProperty("_strokeSet",!0),this._renderer._setProperty("_doStroke",!0),this._renderer.stroke.apply(this._renderer,arguments),this},e.exports=n},{"../core/constants":47,"../core/core":48,"./p5.Color":42}],44:[function(t,e,r){"use strict";var n=t("./core"),i=t("./constants");t("./error_helpers"),n.prototype.arc=function(t,e,r,n,o,a,s){if(this._validateParameters("arc",arguments,[["Number","Number","Number","Number","Number","Number"],["Number","Number","Number","Number","Number","Number","String"]]),!this._renderer._doStroke&&!this._renderer._doFill)return this;for(this._angleMode===i.DEGREES&&(o=this.radians(o),a=this.radians(a));0>o;)o+=i.TWO_PI;for(;0>a;)a+=i.TWO_PI;return o%=i.TWO_PI,a%=i.TWO_PI,o=o<=i.HALF_PI?Math.atan(r/n*Math.tan(o)):o>i.HALF_PI&&o<=3*i.HALF_PI?Math.atan(r/n*Math.tan(o))+i.PI:Math.atan(r/n*Math.tan(o))+i.TWO_PI,a=a<=i.HALF_PI?Math.atan(r/n*Math.tan(a)):a>i.HALF_PI&&a<=3*i.HALF_PI?Math.atan(r/n*Math.tan(a))+i.PI:Math.atan(r/n*Math.tan(a))+i.TWO_PI,o>a&&(a+=i.TWO_PI),r=Math.abs(r),n=Math.abs(n),this._renderer.arc(t,e,r,n,o,a,s),this},n.prototype.ellipse=function(t,e,r,n){return this._validateParameters("ellipse",arguments,["Number","Number","Number","Number"]),this._renderer._doStroke||this._renderer._doFill?(r=Math.abs(r),n=Math.abs(n),this._renderer.ellipse(t,e,r,n),this):this},n.prototype.line=function(){return this._renderer._doStroke?(this._renderer.isP3D?(this._validateParameters("line",arguments,[["Number","Number","Number","Number","Number","Number"]]),this._renderer.line(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])):(this._validateParameters("line",arguments,[["Number","Number","Number","Number"]]),this._renderer.line(arguments[0],arguments[1],arguments[2],arguments[3])),this):this},n.prototype.point=function(){return this._renderer._doStroke?(this._renderer.isP3D?(this._validateParameters("point",arguments,[["Number","Number","Number"]]),this._renderer.point(arguments[0],arguments[1],arguments[2])):(this._validateParameters("point",arguments,[["Number","Number"]]),this._renderer.point(arguments[0],arguments[1])),this):this},n.prototype.quad=function(){return this._renderer._doStroke||this._renderer._doFill?(this._renderer.isP3D?(this._validateParameters("quad",arguments,[["Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number"]]),this._renderer.quad(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11])):(this._validateParameters("quad",arguments,[["Number","Number","Number","Number","Number","Number","Number","Number"]]),this._renderer.quad(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7])),this):this},n.prototype.rect=function(t,e,r,n,i,o,a,s){return this._validateParameters("rect",arguments,[["Number","Number","Number","Number"],["Number","Number","Number","Number","Number"],["Number","Number","Number","Number","Number","Number","Number","Number"]]),this._renderer._doStroke||this._renderer._doFill?(this._renderer.rect(t,e,r,n,i,o,a,s),this):void 0},n.prototype.triangle=function(){return this._renderer._doStroke||this._renderer._doFill?(this._renderer.isP3D?(this._validateParameters("triangle",arguments,[["Number","Number","Number","Number","Number","Number","Number","Number","Number"]]),this._renderer.triangle(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8])):(this._validateParameters("triangle",arguments,[["Number","Number","Number","Number","Number","Number"]]),this._renderer.triangle(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])),this):this},e.exports=n},{"./constants":47,"./core":48,"./error_helpers":51}],45:[function(t,e,r){"use strict";var n=t("./core"),i=t("./constants");n.prototype.ellipseMode=function(t){return(t===i.CORNER||t===i.CORNERS||t===i.RADIUS||t===i.CENTER)&&(this._renderer._ellipseMode=t),this},n.prototype.noSmooth=function(){return this._renderer.noSmooth(),this},n.prototype.rectMode=function(t){return(t===i.CORNER||t===i.CORNERS||t===i.RADIUS||t===i.CENTER)&&(this._renderer._rectMode=t),this},n.prototype.smooth=function(){return this._renderer.smooth(),this},n.prototype.strokeCap=function(t){return(t===i.ROUND||t===i.SQUARE||t===i.PROJECT)&&this._renderer.strokeCap(t),this},n.prototype.strokeJoin=function(t){return(t===i.ROUND||t===i.BEVEL||t===i.MITER)&&this._renderer.strokeJoin(t),this},n.prototype.strokeWeight=function(t){return this._renderer.strokeWeight(t),this},e.exports=n},{"./constants":47,"./core":48}],46:[function(t,e,r){var n=t("./constants");e.exports={modeAdjust:function(t,e,r,i,o){return o===n.CORNER?{x:t,y:e,w:r,h:i}:o===n.CORNERS?{x:t,y:e,w:r-t,h:i-e}:o===n.RADIUS?{x:t-r,y:e-i,w:2*r,h:2*i}:o===n.CENTER?{x:t-.5*r,y:e-.5*i,w:r,h:i}:void 0},arcModeAdjust:function(t,e,r,i,o){return o===n.CORNER?{x:t+.5*r,y:e+.5*i,w:r,h:i}:o===n.CORNERS?{x:t,y:e,w:r+t,h:i+e}:o===n.RADIUS?{x:t,y:e,w:2*r,h:2*i}:o===n.CENTER?{x:t,y:e,w:r,h:i}:void 0}}},{"./constants":47}],47:[function(t,e,r){
var n=Math.PI;e.exports={P2D:"p2d",WEBGL:"webgl",ARROW:"default",CROSS:"crosshair",HAND:"pointer",MOVE:"move",TEXT:"text",WAIT:"wait",HALF_PI:n/2,PI:n,QUARTER_PI:n/4,TAU:2*n,TWO_PI:2*n,DEGREES:"degrees",RADIANS:"radians",CORNER:"corner",CORNERS:"corners",RADIUS:"radius",RIGHT:"right",LEFT:"left",CENTER:"center",TOP:"top",BOTTOM:"bottom",BASELINE:"alphabetic",POINTS:"points",LINES:"lines",TRIANGLES:"triangles",TRIANGLE_FAN:"triangles_fan",TRIANGLE_STRIP:"triangles_strip",QUADS:"quads",QUAD_STRIP:"quad_strip",CLOSE:"close",OPEN:"open",CHORD:"chord",PIE:"pie",PROJECT:"square",SQUARE:"butt",ROUND:"round",BEVEL:"bevel",MITER:"miter",RGB:"rgb",HSB:"hsb",HSL:"hsl",AUTO:"auto",ALT:18,BACKSPACE:8,CONTROL:17,DELETE:46,DOWN_ARROW:40,ENTER:13,ESCAPE:27,LEFT_ARROW:37,OPTION:18,RETURN:13,RIGHT_ARROW:39,SHIFT:16,TAB:9,UP_ARROW:38,BLEND:"normal",ADD:"lighter",DARKEST:"darken",LIGHTEST:"lighten",DIFFERENCE:"difference",EXCLUSION:"exclusion",MULTIPLY:"multiply",SCREEN:"screen",REPLACE:"source-over",OVERLAY:"overlay",HARD_LIGHT:"hard-light",SOFT_LIGHT:"soft-light",DODGE:"color-dodge",BURN:"color-burn",THRESHOLD:"threshold",GRAY:"gray",OPAQUE:"opaque",INVERT:"invert",POSTERIZE:"posterize",DILATE:"dilate",ERODE:"erode",BLUR:"blur",NORMAL:"normal",ITALIC:"italic",BOLD:"bold",_DEFAULT_TEXT_FILL:"#000000",_DEFAULT_LEADMULT:1.25,_CTX_MIDDLE:"middle",LINEAR:"linear",QUADRATIC:"quadratic",BEZIER:"bezier",CURVE:"curve",_DEFAULT_STROKE:"#000000",_DEFAULT_FILL:"#FFFFFF"}},{}],48:[function(t,e,r){"use strict";t("./shim");var n=t("./constants"),i=function(t,e,r){2===arguments.length&&"boolean"==typeof e&&(r=e,e=void 0),this._setupDone=!1,this.pixelDensity=window.devicePixelRatio||1,this._userNode=e,this._curElement=null,this._elements=[],this._requestAnimId=0,this._preloadCount=0,this._isGlobal=!1,this._loop=!0,this._styles=[],this._defaultCanvasSize={width:100,height:100},this._events={mousemove:null,mousedown:null,mouseup:null,click:null,mouseover:null,mouseout:null,keydown:null,keyup:null,keypress:null,touchstart:null,touchmove:null,touchend:null,resize:null,blur:null},window.DeviceOrientationEvent?this._events.deviceorientation=null:window.DeviceMotionEvent?this._events.devicemotion=null:this._events.MozOrientation=null,/Firefox/i.test(navigator.userAgent)?this._events.DOMMouseScroll=null:this._events.mousewheel=null,this._loadingScreenId="p5_loading",this._start=function(){this._userNode&&"string"==typeof this._userNode&&(this._userNode=document.getElementById(this._userNode)),this.createCanvas(this._defaultCanvasSize.width,this._defaultCanvasSize.height,"p2d",!0);var t=this.preload||window.preload;if(t){var e=document.getElementById(this._loadingScreenId);if(!e){e=document.createElement("div"),e.innerHTML="Loading...",e.style.position="absolute",e.id=this._loadingScreenId;var r=this._userNode||document.body;r.appendChild(e)}for(var n in this._preloadMethods){this._preloadMethods[n]=this._preloadMethods[n]||i;var o=this._preloadMethods[n];(o===i.prototype||o===i)&&(o=this._isGlobal?window:this),this._registeredPreloadMethods[n]=o[n],o[n]=this._wrapPreload(o,n)}t()}else this._setup(),this._runFrames(),this._draw()}.bind(this),this._decrementPreload=function(){var t=this._isGlobal?window:this;if(t._setProperty("_preloadCount",t._preloadCount-1),0===t._preloadCount){var e=document.getElementById(t._loadingScreenId);e&&e.parentNode.removeChild(e),t._setup(),t._runFrames(),t._draw()}},this._wrapPreload=function(t,e){return function(){this._incrementPreload();var r=Array.prototype.slice.call(arguments);return r.push(this._decrementPreload.bind(this)),this._registeredPreloadMethods[e].apply(t,r)}.bind(this)},this._incrementPreload=function(){var t=this._isGlobal?window:this;t._setProperty("_preloadCount",t._preloadCount+1)},this._setup=function(){var t=this._isGlobal?window:this;if("function"==typeof t.preload)for(var e in this._preloadMethods)t[e]=this._preloadMethods[e][e];"function"==typeof t.setup&&t.setup();for(var r=new RegExp(/(^|\s)p5_hidden(?!\S)/g),n=document.getElementsByClassName("p5_hidden"),i=0;i<n.length;i++){var o=n[i];o.style.visibility="",o.className=o.className.replace(r,"")}this._setupDone=!0}.bind(this),this._draw=function(){var t=window.performance.now(),e=t-this._lastFrameTime,r=1e3/this._targetFrameRate,n=5;(!this.loop||e>=r-n)&&(this._setProperty("frameCount",this.frameCount+1),this.redraw(),this._updatePAccelerations(),this._updatePMouseCoords(),this._updatePTouchCoords(),this._frameRate=1e3/(t-this._lastFrameTime),this._lastFrameTime=t),this._renderer.isP3D&&this._renderer._update(),this._loop&&(this._requestAnimId=window.requestAnimationFrame(this._draw))}.bind(this),this._runFrames=function(){this._updateInterval&&clearInterval(this._updateInterval)}.bind(this),this._setProperty=function(t,e){this[t]=e,this._isGlobal&&(window[t]=e)}.bind(this),this.remove=function(){if(this._curElement){this._loop=!1,this._requestAnimId&&window.cancelAnimationFrame(this._requestAnimId);for(var t in this._events)window.removeEventListener(t,this._events[t]);for(var e=0;e<this._elements.length;e++){var r=this._elements[e];r.elt.parentNode&&r.elt.parentNode.removeChild(r.elt);for(var n in r._events)r.elt.removeEventListener(n,r._events[n])}var o=this;if(this._registeredMethods.remove.forEach(function(t){"undefined"!=typeof t&&t.call(o)}),this._isGlobal){for(var a in i.prototype)try{delete window[a]}catch(s){window[a]=void 0}for(var h in this)if(this.hasOwnProperty(h))try{delete window[h]}catch(s){window[h]=void 0}}}}.bind(this);for(var o in n)i.prototype[o]=n[o];if(t)t(this);else{this._isGlobal=!0;for(var a in i.prototype)if("function"==typeof i.prototype[a]){var s=a.substring(2);this._events.hasOwnProperty(s)||(window[a]=i.prototype[a].bind(this))}else window[a]=i.prototype[a];for(var h in this)this.hasOwnProperty(h)&&(window[h]=this[h])}for(var u in this._events){var c=this["_on"+u];if(c){var l=c.bind(this);window.addEventListener(u,l),this._events[u]=l}}var p=this;window.addEventListener("focus",function(){p._setProperty("focused",!0)}),window.addEventListener("blur",function(){p._setProperty("focused",!1)}),r?this._start():"complete"===document.readyState?this._start():window.addEventListener("load",this._start.bind(this),!1)};i.prototype._preloadMethods={loadJSON:i.prototype,loadImage:i.prototype,loadStrings:i.prototype,loadXML:i.prototype,loadShape:i.prototype,loadTable:i.prototype,loadFont:i.prototype},i.prototype._registeredMethods={pre:[],post:[],remove:[]},i.prototype._registeredPreloadMethods={},i.prototype.registerPreloadMethod=function(t,e){i.prototype._preloadMethods.hasOwnProperty(t)||(i.prototype._preloadMethods[t]=e)},i.prototype.registerMethod=function(t,e){i.prototype._registeredMethods.hasOwnProperty(t)||(i.prototype._registeredMethods[t]=[]),i.prototype._registeredMethods[t].push(e)},e.exports=i},{"./constants":47,"./shim":57}],49:[function(t,e,r){"use strict";var n=t("./core");t("./error_helpers");var i=20,o=20;n.prototype.bezier=function(t,e,r,n,i,o,a,s){return this._validateParameters("bezier",arguments,["Number","Number","Number","Number","Number","Number","Number","Number"]),this._renderer._doStroke?(this._renderer.bezier(t,e,r,n,i,o,a,s),this):this},n.prototype.bezierDetail=function(t){return i=t,this},n.prototype.bezierPoint=function(t,e,r,n,i){var o=1-i;return Math.pow(o,3)*t+3*Math.pow(o,2)*i*e+3*o*Math.pow(i,2)*r+Math.pow(i,3)*n},n.prototype.bezierTangent=function(t,e,r,n,i){var o=1-i;return 3*n*Math.pow(i,2)-3*r*Math.pow(i,2)+6*r*o*i-6*e*o*i+3*e*Math.pow(o,2)-3*t*Math.pow(o,2)},n.prototype.curve=function(t,e,r,n,i,o,a,s){return this._validateParameters("curve",arguments,["Number","Number","Number","Number","Number","Number","Number","Number"]),this._renderer._doStroke?(this._renderer.curve(t,e,r,n,i,o,a,s),this):void 0},n.prototype.curveDetail=function(t){return o=t,this},n.prototype.curveTightness=function(t){this._renderer._curveTightness=t},n.prototype.curvePoint=function(t,e,r,n,i){var o=i*i*i,a=i*i,s=-.5*o+a-.5*i,h=1.5*o-2.5*a+1,u=-1.5*o+2*a+.5*i,c=.5*o-.5*a;return t*s+e*h+r*u+n*c},n.prototype.curveTangent=function(t,e,r,n,i){var o=i*i,a=-3*o/2+2*i-.5,s=9*o/2-5*i,h=-9*o/2+4*i+.5,u=3*o/2-i;return t*a+e*s+r*h+n*u},e.exports=n},{"./core":48,"./error_helpers":51}],50:[function(t,e,r){"use strict";function n(t){var e=document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled;if(!e)throw new Error("Fullscreen not enabled in this browser.");t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}function i(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}var o=t("./core"),a=t("./constants"),s=[a.ARROW,a.CROSS,a.HAND,a.MOVE,a.TEXT,a.WAIT];o.prototype._frameRate=0,o.prototype._lastFrameTime=window.performance.now(),o.prototype._targetFrameRate=60,window.console&&console.log?o.prototype.print=function(t){try{var e=JSON.parse(JSON.stringify(t));console.log(e)}catch(r){console.log(t)}}:o.prototype.print=function(){},o.prototype.println=o.prototype.print,o.prototype.frameCount=0,o.prototype.focused=document.hasFocus(),o.prototype.cursor=function(t,e,r){var n="auto",i=this._curElement.elt;if(s.indexOf(t)>-1)n=t;else if("string"==typeof t){var o="";e&&r&&"number"==typeof e&&"number"==typeof r&&(o=e+" "+r),n="http://"!==t.substring(0,6)?"url("+t+") "+o+", auto":/\.(cur|jpg|jpeg|gif|png|CUR|JPG|JPEG|GIF|PNG)$/.test(t)?"url("+t+") "+o+", auto":t}i.style.cursor=n},o.prototype.frameRate=function(t){return"undefined"==typeof t?this._frameRate:(this._setProperty("_targetFrameRate",t),this._runFrames(),this)},o.prototype.getFrameRate=function(){return this.frameRate()},o.prototype.setFrameRate=function(t){return this.frameRate(t)},o.prototype.noCursor=function(){this._curElement.elt.style.cursor="none"},o.prototype.displayWidth=screen.width,o.prototype.displayHeight=screen.height,o.prototype.windowWidth=window.innerWidth,o.prototype.windowHeight=window.innerHeight,o.prototype._onresize=function(t){this._setProperty("windowWidth",window.innerWidth),this._setProperty("windowHeight",window.innerHeight);var e,r=this._isGlobal?window:this;"function"==typeof r.windowResized&&(e=r.windowResized(t),void 0===e||e||t.preventDefault())},o.prototype.width=0,o.prototype.height=0,o.prototype.fullScreen=function(t){return"undefined"==typeof t?document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement:void(t?n(document.documentElement):i())},o.prototype.devicePixelScaling=function(t){t?"number"==typeof t?this.pixelDensity=t:this.pixelDensity=window.devicePixelRatio||1:this.pixelDensity=1,this.resizeCanvas(this.width,this.height,!0)},o.prototype.getURL=function(){return location.href},o.prototype.getURLPath=function(){return location.pathname.split("/").filter(function(t){return""!==t})},o.prototype.getURLParams=function(){for(var t,e=/[?&]([^&=]+)(?:[&=])([^&=]+)/gim,r={};null!=(t=e.exec(location.search));)t.index===e.lastIndex&&e.lastIndex++,r[t[1]]=t[2];return r},e.exports=o},{"./constants":47,"./core":48}],51:[function(t,e,r){"use strict";function n(t,e,r){if(t.match(/^p5\./)){var n=t.split(".");return r instanceof a[n[1]]}return"Boolean"===t||t.toLowerCase()===e||m.indexOf(t)>-1&&d(r)}function i(t,e,r){s&&(o(),s=!1),"undefined"===p(r)?r="#B40033":"number"===p(r)&&(r=x[r])}function o(){var t="transparent",e="#ED225D",r="#ED225D",n="white";console.log("%c    _ \n /\\| |/\\ \n \\ ` ' /  \n / , . \\  \n \\/|_|\\/ \n\n%c> p5.js says: Welcome! This is your friendly debugger. To turn me off switch to using p5.min.js.","background-color:"+t+";color:"+e+";","background-color:"+r+";color:"+n+";")}for(var a=t("./core"),s=!1,h={},u=h.toString,c=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],l=0;l<c.length;l++)h["[object "+c[l]+"]"]=c[l].toLowerCase();var p=function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?h[u.call(t)]||"object":typeof t},f=Array.isArray||function(t){return"array"===p(t)},d=function(t){return!f(t)&&t-parseFloat(t)+1>=0},m=["Number","Integer","Number/Constant"],g=0,y=1,v=2,_=3,x=["#2D7BB6","#EE9900","#4DB200","#C83C00"];a.prototype._validateParameters=function(t,e,r){f(r[0])||(r=[r]);for(var o,a=Math.abs(e.length-r[0].length),s=0,h=1,u=r.length;u>h;h++){var c=Math.abs(e.length-r[h].length);a>=c&&(s=h,a=c)}var l="X";a>0&&(o="You wrote "+t+"(",e.length>0&&(o+=l+Array(e.length).join(","+l)),o+="). "+t+" was expecting "+r[s].length+" parameters. Try "+t+"(",r[s].length>0&&(o+=l+Array(r[s].length).join(","+l)),o+=").",r.length>1&&(o+=" "+t+" takes different numbers of parameters depending on what you want to do. Click this link to learn more: "),i(o,t,g));for(var d=0;d<r.length;d++)for(var m=0;m<r[d].length&&m<e.length;m++){var _=r[d][m],x=p(e[m]);"undefined"===x||null===x?i("It looks like "+t+" received an empty variable in spot #"+(m+1)+". If not intentional, this is often a problem with scope: [link to scope].",t,y):"*"===_||n(_,x,e[m])||(o=t+" was expecting a "+_.toLowerCase()+" for parameter #"+(m+1)+", received ",o+="string"===x?'"'+e[m]+'"':e[m],o+=" instead.",r.length>1&&(o+=" "+t+" takes different numbers of parameters depending on what you want to do. Click this link to learn more:"),i(o,t,v))}},a.prototype._validateParameters=function(){return!0};var b={0:{fileType:"image",method:"loadImage",message:" hosting the image online,"},1:{fileType:"XML file",method:"loadXML"},2:{fileType:"table file",method:"loadTable"},3:{fileType:"text file",method:"loadStrings"}};a._friendlyFileLoadError=function(t,e){var r=b[t],n="It looks like there was a problem loading your "+r.fileType+". Try checking if the file path%c ["+e+"] %cis correct,"+(r.message||"")+" or running a local server.";i(n,r.method,_)},e.exports=a},{"./core":48}],52:[function(t,e,r){function n(t,e,r){var n=e.bind(r);r.elt.addEventListener(t,n,!1),r._events[t]=n}var i=t("./core");i.Element=function(t,e){this.elt=t,this._pInst=e,this._events={},this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight},i.Element.prototype.parent=function(t){return"string"==typeof t?t=document.getElementById(t):t instanceof i.Element&&(t=t.elt),t.appendChild(this.elt),this},i.Element.prototype.id=function(t){return this.elt.id=t,this},i.Element.prototype["class"]=function(t){return this.elt.className+=" "+t,this},i.Element.prototype.mousePressed=function(t){return n("mousedown",t,this),n("touchstart",t,this),this},i.Element.prototype.mouseWheel=function(t){return n("mousewheel",t,this),this},i.Element.prototype.mouseReleased=function(t){return n("mouseup",t,this),n("touchend",t,this),this},i.Element.prototype.mouseClicked=function(t){return n("click",t,this),this},i.Element.prototype.mouseMoved=function(t){return n("mousemove",t,this),n("touchmove",t,this),this},i.Element.prototype.mouseOver=function(t){return n("mouseover",t,this),this},i.Element.prototype.changed=function(t){return n("change",t,this),this},i.Element.prototype.mouseOut=function(t){return n("mouseout",t,this),this},i.Element.prototype.touchStarted=function(t){return n("touchstart",t,this),n("mousedown",t,this),this},i.Element.prototype.touchMoved=function(t){return n("touchmove",t,this),n("mousemove",t,this),this},i.Element.prototype.touchEnded=function(t){return n("touchend",t,this),n("mouseup",t,this),this},i.Element.prototype.dragOver=function(t){return n("dragover",t,this),this},i.Element.prototype.dragLeave=function(t){return n("dragleave",t,this),this},i.Element.prototype.drop=function(t,e){function r(e){var r=new i.File(e);return function(e){r.data=e.target.result,t(r)}}return window.File&&window.FileReader&&window.FileList&&window.Blob?(n("dragover",function(t){t.stopPropagation(),t.preventDefault()},this),n("dragleave",function(t){t.stopPropagation(),t.preventDefault()},this),arguments.length>1&&n("drop",e,this),n("drop",function(t){t.stopPropagation(),t.preventDefault();for(var e=t.dataTransfer.files,n=0;n<e.length;n++){var i=e[n],o=new FileReader;o.onload=r(i),i.type.indexOf("text")>-1?o.readAsText(i):o.readAsDataURL(i)}},this)):console.log("The File APIs are not fully supported in this browser."),this},i.Element.prototype._setProperty=function(t,e){this[t]=e},e.exports=i.Element},{"./core":48}],53:[function(t,e,r){var n=t("./core"),i=t("./constants");n.Graphics=function(t,e,r,o){var a=r||i.P2D,s=document.createElement("canvas"),h=this._userNode||document.body;h.appendChild(s),n.Element.call(this,s,o,!1),this._styles=[],this.width=t,this.height=e,this.pixelDensity=o.pixelDensity,a===i.WEBGL?this._renderer=new n.Renderer3D(s,o,!1):this._renderer=new n.Renderer2D(s,o,!1),this._renderer.resize(t,e),this._renderer._applyDefaults(),o._elements.push(this);for(var u in n.prototype)this[u]||("function"==typeof n.prototype[u]?this[u]=n.prototype[u].bind(this):this[u]=n.prototype[u]);return this},n.Graphics.prototype=Object.create(n.Element.prototype),e.exports=n.Graphics},{"./constants":47,"./core":48}],54:[function(t,e,r){function n(t){var e=0,r=0;if(t.offsetParent){do e+=t.offsetLeft,r+=t.offsetTop;while(t=t.offsetParent)}else e+=t.offsetLeft,r+=t.offsetTop;return[e,r]}var i=t("./core"),o=t("../core/constants");i.Renderer=function(t,e,r){i.Element.call(this,t,e),this.canvas=t,this._pInst=e,r?(this._isMainCanvas=!0,this._pInst._setProperty("_curElement",this),this._pInst._setProperty("canvas",this.canvas),this._pInst._setProperty("width",this.width),this._pInst._setProperty("height",this.height)):(this.canvas.style.display="none",this._styles=[]),this._textSize=12,this._textLeading=15,this._textFont="sans-serif",this._textStyle=o.NORMAL,this._textAscent=null,this._textDescent=null,this._rectMode=o.CORNER,this._ellipseMode=o.CENTER,this._curveTightness=0,this._imageMode=o.CORNER,this._tint=null,this._doStroke=!0,this._doFill=!0,this._strokeSet=!1,this._fillSet=!1,this._colorMode=o.RGB,this._colorMaxes={rgb:[255,255,255,255],hsb:[360,100,100,1],hsl:[360,100,100,1]}},i.Renderer.prototype=Object.create(i.Element.prototype),i.Renderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.elt.width=t*this._pInst.pixelDensity,this.elt.height=e*this._pInst.pixelDensity,this.elt.style.width=t+"px",this.elt.style.height=e+"px",this._isMainCanvas&&(this._pInst._setProperty("width",this.width),this._pInst._setProperty("height",this.height))},i.Renderer.prototype.textLeading=function(t){return arguments.length&&arguments[0]?(this._setProperty("_textLeading",t),this):this._textLeading},i.Renderer.prototype.textSize=function(t){return arguments.length&&arguments[0]?(this._setProperty("_textSize",t),this._setProperty("_textLeading",t*o._DEFAULT_LEADMULT),this._applyTextProperties()):this._textSize},i.Renderer.prototype.textStyle=function(t){return arguments.length&&arguments[0]?((t===o.NORMAL||t===o.ITALIC||t===o.BOLD)&&this._setProperty("_textStyle",t),this._applyTextProperties()):this._textStyle},i.Renderer.prototype.textAscent=function(){return null===this._textAscent&&this._updateTextMetrics(),this._textAscent},i.Renderer.prototype.textDescent=function(){return null===this._textDescent&&this._updateTextMetrics(),this._textDescent},i.Renderer.prototype._isOpenType=function(t){return t=t||this._textFont,"object"==typeof t&&t.font&&t.font.supported},i.Renderer.prototype._updateTextMetrics=function(){if(this._isOpenType())return this._setProperty("_textAscent",this._textFont._textAscent()),this._setProperty("_textDescent",this._textFont._textDescent()),this;var t=document.createElement("span");t.style.fontFamily=this._textFont,t.style.fontSize=this._textSize+"px",t.innerHTML="ABCjgq|";var e=document.createElement("div");e.style.display="inline-block",e.style.width="1px",e.style.height="0px";var r=document.createElement("div");r.appendChild(t),r.appendChild(e),r.style.height="0px",r.style.overflow="hidden",document.body.appendChild(r),e.style.verticalAlign="baseline";var i=n(e),o=n(t),a=i[1]-o[1];e.style.verticalAlign="bottom",i=n(e),o=n(t);var s=i[1]-o[1],h=s-a;return document.body.removeChild(r),this._setProperty("_textAscent",a),this._setProperty("_textDescent",h),this},e.exports=i.Renderer},{"../core/constants":47,"./core":48}],55:[function(t,e,r){var n=t("./core"),i=t("./canvas"),o=t("./constants"),a=t("../image/filters");t("./p5.Renderer");var s="rgba(0,0,0,0)";n.Renderer2D=function(t,e,r){return n.Renderer.call(this,t,e,r),this.drawingContext=this.canvas.getContext("2d"),this._pInst._setProperty("drawingContext",this.drawingContext),this},n.Renderer2D.prototype=Object.create(n.Renderer.prototype),n.Renderer2D.prototype._applyDefaults=function(){this.drawingContext.fillStyle=o._DEFAULT_FILL,this.drawingContext.strokeStyle=o._DEFAULT_STROKE,this.drawingContext.lineCap=o.ROUND,this.drawingContext.font="normal 12px sans-serif"},n.Renderer2D.prototype.resize=function(t,e){n.Renderer.prototype.resize.call(this,t,e),this.drawingContext.scale(this._pInst.pixelDensity,this._pInst.pixelDensity)},n.Renderer2D.prototype.background=function(){if(this.drawingContext.save(),this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pInst.pixelDensity,this._pInst.pixelDensity),arguments[0]instanceof n.Image)this._pInst.image(arguments[0],0,0,this.width,this.height);else{var t=this.drawingContext.fillStyle,e=this._pInst.color.apply(this._pInst,arguments),r=e.toString();this.drawingContext.fillStyle=r,this.drawingContext.fillRect(0,0,this.width,this.height),this.drawingContext.fillStyle=t}this.drawingContext.restore()},n.Renderer2D.prototype.clear=function(){this.drawingContext.clearRect(0,0,this.width,this.height)},n.Renderer2D.prototype.fill=function(){var t=this.drawingContext,e=this._pInst.color.apply(this._pInst,arguments);t.fillStyle=e.toString()},n.Renderer2D.prototype.stroke=function(){var t=this.drawingContext,e=this._pInst.color.apply(this._pInst,arguments);t.strokeStyle=e.toString()},n.Renderer2D.prototype.image=function(t,e,r,n,i){var o=t.canvas||t.elt;try{this._tint&&t.canvas?this.drawingContext.drawImage(this._getTintedImageCanvas(t),e,r,n,i):this.drawingContext.drawImage(o,e,r,n,i)}catch(a){if("NS_ERROR_NOT_AVAILABLE"!==a.name)throw a}},n.Renderer2D.prototype._getTintedImageCanvas=function(t){if(!t.canvas)return t;var e=a._toPixels(t.canvas),r=document.createElement("canvas");r.width=t.canvas.width,r.height=t.canvas.height;for(var n=r.getContext("2d"),i=n.createImageData(t.canvas.width,t.canvas.height),o=i.data,s=0;s<e.length;s+=4){var h=e[s],u=e[s+1],c=e[s+2],l=e[s+3];o[s]=h*this._tint[0]/255,o[s+1]=u*this._tint[1]/255,o[s+2]=c*this._tint[2]/255,o[s+3]=l*this._tint[3]/255}return n.putImageData(i,0,0),r},n.Renderer2D.prototype.blendMode=function(t){this.drawingContext.globalCompositeOperation=t},n.Renderer2D.prototype.blend=function(){var t=this.drawingContext.globalCompositeOperation,e=arguments[arguments.length-1],r=Array.prototype.slice.call(arguments,0,arguments.length-1);this.drawingContext.globalCompositeOperation=e,this._pInst.copy.apply(this._pInst,r),this.drawingContext.globalCompositeOperation=t},n.Renderer2D.prototype.copy=function(){var t,e,r,i,o,a,s,h,u;if(9===arguments.length)t=arguments[0],e=arguments[1],r=arguments[2],i=arguments[3],o=arguments[4],a=arguments[5],s=arguments[6],h=arguments[7],u=arguments[8];else{if(8!==arguments.length)throw new Error("Signature not supported");t=this._pInst,e=arguments[0],r=arguments[1],i=arguments[2],o=arguments[3],a=arguments[4],s=arguments[5],h=arguments[6],u=arguments[7]}n.Renderer2D._copyHelper(t,e,r,i,o,a,s,h,u)},n.Renderer2D._copyHelper=function(t,e,r,n,i,o,a,s,h){var u=t.canvas.width/t.width;this.drawingContext.drawImage(t.canvas,u*e,u*r,u*n,u*i,o,a,s,h)},n.Renderer2D.prototype.get=function(t,e,r,i){if(void 0===t&&void 0===e&&void 0===r&&void 0===i?(t=0,e=0,r=this.width,i=this.height):void 0===r&&void 0===i&&(r=1,i=1),t>this.width||e>this.height||0>t||0>e)return[0,0,0,255];var o=this._pInst||this,a=o.pixelDensity||o._pInst.pixelDensity;if(this.loadPixels.call(o),1===r&&1===i)return[o.pixels[4*a*(e*this.width+t)],o.pixels[a*(4*(e*this.width+t)+1)],o.pixels[a*(4*(e*this.width+t)+2)],o.pixels[a*(4*(e*this.width+t)+3)]];var s=t*a,h=e*a,u=Math.min(r,o.width),c=Math.min(i,o.height),l=u*a,p=c*a,f=new n.Image(u,c);return f.canvas.getContext("2d").drawImage(o.canvas,s,h,l,p,0,0,u,c),f},n.Renderer2D.prototype.loadPixels=function(){var t=this.pixelDensity||this._pInst.pixelDensity,e=this.width*t,r=this.height*t,n=this.drawingContext.getImageData(0,0,e,r);this._pInst?(this._pInst._setProperty("imageData",n),this._pInst._setProperty("pixels",n.data)):(this._setProperty("imageData",n),this._setProperty("pixels",n.data))},n.Renderer2D.prototype.set=function(t,e,r){if(r instanceof n.Image)this.drawingContext.save(),this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pInst.pixelDensity,this._pInst.pixelDensity),this.drawingContext.drawImage(r.canvas,t,e),this.loadPixels.call(this._pInst),this.drawingContext.restore();else{var i=this._pInst||this,o=0,a=0,s=0,h=0,u=4*(e*i.pixelDensity*this.width*i.pixelDensity+t*i.pixelDensity);if(i.imageData||i.loadPixels.call(i),"number"==typeof r)u<i.pixels.length&&(o=r,a=r,s=r,h=255);else if(r instanceof Array){if(r.length<4)throw new Error("pixel array must be of the form [R, G, B, A]");u<i.pixels.length&&(o=r[0],a=r[1],s=r[2],h=r[3])}else r instanceof n.Color&&u<i.pixels.length&&(o=r.rgba[0],a=r.rgba[1],s=r.rgba[2],h=r.rgba[3]);for(var c=0;c<i.pixelDensity;c++)for(var l=0;l<i.pixelDensity;l++)u=4*((e*i.pixelDensity+l)*this.width*i.pixelDensity+(t*i.pixelDensity+c)),i.pixels[u]=o,i.pixels[u+1]=a,i.pixels[u+2]=s,i.pixels[u+3]=h}},n.Renderer2D.prototype.updatePixels=function(t,e,r,n){var i=this.pixelDensity||this._pInst.pixelDensity;void 0===t&&void 0===e&&void 0===r&&void 0===n&&(t=0,e=0,r=this.width,n=this.height),r*=i,n*=i,this._pInst?this.drawingContext.putImageData(this._pInst.imageData,t,e,0,0,r,n):this.drawingContext.putImageData(this.imageData,t,e,0,0,r,n)},n.Renderer2D.prototype._acuteArcToBezier=function(t,e){var r=e/2,n=Math.cos(r),i=Math.sin(r),o=1/Math.tan(r),a=t+r,s=Math.cos(a),h=Math.sin(a),u=(4-n)/3,c=i+(n-u)*o;return{ax:Math.cos(t),ay:Math.sin(t),bx:u*s+c*h,by:u*h-c*s,cx:u*s-c*h,cy:u*h+c*s,dx:Math.cos(t+e),dy:Math.sin(t+e)}},n.Renderer2D.prototype.arc=function(t,e,r,n,a,s,h){for(var u=this.drawingContext,c=i.arcModeAdjust(t,e,r,n,this._ellipseMode),l=c.w/2,p=c.h/2,f=1e-5,d=0,m=[];s-a>f;)d=Math.min(s-a,o.HALF_PI),m.push(this._acuteArcToBezier(a,d)),a+=d;return this._doFill&&(u.beginPath(),m.forEach(function(t,e){0===e&&u.moveTo(c.x+t.ax*l,c.y+t.ay*p),u.bezierCurveTo(c.x+t.bx*l,c.y+t.by*p,c.x+t.cx*l,c.y+t.cy*p,c.x+t.dx*l,c.y+t.dy*p)}),(h===o.PIE||null==h)&&u.lineTo(c.x,c.y),u.closePath(),u.fill()),this._doStroke&&(u.beginPath(),m.forEach(function(t,e){0===e&&u.moveTo(c.x+t.ax*l,c.y+t.ay*p),u.bezierCurveTo(c.x+t.bx*l,c.y+t.by*p,c.x+t.cx*l,c.y+t.cy*p,c.x+t.dx*l,c.y+t.dy*p)}),h===o.PIE?(u.lineTo(c.x,c.y),u.closePath()):h===o.CHORD&&u.closePath(),u.stroke()),this},n.Renderer2D.prototype.ellipse=function(t,e,r,n){var o=this.drawingContext,a=this._doFill,h=this._doStroke;if(a&&!h){if(o.fillStyle===s)return this}else if(!a&&h&&o.strokeStyle===s)return this;var u=i.modeAdjust(t,e,r,n,this._ellipseMode),c=.5522847498,l=u.w/2*c,p=u.h/2*c,f=u.x+u.w,d=u.y+u.h,m=u.x+u.w/2,g=u.y+u.h/2;o.beginPath(),o.moveTo(u.x,g),o.bezierCurveTo(u.x,g-p,m-l,u.y,m,u.y),o.bezierCurveTo(m+l,u.y,f,g-p,f,g),o.bezierCurveTo(f,g+p,m+l,d,m,d),o.bezierCurveTo(m-l,d,u.x,g+p,u.x,g),o.closePath(),a&&o.fill(),h&&o.stroke()},n.Renderer2D.prototype.line=function(t,e,r,n){var i=this.drawingContext;return this._doStroke?i.strokeStyle===s?this:(i.lineWidth%2===1&&i.translate(.5,.5),i.beginPath(),i.moveTo(t,e),i.lineTo(r,n),i.stroke(),i.lineWidth%2===1&&i.translate(-.5,-.5),this):this},n.Renderer2D.prototype.point=function(t,e){var r=this.drawingContext,n=r.strokeStyle,i=r.fillStyle;return this._doStroke?r.strokeStyle===s?this:(t=Math.round(t),e=Math.round(e),r.fillStyle=n,r.lineWidth>1?(r.beginPath(),r.arc(t,e,r.lineWidth/2,0,o.TWO_PI,!1),r.fill()):r.fillRect(t,e,1,1),void(r.fillStyle=i)):this},n.Renderer2D.prototype.quad=function(t,e,r,n,i,o,a,h){var u=this.drawingContext,c=this._doFill,l=this._doStroke;if(c&&!l){if(u.fillStyle===s)return this}else if(!c&&l&&u.strokeStyle===s)return this;return u.beginPath(),u.moveTo(t,e),u.lineTo(r,n),u.lineTo(i,o),u.lineTo(a,h),u.closePath(),c&&u.fill(),l&&u.stroke(),this},n.Renderer2D.prototype.rect=function(t,e,r,n,o,a,h,u){var c=this.drawingContext,l=this._doFill,p=this._doStroke;if(l&&!p){if(c.fillStyle===s)return this}else if(!l&&p&&c.strokeStyle===s)return this;var f=i.modeAdjust(t,e,r,n,this._rectMode);if(this._doStroke&&c.lineWidth%2===1&&c.translate(.5,.5),c.beginPath(),"undefined"==typeof o)c.rect(f.x,f.y,f.w,f.h);else{"undefined"==typeof a&&(a=o),"undefined"==typeof h&&(h=a),"undefined"==typeof u&&(u=h);var d=f.x,m=f.y,g=f.w,y=f.h,v=g/2,_=y/2;2*o>g&&(o=v),2*o>y&&(o=_),2*a>g&&(a=v),2*a>y&&(a=_),2*h>g&&(h=v),2*h>y&&(h=_),2*u>g&&(u=v),2*u>y&&(u=_),c.beginPath(),c.moveTo(d+o,m),c.arcTo(d+g,m,d+g,m+y,a),c.arcTo(d+g,m+y,d,m+y,h),c.arcTo(d,m+y,d,m,u),c.arcTo(d,m,d+g,m,o),c.closePath()}return this._doFill&&c.fill(),this._doStroke&&c.stroke(),this._doStroke&&c.lineWidth%2===1&&c.translate(-.5,-.5),this},n.Renderer2D.prototype.triangle=function(t,e,r,n,i,o){var a=this.drawingContext,h=this._doFill,u=this._doStroke;if(h&&!u){if(a.fillStyle===s)return this}else if(!h&&u&&a.strokeStyle===s)return this;a.beginPath(),a.moveTo(t,e),a.lineTo(r,n),a.lineTo(i,o),a.closePath(),h&&a.fill(),u&&a.stroke()},n.Renderer2D.prototype.endShape=function(t,e,r,n,i,a,s){if(0===e.length)return this;if(!this._doStroke&&!this._doFill)return this;var h,u=t===o.CLOSE;u&&!a&&e.push(e[0]);var c,l,p=e.length;if(!r||s!==o.POLYGON&&null!==s)if(!n||s!==o.POLYGON&&null!==s)if(!i||s!==o.POLYGON&&null!==s)if(s===o.POINTS)for(c=0;p>c;c++)h=e[c],this._doStroke&&this._pInst.stroke(h[6]),this._pInst.point(h[0],h[1]);else if(s===o.LINES)for(c=0;p>c+1;c+=2)h=e[c],this._doStroke&&this._pInst.stroke(e[c+1][6]),this._pInst.line(h[0],h[1],e[c+1][0],e[c+1][1]);else if(s===o.TRIANGLES)for(c=0;p>c+2;c+=3)h=e[c],this.drawingContext.beginPath(),this.drawingContext.moveTo(h[0],h[1]),this.drawingContext.lineTo(e[c+1][0],e[c+1][1]),this.drawingContext.lineTo(e[c+2][0],e[c+2][1]),this.drawingContext.lineTo(h[0],h[1]),this._doFill&&(this._pInst.fill(e[c+2][5]),this.drawingContext.fill()),this._doStroke&&(this._pInst.stroke(e[c+2][6]),this.drawingContext.stroke()),this.drawingContext.closePath();else if(s===o.TRIANGLE_STRIP)for(c=0;p>c+1;c++)h=e[c],this.drawingContext.beginPath(),this.drawingContext.moveTo(e[c+1][0],e[c+1][1]),this.drawingContext.lineTo(h[0],h[1]),this._doStroke&&this._pInst.stroke(e[c+1][6]),this._doFill&&this._pInst.fill(e[c+1][5]),p>c+2&&(this.drawingContext.lineTo(e[c+2][0],e[c+2][1]),this._doStroke&&this._pInst.stroke(e[c+2][6]),this._doFill&&this._pInst.fill(e[c+2][5])),this._doFillStrokeClose();else if(s===o.TRIANGLE_FAN){if(p>2)for(this.drawingContext.beginPath(),this.drawingContext.moveTo(e[0][0],e[0][1]),this.drawingContext.lineTo(e[1][0],e[1][1]),this.drawingContext.lineTo(e[2][0],e[2][1]),this._doFill&&this._pInst.fill(e[2][5]),this._doStroke&&this._pInst.stroke(e[2][6]),this._doFillStrokeClose(),c=3;p>c;c++)h=e[c],this.drawingContext.beginPath(),this.drawingContext.moveTo(e[0][0],e[0][1]),this.drawingContext.lineTo(e[c-1][0],e[c-1][1]),this.drawingContext.lineTo(h[0],h[1]),this._doFill&&this._pInst.fill(h[5]),this._doStroke&&this._pInst.stroke(h[6]),this._doFillStrokeClose()}else if(s===o.QUADS)for(c=0;p>c+3;c+=4){for(h=e[c],this.drawingContext.beginPath(),this.drawingContext.moveTo(h[0],h[1]),l=1;4>l;l++)this.drawingContext.lineTo(e[c+l][0],e[c+l][1]);this.drawingContext.lineTo(h[0],h[1]),this._doFill&&this._pInst.fill(e[c+3][5]),
this._doStroke&&this._pInst.stroke(e[c+3][6]),this._doFillStrokeClose()}else if(s===o.QUAD_STRIP){if(p>3)for(c=0;p>c+1;c+=2)h=e[c],this.drawingContext.beginPath(),p>c+3?(this.drawingContext.moveTo(e[c+2][0],e[c+2][1]),this.drawingContext.lineTo(h[0],h[1]),this.drawingContext.lineTo(e[c+1][0],e[c+1][1]),this.drawingContext.lineTo(e[c+3][0],e[c+3][1]),this._doFill&&this._pInst.fill(e[c+3][5]),this._doStroke&&this._pInst.stroke(e[c+3][6])):(this.drawingContext.moveTo(h[0],h[1]),this.drawingContext.lineTo(e[c+1][0],e[c+1][1])),this._doFillStrokeClose()}else{for(this.drawingContext.beginPath(),this.drawingContext.moveTo(e[0][0],e[0][1]),c=1;p>c;c++)h=e[c],h.isVert&&(h.moveTo?this.drawingContext.moveTo(h[0],h[1]):this.drawingContext.lineTo(h[0],h[1]));this._doFillStrokeClose()}else{for(this.drawingContext.beginPath(),c=0;p>c;c++)e[c].isVert?e[c].moveTo?this.drawingContext.moveTo([0],e[c][1]):this.drawingContext.lineTo(e[c][0],e[c][1]):this.drawingContext.quadraticCurveTo(e[c][0],e[c][1],e[c][2],e[c][3]);this._doFillStrokeClose()}else{for(this.drawingContext.beginPath(),c=0;p>c;c++)e[c].isVert?e[c].moveTo?this.drawingContext.moveTo(e[c][0],e[c][1]):this.drawingContext.lineTo(e[c][0],e[c][1]):this.drawingContext.bezierCurveTo(e[c][0],e[c][1],e[c][2],e[c][3],e[c][4],e[c][5]);this._doFillStrokeClose()}else if(p>3){var f=[],d=1-this._curveTightness;for(this.drawingContext.beginPath(),this.drawingContext.moveTo(e[1][0],e[1][1]),c=1;p>c+2;c++)h=e[c],f[0]=[h[0],h[1]],f[1]=[h[0]+(d*e[c+1][0]-d*e[c-1][0])/6,h[1]+(d*e[c+1][1]-d*e[c-1][1])/6],f[2]=[e[c+1][0]+(d*e[c][0]-d*e[c+2][0])/6,e[c+1][1]+(d*e[c][1]-d*e[c+2][1])/6],f[3]=[e[c+1][0],e[c+1][1]],this.drawingContext.bezierCurveTo(f[1][0],f[1][1],f[2][0],f[2][1],f[3][0],f[3][1]);u&&this.drawingContext.lineTo(e[c+1][0],e[c+1][1]),this._doFillStrokeClose()}return r=!1,n=!1,i=!1,a=!1,u&&e.pop(),this},n.Renderer2D.prototype.noSmooth=function(){return"imageSmoothingEnabled"in this.drawingContext?this.drawingContext.imageSmoothingEnabled=!1:"mozImageSmoothingEnabled"in this.drawingContext?this.drawingContext.mozImageSmoothingEnabled=!1:"webkitImageSmoothingEnabled"in this.drawingContext?this.drawingContext.webkitImageSmoothingEnabled=!1:"msImageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.msImageSmoothingEnabled=!1),this},n.Renderer2D.prototype.smooth=function(){return"imageSmoothingEnabled"in this.drawingContext?this.drawingContext.imageSmoothingEnabled=!0:"mozImageSmoothingEnabled"in this.drawingContext?this.drawingContext.mozImageSmoothingEnabled=!0:"webkitImageSmoothingEnabled"in this.drawingContext?this.drawingContext.webkitImageSmoothingEnabled=!0:"msImageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.msImageSmoothingEnabled=!0),this},n.Renderer2D.prototype.strokeCap=function(t){return(t===o.ROUND||t===o.SQUARE||t===o.PROJECT)&&(this.drawingContext.lineCap=t),this},n.Renderer2D.prototype.strokeJoin=function(t){return(t===o.ROUND||t===o.BEVEL||t===o.MITER)&&(this.drawingContext.lineJoin=t),this},n.Renderer2D.prototype.strokeWeight=function(t){return"undefined"==typeof t||0===t?this.drawingContext.lineWidth=1e-4:this.drawingContext.lineWidth=t,this},n.Renderer2D.prototype._getFill=function(){return this.drawingContext.fillStyle},n.Renderer2D.prototype._getStroke=function(){return this.drawingContext.strokeStyle},n.Renderer2D.prototype.bezier=function(t,e,r,n,i,o,a,s){return this._pInst.beginShape(),this._pInst.vertex(t,e),this._pInst.bezierVertex(r,n,i,o,a,s),this._pInst.endShape(),this},n.Renderer2D.prototype.curve=function(t,e,r,n,i,o,a,s){return this._pInst.beginShape(),this._pInst.curveVertex(t,e),this._pInst.curveVertex(r,n),this._pInst.curveVertex(i,o),this._pInst.curveVertex(a,s),this._pInst.endShape(),this},n.Renderer2D.prototype._doFillStrokeClose=function(){this._doFill&&this.drawingContext.fill(),this._doStroke&&this.drawingContext.stroke(),this.drawingContext.closePath()},n.Renderer2D.prototype.applyMatrix=function(t,e,r,n,i,o){this.drawingContext.transform(t,e,r,n,i,o)},n.Renderer2D.prototype.resetMatrix=function(){return this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pInst.pixelDensity,this._pInst.pixelDensity),this},n.Renderer2D.prototype.rotate=function(t){this.drawingContext.rotate(t)},n.Renderer2D.prototype.scale=function(){var t=1,e=1;return 1===arguments.length?t=e=arguments[0]:(t=arguments[0],e=arguments[1]),this.drawingContext.scale(t,e),this},n.Renderer2D.prototype.shearX=function(t){return this._pInst._angleMode===o.DEGREES&&(t=this._pInst.radians(t)),this.drawingContext.transform(1,0,this._pInst.tan(t),1,0,0),this},n.Renderer2D.prototype.shearY=function(t){return this._pInst._angleMode===o.DEGREES&&(t=this._pInst.radians(t)),this.drawingContext.transform(1,this._pInst.tan(t),0,1,0,0),this},n.Renderer2D.prototype.translate=function(t,e){return this.drawingContext.translate(t,e),this},n.Renderer2D.prototype.text=function(t,e,r,n,i){var a,s,h,u,c,l,p,f,d,m,g=this._pInst;if(this._doFill||this._doStroke){if("string"!=typeof t&&(t=t.toString()),t=t.replace(/(\t)/g,"  "),a=t.split("\n"),"undefined"!=typeof n){for(d=0,h=0;h<a.length;h++)for(c="",f=a[h].split(" "),s=0;s<f.length;s++)l=c+f[s]+" ",p=this.textWidth(l),p>n?(c=f[s]+" ",d+=g.textLeading()):c=l;switch(this._rectMode===o.CENTER&&(e-=n/2,r-=i/2),this.drawingContext.textAlign){case o.CENTER:e+=n/2;break;case o.RIGHT:e+=n}if("undefined"!=typeof i)switch(this.drawingContext.textBaseline){case o.BOTTOM:r+=i-d;break;case o._CTX_MIDDLE:r+=(i-d)/2;break;case o.BASELINE:m=!0,this.drawingContext.textBaseline=o.TOP}for(h=0;h<a.length;h++){for(c="",f=a[h].split(" "),s=0;s<f.length;s++)l=c+f[s]+" ",p=this.textWidth(l),p>n&&c.length>0?(this._renderText(g,c,e,r),c=f[s]+" ",r+=g.textLeading()):c=l;this._renderText(g,c,e,r),r+=g.textLeading()}}else for(u=0;u<a.length;u++)this._renderText(g,a[u],e,r),r+=g.textLeading();return m&&(this.drawingContext.textBaseline=o.BASELINE),g}},n.Renderer2D.prototype._renderText=function(t,e,r,n){return t.push(),this._isOpenType()?this._textFont._renderPath(e,r,n):(this._doStroke&&this._strokeSet&&this.drawingContext.strokeText(e,r,n),this._doFill&&(this.drawingContext.fillStyle=this._fillSet?this.drawingContext.fillStyle:o._DEFAULT_TEXT_FILL,this.drawingContext.fillText(e,r,n))),t.pop(),t},n.Renderer2D.prototype.textWidth=function(t){return this._isOpenType()?this._textFont._textWidth(t):this.drawingContext.measureText(t).width},n.Renderer2D.prototype.textAlign=function(t,e){if(arguments.length)return(t===o.LEFT||t===o.RIGHT||t===o.CENTER)&&(this.drawingContext.textAlign=t),(e===o.TOP||e===o.BOTTOM||e===o.CENTER||e===o.BASELINE)&&(e===o.CENTER?this.drawingContext.textBaseline=o._CTX_MIDDLE:this.drawingContext.textBaseline=e),this._pInst;var r=this.drawingContext.textBaseline;return r===o._CTX_MIDDLE&&(r=o.CENTER),{horizontal:this.drawingContext.textAlign,vertical:r}},n.Renderer2D.prototype._applyTextProperties=function(){var t,e=this._pInst;return this._setProperty("_textAscent",null),this._setProperty("_textDescent",null),t=this._textFont,this._isOpenType()&&(t=this._textFont.font.familyName,this._setProperty("_textStyle",this._textFont.font.styleName)),this.drawingContext.font=this._textStyle+" "+this._textSize+"px "+t,e},n.Renderer2D.prototype.push=function(){this.drawingContext.save()},n.Renderer2D.prototype.pop=function(){this.drawingContext.restore()},e.exports=n.Renderer2D},{"../image/filters":65,"./canvas":46,"./constants":47,"./core":48,"./p5.Renderer":54}],56:[function(t,e,r){var n=t("./core"),i=t("./constants");t("./p5.Graphics"),t("./p5.Renderer2D"),t("../3d/p5.Renderer3D"),n.prototype.createCanvas=function(t,e,r){var o,a,s=r||i.P2D;return arguments[3]&&(o="boolean"==typeof arguments[3]?arguments[3]:!1),s===i.WEBGL?(a=document.getElementById("defaultCanvas"),a&&a.parentNode.removeChild(a),a=document.createElement("canvas"),a.id="defaultCanvas"):o?(a=document.createElement("canvas"),a.id="defaultCanvas"):a=this.canvas,this._setupDone||(a.className+=" p5_hidden",a.style.visibility="hidden"),this._userNode?this._userNode.appendChild(a):document.body.appendChild(a),s===i.WEBGL?(this._setProperty("_renderer",new n.Renderer3D(a,this,!0)),this._isdefaultGraphics=!0):this._isdefaultGraphics||(this._setProperty("_renderer",new n.Renderer2D(a,this,!0)),this._isdefaultGraphics=!0),this._renderer.resize(t,e),this._renderer._applyDefaults(),o&&this._elements.push(this._renderer),this._renderer},n.prototype.resizeCanvas=function(t,e,r){this._renderer&&(this._renderer.resize(t,e),this._renderer._applyDefaults(),r||this.redraw())},n.prototype.noCanvas=function(){this.canvas&&this.canvas.parentNode.removeChild(this.canvas)},n.prototype.createGraphics=function(t,e,r){return new n.Graphics(t,e,r,this)},n.prototype.blendMode=function(t){if(t!==i.BLEND&&t!==i.DARKEST&&t!==i.LIGHTEST&&t!==i.DIFFERENCE&&t!==i.MULTIPLY&&t!==i.EXCLUSION&&t!==i.SCREEN&&t!==i.REPLACE&&t!==i.OVERLAY&&t!==i.HARD_LIGHT&&t!==i.SOFT_LIGHT&&t!==i.DODGE&&t!==i.BURN&&t!==i.ADD&&t!==i.NORMAL)throw new Error("Mode "+t+" not recognized.");this._renderer.blendMode(t)},e.exports=n},{"../3d/p5.Renderer3D":36,"./constants":47,"./core":48,"./p5.Graphics":53,"./p5.Renderer2D":55}],57:[function(t,e,r){window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)}}(),window.performance=window.performance||{},window.performance.now=function(){var t=Date.now();return window.performance.now||window.performance.mozNow||window.performance.msNow||window.performance.oNow||window.performance.webkitNow||function(){return Date.now()-t}}(),function(){"use strict";"undefined"!=typeof Uint8ClampedArray&&(Uint8ClampedArray.prototype.slice=Array.prototype.slice)}()},{}],58:[function(t,e,r){"use strict";var n=t("./core");n.prototype.exit=function(){throw"exit() not implemented, see remove()"},n.prototype.noLoop=function(){this._loop=!1},n.prototype.loop=function(){this._loop=!0,this._draw()},n.prototype.push=function(){this._renderer.push(),this._styles.push({doStroke:this._renderer._doStroke,doFill:this._renderer._doFill,tint:this._renderer._tint,imageMode:this._renderer._imageMode,rectMode:this._renderer._rectMode,ellipseMode:this._renderer._ellipseMode,colorMode:this._renderer._colorMode,textFont:this._renderer._textFont,textLeading:this._renderer._textLeading,textSize:this._renderer._textSize,textStyle:this._renderer._textStyle})},n.prototype.pop=function(){this._renderer.pop();var t=this._styles.pop();this._renderer._doStroke=t.doStroke,this._renderer._doFill=t.doFill,this._renderer._tint=t.tint,this._renderer._imageMode=t.imageMode,this._renderer._rectMode=t.rectMode,this._renderer._ellipseMode=t.ellipseMode,this._renderer._colorMode=t.colorMode,this._renderer._textFont=t.textFont,this._renderer._textLeading=t.textLeading,this._renderer._textSize=t.textSize,this._renderer._textStyle=t.textStyle},n.prototype.pushStyle=function(){throw new Error("pushStyle() not used, see push()")},n.prototype.popStyle=function(){throw new Error("popStyle() not used, see pop()")},n.prototype.redraw=function(){var t=this.setup||window.setup,e=this.draw||window.draw;if("function"==typeof e){this.push(),"undefined"==typeof t&&this.scale(this.pixelDensity,this.pixelDensity);var r=this;this._registeredMethods.pre.forEach(function(t){t.call(r)}),e(),this._registeredMethods.post.forEach(function(t){t.call(r)}),this.pop()}},n.prototype.size=function(){var t="size() is not a valid p5 function, to set the size of the ";throw t+="drawing canvas, please use createCanvas() instead"},e.exports=n},{"./core":48}],59:[function(t,e,r){"use strict";var n=t("./core"),i=t("./constants");n.prototype.applyMatrix=function(t,e,r,n,i,o){return this._renderer.applyMatrix(t,e,r,n,i,o),this},n.prototype.popMatrix=function(){throw new Error("popMatrix() not used, see pop()")},n.prototype.printMatrix=function(){throw new Error("printMatrix() not implemented")},n.prototype.pushMatrix=function(){throw new Error("pushMatrix() not used, see push()")},n.prototype.resetMatrix=function(){return this._renderer.resetMatrix(),this},n.prototype.rotate=function(){var t=arguments[0];return this._angleMode===i.DEGREES&&(t=this.radians(t)),arguments.length>1?this._renderer.rotate(t,arguments[1]):this._renderer.rotate(t),this},n.prototype.rotateX=function(t){if(!this._renderer.isP3D)throw"not yet implemented.";return this._validateParameters("rotateX",arguments,[["Number"]]),this._renderer.rotateX(t),this},n.prototype.rotateY=function(t){if(!this._renderer.isP3D)throw"not yet implemented.";return this._validateParameters("rotateY",arguments,[["Number"]]),this._renderer.rotateY(t),this},n.prototype.rotateZ=function(t){if(!this._renderer.isP3D)throw"not supported in p2d. Please use webgl mode";return this._validateParameters("rotateZ",arguments,[["Number"]]),this._renderer.rotateZ(t),this},n.prototype.scale=function(){return this._renderer.isP3D?(this._validateParameters("scale",arguments,[["Number","Number","Number"]]),this._renderer.scale(arguments[0],arguments[1],arguments[2])):(this._validateParameters("scale",arguments,[["Number","Number"]]),this._renderer.scale.apply(this._renderer,arguments)),this},n.prototype.shearX=function(t){return this._angleMode===i.DEGREES&&(t=this.radians(t)),this._renderer.shearX(t),this},n.prototype.shearY=function(t){return this._angleMode===i.DEGREES&&(t=this.radians(t)),this._renderer.shearY(t),this},n.prototype.translate=function(t,e,r){return this._renderer.isP3D?(this._validateParameters("translate",arguments,[["Number","Number","Number"]]),this._renderer.translate(t,e,r)):(this._validateParameters("translate",arguments,[["Number","Number"]]),this._renderer.translate(t,e)),this},e.exports=n},{"./constants":47,"./core":48}],60:[function(t,e,r){"use strict";var n=t("./core"),i=t("./constants"),o=null,a=[],s=[],h=!1,u=!1,c=!1,l=!1;n.prototype.beginContour=function(){return s=[],l=!0,this},n.prototype.beginShape=function(t){return o=t===i.POINTS||t===i.LINES||t===i.TRIANGLES||t===i.TRIANGLE_FAN||t===i.TRIANGLE_STRIP||t===i.QUADS||t===i.QUAD_STRIP?t:null,this._renderer.isP3D?this._renderer.beginShape(t):(a=[],s=[]),this},n.prototype.bezierVertex=function(t,e,r,n,i,o){if(0===a.length)throw"vertex() must be used once before calling bezierVertex()";h=!0;for(var u=[],c=0;c<arguments.length;c++)u[c]=arguments[c];return u.isVert=!1,l?s.push(u):a.push(u),this},n.prototype.curveVertex=function(t,e){return u=!0,this.vertex(t,e),this},n.prototype.endContour=function(){var t=s[0].slice();t.isVert=s[0].isVert,t.moveTo=!1,s.push(t),a.push(a[0]);for(var e=0;e<s.length;e++)a.push(s[e]);return this},n.prototype.endShape=function(t){if(this._renderer.isP3D)this._renderer.endShape();else{if(0===a.length)return this;if(!this._renderer._doStroke&&!this._renderer._doFill)return this;var e=t===i.CLOSE;e&&!l&&a.push(a[0]),this._renderer.endShape(t,a,u,h,c,l,o),u=!1,h=!1,c=!1,l=!1,e&&a.pop()}return this},n.prototype.quadraticVertex=function(t,e,r,n){if(this._contourInited){var o={};return o.x=t,o.y=e,o.x3=r,o.y3=n,o.type=i.QUADRATIC,this._contourVertices.push(o),this}if(!(a.length>0))throw"vertex() must be used once before calling quadraticVertex()";c=!0;for(var h=[],u=0;u<arguments.length;u++)h[u]=arguments[u];return h.isVert=!1,l?s.push(h):a.push(h),this},n.prototype.vertex=function(t,e,r){if(this._renderer.isP3D)this._validateParameters("vertex",arguments,[["Number","Number","Number"]]),this._renderer.vertex(arguments[0],arguments[1],arguments[2]);else{this._validateParameters("vertex",arguments,[["Number","Number"],["Number","Number","Number"]]);var n=[];n.isVert=!0,n[0]=t,n[1]=e,n[2]=0,n[3]=0,n[4]=0,n[5]=this._renderer._getFill(),n[6]=this._renderer._getStroke(),r&&(n.moveTo=r),l?(0===s.length&&(n.moveTo=!0),s.push(n)):a.push(n)}return this},e.exports=n},{"./constants":47,"./core":48}],61:[function(t,e,r){"use strict";var n=t("../core/core");n.prototype.deviceOrientation=void 0,n.prototype.accelerationX=0,n.prototype.accelerationY=0,n.prototype.accelerationZ=0,n.prototype.pAccelerationX=0,n.prototype.pAccelerationY=0,n.prototype.pAccelerationZ=0,n.prototype._updatePAccelerations=function(){this._setProperty("pAccelerationX",this.accelerationX),this._setProperty("pAccelerationY",this.accelerationY),this._setProperty("pAccelerationZ",this.accelerationZ)};var i=.5,o=30;n.prototype.setMoveThreshold=function(t){"number"==typeof t&&(i=t)},n.prototype.setShakeThreshold=function(t){"number"==typeof t&&(o=t)};var a="",s="";n.prototype._ondeviceorientation=function(t){this._setProperty("accelerationX",t.beta),this._setProperty("accelerationY",t.gamma),this._setProperty("accelerationZ",t.alpha),this._handleMotion()},n.prototype._ondevicemotion=function(t){this._setProperty("accelerationX",2*t.acceleration.x),this._setProperty("accelerationY",2*t.acceleration.y),this._setProperty("accelerationZ",2*t.acceleration.z),this._handleMotion()},n.prototype._onMozOrientation=function(t){this._setProperty("accelerationX",t.x),this._setProperty("accelerationY",t.y),this._setProperty("accelerationZ",t.z),this._handleMotion()},n.prototype._handleMotion=function(){90===window.orientation||-90===window.orientation?this._setProperty("deviceOrientation","landscape"):0===window.orientation?this._setProperty("deviceOrientation","portrait"):void 0===window.orientation&&this._setProperty("deviceOrientation","undefined");var t=this.deviceMoved||window.deviceMoved;"function"==typeof t&&(Math.abs(this.accelerationX-this.pAccelerationX)>i||Math.abs(this.accelerationY-this.pAccelerationY)>i||Math.abs(this.accelerationZ-this.pAccelerationZ)>i)&&t();var e=this.deviceTurned||window.deviceTurned;if("function"==typeof e){var r=0;Math.abs(this.accelerationX)>r&&(r=this.accelerationX,s="x"),Math.abs(this.accelerationY)>r&&(r=this.accelerationY,s="y"),Math.abs(this.accelerationZ)>r&&(s="z"),""!==a&&a!==s&&e(s),a=s}var n=this.deviceShaken||window.deviceShaken;if("function"==typeof n){var h,u;null!==this.pAccelerationX&&(h=Math.abs(this.accelerationX-this.pAccelerationX),u=Math.abs(this.accelerationY-this.pAccelerationY)),h+u>o&&n()}},e.exports=n},{"../core/core":48}],62:[function(t,e,r){"use strict";var n=t("../core/core"),i={};n.prototype.isKeyPressed=!1,n.prototype.keyIsPressed=!1,n.prototype.key="",n.prototype.keyCode=0,n.prototype._onkeydown=function(t){this._setProperty("isKeyPressed",!0),this._setProperty("keyIsPressed",!0),this._setProperty("keyCode",t.which),i[t.which]=!0;var e=String.fromCharCode(t.which);e||(e=t.which),this._setProperty("key",e);var r=this.keyPressed||window.keyPressed;if("function"==typeof r&&!t.charCode){var n=r(t);n===!1&&t.preventDefault()}},n.prototype._onkeyup=function(t){var e=this.keyReleased||window.keyReleased;this._setProperty("isKeyPressed",!1),this._setProperty("keyIsPressed",!1),i[t.which]=!1;var r=String.fromCharCode(t.which);if(r||(r=t.which),this._setProperty("key",r),this._setProperty("keyCode",t.which),"function"==typeof e){var n=e(t);n===!1&&t.preventDefault()}},n.prototype._onkeypress=function(t){this._setProperty("keyCode",t.which),this._setProperty("key",String.fromCharCode(t.which));var e=this.keyTyped||window.keyTyped;if("function"==typeof e){var r=e(t);r===!1&&t.preventDefault()}},n.prototype._onblur=function(t){i={}},n.prototype.keyIsDown=function(t){return i[t]},e.exports=n},{"../core/core":48}],63:[function(t,e,r){"use strict";function n(t,e){var r=t.getBoundingClientRect();return{x:e.clientX-r.left,y:e.clientY-r.top}}var i=t("../core/core"),o=t("../core/constants");i.prototype.mouseX=0,i.prototype.mouseY=0,i.prototype.pmouseX=0,i.prototype.pmouseY=0,i.prototype.winMouseX=0,i.prototype.winMouseY=0,i.prototype.pwinMouseX=0,i.prototype.pwinMouseY=0,i.prototype.mouseButton=0,i.prototype.mouseIsPressed=!1,i.prototype.isMousePressed=!1,i.prototype._updateMouseCoords=function(t){if("touchstart"===t.type||"touchmove"===t.type||"touchend"===t.type)this._setProperty("mouseX",this.touchX),this._setProperty("mouseY",this.touchY);else if(null!==this._curElement){var e=n(this._curElement.elt,t);this._setProperty("mouseX",e.x),this._setProperty("mouseY",e.y)}this._setProperty("winMouseX",t.pageX),this._setProperty("winMouseY",t.pageY)},i.prototype._updatePMouseCoords=function(t){this._setProperty("pmouseX",this.mouseX),this._setProperty("pmouseY",this.mouseY),this._setProperty("pwinMouseX",this.winMouseX),this._setProperty("pwinMouseY",this.winMouseY)},i.prototype._setMouseButton=function(t){1===t.button?this._setProperty("mouseButton",o.CENTER):2===t.button?this._setProperty("mouseButton",o.RIGHT):(this._setProperty("mouseButton",o.LEFT),("touchstart"===t.type||"touchmove"===t.type)&&(this._setProperty("mouseX",this.touchX),this._setProperty("mouseY",this.touchY)))},i.prototype._onmousemove=function(t){var e,r=this._isGlobal?window:this;this._updateMouseCoords(t),this.isMousePressed?"function"==typeof r.mouseDragged?(e=r.mouseDragged(t),e===!1&&t.preventDefault()):"function"==typeof r.touchMoved&&(e=r.touchMoved(t),e===!1&&t.preventDefault(),this._updateTouchCoords(t)):"function"==typeof r.mouseMoved&&(e=r.mouseMoved(t),e===!1&&t.preventDefault())},i.prototype._onmousedown=function(t){var e,r=this._isGlobal?window:this;this._setProperty("isMousePressed",!0),this._setProperty("mouseIsPressed",!0),this._setMouseButton(t),this._updateMouseCoords(t),"function"==typeof r.mousePressed?(e=r.mousePressed(t),e===!1&&t.preventDefault()):"function"==typeof r.touchStarted&&(e=r.touchStarted(t),e===!1&&t.preventDefault(),this._updateTouchCoords(t))},i.prototype._onmouseup=function(t){var e,r=this._isGlobal?window:this;this._setProperty("isMousePressed",!1),this._setProperty("mouseIsPressed",!1),"function"==typeof r.mouseReleased?(e=r.mouseReleased(t),e===!1&&t.preventDefault()):"function"==typeof r.touchEnded&&(e=r.touchEnded(t),e===!1&&t.preventDefault(),this._updateTouchCoords(t))},i.prototype._onclick=function(t){var e=this._isGlobal?window:this;if("function"==typeof e.mouseClicked){var r=e.mouseClicked(t);r===!1&&t.preventDefault()}},i.prototype._onmousewheel=i.prototype._onDOMMouseScroll=function(t){var e=this._isGlobal?window:this;if("function"==typeof e.mouseWheel){t.delta=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));var r=e.mouseWheel(t);r===!1&&t.preventDefault()}},e.exports=i},{"../core/constants":47,"../core/core":48}],64:[function(t,e,r){"use strict";function n(t,e,r){r=r||0;var n=t.getBoundingClientRect(),i=e.touches[r]||e.changedTouches[r];return{x:i.clientX-n.left,y:i.clientY-n.top}}var i=t("../core/core");i.prototype.touchX=0,i.prototype.touchY=0,i.prototype.ptouchX=0,i.prototype.ptouchY=0,i.prototype.touches=[],i.prototype.touchIsDown=!1,i.prototype._updateTouchCoords=function(t){if("mousedown"===t.type||"mousemove"===t.type||"mouseup"===t.type)this._setProperty("touchX",this.mouseX),this._setProperty("touchY",this.mouseY);else{var e=n(this._curElement.elt,t,0);this._setProperty("touchX",e.x),this._setProperty("touchY",e.y);for(var r=[],i=0;i<t.touches.length;i++){var o=n(this._curElement.elt,t,i);r[i]={x:o.x,y:o.y}}this._setProperty("touches",r)}},i.prototype._updatePTouchCoords=function(){this._setProperty("ptouchX",this.touchX),this._setProperty("ptouchY",this.touchY)},i.prototype._ontouchstart=function(t){var e,r=this._isGlobal?window:this;this._updateTouchCoords(t),this._setProperty("touchIsDown",!0),"function"==typeof r.touchStarted?(e=r.touchStarted(t),e===!1&&t.preventDefault()):"function"==typeof r.mousePressed&&(e=r.mousePressed(t),e===!1&&t.preventDefault())},i.prototype._ontouchmove=function(t){var e,r=this._isGlobal?window:this;this._updateTouchCoords(t),"function"==typeof r.touchMoved?(e=r.touchMoved(t),e===!1&&t.preventDefault()):"function"==typeof r.mouseDragged&&(e=r.mouseDragged(t),e===!1&&t.preventDefault(),this._updateMouseCoords(t))},i.prototype._ontouchend=function(t){this._updateTouchCoords(t),0===this.touches.length&&this._setProperty("touchIsDown",!1);var e,r=this._isGlobal?window:this;"function"==typeof r.touchEnded?(e=r.touchEnded(t),e===!1&&t.preventDefault()):"function"==typeof r.mouseReleased&&(e=r.mouseReleased(t),e===!1&&t.preventDefault(),this._updateMouseCoords(t))},e.exports=i},{"../core/core":48}],65:[function(t,e,r){"use strict";function n(t){var e=3.5*t|0;if(e=1>e?1:248>e?e:248,a!==e){a=e,s=1+a<<1,h=new Int32Array(s),u=new Array(s);for(var r=0;s>r;r++)u[r]=new Int32Array(256);for(var n,i,o,c,l=1,p=e-1;e>l;l++){h[e+l]=h[p]=i=p*p,o=u[e+l],c=u[p--];for(var f=0;256>f;f++)o[f]=c[f]=i*f}n=h[e]=e*e,o=u[e];for(var d=0;256>d;d++)o[d]=n*d}}function i(t,e){for(var r=o._toPixels(t),i=t.width,c=t.height,l=i*c,p=new Int32Array(l),f=0;l>f;f++)p[f]=o._getARGB(r,f);var d,m,g,y,v,_,x,b,w,S,M=new Int32Array(l),T=new Int32Array(l),E=new Int32Array(l),C=new Int32Array(l),A=0;n(e);var R,P,L,O;for(P=0;c>P;P++){for(R=0;i>R;R++){if(y=g=m=v=d=0,_=R-a,0>_)S=-_,_=0;else{if(_>=i)break;S=0}for(L=S;s>L&&!(_>=i);L++){var D=p[_+A];O=u[L],v+=O[(-16777216&D)>>>24],m+=O[(16711680&D)>>16],g+=O[(65280&D)>>8],y+=O[255&D],d+=h[L],_++}x=A+R,M[x]=v/d,T[x]=m/d,E[x]=g/d,C[x]=y/d}A+=i}for(A=0,b=-a,w=b*i,P=0;c>P;P++){for(R=0;i>R;R++){if(y=g=m=v=d=0,0>b)S=x=-b,_=R;else{if(b>=c)break;S=0,x=b,_=R+w}for(L=S;s>L&&!(x>=c);L++)O=u[L],v+=O[M[_]],m+=O[T[_]],g+=O[E[_]],y+=O[C[_]],d+=h[L],x++,_+=i;p[R+A]=v/d<<24|m/d<<16|g/d<<8|y/d}A+=i,w+=i,b++}o._setPixels(r,p)}var o={};o._toPixels=function(t){return t instanceof ImageData?t.data:t.getContext("2d").getImageData(0,0,t.width,t.height).data},o._getARGB=function(t,e){var r=4*e;return t[r+3]<<24&4278190080|t[r]<<16&16711680|t[r+1]<<8&65280|255&t[r+2]},o._setPixels=function(t,e){for(var r=0,n=0,i=t.length;i>n;n++)r=4*n,t[r+0]=(16711680&e[n])>>>16,t[r+1]=(65280&e[n])>>>8,t[r+2]=255&e[n],t[r+3]=(4278190080&e[n])>>>24},o._toImageData=function(t){return t instanceof ImageData?t:t.getContext("2d").getImageData(0,0,t.width,t.height)},o._createImageData=function(t,e){return o._tmpCanvas=document.createElement("canvas"),o._tmpCtx=o._tmpCanvas.getContext("2d"),this._tmpCtx.createImageData(t,e)},o.apply=function(t,e,r){var n=t.getContext("2d"),i=n.getImageData(0,0,t.width,t.height),o=e(i,r);o instanceof ImageData?n.putImageData(o,0,0,0,0,t.width,t.height):n.putImageData(i,0,0,0,0,t.width,t.height)},o.threshold=function(t,e){var r=o._toPixels(t);void 0===e&&(e=.5);for(var n=Math.floor(255*e),i=0;i<r.length;i+=4){var a,s=r[i],h=r[i+1],u=r[i+2],c=.2126*s+.7152*h+.0722*u;a=c>=n?255:0,r[i]=r[i+1]=r[i+2]=a}},o.gray=function(t){for(var e=o._toPixels(t),r=0;r<e.length;r+=4){var n=e[r],i=e[r+1],a=e[r+2],s=.2126*n+.7152*i+.0722*a;e[r]=e[r+1]=e[r+2]=s}},o.opaque=function(t){for(var e=o._toPixels(t),r=0;r<e.length;r+=4)e[r+3]=255;return e},o.invert=function(t){for(var e=o._toPixels(t),r=0;r<e.length;r+=4)e[r]=255-e[r],e[r+1]=255-e[r+1],e[r+2]=255-e[r+2]},o.posterize=function(t,e){var r=o._toPixels(t);if(2>e||e>255)throw new Error("Level must be greater than 2 and less than 255 for posterize");for(var n=e-1,i=0;i<r.length;i+=4){var a=r[i],s=r[i+1],h=r[i+2];r[i]=255*(a*e>>8)/n,r[i+1]=255*(s*e>>8)/n,r[i+2]=255*(h*e>>8)/n}},o.dilate=function(t){for(var e,r,n,i,a,s,h,u,c,l,p,f,d,m,g,y,v,_=o._toPixels(t),x=0,b=_.length?_.length/4:0,w=new Int32Array(b);b>x;)for(e=x,r=x+t.width;r>x;)n=i=o._getARGB(_,x),h=x-1,s=x+1,u=x-t.width,c=x+t.width,e>h&&(h=x),s>=r&&(s=x),0>u&&(u=0),c>=b&&(c=x),f=o._getARGB(_,u),p=o._getARGB(_,h),d=o._getARGB(_,c),l=o._getARGB(_,s),a=77*(n>>16&255)+151*(n>>8&255)+28*(255&n),g=77*(p>>16&255)+151*(p>>8&255)+28*(255&p),m=77*(l>>16&255)+151*(l>>8&255)+28*(255&l),y=77*(f>>16&255)+151*(f>>8&255)+28*(255&f),v=77*(d>>16&255)+151*(d>>8&255)+28*(255&d),g>a&&(i=p,a=g),m>a&&(i=l,a=m),y>a&&(i=f,a=y),v>a&&(i=d,a=v),w[x++]=i;o._setPixels(_,w)},o.erode=function(t){for(var e,r,n,i,a,s,h,u,c,l,p,f,d,m,g,y,v,_=o._toPixels(t),x=0,b=_.length?_.length/4:0,w=new Int32Array(b);b>x;)for(e=x,r=x+t.width;r>x;)n=i=o._getARGB(_,x),h=x-1,s=x+1,u=x-t.width,c=x+t.width,e>h&&(h=x),s>=r&&(s=x),0>u&&(u=0),c>=b&&(c=x),f=o._getARGB(_,u),p=o._getARGB(_,h),d=o._getARGB(_,c),l=o._getARGB(_,s),a=77*(n>>16&255)+151*(n>>8&255)+28*(255&n),g=77*(p>>16&255)+151*(p>>8&255)+28*(255&p),m=77*(l>>16&255)+151*(l>>8&255)+28*(255&l),y=77*(f>>16&255)+151*(f>>8&255)+28*(255&f),v=77*(d>>16&255)+151*(d>>8&255)+28*(255&d),a>g&&(i=p,a=g),a>m&&(i=l,a=m),a>y&&(i=f,a=y),a>v&&(i=d,a=v),w[x++]=i;o._setPixels(_,w)};var a,s,h,u;o.blur=function(t,e){i(t,e)},e.exports=o},{}],66:[function(t,e,r){"use strict";var n=t("../core/core"),i=[];n.prototype.createImage=function(t,e){return new n.Image(t,e)},n.prototype.saveCanvas=function(){var t,e,r;if(3===arguments.length?(t=arguments[0],e=arguments[1],r=arguments[2]):2===arguments.length?"object"==typeof arguments[0]?(t=arguments[0],e=arguments[1]):(e=arguments[0],r=arguments[1]):1===arguments.length&&("object"==typeof arguments[0]?t=arguments[0]:e=arguments[0]),t instanceof n.Element&&(t=t.elt),t instanceof HTMLCanvasElement||(t=null),r||(r=n.prototype._checkFileExtension(e,r)[1],""===r&&(r="png")),t||this._curElement&&this._curElement.elt&&(t=this._curElement.elt),n.prototype._isSafari()){var i="Hello, Safari user!\n";i+="Now capturing a screenshot...\n",i+="To save this image,\n",i+="go to File --> Save As.\n",alert(i),window.location.href=t.toDataURL()}else{var o;if("undefined"==typeof r)r="png",o="image/png";else switch(r){case"png":o="image/png";break;case"jpeg":o="image/jpeg";break;case"jpg":o="image/jpeg";break;default:o="image/png"}var a="image/octet-stream",s=t.toDataURL(o);s=s.replace(o,a),n.prototype.downloadFile(s,e,r)}},n.prototype.saveFrames=function(t,e,r,o,a){var s=r||3;s=n.prototype.constrain(s,0,15),s=1e3*s;var h=o||15;h=n.prototype.constrain(h,0,22);var u=0,c=n.prototype._makeFrame,l=this._curElement.elt,p=setInterval(function(){c(t+u,e,l),u++},1e3/h);setTimeout(function(){if(clearInterval(p),a)a(i);else for(var t=0;t<i.length;t++){var e=i[t];n.prototype.downloadFile(e.imageData,e.filename,e.ext)}i=[]},s+.01)},n.prototype._makeFrame=function(t,e,r){var n;n=this?this._curElement.elt:r;var o;if(e)switch(e.toLowerCase()){case"png":o="image/png";break;case"jpeg":o="image/jpeg";break;case"jpg":o="image/jpeg";break;default:o="image/png"}else e="png",o="image/png";var a="image/octet-stream",s=n.toDataURL(o);s=s.replace(o,a);var h={};h.imageData=s,h.filename=t,h.ext=e,i.push(h)},e.exports=n},{"../core/core":48}],67:[function(t,e,r){"use strict";var n=t("../core/core"),i=t("./filters"),o=t("../core/canvas"),a=t("../core/constants");t("../core/error_helpers"),n.prototype.loadImage=function(t,e,r){var i=new Image,o=new n.Image(1,1,this);return i.onload=function(){o.width=o.canvas.width=i.width,o.height=o.canvas.height=i.height,o.drawingContext.drawImage(i,0,0),"function"==typeof e&&e(o)},i.onerror=function(t){n._friendlyFileLoadError(0,i.src),"function"==typeof r&&r(t)},0!==t.indexOf("data:image/")&&(i.crossOrigin="Anonymous"),i.src=t,o},n.prototype.image=function(t,e,r,n,i){e=e||0,r=r||0,n=n||t.width,i=i||t.height;var a=o.modeAdjust(e,r,n,i,this._renderer._imageMode);this._renderer.image(t,a.x,a.y,a.w,a.h)},n.prototype.tint=function(){var t=this.color.apply(this,arguments);this._renderer._tint=t.rgba},n.prototype.noTint=function(){this._renderer._tint=null},n.prototype._getTintedImageCanvas=function(t){if(!t.canvas)return t;var e=i._toPixels(t.canvas),r=document.createElement("canvas");r.width=t.canvas.width,r.height=t.canvas.height;for(var n=r.getContext("2d"),o=n.createImageData(t.canvas.width,t.canvas.height),a=o.data,s=0;s<e.length;s+=4){var h=e[s],u=e[s+1],c=e[s+2],l=e[s+3];a[s]=h*this._renderer._tint[0]/255,a[s+1]=u*this._renderer._tint[1]/255,a[s+2]=c*this._renderer._tint[2]/255,a[s+3]=l*this._renderer._tint[3]/255}return n.putImageData(o,0,0),r},n.prototype.imageMode=function(t){(t===a.CORNER||t===a.CORNERS||t===a.CENTER)&&(this._renderer._imageMode=t)},e.exports=n},{"../core/canvas":46,"../core/constants":47,"../core/core":48,"../core/error_helpers":51,"./filters":65}],68:[function(t,e,r){"use strict";var n=t("../core/core"),i=t("./filters");
n.Image=function(t,e){this.width=t,this.height=e,this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.drawingContext=this.canvas.getContext("2d"),this.pixelDensity=1,this.pixels=[]},n.Image.prototype._setProperty=function(t,e){this[t]=e},n.Image.prototype.loadPixels=function(){n.Renderer2D.prototype.loadPixels.call(this)},n.Image.prototype.updatePixels=function(t,e,r,i){n.Renderer2D.prototype.updatePixels.call(this,t,e,r,i)},n.Image.prototype.get=function(t,e,r,i){return n.Renderer2D.prototype.get.call(this,t,e,r,i)},n.Image.prototype.set=function(t,e,r){n.Renderer2D.prototype.set.call(this,t,e,r)},n.Image.prototype.resize=function(t,e){t=t||this.canvas.width,e=e||this.canvas.height;var r=document.createElement("canvas");r.width=t,r.height=e,r.getContext("2d").drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,r.width,r.height),this.canvas.width=this.width=t,this.canvas.height=this.height=e,this.drawingContext.drawImage(r,0,0,t,e,0,0,t,e),this.pixels.length>0&&this.loadPixels()},n.Image.prototype.copy=function(){n.prototype.copy.apply(this,arguments)},n.Image.prototype.mask=function(t){void 0===t&&(t=this);var e=this.drawingContext.globalCompositeOperation,r=1;t instanceof n.Renderer&&(r=t._pInst.pixelDensity);var i=[t,0,0,r*t.width,r*t.height,0,0,this.width,this.height];this.drawingContext.globalCompositeOperation="destination-in",this.copy.apply(this,i),this.drawingContext.globalCompositeOperation=e},n.Image.prototype.filter=function(t,e){i.apply(this.canvas,i[t.toLowerCase()],e)},n.Image.prototype.blend=function(){n.prototype.blend.apply(this,arguments)},n.Image.prototype.save=function(t,e){var r;if(e)switch(e.toLowerCase()){case"png":r="image/png";break;case"jpeg":r="image/jpeg";break;case"jpg":r="image/jpeg";break;default:r="image/png"}else e="png",r="image/png";var i="image/octet-stream",o=this.canvas.toDataURL(r);o=o.replace(r,i),n.prototype.downloadFile(o,t,e)},e.exports=n.Image},{"../core/core":48,"./filters":65}],69:[function(t,e,r){"use strict";var n=t("../core/core"),i=t("./filters");t("../color/p5.Color"),n.prototype.pixels=[],n.prototype.blend=function(){this._renderer.blend.apply(this._renderer,arguments)},n.prototype.copy=function(){n.Renderer2D._copyHelper.apply(this,arguments)},n.prototype.filter=function(t,e){i.apply(this.canvas,i[t.toLowerCase()],e)},n.prototype.get=function(t,e,r,n){return this._renderer.get(t,e,r,n)},n.prototype.loadPixels=function(){this._renderer.loadPixels()},n.prototype.set=function(t,e,r){this._renderer.set(t,e,r)},n.prototype.updatePixels=function(t,e,r,n){this._renderer.updatePixels(t,e,r,n)},e.exports=n},{"../color/p5.Color":42,"../core/core":48,"./filters":65}],70:[function(t,e,r){"use strict";function n(t,e){var r={};if(e=e||[],"undefined"==typeof e)for(var n=0;n<t.length;n++)e[n.toString()]=n;for(var i=0;i<e.length;i++){var o=e[i],a=t[i];r[o]=a}return r}function i(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function o(t,e){e&&e!==!0&&"true"!==e||(e=""),t||(t="untitled");var r="";return t&&t.indexOf(".")>-1&&(r=t.split(".").pop()),e&&r!==e&&(r=e,t=t+"."+r),[t,r]}function a(t){document.body.removeChild(t.target)}var s=t("../core/core"),h=t("reqwest"),u=t("opentype.js");t("../core/error_helpers"),s.prototype.loadFont=function(t,e,r){var n=new s.Font(this);return u.load(t,function(t,i){if(t){if("undefined"!=typeof r)return r(t);throw t}n.font=i,"undefined"!=typeof e&&e(n)}),n},s.prototype.createInput=function(){throw"not yet implemented"},s.prototype.createReader=function(){throw"not yet implemented"},s.prototype.loadBytes=function(){throw"not yet implemented"},s.prototype.loadJSON=function(){var t=arguments[0],e=arguments[1],r=[],n="json";return"string"==typeof arguments[2]&&("jsonp"===arguments[2]||"json"===arguments[2])&&(n=arguments[2]),h({url:t,type:n,crossOrigin:!0}).then(function(t){for(var n in t)r[n]=t[n];"undefined"!=typeof e&&e(t)}),r},s.prototype.loadStrings=function(t,e){var r=[],n=new XMLHttpRequest;return n.open("GET",t,!0),n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var i=n.responseText.match(/[^\r\n]+/g);for(var o in i)r[o]=i[o];"undefined"!=typeof e&&e(r)}else s._friendlyFileLoadError(3,t)},n.send(null),r},s.prototype.loadTable=function(t){for(var e=null,r=[],i=!1,o=",",a=!1,u=1;u<arguments.length;u++)if("function"==typeof arguments[u])e=arguments[u];else if("string"==typeof arguments[u])if(r.push(arguments[u]),"header"===arguments[u]&&(i=!0),"csv"===arguments[u]){if(a)throw new Error("Cannot set multiple separator types.");o=",",a=!0}else if("tsv"===arguments[u]){if(a)throw new Error("Cannot set multiple separator types.");o="	",a=!0}var c=new s.Table;return h({url:t,crossOrigin:!0,type:"csv"}).then(function(t){t=t.responseText;for(var r,a={},h=0,l=1,p=2,f=4,d='"',m="\r",g="\n",y=[],v=0,_=null,x=function(){a.escaped=!1,_=[],w()},b=function(){a.currentState=f,y.push(_),_=null},w=function(){a.currentState=h,a.token=""},S=function(){_.push(a.token),w()};;){if(r=t[v++],null==r){if(a.escaped)throw new Error("Unclosed quote in file.");if(_){S(),b();break}}if(null===_&&x(),a.currentState===h){if(r===d){a.escaped=!0,a.currentState=l;continue}a.currentState=l}a.currentState===l&&a.escaped?r===d?t[v]===d?(a.token+=d,v++):(a.escaped=!1,a.currentState=p):a.token+=r:r===m?(t[v]===g&&v++,S(),b()):r===g?(S(),b()):r===o?S():a.currentState===l&&(a.token+=r)}if(i)c.columns=y.shift();else for(u=0;u<y.length;u++)c.columns[u]=u.toString();var M;for(u=0;u<y.length&&(u!==y.length-1||1!==y[u].length||"undefined"!==y[u][0]);u++)M=new s.TableRow,M.arr=y[u],M.obj=n(y[u],c.columns),c.addRow(M);null!==e&&e(c)}).fail(function(r,n){s._friendlyFileLoadError(2,t),"undefined"!=typeof e&&e(!1)}),c},s.prototype.loadXML=function(t,e){var r=document.implementation.createDocument(null,null);return h({url:t,type:"xml",crossOrigin:!0,error:function(e){s._friendlyFileLoadError(1,t)}}).then(function(t){var n=t.documentElement;r.appendChild(n),"undefined"!=typeof e&&e(t)}),r},s.prototype.parseXML=function(){throw"not yet implemented"},s.prototype.selectFolder=function(){throw"not yet implemented"},s.prototype.selectInput=function(){throw"not yet implemented"},s.prototype.httpGet=function(){var t=Array.prototype.slice.call(arguments);t.push("GET"),s.prototype.httpDo.apply(this,t)},s.prototype.httpPost=function(){var t=Array.prototype.slice.call(arguments);t.push("POST"),s.prototype.httpDo.apply(this,t)},s.prototype.httpDo=function(){for(var t,e="GET",r=arguments[0],n={},i="",o=1;o<arguments.length;o++){var a=arguments[o];"string"==typeof a?"GET"===a||"POST"===a||"PUT"===a?e=a:i=a:"object"==typeof a?n=a:"function"==typeof a&&(t=a)}""===i&&(i=-1!==r.indexOf("json")?"json":-1!==r.indexOf("xml")?"xml":"text"),h({url:r,method:e,data:n,type:i,crossOrigin:!0,success:function(e){"undefined"!=typeof t&&t("text"===i?e.response:e)}})},window.URL=window.URL||window.webkitURL,s.prototype._pWriters=[],s.prototype.beginRaw=function(){throw"not yet implemented"},s.prototype.beginRecord=function(){throw"not yet implemented"},s.prototype.createOutput=function(){throw"not yet implemented"},s.prototype.createWriter=function(t,e){var r;for(var n in s.prototype._pWriters)if(s.prototype._pWriters[n].name===t)return r=new s.PrintWriter(t+window.millis(),e),s.prototype._pWriters.push(r),r;return r=new s.PrintWriter(t,e),s.prototype._pWriters.push(r),r},s.prototype.endRaw=function(){throw"not yet implemented"},s.prototype.endRecord=function(){throw"not yet implemented"},s.PrintWriter=function(t,e){var r=this;this.name=t,this.content="",this.print=function(t){this.content+=t},this.println=function(t){this.content+=t+"\n"},this.flush=function(){this.content=""},this.close=function(){var n=[];n.push(this.content),s.prototype.writeFile(n,t,e);for(var i in s.prototype._pWriters)s.prototype._pWriters[i].name===this.name&&s.prototype._pWriters.splice(i,1);r.flush(),r={}}},s.prototype.saveBytes=function(){throw"not yet implemented"},s.prototype.save=function(t,e,r){var n=arguments,i=this._curElement.elt;if(0===n.length)return void s.prototype.saveCanvas(i);if(n[0]instanceof s.Renderer||n[0]instanceof s.Graphics)return void s.prototype.saveCanvas(n[0].elt,n[1],n[2]);if(1===n.length&&"string"==typeof n[0])s.prototype.saveCanvas(i,n[0]);else{var a=o(n[1],n[2])[1];switch(a){case"json":return void s.prototype.saveJSON(n[0],n[1],n[2]);case"txt":return void s.prototype.saveStrings(n[0],n[1],n[2]);default:n[0]instanceof Array?s.prototype.saveStrings(n[0],n[1],n[2]):n[0]instanceof s.Table?s.prototype.saveTable(n[0],n[1],n[2],n[3]):n[0]instanceof s.Image?s.prototype.saveCanvas(n[0].canvas,n[1]):n[0]instanceof s.SoundFile&&s.prototype.saveSound(n[0],n[1],n[2],n[3])}}},s.prototype.saveJSON=function(t,e,r){var n;n=r?JSON.stringify(t):JSON.stringify(t,void 0,2),console.log(n),this.saveStrings(n.split("\n"),e,"json")},s.prototype.saveJSONObject=s.prototype.saveJSON,s.prototype.saveJSONArray=s.prototype.saveJSON,s.prototype.saveStream=function(){throw"not yet implemented"},s.prototype.saveStrings=function(t,e,r){var n=r||"txt",i=this.createWriter(e,n);for(var o in t)o<t.length-1?i.println(t[o]):i.print(t[o]);i.close(),i.flush()},s.prototype.saveXML=function(){throw"not yet implemented"},s.prototype.selectOutput=function(){throw"not yet implemented"},s.prototype.saveTable=function(t,e,r){var n=this.createWriter(e,r),o=t.columns,a=",";if("tsv"===r&&(a="	"),"html"!==r){if("0"!==o[0])for(var s=0;s<o.length;s++)s<o.length-1?n.print(o[s]+a):n.println(o[s]);for(var h=0;h<t.rows.length;h++){var u;for(u=0;u<t.rows[h].arr.length;u++)u<t.rows[h].arr.length-1?n.print(t.rows[h].arr[u]+a):h<t.rows.length-1?n.println(t.rows[h].arr[u]):n.print(t.rows[h].arr[u])}}else{n.println("<html>"),n.println("<head>");var c='  <meta http-equiv="content-type" content';if(c+='="text/html;charset=utf-8" />',n.println(c),n.println("</head>"),n.println("<body>"),n.println("  <table>"),"0"!==o[0]){n.println("    <tr>");for(var l=0;l<o.length;l++){var p=i(o[l]);n.println("      <td>"+p),n.println("      </td>")}n.println("    </tr>")}for(var f=0;f<t.rows.length;f++){n.println("    <tr>");for(var d=0;d<t.columns.length;d++){var m=t.rows[f].getString(d),g=i(m);n.println("      <td>"+g),n.println("      </td>")}n.println("    </tr>")}n.println("  </table>"),n.println("</body>"),n.print("</html>")}n.close(),n.flush()},s.prototype.writeFile=function(t,e,r){var n="application/octet-stream";s.prototype._isSafari()&&(n="text/plain");var i=new Blob(t,{type:n}),o=window.URL.createObjectURL(i);s.prototype.downloadFile(o,e,r)},s.prototype.downloadFile=function(t,e,r){var n=o(e,r),i=n[0],h=n[1],u=document.createElement("a");if(u.href=t,u.download=i,u.onclick=a,u.style.display="none",document.body.appendChild(u),s.prototype._isSafari()){var c="Hello, Safari user! To download this file...\n";c+="1. Go to File --> Save As.\n",c+='2. Choose "Page Source" as the Format.\n',c+='3. Name it with this extension: ."'+h+'"',alert(c)}u.click(),t=null},s.prototype._checkFileExtension=o,s.prototype._isSafari=function(){var t=Object.prototype.toString.call(window.HTMLElement);return t.indexOf("Constructor")>0},e.exports=s},{"../core/core":48,"../core/error_helpers":51,"opentype.js":8,reqwest:27}],71:[function(t,e,r){"use strict";var n=t("../core/core");n.Table=function(t){this.columns=[],this.rows=[]},n.Table.prototype.addRow=function(t){var e=t||new n.TableRow;if("undefined"==typeof e.arr||"undefined"==typeof e.obj)throw"invalid TableRow: "+e;return e.table=this,this.rows.push(e),e},n.Table.prototype.removeRow=function(t){this.rows[t].table=null;var e=this.rows.splice(t+1,this.rows.length);this.rows.pop(),this.rows=this.rows.concat(e)},n.Table.prototype.getRow=function(t){return this.rows[t]},n.Table.prototype.getRows=function(){return this.rows},n.Table.prototype.findRow=function(t,e){if("string"==typeof e){for(var r=0;r<this.rows.length;r++)if(this.rows[r].obj[e]===t)return this.rows[r]}else for(var n=0;n<this.rows.length;n++)if(this.rows[n].arr[e]===t)return this.rows[n];return null},n.Table.prototype.findRows=function(t,e){var r=[];if("string"==typeof e)for(var n=0;n<this.rows.length;n++)this.rows[n].obj[e]===t&&r.push(this.rows[n]);else for(var i=0;i<this.rows.length;i++)this.rows[i].arr[e]===t&&r.push(this.rows[i]);return r},n.Table.prototype.matchRow=function(t,e){if("number"==typeof e){for(var r=0;r<this.rows.length;r++)if(this.rows[r].arr[e].match(t))return this.rows[r]}else for(var n=0;n<this.rows.length;n++)if(this.rows[n].obj[e].match(t))return this.rows[n];return null},n.Table.prototype.matchRows=function(t,e){var r=[];if("number"==typeof e)for(var n=0;n<this.rows.length;n++)this.rows[n].arr[e].match(t)&&r.push(this.rows[n]);else for(var i=0;i<this.rows.length;i++)this.rows[i].obj[e].match(t)&&r.push(this.rows[i]);return r},n.Table.prototype.getColumn=function(t){var e=[];if("string"==typeof t)for(var r=0;r<this.rows.length;r++)e.push(this.rows[r].obj[t]);else for(var n=0;n<this.rows.length;n++)e.push(this.rows[n].arr[t]);return e},n.Table.prototype.clearRows=function(){delete this.rows,this.rows=[]},n.Table.prototype.addColumn=function(t){var e=t||null;this.columns.push(e)},n.Table.prototype.getColumnCount=function(){return this.columns.length},n.Table.prototype.getRowCount=function(){return this.rows.length},n.Table.prototype.removeTokens=function(t,e){for(var r=function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},n=[],i=0;i<t.length;i++)n.push(r(t.charAt(i)));var o=new RegExp(n.join("|"),"g");if("undefined"==typeof e)for(var a=0;a<this.columns.length;a++)for(var s=0;s<this.rows.length;s++){var h=this.rows[s].arr[a];h=h.replace(o,""),this.rows[s].arr[a]=h,this.rows[s].obj[this.columns[a]]=h}else if("string"==typeof e)for(var u=0;u<this.rows.length;u++){var c=this.rows[u].obj[e];c=c.replace(o,""),this.rows[u].obj[e]=c;var l=this.columns.indexOf(e);this.rows[u].arr[l]=c}else for(var p=0;p<this.rows.length;p++){var f=this.rows[p].arr[e];f=f.replace(o,""),this.rows[p].arr[e]=f,this.rows[p].obj[this.columns[e]]=f}},n.Table.prototype.trim=function(t){var e=new RegExp(" ","g");if("undefined"==typeof t)for(var r=0;r<this.columns.length;r++)for(var n=0;n<this.rows.length;n++){var i=this.rows[n].arr[r];i=i.replace(e,""),this.rows[n].arr[r]=i,this.rows[n].obj[this.columns[r]]=i}else if("string"==typeof t)for(var o=0;o<this.rows.length;o++){var a=this.rows[o].obj[t];a=a.replace(e,""),this.rows[o].obj[t]=a;var s=this.columns.indexOf(t);this.rows[o].arr[s]=a}else for(var h=0;h<this.rows.length;h++){var u=this.rows[h].arr[t];u=u.replace(e,""),this.rows[h].arr[t]=u,this.rows[h].obj[this.columns[t]]=u}},n.Table.prototype.removeColumn=function(t){var e,r;"string"==typeof t?(e=t,r=this.columns.indexOf(t),console.log("string")):(r=t,e=this.columns[t]);var n=this.columns.splice(r+1,this.columns.length);this.columns.pop(),this.columns=this.columns.concat(n);for(var i=0;i<this.rows.length;i++){var o=this.rows[i].arr,a=o.splice(r+1,o.length);o.pop(),this.rows[i].arr=o.concat(a),delete this.rows[i].obj[e]}},n.Table.prototype.set=function(t,e,r){this.rows[t].set(e,r)},n.Table.prototype.setNum=function(t,e,r){this.rows[t].setNum(e,r)},n.Table.prototype.setString=function(t,e,r){this.rows[t].setString(e,r)},n.Table.prototype.get=function(t,e){return this.rows[t].get(e)},n.Table.prototype.getNum=function(t,e){return this.rows[t].getNum(e)},n.Table.prototype.getString=function(t,e){return this.rows[t].getString(e)},n.Table.prototype.getObject=function(t){for(var e,r,n,i={},o=0;o<this.rows.length;o++)if(e=this.rows[o].obj,"string"==typeof t){if(r=this.columns.indexOf(t),!(r>=0))throw'This table has no column named "'+t+'"';n=e[t],i[n]=e}else i[o]=this.rows[o].obj;return i},n.Table.prototype.getArray=function(){for(var t=[],e=0;e<this.rows.length;e++)t.push(this.rows[e].arr);return t},e.exports=n.Table},{"../core/core":48}],72:[function(t,e,r){"use strict";var n=t("../core/core");n.TableRow=function(t,e){var r=[],n={};t&&(e=e||",",r=t.split(e));for(var i=0;i<r.length;i++){var o=i,a=r[i];n[o]=a}this.arr=r,this.obj=n,this.table=null},n.TableRow.prototype.set=function(t,e){if("string"==typeof t){var r=this.table.columns.indexOf(t);if(!(r>=0))throw'This table has no column named "'+t+'"';this.obj[t]=e,this.arr[r]=e}else{if(!(t<this.table.columns.length))throw"Column #"+t+" is out of the range of this table";this.arr[t]=e;var n=this.table.columns[t];this.obj[n]=e}},n.TableRow.prototype.setNum=function(t,e){var r=parseFloat(e,10);this.set(t,r)},n.TableRow.prototype.setString=function(t,e){var r=e.toString();this.set(t,r)},n.TableRow.prototype.get=function(t){return"string"==typeof t?this.obj[t]:this.arr[t]},n.TableRow.prototype.getNum=function(t){var e;if(e="string"==typeof t?parseFloat(this.obj[t],10):parseFloat(this.arr[t],10),"NaN"===e.toString())throw"Error: "+this.obj[t]+" is NaN (Not a Number)";return e},n.TableRow.prototype.getString=function(t){return"string"==typeof t?this.obj[t].toString():this.arr[t].toString()},e.exports=n.TableRow},{"../core/core":48}],73:[function(t,e,r){"use strict";var n=t("../core/core");n.prototype.abs=Math.abs,n.prototype.ceil=Math.ceil,n.prototype.constrain=function(t,e,r){return Math.max(Math.min(t,r),e)},n.prototype.dist=function(t,e,r,n){return Math.sqrt((r-t)*(r-t)+(n-e)*(n-e))},n.prototype.exp=Math.exp,n.prototype.floor=Math.floor,n.prototype.lerp=function(t,e,r){return r*(e-t)+t},n.prototype.log=Math.log,n.prototype.mag=function(t,e){return Math.sqrt(t*t+e*e)},n.prototype.map=function(t,e,r,n,i){return(t-e)/(r-e)*(i-n)+n},n.prototype.max=function(){return arguments[0]instanceof Array?Math.max.apply(null,arguments[0]):Math.max.apply(null,arguments)},n.prototype.min=function(){return arguments[0]instanceof Array?Math.min.apply(null,arguments[0]):Math.min.apply(null,arguments)},n.prototype.norm=function(t,e,r){return this.map(t,e,r,0,1)},n.prototype.pow=Math.pow,n.prototype.round=Math.round,n.prototype.sq=function(t){return t*t},n.prototype.sqrt=Math.sqrt,e.exports=n},{"../core/core":48}],74:[function(t,e,r){"use strict";var n=t("../core/core");n.prototype.createVector=function(t,e,r){return this instanceof n?new n.Vector(this,arguments):new n.Vector(t,e,r)},e.exports=n},{"../core/core":48}],75:[function(t,e,r){"use strict";var n,i=t("../core/core"),o=4,a=1<<o,s=8,h=1<<s,u=4095,c=4,l=.5,p=function(t){return.5*(1-Math.cos(t*Math.PI))};i.prototype.noise=function(t,e,r){if(e=e||0,r=r||0,null==n){n=new Array(u+1);for(var i=0;u+1>i;i++)n[i]=Math.random()}0>t&&(t=-t),0>e&&(e=-e),0>r&&(r=-r);for(var f,d,m,g,y,v=Math.floor(t),_=Math.floor(e),x=Math.floor(r),b=t-v,w=e-_,S=r-x,M=0,T=.5,E=0;c>E;E++){var C=v+(_<<o)+(x<<s);f=p(b),d=p(w),m=n[C&u],m+=f*(n[C+1&u]-m),g=n[C+a&u],g+=f*(n[C+a+1&u]-g),m+=d*(g-m),C+=h,g=n[C&u],g+=f*(n[C+1&u]-g),y=n[C+a&u],y+=f*(n[C+a+1&u]-y),g+=d*(y-g),m+=p(S)*(g-m),M+=m*T,T*=l,v<<=1,b*=2,_<<=1,w*=2,x<<=1,S*=2,b>=1&&(v++,b--),w>=1&&(_++,w--),S>=1&&(x++,S--)}return M},i.prototype.noiseDetail=function(t,e){t>0&&(c=t),e>0&&(l=e)},i.prototype.noiseSeed=function(t){var e=function(){var t,e,r=4294967296,n=1664525,i=1013904223;return{setSeed:function(n){e=t=(null==n?Math.random()*r:n)>>>0},getSeed:function(){return t},rand:function(){return e=(n*e+i)%r,e/r}}}();e.setSeed(t),n=new Array(u+1);for(var r=0;u+1>r;r++)n[r]=e.rand()},e.exports=i},{"../core/core":48}],76:[function(t,e,r){"use strict";var n=t("../core/core"),i=t("./polargeometry"),o=t("../core/constants");n.Vector=function(){var t,e,r;arguments[0]instanceof n?(this.p5=arguments[0],t=arguments[1][0]||0,e=arguments[1][1]||0,r=arguments[1][2]||0):(t=arguments[0]||0,e=arguments[1]||0,r=arguments[2]||0),this.x=t,this.y=e,this.z=r},n.Vector.prototype.toString=function(){return"p5.Vector Object : ["+this.x+", "+this.y+", "+this.z+"]"},n.Vector.prototype.set=function(t,e,r){return t instanceof n.Vector?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this):t instanceof Array?(this.x=t[0]||0,this.y=t[1]||0,this.z=t[2]||0,this):(this.x=t||0,this.y=e||0,this.z=r||0,this)},n.Vector.prototype.copy=function(){return this.p5?new n.Vector(this.p5,[this.x,this.y,this.z]):new n.Vector(this.x,this.y,this.z)},n.Vector.prototype.add=function(t,e,r){return t instanceof n.Vector?(this.x+=t.x||0,this.y+=t.y||0,this.z+=t.z||0,this):t instanceof Array?(this.x+=t[0]||0,this.y+=t[1]||0,this.z+=t[2]||0,this):(this.x+=t||0,this.y+=e||0,this.z+=r||0,this)},n.Vector.prototype.sub=function(t,e,r){return t instanceof n.Vector?(this.x-=t.x||0,this.y-=t.y||0,this.z-=t.z||0,this):t instanceof Array?(this.x-=t[0]||0,this.y-=t[1]||0,this.z-=t[2]||0,this):(this.x-=t||0,this.y-=e||0,this.z-=r||0,this)},n.Vector.prototype.mult=function(t){return this.x*=t||0,this.y*=t||0,this.z*=t||0,this},n.Vector.prototype.div=function(t){return this.x/=t,this.y/=t,this.z/=t,this},n.Vector.prototype.mag=function(){return Math.sqrt(this.magSq())},n.Vector.prototype.magSq=function(){var t=this.x,e=this.y,r=this.z;return t*t+e*e+r*r},n.Vector.prototype.dot=function(t,e,r){return t instanceof n.Vector?this.dot(t.x,t.y,t.z):this.x*(t||0)+this.y*(e||0)+this.z*(r||0)},n.Vector.prototype.cross=function(t){var e=this.y*t.z-this.z*t.y,r=this.z*t.x-this.x*t.z,i=this.x*t.y-this.y*t.x;return this.p5?new n.Vector(this.p5,[e,r,i]):new n.Vector(e,r,i)},n.Vector.prototype.dist=function(t){var e=t.copy().sub(this);return e.mag()},n.Vector.prototype.normalize=function(){return this.div(this.mag())},n.Vector.prototype.limit=function(t){var e=this.magSq();return e>t*t&&(this.div(Math.sqrt(e)),this.mult(t)),this},n.Vector.prototype.setMag=function(t){return this.normalize().mult(t)},n.Vector.prototype.heading=function(){var t=Math.atan2(this.y,this.x);return this.p5?this.p5._angleMode===o.RADIANS?t:i.radiansToDegrees(t):t},n.Vector.prototype.rotate=function(t){this.p5&&this.p5._angleMode===o.DEGREES&&(t=i.degreesToRadians(t));var e=this.heading()+t,r=this.mag();return this.x=Math.cos(e)*r,this.y=Math.sin(e)*r,this},n.Vector.prototype.lerp=function(t,e,r,i){return t instanceof n.Vector?this.lerp(t.x,t.y,t.z,e):(this.x+=(t-this.x)*i||0,this.y+=(e-this.y)*i||0,this.z+=(r-this.z)*i||0,this)},n.Vector.prototype.array=function(){return[this.x||0,this.y||0,this.z||0]},n.Vector.prototype.equals=function(t,e,r){var i,o,a;return t instanceof n.Vector?(i=t.x||0,o=t.y||0,a=t.z||0):t instanceof Array?(i=t[0]||0,o=t[1]||0,a=t[2]||0):(i=t||0,o=e||0,a=r||0),this.x===i&&this.y===o&&this.z===a},n.Vector.fromAngle=function(t){return this.p5&&this.p5._angleMode===o.DEGREES&&(t=i.degreesToRadians(t)),this.p5?new n.Vector(this.p5,[Math.cos(t),Math.sin(t),0]):new n.Vector(Math.cos(t),Math.sin(t),0)},n.Vector.random2D=function(){var t;return t=this.p5?this.p5._angleMode===o.DEGREES?this.p5.random(360):this.p5.random(o.TWO_PI):Math.random()*Math.PI*2,this.fromAngle(t)},n.Vector.random3D=function(){var t,e;this.p5?(t=this.p5.random(0,o.TWO_PI),e=this.p5.random(-1,1)):(t=Math.random()*Math.PI*2,e=2*Math.random()-1);var r=Math.sqrt(1-e*e)*Math.cos(t),i=Math.sqrt(1-e*e)*Math.sin(t);return this.p5?new n.Vector(this.p5,[r,i,e]):new n.Vector(r,i,e)},n.Vector.add=function(t,e,r){return r?r.set(t):r=t.copy(),r.add(e),r},n.Vector.sub=function(t,e,r){return r?r.set(t):r=t.copy(),r.sub(e),r},n.Vector.mult=function(t,e,r){return r?r.set(t):r=t.copy(),r.mult(e),r},n.Vector.div=function(t,e,r){return r?r.set(t):r=t.copy(),r.div(e),r},n.Vector.dot=function(t,e){return t.dot(e)},n.Vector.cross=function(t,e){return t.cross(e)},n.Vector.dist=function(t,e){return t.dist(e)},n.Vector.lerp=function(t,e,r,n){return n?n.set(t):n=t.copy(),n.lerp(e,r),n},n.Vector.angleBetween=function(t,e){var r=Math.acos(t.dot(e)/(t.mag()*e.mag()));return this.p5&&this.p5._angleMode===o.DEGREES&&(r=i.radiansToDegrees(r)),r},e.exports=n.Vector},{"../core/constants":47,"../core/core":48,"./polargeometry":77}],77:[function(t,e,r){e.exports={degreesToRadians:function(t){return 2*Math.PI*t/360},radiansToDegrees:function(t){return 360*t/(2*Math.PI)}}},{}],78:[function(t,e,r){"use strict";var n=t("../core/core"),i=!1,o=function(){var t,e,r=4294967296,n=1664525,i=1013904223;return{setSeed:function(n){e=t=(null==n?Math.random()*r:n)>>>0},getSeed:function(){return t},rand:function(){return e=(n*e+i)%r,e/r}}}();n.prototype.randomSeed=function(t){o.setSeed(t),i=!0},n.prototype.random=function(t,e){var r;if(r=i?o.rand():Math.random(),0===arguments.length)return r;if(1===arguments.length)return r*t;if(t>e){var n=t;t=e,e=n}return r*(e-t)+t};var a,s=!1;n.prototype.randomGaussian=function(t,e){var r,n,i,o;if(s)r=a,s=!1;else{do n=this.random(2)-1,i=this.random(2)-1,o=n*n+i*i;while(o>=1);o=Math.sqrt(-2*Math.log(o)/o),r=n*o,a=i*o,s=!0}var h=t||0,u=e||1;return r*u+h},e.exports=n},{"../core/core":48}],79:[function(t,e,r){"use strict";var n=t("../core/core"),i=t("./polargeometry"),o=t("../core/constants");n.prototype._angleMode=o.RADIANS,n.prototype.acos=function(t){return this._angleMode===o.RADIANS?Math.acos(t):i.radiansToDegrees(Math.acos(t))},n.prototype.asin=function(t){return this._angleMode===o.RADIANS?Math.asin(t):i.radiansToDegrees(Math.asin(t))},n.prototype.atan=function(t){return this._angleMode===o.RADIANS?Math.atan(t):i.radiansToDegrees(Math.atan(t))},n.prototype.atan2=function(t,e){return this._angleMode===o.RADIANS?Math.atan2(t,e):i.radiansToDegrees(Math.atan2(t,e))},n.prototype.cos=function(t){return this._angleMode===o.RADIANS?Math.cos(t):Math.cos(this.radians(t))},n.prototype.sin=function(t){return this._angleMode===o.RADIANS?Math.sin(t):Math.sin(this.radians(t))},n.prototype.tan=function(t){return this._angleMode===o.RADIANS?Math.tan(t):Math.tan(this.radians(t))},n.prototype.degrees=function(t){return i.radiansToDegrees(t)},n.prototype.radians=function(t){return i.degreesToRadians(t)},n.prototype.angleMode=function(t){(t===o.DEGREES||t===o.RADIANS)&&(this._angleMode=t)},e.exports=n},{"../core/constants":47,"../core/core":48,"./polargeometry":77}],80:[function(t,e,r){"use strict";var n=t("../core/core");n.prototype.textAlign=function(t,e){return this._renderer.textAlign.apply(this._renderer,arguments)},n.prototype.textLeading=function(t){return this._renderer.textLeading.apply(this._renderer,arguments)},n.prototype.textSize=function(t){return this._renderer.textSize.apply(this._renderer,arguments)},n.prototype.textStyle=function(t){return this._renderer.textStyle.apply(this._renderer,arguments)},n.prototype.textWidth=function(t){return this._renderer.textWidth.apply(this._renderer,arguments)},n.prototype.textAscent=function(){return this._renderer.textAscent()},n.prototype.textDescent=function(){return this._renderer.textDescent()},n.prototype._updateTextMetrics=function(){return this._renderer._updateTextMetrics()},e.exports=n},{"../core/core":48}],81:[function(t,e,r){"use strict";var n=t("../core/core"),i=t("../core/constants");t("../core/error_helpers"),n.prototype.text=function(t,e,r,n,i){return this._validateParameters("text",arguments,[["*","Number","Number"],["*","Number","Number","Number","Number"]]),this._renderer._doFill||this._renderer._doStroke?this._renderer.text.apply(this._renderer,arguments):this},n.prototype.textFont=function(t,e){if(arguments.length){if(!t)throw Error("null font passed to textFont");return this._renderer._setProperty("_textFont",t),e&&(this._renderer._setProperty("_textSize",e),this._renderer._setProperty("_textLeading",e*i._DEFAULT_LEADMULT)),this._renderer._applyTextProperties()}return this},e.exports=n},{"../core/constants":47,"../core/core":48,"../core/error_helpers":51}],82:[function(t,e,r){"use strict";function n(){for(var t=Array.prototype.slice.call(arguments),e=t.length,r="";e--;)r+=t[e]===Object(t[e])?JSON.stringify(t[e]):t[e];return r}var i=t("../core/core"),o=t("../core/constants");i.Font=function(t){this.parent=t,this.cache={},this.font=void 0},i.Font.prototype.list=function(){throw"not yet implemented"},i.Font.prototype.textBounds=function(t,e,r,i,o){e=void 0!==e?e:0,r=void 0!==r?r:0,i=i||this.parent._renderer._textSize;var a=this.cache[n("textBounds",t,e,r,i)];if(!a){var s,h,u,c,l=[],p=[],f=this,d=this._scale(i);this.font.forEachGlyph(t,e,r,i,o,function(t,e,r,n){l.push(e),p.push(r);var o=t.getMetrics();"space"!==t.name?(l.push(e+o.xMax*d),p.push(r+-o.yMin*d),p.push(r+-o.yMax*d)):l.push(e+f.font.charToGlyph(" ").advanceWidth*f._scale(i))}),s=Math.max(0,Math.min.apply(null,l)),h=Math.max(0,Math.min.apply(null,p)),u=Math.max(0,Math.max.apply(null,l)),c=Math.max(0,Math.max.apply(null,p)),a={x:s,y:h,h:c-h,w:u-s,advance:s-e},this.cache[n("textBounds",t,e,r,i)]=a}return a},i.Font.prototype._getGlyphs=function(t){return this.font.stringToGlyphs(t)},i.Font.prototype._getPath=function(t,e,r,n){var i=this.parent,o=i._renderer.drawingContext,a=this._handleAlignment(i,o,t,e,r);return this.font.getPath(t,a.x,a.y,i._renderer._textSize,n)},i.Font.prototype._getPathData=function(t,e,r,n){var i=3;return"string"==typeof t&&arguments.length>2?t=this._getPath(t,e,r,n):"object"==typeof e&&(n=e),n&&"number"==typeof n.decimals&&(i=n.decimals),t.toPathData(i)},i.Font.prototype._getSVG=function(t,e,r,n){var i=3;return"string"==typeof t&&arguments.length>2?t=this._getPath(t,e,r,n):"object"==typeof e&&(n=e),n&&("number"==typeof n.decimals&&(i=n.decimals),"number"==typeof n.strokeWidth&&(t.strokeWidth=n.strokeWidth),"undefined"!=typeof n.fill&&(t.fill=n.fill),"undefined"!=typeof n.stroke&&(t.stroke=n.stroke)),t.toSVG(i)},i.Font.prototype._renderPath=function(t,e,r,n){var i,a=this.parent._renderer,s=a.drawingContext;i="object"==typeof t&&t.commands?t.commands:this._getPath(t,e,r,a._textSize,n).commands,s.beginPath();for(var h=0;h<i.length;h+=1){var u=i[h];"M"===u.type?s.moveTo(u.x,u.y):"L"===u.type?s.lineTo(u.x,u.y):"C"===u.type?s.bezierCurveTo(u.x1,u.y1,u.x2,u.y2,u.x,u.y):"Q"===u.type?s.quadraticCurveTo(u.x1,u.y1,u.x,u.y):"Z"===u.type&&s.closePath()}return a._doStroke&&a._strokeSet&&s.stroke(),a._doFill&&(s.fillStyle=a._fillSet?s.fillStyle:o._DEFAULT_TEXT_FILL,s.fill()),this},i.Font.prototype._textWidth=function(t,e){if(" "===t)return this.font.charToGlyph(" ").advanceWidth*this._scale(e);var r=this.textBounds(t,0,0,e);return r.w+r.advance},i.Font.prototype._textAscent=function(t){return this.font.ascender*this._scale(t)},i.Font.prototype._textDescent=function(t){return-this.font.descender*this._scale(t)},i.Font.prototype._scale=function(t){return 1/this.font.unitsPerEm*(t||this.parent._renderer._textSize)},i.Font.prototype._handleAlignment=function(t,e,r,n,i){var a=this._textWidth(r),s=this._textAscent(),h=this._textDescent(),u=s+h;return e.textAlign===o.CENTER?n-=a/2:e.textAlign===o.RIGHT&&(n-=a),e.textBaseline===o.TOP?i+=u:e.textBaseline===o._CTX_MIDDLE?i+=u/2-h:e.textBaseline===o.BOTTOM&&(i-=h),{x:n,y:i}},e.exports=i.Font},{"../core/constants":47,"../core/core":48}],83:[function(t,e,r){"use strict";var n=t("../core/core");n.prototype.append=function(t,e){return t.push(e),t},n.prototype.arrayCopy=function(t,e,r,n,i){var o,a;"undefined"!=typeof i?(a=Math.min(i,t.length),o=n,t=t.slice(e,a+e)):("undefined"!=typeof r?(a=r,a=Math.min(a,t.length)):a=t.length,o=0,r=e,t=t.slice(0,a)),Array.prototype.splice.apply(r,[o,a].concat(t))},n.prototype.concat=function(t,e){return t.concat(e)},n.prototype.reverse=function(t){return t.reverse()},n.prototype.shorten=function(t){return t.pop(),t},n.prototype.shuffle=function(t,e){t=e||ArrayBuffer.isView(t)?t:t.slice();for(var r,n,i=t.length;i>1;)r=Math.random()*i|0,n=t[--i],t[i]=t[r],t[r]=n;return t},n.prototype.sort=function(t,e){var r=e?t.slice(0,Math.min(e,t.length)):t,n=e?t.slice(Math.min(e,t.length)):[];return r="string"==typeof r[0]?r.sort():r.sort(function(t,e){return t-e}),r.concat(n)},n.prototype.splice=function(t,e,r){return Array.prototype.splice.apply(t,[r,0].concat(e)),t},n.prototype.subset=function(t,e,r){return"undefined"!=typeof r?t.slice(e,e+r):t.slice(e,t.length)},e.exports=n},{"../core/core":48}],84:[function(t,e,r){"use strict";var n=t("../core/core");n.prototype["float"]=function(t){return parseFloat(t)},n.prototype["int"]=function(t,e){return"string"==typeof t?(e=e||10,parseInt(t,e)):"number"==typeof t?0|t:"boolean"==typeof t?t?1:0:t instanceof Array?t.map(function(t){
return n.prototype["int"](t,e)}):void 0},n.prototype.str=function(t){return t instanceof Array?t.map(n.prototype.str):String(t)},n.prototype["boolean"]=function(t){return"number"==typeof t?0!==t:"string"==typeof t?"true"===t.toLowerCase():"boolean"==typeof t?t:t instanceof Array?t.map(n.prototype["boolean"]):void 0},n.prototype["byte"]=function(t){var e=n.prototype["int"](t,10);return"number"==typeof e?(e+128)%256-128:e instanceof Array?e.map(n.prototype["byte"]):void 0},n.prototype["char"]=function(t){return"number"!=typeof t||isNaN(t)?t instanceof Array?t.map(n.prototype["char"]):"string"==typeof t?n.prototype["char"](parseInt(t,10)):void 0:String.fromCharCode(t)},n.prototype.unchar=function(t){return"string"==typeof t&&1===t.length?t.charCodeAt(0):t instanceof Array?t.map(n.prototype.unchar):void 0},n.prototype.hex=function(t,e){if(e=void 0===e||null===e?e=8:e,t instanceof Array)return t.map(function(t){return n.prototype.hex(t,e)});if("number"==typeof t){0>t&&(t=4294967295+t+1);for(var r=Number(t).toString(16).toUpperCase();r.length<e;)r="0"+r;return r.length>=e&&(r=r.substring(r.length-e,r.length)),r}},n.prototype.unhex=function(t){return t instanceof Array?t.map(n.prototype.unhex):parseInt("0x"+t,16)},e.exports=n},{"../core/core":48}],85:[function(t,e,r){"use strict";function n(){var t=arguments[0],e=0>t,r=e?t.toString().substring(1):t.toString(),n=r.indexOf("."),i=-1!==n?r.substring(0,n):r,o=-1!==n?r.substring(n+1):"",a=e?"-":"";if(3===arguments.length){var s="";(-1!==n||arguments[2]-o.length>0)&&(s="."),o.length>arguments[2]&&(o=o.substring(0,arguments[2]));for(var h=0;h<arguments[1]-i.length;h++)a+="0";a+=i,a+=s,a+=o;for(var u=0;u<arguments[2]-o.length;u++)a+="0";return a}for(var c=0;c<Math.max(arguments[1]-i.length,0);c++)a+="0";return a+=r}function i(){var t=arguments[0].toString(),e=t.indexOf("."),r=-1!==e?t.substring(e):"",n=-1!==e?t.substring(0,e):t;if(n=n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),0===arguments[1])r="";else if(void 0!==arguments[1])if(arguments[1]>r.length){r+=-1===e?".":"";for(var i=arguments[1]-r.length+1,o=0;i>o;o++)r+="0"}else r=r.substring(0,arguments[1]+1);return n+r}function o(){return parseFloat(arguments[0])>0?"+"+arguments[0].toString():arguments[0].toString()}function a(){return parseFloat(arguments[0])>0?" "+arguments[0].toString():arguments[0].toString()}var s=t("../core/core");s.prototype.join=function(t,e){return t.join(e)},s.prototype.match=function(t,e){return t.match(e)},s.prototype.matchAll=function(t,e){for(var r=new RegExp(e,"g"),n=r.exec(t),i=[];null!==n;)i.push(n),n=r.exec(t);return i},s.prototype.nf=function(){if(arguments[0]instanceof Array){var t=arguments[1],e=arguments[2];return arguments[0].map(function(r){return n(r,t,e)})}var r=Object.prototype.toString.call(arguments[0]);return"[object Arguments]"===r?3===arguments[0].length?this.nf(arguments[0][0],arguments[0][1],arguments[0][2]):2===arguments[0].length?this.nf(arguments[0][0],arguments[0][1]):this.nf(arguments[0][0]):n.apply(this,arguments)},s.prototype.nfc=function(){if(arguments[0]instanceof Array){var t=arguments[1];return arguments[0].map(function(e){return i(e,t)})}return i.apply(this,arguments)},s.prototype.nfp=function(){var t=this.nf.apply(this,arguments);return t instanceof Array?t.map(o):o(t)},s.prototype.nfs=function(){var t=this.nf.apply(this,arguments);return t instanceof Array?t.map(a):a(t)},s.prototype.split=function(t,e){return t.split(e)},s.prototype.splitTokens=function(){var t;return t=arguments.length>1?new RegExp("["+arguments[1]+"]","g"):/\s/g,arguments[0].split(t).filter(function(t){return t})},s.prototype.trim=function(t){return t instanceof Array?t.map(this.trim):t.trim()},e.exports=s},{"../core/core":48}],86:[function(t,e,r){"use strict";var n=t("../core/core");n.prototype.day=function(){return(new Date).getDate()},n.prototype.hour=function(){return(new Date).getHours()},n.prototype.minute=function(){return(new Date).getMinutes()},n.prototype.millis=function(){return window.performance.now()},n.prototype.month=function(){return(new Date).getMonth()+1},n.prototype.second=function(){return(new Date).getSeconds()},n.prototype.year=function(){return(new Date).getFullYear()},e.exports=n},{"../core/core":48}]},{},[39])(39)}),function(t,e){"function"==typeof define&&define.amd?define("p5.sound",["p5"],function(t){e(t)}):e("object"==typeof exports?require("../p5"):t.p5)}(this,function(t){var e;e=function(){"use strict";window.AudioContext=window.AudioContext||window.webkitAudioContext;var e=new window.AudioContext;t.prototype.getAudioContext=function(){return e},"function"!=typeof e.createGain&&(window.audioContext.createGain=window.audioContext.createGainNode),"function"!=typeof e.createDelay&&(window.audioContext.createDelay=window.audioContext.createDelayNode),"function"!=typeof window.AudioBufferSourceNode.prototype.start&&(window.AudioBufferSourceNode.prototype.start=window.AudioBufferSourceNode.prototype.noteGrainOn),"function"!=typeof window.AudioBufferSourceNode.prototype.stop&&(window.AudioBufferSourceNode.prototype.stop=window.AudioBufferSourceNode.prototype.noteOff),"function"!=typeof window.OscillatorNode.prototype.start&&(window.OscillatorNode.prototype.start=window.OscillatorNode.prototype.noteOn),"function"!=typeof window.OscillatorNode.prototype.stop&&(window.OscillatorNode.prototype.stop=window.OscillatorNode.prototype.noteOff),window.AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(window.AudioContext.prototype.createScriptProcessor=window.AudioContext.prototype.createJavaScriptNode),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var r=document.createElement("audio");t.prototype.isSupported=function(){return!!r.canPlayType};var n=function(){return!!r.canPlayType&&r.canPlayType('audio/ogg; codecs="vorbis"')},i=function(){return!!r.canPlayType&&r.canPlayType("audio/mpeg;")},o=function(){return!!r.canPlayType&&r.canPlayType('audio/wav; codecs="1"')},a=function(){return!!r.canPlayType&&(r.canPlayType("audio/x-m4a;")||r.canPlayType("audio/aac;"))},s=function(){return!!r.canPlayType&&r.canPlayType("audio/x-aiff;")};t.prototype.isFileSupported=function(t){switch(t.toLowerCase()){case"mp3":return i();case"wav":return o();case"ogg":return n();case"mp4":return a();case"aiff":return s();default:return!1}};var h=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1;h&&window.addEventListener("touchstart",function(){var t=e.createBuffer(1,1,22050),r=e.createBufferSource();r.buffer=t,r.connect(e.destination),r.start(0)},!1)}();var r;r=function(){"use strict";var e=function(){var e=t.prototype.getAudioContext();this.input=e.createGain(),this.output=e.createGain(),this.limiter=e.createDynamicsCompressor(),this.limiter.threshold.value=0,this.limiter.ratio.value=100,this.audiocontext=e,this.output.disconnect(),this.inputSources=[],this.input.connect(this.limiter),this.limiter.connect(this.output),this.meter=e.createGain(),this.fftMeter=e.createGain(),this.output.connect(this.meter),this.output.connect(this.fftMeter),this.output.connect(this.audiocontext.destination),this.soundArray=[],this.parts=[],this.extensions=[]},r=new e;return t.prototype.getMasterVolume=function(){return r.output.gain.value},t.prototype.masterVolume=function(t,e,n){if("number"==typeof t){var e=e||0,n=n||0,i=r.audiocontext.currentTime,o=r.output.gain.value;r.output.gain.cancelScheduledValues(i+n),r.output.gain.linearRampToValueAtTime(o,i+n),r.output.gain.linearRampToValueAtTime(t,i+n+e)}else{if(!t)return r.output.gain;t.connect(r.output.gain)}},t.soundOut=r,t.soundOut._silentNode=r.audiocontext.createGain(),t.soundOut._silentNode.gain.value=0,t.soundOut._silentNode.connect(r.audiocontext.destination),r}(e);var n;n=function(){"use strict";var e=r;t.prototype.sampleRate=function(){return e.audiocontext.sampleRate},t.prototype.freqToMidi=function(t){var e=Math.log(t/440)/Math.log(2),r=Math.round(12*e)+57;return r},t.prototype.midiToFreq=function(t){return 440*Math.pow(2,(t-69)/12)},t.prototype.soundFormats=function(){e.extensions=[];for(var t=0;t<arguments.length;t++){if(arguments[t]=arguments[t].toLowerCase(),!(["mp3","wav","ogg","m4a","aac"].indexOf(arguments[t])>-1))throw arguments[t]+" is not a valid sound format!";e.extensions.push(arguments[t])}},t.prototype.disposeSound=function(){for(var t=0;t<e.soundArray.length;t++)e.soundArray[t].dispose()},t.prototype.registerMethod("remove",t.prototype.disposeSound),t.prototype._checkFileFormats=function(r){var n;if("string"==typeof r){n=r;var i=n.split(".").pop();if(["mp3","wav","ogg","m4a","aac"].indexOf(i)>-1){var o=t.prototype.isFileSupported(i);if(o)n=n;else for(var a=n.split("."),s=a[a.length-1],h=0;h<e.extensions.length;h++){var u=e.extensions[h],o=t.prototype.isFileSupported(u);if(o){s="",2===a.length&&(s+=a[0]);for(var h=1;h<=a.length-2;h++){var c=a[h];s+="."+c}n=s+=".",n=n+=u;break}}}else for(var h=0;h<e.extensions.length;h++){var u=e.extensions[h],o=t.prototype.isFileSupported(u);if(o){n=n+"."+u;break}}}else if("object"==typeof r)for(var h=0;h<r.length;h++){var u=r[h].split(".").pop(),o=t.prototype.isFileSupported(u);if(o){n=r[h];break}}return n},t.prototype._mathChain=function(t,e,r,n,i){for(var o in t.mathOps)t.mathOps[o]instanceof i&&(t.mathOps[o].dispose(),r=o,r<t.mathOps.length-1&&(n=t.mathOps[o+1]));return t.mathOps[r-1].disconnect(),t.mathOps[r-1].connect(e),e.connect(n),t.mathOps[r]=e,t}}(r);var i;i=function(){"use strict";var e=r,n=e.audiocontext;"undefined"!=typeof n.createStereoPanner?(t.Panner=function(t,e,r){this.stereoPanner=this.input=n.createStereoPanner(),t.connect(this.stereoPanner),this.stereoPanner.connect(e)},t.Panner.prototype.pan=function(t,e){var r=e||0,i=n.currentTime+r;this.stereoPanner.pan.linearRampToValueAtTime(t,i)},t.Panner.prototype.inputChannels=function(t){},t.Panner.prototype.connect=function(t){this.stereoPanner.connect(t)},t.Panner.prototype.disconnect=function(t){this.stereoPanner.disconnect()}):(t.Panner=function(t,e,r){this.input=n.createGain(),t.connect(this.input),this.left=n.createGain(),this.right=n.createGain(),this.left.channelInterpretation="discrete",this.right.channelInterpretation="discrete",r>1?(this.splitter=n.createChannelSplitter(2),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0)):(this.input.connect(this.left),this.input.connect(this.right)),this.output=n.createChannelMerger(2),this.left.connect(this.output,0,1),this.right.connect(this.output,0,0),this.output.connect(e)},t.Panner.prototype.pan=function(t,e){var r=e||0,i=n.currentTime+r,o=(t+1)/2,a=Math.cos(o*Math.PI/2),s=Math.sin(o*Math.PI/2);this.left.gain.linearRampToValueAtTime(s,i),this.right.gain.linearRampToValueAtTime(a,i)},t.Panner.prototype.inputChannels=function(t){1===t?(this.input.disconnect(),this.input.connect(this.left),this.input.connect(this.right)):2===t&&(this.splitter=n.createChannelSplitter(2),this.input.disconnect(),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0))},t.Panner.prototype.connect=function(t){this.output.connect(t)},t.Panner.prototype.disconnect=function(t){this.output.disconnect()}),t.Panner3D=function(t,e){var r=n.createPanner();return r.panningModel="HRTF",r.distanceModel="linear",r.setPosition(0,0,0),t.connect(r),r.connect(e),r.pan=function(t,e,n){r.setPosition(t,e,n)},r}}(r);var o;o=function(){"use strict";function e(t,e){for(var r={},n=t.length,i=0;n>i;i++){if(t[i]>e){var o=t[i],a=new c(o,i);r[i]=a,i+=6e3}i++}return r}function n(t){for(var e=[],r=Object.keys(t).sort(),n=0;n<r.length;n++)for(var i=0;10>i;i++){var o=t[r[n]],a=t[r[n+i]];if(o&&a){var s=o.sampleIndex,h=a.sampleIndex,u=h-s;u>0&&o.intervals.push(u);var c=e.some(function(t,e){return t.interval===u?(t.count++,t):void 0});c||e.push({interval:u,count:1})}}return e}function i(t,e){var r=[];return t.forEach(function(t,n){try{var i=Math.abs(60/(t.interval/e));i=a(i);var o=r.some(function(e){return e.tempo===i?e.count+=t.count:void 0});if(!o){if(isNaN(i))return;r.push({tempo:Math.round(i),count:t.count})}}catch(s){throw s}}),r}function o(t,e,r,n){for(var i=[],o=Object.keys(t).sort(),s=0;s<o.length;s++)for(var h=o[s],u=t[h],c=0;c<u.intervals.length;c++){var l=Math.round(Math.abs(60/(u.intervals[c]/r)));l=a(l);Math.abs(l-e)<n&&i.push(u.sampleIndex/44100)}return i=i.filter(function(t,e,r){var n=r[e+1]-t;return n>.01?!0:void 0})}function a(t){if(isFinite(t)&&0!=t){for(;90>t;)t*=2;for(;t>180&&t>90;)t/=2;return t}}var s=r,h=s.audiocontext;t.SoundFile=function(e,r,n){if("undefined"!=typeof e){if("string"==typeof e||"string"==typeof e[0]){var i=t.prototype._checkFileFormats(e);this.url=i}else if("object"==typeof e&&!(window.File&&window.FileReader&&window.FileList&&window.Blob))throw"Unable to load file because the File API is not supported";e.file&&(e=e.file),this.file=e}this._looping=!1,this._playing=!1,this._paused=!1,this._pauseTime=0,this._cues=[],this._lastPos=0,this._counterNode,this._scopeNode,this.bufferSourceNodes=[],this.bufferSourceNode=null,this.buffer=null,this.playbackRate=1,this.gain=1,this.input=s.audiocontext.createGain(),this.output=s.audiocontext.createGain(),this.reversed=!1,this.startTime=0,this.endTime=null,this.pauseTime=0,this.mode="sustain",this.startMillis=null,this.amplitude=new t.Amplitude,this.output.connect(this.amplitude.input),this.panPosition=0,this.panner=new t.Panner(this.output,s.input,2),(this.url||this.file)&&this.load(r),s.soundArray.push(this),"function"==typeof n?this.whileLoading=n:this.whileLoading=function(){}},t.prototype.registerPreloadMethod("loadSound",t),t.prototype.loadSound=function(e,r,n){window.location.origin.indexOf("file://")>-1&&"undefined"===window.cordova&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var i=new t.SoundFile(e,r,n);return i},t.SoundFile.prototype.load=function(t){if(void 0!=this.url&&""!=this.url){var e=this,r=new XMLHttpRequest;r.addEventListener("progress",function(t){e._updateProgress(t)},!1),r.open("GET",this.url,!0),r.responseType="arraybuffer";var n=this;r.onload=function(){h.decodeAudioData(r.response,function(e){n.buffer=e,n.panner.inputChannels(e.numberOfChannels),t&&t(n)})},r.send()}else if(void 0!=this.file){var i=new FileReader,n=this;i.onload=function(){h.decodeAudioData(i.result,function(e){n.buffer=e,n.panner.inputChannels(e.numberOfChannels),t&&t(n)})},i.readAsArrayBuffer(this.file)}},t.SoundFile.prototype._updateProgress=function(t){if(t.lengthComputable){var e=Math.log(t.loaded/t.total*9.9);this.whileLoading(e)}else console.log("size unknown")},t.SoundFile.prototype.isLoaded=function(){return this.buffer?!0:!1},t.SoundFile.prototype.play=function(t,e,r,n,i){var o,a,h=this,u=s.audiocontext.currentTime,t=t||0;if(0>t&&(t=0),t+=u,!this.buffer)throw"not ready to play file, buffer has yet to load. Try preload()";if(this._pauseTime=0,"restart"===this.mode&&this.buffer&&this.bufferSourceNode){var u=s.audiocontext.currentTime;this.bufferSourceNode.stop(t),this._counterNode.stop(t)}if(this.bufferSourceNode=this._initSourceNode(),this._counterNode=this._initCounterNode(),n){if(!(n>=0&&n<this.buffer.duration))throw"start time out of range";o=n}else o=0;i=i?i<=this.buffer.duration-o?i:this.buffer.duration:this.buffer.duration-o;var c=r||1;if(this.bufferSourceNode.connect(this.output),this.output.gain.value=c,e=e||Math.abs(this.playbackRate),this.bufferSourceNode.playbackRate.setValueAtTime(e,u),this._paused?(this.bufferSourceNode.start(t,this.pauseTime,i),this._counterNode.start(t,this.pauseTime,i)):(this.bufferSourceNode.start(t,o,i),this._counterNode.start(t,o,i)),this._playing=!0,this._paused=!1,this.bufferSourceNodes.push(this.bufferSourceNode),this.bufferSourceNode._arrayIndex=this.bufferSourceNodes.length-1,this.bufferSourceNode.onended=function(t){var e=this;this._playing=!1,setTimeout(function(){h.bufferSourceNodes.splice(e._arrayIndex,1),0===h.bufferSourceNodes.length&&(h._playing=!1)},1)},this.bufferSourceNode.loop=this._looping,this._counterNode.loop=this._looping,this._looping===!0){var a=o+i;this.bufferSourceNode.loopStart=o,this.bufferSourceNode.loopEnd=a,this._counterNode.loopStart=o,this._counterNode.loopEnd=a}},t.SoundFile.prototype.playMode=function(t){var e=t.toLowerCase();if("restart"===e&&this.buffer&&this.bufferSourceNode)for(var r=0;r<this.bufferSourceNodes.length-1;r++){var n=s.audiocontext.currentTime;this.bufferSourceNodes[r].stop(n)}if("restart"!==e&&"sustain"!==e)throw'Invalid play mode. Must be either "restart" or "sustain"';this.mode=e},t.SoundFile.prototype.pause=function(t){var e=s.audiocontext.currentTime,t=t||0,r=t+e;this.isPlaying()&&this.buffer&&this.bufferSourceNode?(this.pauseTime=this.currentTime(),this.bufferSourceNode.stop(r),this._counterNode.stop(r),this._paused=!0,this._playing=!1,this._pauseTime=this.currentTime()):this._pauseTime=0},t.SoundFile.prototype.loop=function(t,e,r,n,i){this._looping=!0,this.play(t,e,r,n,i)},t.SoundFile.prototype.setLoop=function(t){if(t===!0)this._looping=!0;else{if(t!==!1)throw"Error: setLoop accepts either true or false";this._looping=!1}this.bufferSourceNode&&(this.bufferSourceNode.loop=this._looping,this._counterNode.loop=this._looping)},t.SoundFile.prototype.isLooping=function(){return this.bufferSourceNode&&this._looping===!0&&this.isPlaying()===!0?!0:!1},t.SoundFile.prototype.isPlaying=function(){return this._playing},t.SoundFile.prototype.isPaused=function(){return this._paused},t.SoundFile.prototype.stop=function(t){var e=t||0;if("sustain"==this.mode)this.stopAll(e),this._playing=!1,this.pauseTime=0,this._paused=!1;else if(this.buffer&&this.bufferSourceNode){var r=s.audiocontext.currentTime,n=e||0;this.pauseTime=0,this.bufferSourceNode.stop(r+n),this._counterNode.stop(r+n),this._playing=!1,this._paused=!1}},t.SoundFile.prototype.stopAll=function(t){var e=s.audiocontext.currentTime,r=t||0;if(this.buffer&&this.bufferSourceNode){for(var n=0;n<this.bufferSourceNodes.length;n++)if(void 0!=typeof this.bufferSourceNodes[n])try{this.bufferSourceNodes[n].stop(e+r)}catch(i){}this._counterNode.stop(e+r)}},t.SoundFile.prototype.setVolume=function(t,e,r){if("number"==typeof t){var e=e||0,r=r||0,n=s.audiocontext.currentTime,i=this.output.gain.value;this.output.gain.cancelScheduledValues(n+r),this.output.gain.linearRampToValueAtTime(i,n+r),this.output.gain.linearRampToValueAtTime(t,n+r+e)}else{if(!t)return this.output.gain;t.connect(this.output.gain)}},t.SoundFile.prototype.amp=t.SoundFile.prototype.setVolume,t.SoundFile.prototype.fade=t.SoundFile.prototype.setVolume,t.SoundFile.prototype.getVolume=function(){return this.output.gain.value},t.SoundFile.prototype.pan=function(t,e){this.panPosition=t,this.panner.pan(t,e)},t.SoundFile.prototype.getPan=function(){return this.panPosition},t.SoundFile.prototype.rate=function(t){if(this.playbackRate!==t||!this.bufferSourceNode||this.bufferSourceNode.playbackRate.value!==t){this.playbackRate=t;var e=t;if(0===this.playbackRate&&this._playing&&this.pause(),this.playbackRate<0&&!this.reversed){var r=this.currentTime();this.bufferSourceNode.playbackRate.value;this.reverseBuffer(),e=Math.abs(t);var n=(r-this.duration())/e;this.pauseTime=n}else this.playbackRate>0&&this.reversed&&this.reverseBuffer();if(this.bufferSourceNode){var i=s.audiocontext.currentTime;this.bufferSourceNode.playbackRate.cancelScheduledValues(i),this.bufferSourceNode.playbackRate.linearRampToValueAtTime(Math.abs(e),i),this._counterNode.playbackRate.cancelScheduledValues(i),this._counterNode.playbackRate.linearRampToValueAtTime(Math.abs(e),i)}}},t.SoundFile.prototype.setPitch=function(t){var e=midiToFreq(t)/midiToFreq(60);this.rate(e)},t.SoundFile.prototype.getPlaybackRate=function(){return this.playbackRate},t.SoundFile.prototype.duration=function(){return this.buffer?this.buffer.duration:0},t.SoundFile.prototype.currentTime=function(){return this._pauseTime>0?this._pauseTime:this._lastPos/h.sampleRate},t.SoundFile.prototype.jump=function(t,e){if(0>t||t>this.buffer.duration)throw"jump time out of range";if(e>this.buffer.duration-t)throw"end time out of range";var r=t||0,n=e||this.buffer.duration-t;this.isPlaying()&&this.stop(),this.play(0,this.playbackRate,this.output.gain.value,r,n)},t.SoundFile.prototype.channels=function(){return this.buffer.numberOfChannels},t.SoundFile.prototype.sampleRate=function(){return this.buffer.sampleRate},t.SoundFile.prototype.frames=function(){return this.buffer.length},t.SoundFile.prototype.getPeaks=function(t){if(!this.buffer)throw"Cannot load peaks yet, buffer is not loaded";if(t||(t=5*window.width),this.buffer){for(var e=this.buffer,r=e.length/t,n=~~(r/10)||1,i=e.numberOfChannels,o=new Float32Array(Math.round(t)),a=0;i>a;a++)for(var s=e.getChannelData(a),h=0;t>h;h++){for(var u=~~(h*r),c=~~(u+r),l=0,p=u;c>p;p+=n){var f=s[p];f>l?l=f:-f>l&&(l=f)}(0===a||Math.abs(l)>o[h])&&(o[h]=l)}return o}},t.SoundFile.prototype.reverseBuffer=function(){var t=this.getVolume();if(this.setVolume(0,.01,0),this.pause(),!this.buffer)throw"SoundFile is not done loading";for(var e=0;e<this.buffer.numberOfChannels;e++)Array.prototype.reverse.call(this.buffer.getChannelData(e));this.reversed=!this.reversed,this.setVolume(t,.01,.0101),this.play()},t.SoundFile.prototype._onEnded=function(t){t.onended=function(t){var e=s.audiocontext.currentTime;t.stop(e)}},t.SoundFile.prototype.add=function(){},t.SoundFile.prototype.dispose=function(){var t=s.audiocontext.currentTime;if(this.stop(t),this.buffer&&this.bufferSourceNode){for(var e=0;e<this.bufferSourceNodes.length-1;e++)null!==this.bufferSourceNodes[e]&&(this.bufferSourceNodes[e].stop(t),this.bufferSourceNodes[e]=null);if(this.isPlaying()){try{this._counterNode.stop(t)}catch(r){console.log(r)}this._counterNode=null}}this.output&&(this.output.disconnect(),this.output=null),this.panner&&(this.panner.disconnect(),this.panner=null)},t.SoundFile.prototype.connect=function(t){t?t.hasOwnProperty("input")?this.panner.connect(t.input):this.panner.connect(t):this.panner.connect(s.input)},t.SoundFile.prototype.disconnect=function(t){this.panner.disconnect(t)},t.SoundFile.prototype.getLevel=function(t){return t&&(this.amplitude.smoothing=t),this.amplitude.getLevel()},t.SoundFile.prototype.setPath=function(e,r){var n=t.prototype._checkFileFormats(e);this.url=n,this.load(r)},t.SoundFile.prototype.setBuffer=function(t){var e=t.length,r=t[0].length,n=h.createBuffer(e,r,h.sampleRate);!t[0]instanceof Float32Array&&(t[0]=new Float32Array(t[0]));for(var i=0;e>i;i++){var o=n.getChannelData(i);o.set(t[i])}this.buffer=n,this.panner.inputChannels(e)},t.SoundFile.prototype._initCounterNode=function(){var e=this,r=h.currentTime,n=h.createBufferSource();return e._scopeNode&&(e._scopeNode.disconnect(),e._scopeNode=null),e._scopeNode=h.createScriptProcessor(256,1,1),n.buffer=u(e.buffer),n.playbackRate.setValueAtTime(e.playbackRate,r),n.connect(e._scopeNode),e._scopeNode.connect(t.soundOut._silentNode),e._scopeNode.onaudioprocess=function(t){var r=t.inputBuffer.getChannelData(0);e._lastPos=r[r.length-1]||0,e._onTimeUpdate(e._lastPos)},n},t.SoundFile.prototype._initSourceNode=function(){var t=this,e=h.currentTime,r=h.createBufferSource();return r.buffer=t.buffer,r.playbackRate.setValueAtTime(t.playbackRate,e),r};var u=function(t){for(var e=new Float32Array(t.length),r=h.createBuffer(1,t.length,44100),n=0;n<t.length;n++)e[n]=n;return r.getChannelData(0).set(e),r};t.SoundFile.prototype.processPeaks=function(t,r,a,s){var h=this.buffer.length,u=this.buffer.sampleRate,c=this.buffer,p=r||.9,f=p,d=a||.22,m=s||200,g=new OfflineAudioContext(1,h,u),y=g.createBufferSource();y.buffer=c;var v=g.createBiquadFilter();v.type="lowpass",y.connect(v),v.connect(g.destination),y.start(0),g.startRendering(),g.oncomplete=function(r){var a=r.renderedBuffer,s=a.getChannelData(0);do l=e(s,f),f-=.005;while(Object.keys(l).length<m&&f>=d);var h=n(l),u=i(h,a.sampleRate),c=u.sort(function(t,e){return e.count-t.count}).splice(0,5);this.tempo=c[0].tempo;var p=5,g=o(l,c[0].tempo,a.sampleRate,p);t(g)}};var c=function(t,e){this.sampleIndex=e,this.amplitude=t,this.tempos=[],this.intervals=[]},l=[];t.SoundFile.prototype.addCue=function(t,e,r){var n=this._cueIDCounter++,i=new p(e,t,n,r);return this._cues.push(i),n},t.SoundFile.prototype.removeCue=function(t){for(var e=0;e<this._cues.length;e++){var r=this._cues[e];r.id===t&&this.cues.splice(e,1)}0===this._cues.length},t.SoundFile.prototype.clearCues=function(){this._cues=[]},t.SoundFile.prototype._onTimeUpdate=function(t){for(var e=t/this.buffer.sampleRate,r=0;r<this._cues.length;r++){var n=this._cues[r].time,i=this._cues[r].val;this._prevTime<n&&e>=n&&this._cues[r].callback(i)}this._prevTime=e};var p=function(t,e,r,n){this.callback=t,this.time=e,this.id=r,this.val=n}}(e,r);var a;a=function(){"use strict";var e=r;t.Amplitude=function(t){this.bufferSize=2048,this.audiocontext=e.audiocontext,this.processor=this.audiocontext.createScriptProcessor(this.bufferSize,2,1),this.input=this.processor,this.output=this.audiocontext.createGain(),this.smoothing=t||0,this.volume=0,this.average=0,this.stereoVol=[0,0],this.stereoAvg=[0,0],this.stereoVolNorm=[0,0],this.volMax=.001,this.normalize=!1,this.processor.onaudioprocess=this._audioProcess.bind(this),this.processor.connect(this.output),this.output.gain.value=0,this.output.connect(this.audiocontext.destination),e.meter.connect(this.processor)},t.Amplitude.prototype.setInput=function(r,n){e.meter.disconnect(),n&&(this.smoothing=n),null==r?(console.log("Amplitude input source is not ready! Connecting to master output instead"),e.meter.connect(this.processor)):r instanceof t.Signal?r.output.connect(this.processor):r?(r.connect(this.processor),this.processor.disconnect(),this.processor.connect(this.output)):e.meter.connect(this.processor)},t.Amplitude.prototype.connect=function(t){t?t.hasOwnProperty("input")?this.output.connect(t.input):this.output.connect(t):this.output.connect(this.panner.connect(e.input))},t.Amplitude.prototype.disconnect=function(t){this.output.disconnect()},t.Amplitude.prototype._audioProcess=function(t){for(var e=0;e<t.inputBuffer.numberOfChannels;e++){for(var r,n=t.inputBuffer.getChannelData(e),i=n.length,o=0,a=0,s=0;i>s;s++)r=n[s],this.normalize?(o+=Math.max(Math.min(r/this.volMax,1),-1),a+=Math.max(Math.min(r/this.volMax,1),-1)*Math.max(Math.min(r/this.volMax,1),-1)):(o+=r,a+=r*r);var h=o/i,u=Math.sqrt(a/i);this.stereoVol[e]=Math.max(u,this.stereoVol[e]*this.smoothing),this.stereoAvg[e]=Math.max(h,this.stereoVol[e]*this.smoothing),this.volMax=Math.max(this.stereoVol[e],this.volMax)}var c=this,l=this.stereoVol.reduce(function(t,e,r){return c.stereoVolNorm[r-1]=Math.max(Math.min(c.stereoVol[r-1]/c.volMax,1),0),c.stereoVolNorm[r]=Math.max(Math.min(c.stereoVol[r]/c.volMax,1),0),t+e});this.volume=l/this.stereoVol.length,this.volNorm=Math.max(Math.min(this.volume/this.volMax,1),0)},t.Amplitude.prototype.getLevel=function(t){return"undefined"!=typeof t?this.normalize?this.stereoVolNorm[t]:this.stereoVol[t]:this.normalize?this.volNorm:this.volume},t.Amplitude.prototype.toggleNormalize=function(t){"boolean"==typeof t?this.normalize=t:this.normalize=!this.normalize},t.Amplitude.prototype.smooth=function(t){t>=0&&1>t?this.smoothing=t:console.log("Error: smoothing must be between 0 and 1")}}(r);var s;s=function(){"use strict";var e=r;t.FFT=function(t,r){this.smoothing=t||.8,this.bins=r||1024;var n=2*r||2048;this.input=this.analyser=e.audiocontext.createAnalyser(),e.fftMeter.connect(this.analyser),this.analyser.smoothingTimeConstant=this.smoothing,this.analyser.fftSize=n,this.freqDomain=new Uint8Array(this.analyser.frequencyBinCount),this.timeDomain=new Uint8Array(this.analyser.frequencyBinCount),this.bass=[20,140],this.lowMid=[140,400],this.mid=[400,2600],this.highMid=[2600,5200],this.treble=[5200,14e3]},t.FFT.prototype.setInput=function(t){t?(t.output?t.output.connect(this.analyser):t.connect&&t.connect(this.analyser),e.fftMeter.disconnect()):e.fftMeter.connect(this.analyser)},t.FFT.prototype.waveform=function(){for(var e,r,n,i=0;i<arguments.length;i++)"number"==typeof arguments[i]&&(e=arguments[i],this.analyser.fftSize=2*e),"string"==typeof arguments[i]&&(r=arguments[i]);if(r&&!t.prototype._isSafari())return o(this,this.timeDomain),this.analyser.getFloatTimeDomainData(this.timeDomain),this.timeDomain;a(this,this.timeDomain),this.analyser.getByteTimeDomainData(this.timeDomain);for(var n=new Array,i=0;i<this.timeDomain.length;i++){var s=t.prototype.map(this.timeDomain[i],0,255,-1,1);n.push(s)}return n},t.FFT.prototype.analyze=function(){for(var t,e,r=0;r<arguments.length;r++)"number"==typeof arguments[r]&&(t=this.bins=arguments[r],this.analyser.fftSize=2*this.bins),"string"==typeof arguments[r]&&(e=arguments[r]);if(e&&"db"===e.toLowerCase())return n(this),this.analyser.getFloatFrequencyData(this.freqDomain),this.freqDomain;i(this,this.freqDomain),this.analyser.getByteFrequencyData(this.freqDomain);var o=Array.apply([],this.freqDomain);return o.length===this.analyser.fftSize,o.constructor===Array,o},t.FFT.prototype.getEnergy=function(t,r){var n=e.audiocontext.sampleRate/2;if("bass"===t?(t=this.bass[0],r=this.bass[1]):"lowMid"===t?(t=this.lowMid[0],r=this.lowMid[1]):"mid"===t?(t=this.mid[0],r=this.mid[1]):"highMid"===t?(t=this.highMid[0],r=this.highMid[1]):"treble"===t&&(t=this.treble[0],r=this.treble[1]),"number"!=typeof t)throw"invalid input for getEnergy()";if(r){if(t&&r){if(t>r){var i=r;r=t,t=i}for(var o=Math.round(t/n*this.freqDomain.length),a=Math.round(r/n*this.freqDomain.length),s=0,h=0,u=o;a>=u;u++)s+=this.freqDomain[u],h+=1;var c=s/h;return c}throw"invalid input for getEnergy()"}var l=Math.round(t/n*this.freqDomain.length);return this.freqDomain[l]},t.FFT.prototype.getFreq=function(t,e){console.log("getFreq() is deprecated. Please use getEnergy() instead.");var r=this.getEnergy(t,e);return r},t.FFT.prototype.smooth=function(t){t&&(this.smoothing=t),this.analyser.smoothingTimeConstant=t};var n=function(t){t.freqDomain instanceof Float32Array==!1&&(t.freqDomain=new Float32Array(t.analyser.frequencyBinCount))},i=function(t){t.freqDomain instanceof Uint8Array==!1&&(t.freqDomain=new Uint8Array(t.analyser.frequencyBinCount))},o=function(t){t.timeDomain instanceof Float32Array==!1&&(t.timeDomain=new Float32Array(t.analyser.frequencyBinCount))},a=function(t){t.timeDomain instanceof Uint8Array==!1&&(t.timeDomain=new Uint8Array(t.analyser.frequencyBinCount))}}(r);var h;h=function(){"use strict";function t(t){return void 0===t}var e;if(t(window.AudioContext)&&(window.AudioContext=window.webkitAudioContext),t(window.OfflineAudioContext)&&(window.OfflineAudioContext=window.webkitOfflineAudioContext),t(AudioContext))throw new Error("Web Audio is not supported in this browser");e=new AudioContext,"function"!=typeof AudioContext.prototype.createGain&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),"function"!=typeof AudioContext.prototype.createDelay&&(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),"function"!=typeof AudioContext.prototype.createPeriodicWave&&(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),"function"!=typeof AudioBufferSourceNode.prototype.start&&(AudioBufferSourceNode.prototype.start=AudioBufferSourceNode.prototype.noteGrainOn),"function"!=typeof AudioBufferSourceNode.prototype.stop&&(AudioBufferSourceNode.prototype.stop=AudioBufferSourceNode.prototype.noteOff),"function"!=typeof OscillatorNode.prototype.start&&(OscillatorNode.prototype.start=OscillatorNode.prototype.noteOn),"function"!=typeof OscillatorNode.prototype.stop&&(OscillatorNode.prototype.stop=OscillatorNode.prototype.noteOff),"function"!=typeof OscillatorNode.prototype.setPeriodicWave&&(OscillatorNode.prototype.setPeriodicWave=OscillatorNode.prototype.setWaveTable),window.Tone||(AudioNode.prototype._nativeConnect=AudioNode.prototype.connect,AudioNode.prototype.connect=function(e,r,n){if(e.input)Array.isArray(e.input)?(t(n)&&(n=0),this.connect(e.input[n])):this.connect(e.input,r,n);else try{
e instanceof AudioNode?this._nativeConnect(e,r,n):this._nativeConnect(e,r)}catch(i){throw new Error("error connecting to node: "+e)}});var r=function(e,r){t(e)||1===e?this.input=this.context.createGain():e>1&&(this.input=new Array(e)),t(r)||1===r?this.output=this.context.createGain():r>1&&(this.output=new Array(e))};r.context=e,r.prototype.context=r.context,r.prototype.bufferSize=2048,r.prototype.bufferTime=r.prototype.bufferSize/r.context.sampleRate,r.prototype.connect=function(t,e,r){Array.isArray(this.output)?(e=this.defaultArg(e,0),this.output[e].connect(t,0,r)):this.output.connect(t,e,r)},r.prototype.disconnect=function(t){Array.isArray(this.output)?(t=this.defaultArg(t,0),this.output[t].disconnect()):this.output.disconnect()},r.prototype.connectSeries=function(){if(arguments.length>1)for(var t=arguments[0],e=1;e<arguments.length;e++){var r=arguments[e];t.connect(r),t=r}},r.prototype.connectParallel=function(){var t=arguments[0];if(arguments.length>1)for(var e=1;e<arguments.length;e++){var r=arguments[e];t.connect(r)}},r.prototype.chain=function(){if(arguments.length>0)for(var t=this,e=0;e<arguments.length;e++){var r=arguments[e];t.connect(r),t=r}},r.prototype.fan=function(){if(arguments.length>0)for(var t=1;t<arguments.length;t++)this.connect(arguments[t])},AudioNode.prototype.chain=r.prototype.chain,AudioNode.prototype.fan=r.prototype.fan,r.prototype.defaultArg=function(e,r){if("object"==typeof e&&"object"==typeof r){var n={};for(var i in e)n[i]=this.defaultArg(e[i],e[i]);for(var o in r)n[o]=this.defaultArg(e[o],r[o]);return n}return t(e)?r:e},r.prototype.optionsObject=function(t,e,r){var n={};if(1===t.length&&"object"==typeof t[0])n=t[0];else for(var i=0;i<e.length;i++)n[e[i]]=t[i];return this.isUndef(r)?n:this.defaultArg(n,r)},r.prototype.isUndef=t,r.prototype.equalPowerScale=function(t){var e=.5*Math.PI;return Math.sin(t*e)},r.prototype.logScale=function(t){return Math.max(this.normalize(this.gainToDb(t),-100,0),0)},r.prototype.expScale=function(t){return this.dbToGain(this.interpolate(t,-100,0))},r.prototype.dbToGain=function(t){return Math.pow(2,t/6)},r.prototype.gainToDb=function(t){return 20*(Math.log(t)/Math.LN10)},r.prototype.interpolate=function(t,e,r){return t*(r-e)+e},r.prototype.normalize=function(t,e,r){if(e>r){var n=r;r=e,e=n}else if(e==r)return 0;return(t-e)/(r-e)},r.prototype.dispose=function(){this.isUndef(this.input)||(this.input instanceof AudioNode&&this.input.disconnect(),this.input=null),this.isUndef(this.output)||(this.output instanceof AudioNode&&this.output.disconnect(),this.output=null)};var n=null;r.prototype.noGC=function(){this.output.connect(n)},AudioNode.prototype.noGC=function(){this.connect(n)},r.prototype.now=function(){return this.context.currentTime},r.prototype.samplesToSeconds=function(t){return t/this.context.sampleRate},r.prototype.toSamples=function(t){var e=this.toSeconds(t);return Math.round(e*this.context.sampleRate)},r.prototype.toSeconds=function(t,e){if(e=this.defaultArg(e,this.now()),"number"==typeof t)return t;if("string"==typeof t){var r=0;return"+"===t.charAt(0)&&(t=t.slice(1),r=e),parseFloat(t)+r}return e},r.prototype.frequencyToSeconds=function(t){return 1/parseFloat(t)},r.prototype.secondsToFrequency=function(t){return 1/t};var i=[];return r._initAudioContext=function(t){t(r.context),i.push(t)},r.setContext=function(t){r.prototype.context=t,r.context=t;for(var e=0;e<i.length;e++)i[e](t)},r.extend=function(e,n){function i(){}t(n)&&(n=r),i.prototype=n.prototype,e.prototype=new i,e.prototype.constructor=e},r.startMobile=function(){var t=r.context.createOscillator(),e=r.context.createGain();e.gain.value=0,t.connect(e),e.connect(r.context.destination);var n=r.context.currentTime;t.start(n),t.stop(n+1)},r._initAudioContext(function(t){r.prototype.bufferTime=r.prototype.bufferSize/t.sampleRate,n=t.createGain(),n.gain.value=0,n.connect(t.destination)}),r}();var u;u=function(t){"use strict";return t.SignalBase=function(){},t.extend(t.SignalBase),t.SignalBase.prototype.connect=function(e,r,n){e instanceof t.Signal?e.setValue(0):e instanceof AudioParam&&(e.value=0),t.prototype.connect.call(this,e,r,n)},t.SignalBase.prototype.dispose=function(){t.prototype.dispose.call(this)},t.SignalBase}(h);var c;c=function(t){"use strict";return t.WaveShaper=function(t,e){this._shaper=this.input=this.output=this.context.createWaveShaper(),this._curve=null,Array.isArray(t)?this.setCurve(t):isFinite(t)||this.isUndef(t)?this._curve=new Float32Array(this.defaultArg(t,1024)):"function"==typeof t&&(this._curve=new Float32Array(this.defaultArg(e,1024)),this.setMap(t))},t.extend(t.WaveShaper,t.SignalBase),t.WaveShaper.prototype.setMap=function(t){for(var e=0,r=this._curve.length;r>e;e++){var n=e/r*2-1,i=e/(r-1)*2-1;this._curve[e]=t(n,e,i)}this._shaper.curve=this._curve},t.WaveShaper.prototype.setCurve=function(t){if(this._isSafari()){var e=t[0];t.unshift(e)}this._curve=new Float32Array(t),this._shaper.curve=this._curve},t.WaveShaper.prototype.setOversample=function(t){this._shaper.oversample=t},t.WaveShaper.prototype._isSafari=function(){var t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("safari")&&-1===t.indexOf("chrome")},t.WaveShaper.prototype.dispose=function(){t.prototype.dispose.call(this),this._shaper.disconnect(),this._shaper=null,this._curve=null},t.WaveShaper}(h);var l;l=function(t){"use strict";return t.Signal=function(e){this._scalar=this.context.createGain(),this.input=this.output=this.context.createGain(),this._syncRatio=1,this.value=this.defaultArg(e,0),t.Signal._constant.chain(this._scalar,this.output)},t.extend(t.Signal,t.SignalBase),t.Signal.prototype.getValue=function(){return this._scalar.gain.value},t.Signal.prototype.setValue=function(t){0===this._syncRatio?t=0:t*=this._syncRatio,this._scalar.gain.value=t},t.Signal.prototype.setValueAtTime=function(t,e){t*=this._syncRatio,this._scalar.gain.setValueAtTime(t,this.toSeconds(e))},t.Signal.prototype.setCurrentValueNow=function(t){t=this.defaultArg(t,this.now());var e=this.getValue();return this.cancelScheduledValues(t),this._scalar.gain.setValueAtTime(e,t),e},t.Signal.prototype.linearRampToValueAtTime=function(t,e){t*=this._syncRatio,this._scalar.gain.linearRampToValueAtTime(t,this.toSeconds(e))},t.Signal.prototype.exponentialRampToValueAtTime=function(t,e){t*=this._syncRatio;try{this._scalar.gain.exponentialRampToValueAtTime(t,this.toSeconds(e))}catch(r){this._scalar.gain.linearRampToValueAtTime(t,this.toSeconds(e))}},t.Signal.prototype.exponentialRampToValueNow=function(t,e){var r=this.now();this.setCurrentValueNow(r),"+"===e.toString().charAt(0)&&(e=e.substr(1)),this.exponentialRampToValueAtTime(t,r+this.toSeconds(e))},t.Signal.prototype.linearRampToValueNow=function(t,e){var r=this.now();this.setCurrentValueNow(r),t*=this._syncRatio,"+"===e.toString().charAt(0)&&(e=e.substr(1)),this._scalar.gain.linearRampToValueAtTime(t,r+this.toSeconds(e))},t.Signal.prototype.setTargetAtTime=function(t,e,r){t*=this._syncRatio,this._scalar.gain.setTargetAtTime(t,this.toSeconds(e),r)},t.Signal.prototype.setValueCurveAtTime=function(t,e,r){for(var n=0;n<t.length;n++)t[n]*=this._syncRatio;this._scalar.gain.setValueCurveAtTime(t,this.toSeconds(e),this.toSeconds(r))},t.Signal.prototype.cancelScheduledValues=function(t){this._scalar.gain.cancelScheduledValues(this.toSeconds(t))},t.Signal.prototype.sync=function(t,e){e?this._syncRatio=e:0!==t.getValue()?this._syncRatio=this.getValue()/t.getValue():this._syncRatio=0,this._scalar.disconnect(),this._scalar=this.context.createGain(),this.connectSeries(t,this._scalar,this.output),this._scalar.gain.value=this._syncRatio},t.Signal.prototype.unsync=function(){var e=this.getValue();this._scalar.disconnect(),this._scalar=this.context.createGain(),this._scalar.gain.value=e/this._syncRatio,this._syncRatio=1,t.Signal._constant.chain(this._scalar,this.output)},t.Signal.prototype.dispose=function(){t.prototype.dispose.call(this),this._scalar.disconnect(),this._scalar=null},Object.defineProperty(t.Signal.prototype,"value",{get:function(){return this.getValue()},set:function(t){this.setValue(t)}}),t.Signal._generator=null,t.Signal._constant=null,t._initAudioContext(function(e){t.Signal._generator=e.createOscillator(),t.Signal._constant=new t.WaveShaper([1,1]),t.Signal._generator.connect(t.Signal._constant),t.Signal._generator.start(0),t.Signal._generator.noGC()}),t.Signal}(h);var p;p=function(t){"use strict";return t.Add=function(e){t.call(this,2,0),this._sum=this.input[0]=this.input[1]=this.output=this.context.createGain(),this._value=null,isFinite(e)&&(this._value=new t.Signal(e),this._value.connect(this._sum))},t.extend(t.Add,t.SignalBase),t.Add.prototype.setValue=function(t){if(null===this._value)throw new Error("cannot switch from signal to number");this._value.setValue(t)},t.Add.prototype.dispose=function(){t.prototype.dispose.call(this),this._sum=null,this._value&&(this._value.dispose(),this._value=null)},t.Add}(h);var f;f=function(t){"use strict";return t.Multiply=function(e){t.call(this,2,0),this._mult=this.input[0]=this.output=this.context.createGain(),this._factor=this.input[1]=this.output.gain,this._factor.value=this.defaultArg(e,0)},t.extend(t.Multiply,t.SignalBase),t.Multiply.prototype.setValue=function(t){this._factor.value=t},t.Multiply.prototype.dispose=function(){t.prototype.dispose.call(this),this._mult=null,this._factor=null},t.Multiply}(h);var d;d=function(t){"use strict";return t.Scale=function(e,r){this._outputMin=this.defaultArg(e,0),this._outputMax=this.defaultArg(r,1),this._scale=this.input=new t.Multiply(1),this._add=this.output=new t.Add(0),this._scale.connect(this._add),this._setRange()},t.extend(t.Scale,t.SignalBase),t.Scale.prototype.setMin=function(t){this._outputMin=t,this._setRange()},t.Scale.prototype.setMax=function(t){this._outputMax=t,this._setRange()},t.Scale.prototype._setRange=function(){this._add.setValue(this._outputMin),this._scale.setValue(this._outputMax-this._outputMin)},t.Scale.prototype.dispose=function(){t.prototype.dispose.call(this),this._add.dispose(),this._add=null,this._scale.dispose(),this._scale=null},t.Scale}(h,p,f);var m;m=function(){"use strict";var e=l,n=p,i=f,o=d,a=h,s=r;a.setContext(s.audiocontext),t.Signal=function(t){var r=new e(t);return r},e.prototype.fade=e.prototype.linearRampToValueAtTime,i.prototype.fade=e.prototype.fade,n.prototype.fade=e.prototype.fade,o.prototype.fade=e.prototype.fade,e.prototype.setInput=function(t){t.connect(this)},i.prototype.setInput=e.prototype.setInput,n.prototype.setInput=e.prototype.setInput,o.prototype.setInput=e.prototype.setInput,e.prototype.add=function(t){var e=new n(t);return this.connect(e),e},i.prototype.add=e.prototype.add,n.prototype.add=e.prototype.add,o.prototype.add=e.prototype.add,e.prototype.mult=function(t){var e=new i(t);return this.connect(e),e},i.prototype.mult=e.prototype.mult,n.prototype.mult=e.prototype.mult,o.prototype.mult=e.prototype.mult,e.prototype.scale=function(e,r,n,i){var a,s;4===arguments.length?(a=t.prototype.map(n,e,r,0,1)-.5,s=t.prototype.map(i,e,r,0,1)-.5):(a=arguments[0],s=arguments[1]);var h=new o(a,s);return this.connect(h),h},i.prototype.scale=e.prototype.scale,n.prototype.scale=e.prototype.scale,o.prototype.scale=e.prototype.scale}(l,p,f,d,h,r);var g;g=function(){"use strict";var e=r,n=p,i=f,o=d;t.Oscillator=function(r,n){if("string"==typeof r){var i=n;n=r,r=i}if("number"==typeof n){var i=n;n=r,r=i}this.started=!1,this.oscillator=e.audiocontext.createOscillator(),this.f=r||440,this.oscillator.frequency.setValueAtTime(this.f,e.audiocontext.currentTime),this.oscillator.type=n||"sine";this.oscillator;this.input=e.audiocontext.createGain(),this.output=e.audiocontext.createGain(),this._freqMods=[],this.output.gain.value=.5,this.output.gain.setValueAtTime(.5,e.audiocontext.currentTime),this.oscillator.connect(this.output),this.panPosition=0,this.connection=e.input,this.panner=new t.Panner(this.output,this.connection,1),this.mathOps=[this.output],e.soundArray.push(this)},t.Oscillator.prototype.start=function(t,r){if(this.started){var n=e.audiocontext.currentTime;this.stop(n)}if(!this.started){var i=r||this.f,o=this.oscillator.type;this.oscillator=e.audiocontext.createOscillator(),this.oscillator.frequency.exponentialRampToValueAtTime(Math.abs(i),e.audiocontext.currentTime),this.oscillator.type=o,this.oscillator.connect(this.output),t=t||0,this.oscillator.start(t+e.audiocontext.currentTime),this.freqNode=this.oscillator.frequency;for(var a in this._freqMods)"undefined"!=typeof this._freqMods[a].connect&&this._freqMods[a].connect(this.oscillator.frequency);this.started=!0}},t.Oscillator.prototype.stop=function(t){if(this.started){var r=t||0,n=e.audiocontext.currentTime;this.oscillator.stop(r+n),this.started=!1}},t.Oscillator.prototype.amp=function(t,r,n){var i=this;if("number"==typeof t){var r=r||0,n=n||0,o=e.audiocontext.currentTime,a=this.output.gain.value;this.output.gain.cancelScheduledValues(o),this.output.gain.linearRampToValueAtTime(a,o+n),this.output.gain.linearRampToValueAtTime(t,o+n+r)}else{if(!t)return this.output.gain;console.log(t),t.connect(i.output.gain)}},t.Oscillator.prototype.fade=t.Oscillator.prototype.amp,t.Oscillator.prototype.getAmp=function(){return this.output.gain.value},t.Oscillator.prototype.freq=function(t,r,n){if("number"!=typeof t||isNaN(t)){if(!t)return this.oscillator.frequency;t.output&&(t=t.output),t.connect(this.oscillator.frequency),this._freqMods.push(t)}else{this.f=t;var i=e.audiocontext.currentTime,r=r||0,n=n||0,o=this.oscillator.frequency.value;this.oscillator.frequency.cancelScheduledValues(i),this.oscillator.frequency.setValueAtTime(o,i+n),t>0?this.oscillator.frequency.exponentialRampToValueAtTime(t,n+r+i):this.oscillator.frequency.linearRampToValueAtTime(t,n+r+i)}},t.Oscillator.prototype.getFreq=function(){return this.oscillator.frequency.value},t.Oscillator.prototype.setType=function(t){this.oscillator.type=t},t.Oscillator.prototype.getType=function(){return this.oscillator.type},t.Oscillator.prototype.connect=function(t){t?t.hasOwnProperty("input")?(this.panner.connect(t.input),this.connection=t.input):(this.panner.connect(t),this.connection=t):this.panner.connect(e.input)},t.Oscillator.prototype.disconnect=function(t){this.output.disconnect(),this.panner.disconnect(),this.output.connect(this.panner),this.oscMods=[]},t.Oscillator.prototype.pan=function(t,e){this.panPosition=t,this.panner.pan(t,e)},t.Oscillator.prototype.getPan=function(){return this.panPosition},t.Oscillator.prototype.dispose=function(){if(this.oscillator){var t=e.audiocontext.currentTime;this.stop(t),this.disconnect(),this.oscillator.disconnect(),this.panner=null,this.oscillator=null}this.osc2&&this.osc2.dispose()},t.Oscillator.prototype.phase=function(r){this.dNode||(this.dNode=e.audiocontext.createDelay(),this.output.disconnect(),this.output.connect(this.dNode),this.dNode.connect(this.panner));var n=e.audiocontext.currentTime;this.dNode.delayTime.linearRampToValueAtTime(t.prototype.map(r,0,1,0,1/this.oscillator.frequency.value),n)};var a=function(t,e,r,n,i){var o=t.oscillator;for(var a in t.mathOps)t.mathOps[a]instanceof i&&(o.disconnect(),t.mathOps[a].dispose(),r=a,r<t.mathOps.length-2&&(n=t.mathOps[a+1]));return r==t.mathOps.length-1&&t.mathOps.push(n),a>0&&(o=t.mathOps[a-1]),o.disconnect(),o.connect(e),e.connect(n),t.mathOps[r]=e,t};t.Oscillator.prototype.add=function(t){var e=new n(t),r=this.mathOps.length-1,i=this.output;return a(this,e,r,i,n)},t.Oscillator.prototype.mult=function(t){var e=new i(t),r=this.mathOps.length-1,n=this.output;return a(this,e,r,n,i)},t.Oscillator.prototype.scale=function(e,r,n,i){var s,h;4===arguments.length?(s=t.prototype.map(n,e,r,0,1)-.5,h=t.prototype.map(i,e,r,0,1)-.5):(s=arguments[0],h=arguments[1]);var u=new o(s,h),c=this.mathOps.length-1,l=this.output;return a(this,u,c,l,o)},t.SinOsc=function(e){t.Oscillator.call(this,e,"sine")},t.SinOsc.prototype=Object.create(t.Oscillator.prototype),t.TriOsc=function(e){t.Oscillator.call(this,e,"triangle")},t.TriOsc.prototype=Object.create(t.Oscillator.prototype),t.SawOsc=function(e){t.Oscillator.call(this,e,"sawtooth")},t.SawOsc.prototype=Object.create(t.Oscillator.prototype),t.SqrOsc=function(e){t.Oscillator.call(this,e,"square")},t.SqrOsc.prototype=Object.create(t.Oscillator.prototype)}(r,l,p,f,d);var y;y=function(){"use strict";var e=r,n=p,i=f,o=d,a=h;a.setContext(e.audiocontext);var s=null,u=!1;t.Env=function(r,n,i,o,a,s,h,u){this.aTime=r,this.aLevel=n,this.dTime=i||0,this.dLevel=o||0,this.sTime=a||0,this.sLevel=s||0,this.rTime=h||0,this.rLevel=u||0,this.output=e.audiocontext.createGain(),this.control=new t.Signal,this.control.connect(this.output),this.connection=null,this.mathOps=[this.control],e.soundArray.push(this)},t.Env.prototype.set=function(t,e,r,n,i,o,a,s){this.aTime=t,this.aLevel=e,this.dTime=r||0,this.dLevel=n||0,this.sTime=i||0,this.sLevel=o||0,this.rTime=a||0,this.rLevel=s||0},t.Env.prototype.setInput=function(t){for(var e=0;e<arguments.length;e++)this.connect(arguments[e])},t.Env.prototype.ctrl=function(t){this.connect(t)},t.Env.prototype.play=function(t,r){var n=e.audiocontext.currentTime,i=r||0,o=n+i;t&&this.connection!==t&&this.connect(t);var a=this.control.getValue();this.control.cancelScheduledValues(o),this.control.linearRampToValueAtTime(a,o),this.control.linearRampToValueAtTime(this.aLevel,o+this.aTime),this.control.linearRampToValueAtTime(this.dLevel,o+this.aTime+this.dTime),this.control.linearRampToValueAtTime(this.sLevel,o+this.aTime+this.dTime+this.sTime),this.control.linearRampToValueAtTime(this.rLevel,o+this.aTime+this.dTime+this.sTime+this.rTime);o+this.aTime+this.dTime+this.sTime+this.rTime},t.Env.prototype.triggerAttack=function(t,r){var n=e.audiocontext.currentTime,i=r||0,o=n+i;this.lastAttack=o,u=!0;var a=this.control.getValue();console.log(a),this.control.cancelScheduledValues(o),this.control.linearRampToValueAtTime(a,o),t&&this.connection!==t&&this.connect(t),this.control.linearRampToValueAtTime(this.aLevel,o+this.aTime),this.control.linearRampToValueAtTime(this.aLevel,o+this.aTime),this.control.linearRampToValueAtTime(this.dLevel,o+this.aTime+this.dTime),this.control.linearRampToValueAtTime(this.sLevel,o+this.aTime+this.dTime+this.sTime)},t.Env.prototype.triggerRelease=function(t,r){if(u){var n,i=e.audiocontext.currentTime,o=r||0,a=i+o;if(t&&this.connection!==t&&this.connect(t),this.control.cancelScheduledValues(a),i-this.lastAttack<this.aTime){var h=this.aTime-(a-this.lastAttack);this.control.linearRampToValueAtTime(this.aLevel,a+h),this.control.linearRampToValueAtTime(this.dLevel,a+h+this.dTime),this.control.linearRampToValueAtTime(this.sLevel,a+h+this.dTime+this.sTime),this.control.linearRampToValueAtTime(this.rLevel,a+h+this.dTime+this.sTime+this.rTime),n=a+this.dTime+this.sTime+this.rTime}else if(i-this.lastAttack<this.aTime+this.dTime){var c=this.aTime+this.dTime-(i-this.lastAttack);this.control.linearRampToValueAtTime(this.dLevel,a+c),this.control.linearRampToValueAtTime(this.sLevel,a+c+.01),this.control.linearRampToValueAtTime(this.rLevel,a+c+.01+this.rTime),n=a+this.sTime+this.rTime}else if(i-this.lastAttack<this.aTime+this.dTime+this.sTime){var l=this.aTime+this.dTime+this.sTime-(i-this.lastAttack);this.control.linearRampToValueAtTime(this.sLevel,a+l),this.control.linearRampToValueAtTime(this.rLevel,a+l+this.rTime),n=a+this.rTime}else this.control.linearRampToValueAtTime(this.sLevel,a),this.control.linearRampToValueAtTime(this.rLevel,a+this.rTime),n=a+this.dTime+this.sTime+this.rTime;var p=a+this.aTime+this.dTime+this.sTime+this.rTime;this.connection&&this.connection.hasOwnProperty("oscillator")?(s=this.connection.oscillator,s.stop(p+.01)):this.connect&&this.connection.hasOwnProperty("source")&&(s=this.connection.source,s.stop(p+.01)),u=!1}},t.Env.prototype.connect=function(r){this.connection=r,(r instanceof t.Oscillator||r instanceof t.SoundFile||r instanceof t.AudioIn||r instanceof t.Reverb||r instanceof t.Noise||r instanceof t.Filter||r instanceof t.Delay)&&(r=r.output.gain),r instanceof AudioParam&&r.setValueAtTime(0,e.audiocontext.currentTime),r instanceof t.Signal&&r.setValue(0),this.output.connect(r)},t.Env.prototype.disconnect=function(t){this.output.disconnect()},t.Env.prototype.add=function(e){var r=new n(e),i=this.mathOps.length,o=this.output;return t.prototype._mathChain(this,r,i,o,n)},t.Env.prototype.mult=function(e){var r=new i(e),n=this.mathOps.length,o=this.output;return t.prototype._mathChain(this,r,n,o,i)},t.Env.prototype.scale=function(e,r,n,i){var a=new o(e,r,n,i),s=this.mathOps.length,h=this.output;return t.prototype._mathChain(this,a,s,h,o)},t.Env.prototype.dispose=function(){e.audiocontext.currentTime;this.disconnect();try{this.control.dispose(),this.control=null}catch(t){}for(var r=1;r<this.mathOps.length;r++)mathOps[r].dispose()}}(r,p,f,d,h);var v;v=function(){"use strict";function e(){for(var t=n.audiocontext,e=t.createBuffer(1,2048,t.sampleRate),r=e.getChannelData(0),i=0;2048>i;i++)r[i]=1;var o=t.createBufferSource();return o.buffer=e,o.loop=!0,o}var n=r;t.Pulse=function(r,i){t.Oscillator.call(this,r,"sawtooth"),this.w=i||0,this.osc2=new t.SawOsc(r),this.dNode=n.audiocontext.createDelay(),this.dcOffset=e(),this.dcGain=n.audiocontext.createGain(),this.dcOffset.connect(this.dcGain),this.dcGain.connect(this.output),this.f=r||440;var o=this.w/this.oscillator.frequency.value;this.dNode.delayTime.value=o,this.dcGain.gain.value=1.7*(.5-this.w),this.osc2.disconnect(),this.osc2.panner.disconnect(),this.osc2.amp(-1),this.osc2.output.connect(this.dNode),this.dNode.connect(this.output),this.output.gain.value=1,this.output.connect(this.panner)},t.Pulse.prototype=Object.create(t.Oscillator.prototype),t.Pulse.prototype.width=function(e){if("number"==typeof e){if(1>=e&&e>=0){this.w=e;var r=this.w/this.oscillator.frequency.value;this.dNode.delayTime.value=r}this.dcGain.gain.value=1.7*(.5-this.w)}else{e.connect(this.dNode.delayTime);var n=new t.SignalAdd(-.5);n.setInput(e),n=n.mult(-1),n=n.mult(1.7),n.connect(this.dcGain.gain)}},t.Pulse.prototype.start=function(t,r){var i=n.audiocontext.currentTime,o=r||0;if(!this.started){var a=t||this.f,s=this.oscillator.type;this.oscillator=n.audiocontext.createOscillator(),this.oscillator.frequency.setValueAtTime(a,i),this.oscillator.type=s,this.oscillator.connect(this.output),this.oscillator.start(o+i),this.osc2.oscillator=n.audiocontext.createOscillator(),this.osc2.oscillator.frequency.setValueAtTime(a,o+i),this.osc2.oscillator.type=s,this.osc2.oscillator.connect(this.osc2.output),this.osc2.start(o+i),this.freqNode=[this.oscillator.frequency,this.osc2.oscillator.frequency],this.dcOffset=e(),this.dcOffset.connect(this.dcGain),this.dcOffset.start(o+i),void 0!==this.mods&&void 0!==this.mods.frequency&&(this.mods.frequency.connect(this.freqNode[0]),this.mods.frequency.connect(this.freqNode[1])),this.started=!0,this.osc2.started=!0}},t.Pulse.prototype.stop=function(t){if(this.started){var e=t||0,r=n.audiocontext.currentTime;this.oscillator.stop(e+r),this.osc2.oscillator.stop(e+r),this.dcOffset.stop(e+r),this.started=!1,this.osc2.started=!1}},t.Pulse.prototype.freq=function(t,e,r){if("number"==typeof t){this.f=t;var i=n.audiocontext.currentTime,e=e||0,r=r||0,o=this.oscillator.frequency.value;this.oscillator.frequency.cancelScheduledValues(i),this.oscillator.frequency.setValueAtTime(o,i+r),this.oscillator.frequency.exponentialRampToValueAtTime(t,r+e+i),this.osc2.oscillator.frequency.cancelScheduledValues(i),this.osc2.oscillator.frequency.setValueAtTime(o,i+r),this.osc2.oscillator.frequency.exponentialRampToValueAtTime(t,r+e+i),this.freqMod&&(this.freqMod.output.disconnect(),this.freqMod=null)}else t.output&&(t.output.disconnect(),t.output.connect(this.oscillator.frequency),t.output.connect(this.osc2.oscillator.frequency),this.freqMod=t)}}(r,g);var _;_=function(){"use strict";var e=r;t.Noise=function(e){t.Oscillator.call(this),delete this.f,delete this.freq,delete this.oscillator,this.buffer=n},t.Noise.prototype=Object.create(t.Oscillator.prototype);var n=function(){for(var t=2*e.audiocontext.sampleRate,r=e.audiocontext.createBuffer(1,t,e.audiocontext.sampleRate),n=r.getChannelData(0),i=0;t>i;i++)n[i]=2*Math.random()-1;return r.type="white",r}(),i=function(){var t,r,n,i,o,a,s,h=2*e.audiocontext.sampleRate,u=e.audiocontext.createBuffer(1,h,e.audiocontext.sampleRate),c=u.getChannelData(0);t=r=n=i=o=a=s=0;for(var l=0;h>l;l++){var p=2*Math.random()-1;t=.99886*t+.0555179*p,r=.99332*r+.0750759*p,n=.969*n+.153852*p,i=.8665*i+.3104856*p,o=.55*o+.5329522*p,a=-.7616*a-.016898*p,c[l]=t+r+n+i+o+a+s+.5362*p,c[l]*=.11,s=.115926*p}return u.type="pink",u}(),o=function(){for(var t=2*e.audiocontext.sampleRate,r=e.audiocontext.createBuffer(1,t,e.audiocontext.sampleRate),n=r.getChannelData(0),i=0,o=0;t>o;o++){var a=2*Math.random()-1;n[o]=(i+.02*a)/1.02,i=n[o],n[o]*=3.5}return r.type="brown",r}();t.Noise.prototype.setType=function(t){switch(t){case"white":this.buffer=n;break;case"pink":this.buffer=i;break;case"brown":this.buffer=o;break;default:this.buffer=n}if(this.started){var r=e.audiocontext.currentTime;this.stop(r),this.start(r+.01)}},t.Noise.prototype.getType=function(){return this.buffer.type},t.Noise.prototype.start=function(){this.started&&this.stop(),this.noise=e.audiocontext.createBufferSource(),this.noise.buffer=this.buffer,this.noise.loop=!0,this.noise.connect(this.output);var t=e.audiocontext.currentTime;this.noise.start(t),this.started=!0},t.Noise.prototype.stop=function(){var t=e.audiocontext.currentTime;this.noise&&(this.noise.stop(t),this.started=!1)},t.Noise.prototype.dispose=function(){var t=e.audiocontext.currentTime;this.noise&&(this.noise.disconnect(),this.stop(t)),this.output&&this.output.disconnect(),this.panner&&this.panner.disconnect(),this.output=null,this.panner=null,this.buffer=null,this.noise=null}}(r);var x;x=function(){"use strict";var e=r;t.AudioIn=function(){this.input=e.audiocontext.createGain(),this.output=e.audiocontext.createGain(),this.stream=null,this.mediaStream=null,this.currentSource=0,this.enabled=!1,this.amplitude=new t.Amplitude,this.output.connect(this.amplitude.input),"undefined"==typeof window.MediaStreamTrack?window.alert("This browser does not support MediaStreamTrack"):"function"==typeof window.MediaStreamTrack.getSources&&window.MediaStreamTrack.getSources(this._gotSources),e.soundArray.push(this)},t.AudioIn.prototype.start=function(){var t=this;if(e.inputSources[t.currentSource]){var r=e.inputSources[t.currentSource].id,n={audio:{optional:[{sourceId:r}]}};navigator.getUserMedia(n,this._onStream=function(r){t.stream=r,t.enabled=!0,t.mediaStream=e.audiocontext.createMediaStreamSource(r),t.mediaStream.connect(t.output),t.amplitude.setInput(t.output)},this._onStreamError=function(t){console.error(t)})}else window.navigator.getUserMedia({audio:!0},this._onStream=function(r){t.stream=r,t.enabled=!0,t.mediaStream=e.audiocontext.createMediaStreamSource(r),t.mediaStream.connect(t.output),t.amplitude.setInput(t.output)},this._onStreamError=function(t){console.error(t)})},t.AudioIn.prototype.stop=function(){this.stream&&this.stream.stop()},t.AudioIn.prototype.connect=function(t){t?t.hasOwnProperty("input")?this.output.connect(t.input):t.hasOwnProperty("analyser")?this.output.connect(t.analyser):this.output.connect(t):this.output.connect(e.input)},t.AudioIn.prototype.disconnect=function(t){this.output.disconnect(t),this.output.connect(this.amplitude.input)},t.AudioIn.prototype.getLevel=function(t){return t&&(this.amplitude.smoothing=t),this.amplitude.getLevel()},t.AudioIn.prototype._gotSources=function(t){for(var e=0;e<t.length;e++){var r=t[e];if("audio"===r.kind)return r}},t.AudioIn.prototype.amp=function(t,r){if(r){var n=r||0,i=this.output.gain.value;this.output.gain.cancelScheduledValues(e.audiocontext.currentTime),this.output.gain.setValueAtTime(i,e.audiocontext.currentTime),this.output.gain.linearRampToValueAtTime(t,n+e.audiocontext.currentTime)}else this.output.gain.cancelScheduledValues(e.audiocontext.currentTime),this.output.gain.setValueAtTime(t,e.audiocontext.currentTime)},t.AudioIn.prototype.listSources=function(){return console.log("listSources is deprecated - please use AudioIn.getSources"),console.log("input sources: "),e.inputSources.length>0?e.inputSources:"This browser does not support MediaStreamTrack.getSources()"},t.AudioIn.prototype.getSources=function(t){"function"==typeof window.MediaStreamTrack.getSources?window.MediaStreamTrack.getSources(function(r){for(var n=0,i=r.length;i>n;n++){var o=r[n];"audio"===o.kind&&e.inputSources.push(o)}t(e.inputSources)}):console.log("This browser does not support MediaStreamTrack.getSources()")},t.AudioIn.prototype.setSource=function(t){var r=this;e.inputSources.length>0&&t<e.inputSources.length?(r.currentSource=t,console.log("set source to "+e.inputSources[r.currentSource].id)):console.log("unable to set input source")},t.AudioIn.prototype.dispose=function(){this.stop(),this.output&&this.output.disconnect(),this.amplitude&&this.amplitude.disconnect(),this.amplitude=null,this.output=null}}(r);var b;b=function(){"use strict";var e=r;t.Filter=function(t){this.ac=e.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.biquad=this.ac.createBiquadFilter(),this.input.connect(this.biquad),this.biquad.connect(this.output),this.connect(),t&&this.setType(t)},t.Filter.prototype.process=function(t,e,r){t.connect(this.input),this.set(e,r)},t.Filter.prototype.set=function(t,e,r){t&&this.freq(t,r),e&&this.res(e,r)},t.Filter.prototype.freq=function(t,e){var r=this,n=e||0;return 0>=t&&(t=1),"number"==typeof t?(r.biquad.frequency.value=t,r.biquad.frequency.cancelScheduledValues(this.ac.currentTime+.01+n),r.biquad.frequency.exponentialRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.biquad.frequency),r.biquad.frequency.value},t.Filter.prototype.res=function(t,e){var r=this,n=e||0;return"number"==typeof t?(r.biquad.Q.value=t,r.biquad.Q.cancelScheduledValues(r.ac.currentTime+.01+n),r.biquad.Q.linearRampToValueAtTime(t,r.ac.currentTime+.02+n)):t&&freq.connect(this.biquad.Q),r.biquad.Q.value},t.Filter.prototype.setType=function(t){this.biquad.type=t},t.Filter.prototype.amp=function(t,r,n){var r=r||0,n=n||0,i=e.audiocontext.currentTime,o=this.output.gain.value;this.output.gain.cancelScheduledValues(i),this.output.gain.linearRampToValueAtTime(o,i+n+.001),this.output.gain.linearRampToValueAtTime(t,i+n+r+.001)},t.Filter.prototype.connect=function(e){var r=e||t.soundOut.input;this.output.connect(r)},t.Filter.prototype.disconnect=function(){this.output.disconnect()},t.LowPass=function(){t.Filter.call(this,"lowpass")},t.LowPass.prototype=Object.create(t.Filter.prototype),t.HighPass=function(){t.Filter.call(this,"highpass")},t.HighPass.prototype=Object.create(t.Filter.prototype),t.BandPass=function(){t.Filter.call(this,"bandpass")},t.BandPass.prototype=Object.create(t.Filter.prototype)}(r);var w;w=function(){"use strict";var e=r;t.Delay=function(){this.ac=e.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this._split=this.ac.createChannelSplitter(2),this._merge=this.ac.createChannelMerger(2),this._leftGain=this.ac.createGain(),this._rightGain=this.ac.createGain(),this.leftDelay=this.ac.createDelay(),this.rightDelay=this.ac.createDelay(),this._leftFilter=new t.Filter,this._rightFilter=new t.Filter,this._leftFilter.disconnect(),this._rightFilter.disconnect(),this.lowPass=this._leftFilter,this._leftFilter.biquad.frequency.setValueAtTime(1200,this.ac.currentTime),this._rightFilter.biquad.frequency.setValueAtTime(1200,this.ac.currentTime),this._leftFilter.biquad.Q.setValueAtTime(.3,this.ac.currentTime),this._rightFilter.biquad.Q.setValueAtTime(.3,this.ac.currentTime),this.input.connect(this._split),this.leftDelay.connect(this._leftGain),this.rightDelay.connect(this._rightGain),this._leftGain.connect(this._leftFilter.input),this._rightGain.connect(this._rightFilter.input),this._merge.connect(this.output),this.output.connect(t.soundOut.input),this._leftFilter.biquad.gain.setValueAtTime(1,this.ac.currentTime),this._rightFilter.biquad.gain.setValueAtTime(1,this.ac.currentTime),
this.setType(0),this._maxDelay=this.leftDelay.delayTime.maxValue},t.Delay.prototype.process=function(t,e,r,n){var i=r||0,o=e||0;if(i>=1)throw new Error("Feedback value will force a positive feedback loop.");if(o>=this._maxDelay)throw new Error("Delay Time exceeds maximum delay time of "+this._maxDelay+" second.");t.connect(this.input),this.leftDelay.delayTime.setValueAtTime(o,this.ac.currentTime),this.rightDelay.delayTime.setValueAtTime(o,this.ac.currentTime),this._leftGain.gain.setValueAtTime(i,this.ac.currentTime),this._rightGain.gain.setValueAtTime(i,this.ac.currentTime),n&&(this._leftFilter.freq(n),this._rightFilter.freq(n))},t.Delay.prototype.delayTime=function(t){"number"!=typeof t?(t.connect(this.leftDelay.delayTime),t.connect(this.rightDelay.delayTime)):(this.leftDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.rightDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.leftDelay.delayTime.linearRampToValueAtTime(t,this.ac.currentTime),this.rightDelay.delayTime.linearRampToValueAtTime(t,this.ac.currentTime))},t.Delay.prototype.feedback=function(t){if("number"!=typeof t)t.connect(this._leftGain.gain),t.connect(this._rightGain.gain);else{if(t>=1)throw new Error("Feedback value will force a positive feedback loop.");this._leftGain.gain.exponentialRampToValueAtTime(t,this.ac.currentTime),this._rightGain.gain.exponentialRampToValueAtTime(t,this.ac.currentTime)}},t.Delay.prototype.filter=function(t,e){this._leftFilter.set(t,e),this._rightFilter.set(t,e)},t.Delay.prototype.setType=function(t){switch(1===t&&(t="pingPong"),this._split.disconnect(),this._leftFilter.disconnect(),this._rightFilter.disconnect(),this._split.connect(this.leftDelay,0),this._split.connect(this.rightDelay,1),t){case"pingPong":this._rightFilter.setType(this._leftFilter.biquad.type),this._leftFilter.output.connect(this._merge,0,0),this._rightFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.rightDelay),this._rightFilter.output.connect(this.leftDelay);break;default:this._leftFilter.output.connect(this._merge,0,0),this._leftFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.leftDelay),this._leftFilter.output.connect(this.rightDelay)}},t.Delay.prototype.amp=function(t,r,n){var r=r||0,n=n||0,i=e.audiocontext.currentTime,o=this.output.gain.value;this.output.gain.cancelScheduledValues(i),this.output.gain.linearRampToValueAtTime(o,i+n+.001),this.output.gain.linearRampToValueAtTime(t,i+n+r+.001)},t.Delay.prototype.connect=function(e){var r=e||t.soundOut.input;this.output.connect(r)},t.Delay.prototype.disconnect=function(){this.output.disconnect()}}(r,b);var S;S=function(){"use strict";var e=r;t.Reverb=function(){this.ac=e.audiocontext,this.convolverNode=this.ac.createConvolver(),this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.input.gain.value=.5,this.input.connect(this.convolverNode),this.convolverNode.connect(this.output),this._seconds=3,this._decay=2,this._reverse=!1,this._buildImpulse(),this.connect(),e.soundArray.push(this)},t.Reverb.prototype.process=function(t,e,r,n){t.connect(this.input);var i=!1;e&&(this._seconds=e,i=!0),r&&(this._decay=r),n&&(this._reverse=n),i&&this._buildImpulse()},t.Reverb.prototype.set=function(t,e,r){var n=!1;t&&(this._seconds=t,n=!0),e&&(this._decay=e),r&&(this._reverse=r),n&&this._buildImpulse()},t.Reverb.prototype.amp=function(t,r,n){var r=r||0,n=n||0,i=e.audiocontext.currentTime,o=this.output.gain.value;this.output.gain.cancelScheduledValues(i),this.output.gain.linearRampToValueAtTime(o,i+n+.001),this.output.gain.linearRampToValueAtTime(t,i+n+r+.001)},t.Reverb.prototype.connect=function(e){var r=e||t.soundOut.input;this.output.connect(r.input?r.input:r)},t.Reverb.prototype.disconnect=function(){this.output.disconnect()},t.Reverb.prototype._buildImpulse=function(){var t,e,r=this.ac.sampleRate,n=r*this._seconds,i=this._decay,o=this.ac.createBuffer(2,n,r),a=o.getChannelData(0),s=o.getChannelData(1);for(e=0;n>e;e++)t=this.reverse?n-e:e,a[e]=(2*Math.random()-1)*Math.pow(1-t/n,i),s[e]=(2*Math.random()-1)*Math.pow(1-t/n,i);this.convolverNode.buffer=o},t.Reverb.prototype.dispose=function(){this.convolverNode&&(this.convolverNode.buffer=null,this.convolverNode=null),"undefined"!=typeof this.output&&(this.output.disconnect(),this.output=null),"undefined"!=typeof this.panner&&(this.panner.disconnect(),this.panner=null)},t.Convolver=function(t,r){this.ac=e.audiocontext,this.convolverNode=this.ac.createConvolver(),this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.input.gain.value=.5,this.input.connect(this.convolverNode),this.convolverNode.connect(this.output),t?(this.impulses=[],this._loadBuffer(t,r)):(this._seconds=3,this._decay=2,this._reverse=!1,this._buildImpulse()),this.connect(),e.soundArray.push(this)},t.Convolver.prototype=Object.create(t.Reverb.prototype),t.prototype.registerPreloadMethod("createConvolver",t),t.prototype.createConvolver=function(e,r){window.location.origin.indexOf("file://")>-1&&"undefined"===window.cordova&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var n=new t.Convolver(e,r);return n.impulses=[],n},t.Convolver.prototype._loadBuffer=function(e,r){e=t.prototype._checkFileFormats(e);var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer";var i=this;n.onload=function(){var o=t.prototype.getAudioContext();o.decodeAudioData(n.response,function(t){var n={},o=e.split("/");n.name=o[o.length-1],n.audioBuffer=t,i.impulses.push(n),i.convolverNode.buffer=n.audioBuffer,r&&r(n)})},n.send()},t.Convolver.prototype.set=null,t.Convolver.prototype.process=function(t){t.connect(this.input)},t.Convolver.prototype.impulses=[],t.Convolver.prototype.addImpulse=function(t,e){window.location.origin.indexOf("file://")>-1&&"undefined"===window.cordova&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this._loadBuffer(t,e)},t.Convolver.prototype.resetImpulse=function(t,e){window.location.origin.indexOf("file://")>-1&&"undefined"===window.cordova&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this.impulses=[],this._loadBuffer(t,e)},t.Convolver.prototype.toggleImpulse=function(t){if("number"==typeof t&&t<this.impulses.length&&(this.convolverNode.buffer=this.impulses[t].audioBuffer),"string"==typeof t)for(var e=0;e<this.impulses.length;e++)if(this.impulses[e].name===t){this.convolverNode.buffer=this.impulses[e].audioBuffer;break}},t.Convolver.prototype.dispose=function(){for(var t in this.impulses)this.impulses[t]=null;this.convolverNode.disconnect(),this.concolverNode=null,"undefined"!=typeof this.output&&(this.output.disconnect(),this.output=null),"undefined"!=typeof this.panner&&(this.panner.disconnect(),this.panner=null)}}(r,e);var M;M=function(t){"use strict";return t.Clock=function(e,r){this._oscillator=null,this._jsNode=this.context.createScriptProcessor(this.bufferSize,1,1),this._jsNode.onaudioprocess=this._processBuffer.bind(this),this._controlSignal=new t.Signal(1),this._upTick=!1,this.tick=this.defaultArg(r,function(){}),this._jsNode.noGC(),this.setRate(e)},t.extend(t.Clock),t.Clock.prototype.setRate=function(t,e){var r=this.secondsToFrequency(this.toSeconds(t));e?this._controlSignal.exponentialRampToValueNow(r,e):(this._controlSignal.cancelScheduledValues(0),this._controlSignal.setValue(r))},t.Clock.prototype.getRate=function(){return this._controlSignal.getValue()},t.Clock.prototype.start=function(t){this._oscillator=this.context.createOscillator(),this._oscillator.type="square",this._oscillator.connect(this._jsNode),this._controlSignal.connect(this._oscillator.frequency),this._upTick=!1;var e=this.toSeconds(t);this._oscillator.start(e),this._oscillator.onended=function(){}},t.Clock.prototype.stop=function(t,e){var r=this.toSeconds(t);this._oscillator.onended=e,this._oscillator.stop(r)},t.Clock.prototype._processBuffer=function(t){for(var e=this.defaultArg(t.playbackTime,this.now()),r=this._jsNode.bufferSize,n=t.inputBuffer.getChannelData(0),i=this._upTick,o=this,a=0;r>a;a++){var s=n[a];s>0&&!i?(i=!0,setTimeout(function(){var t=e+o.samplesToSeconds(a+2*r);return function(){o.tick(t)}}(),0)):0>s&&i&&(i=!1)}this._upTick=i},t.Clock.prototype.dispose=function(){this._jsNode.disconnect(),this._controlSignal.dispose(),this._oscillator&&(this._oscillator.onended(),this._oscillator.disconnect()),this._jsNode.onaudioprocess=function(){},this._jsNode=null,this._controlSignal=null,this._oscillator=null},t.Clock}(h);var T;T=function(){"use strict";var e=r,n=M,i=e.audiocontext;t.Metro=function(){this.clock=new n(i.sampleRate,this.ontick.bind(this)),this.syncedParts=[],this.bpm=120,this._init(),this.tickCallback=function(){}};var o=0,a=0;t.Metro.prototype.ontick=function(t){var r=t-o,n=t-e.audiocontext.currentTime;if(!(-.02>=r-a)){o=t;for(var i in this.syncedParts){var s=this.syncedParts[i];s.incrementStep(n);for(var h in s.phrases){var u=s.phrases[h],c=u.sequence,l=this.metroTicks%c.length;0!==c[l]&&(this.metroTicks<c.length||!u.looping)&&u.callback(n,c[l])}}this.metroTicks+=1,this.tickCallback(n)}},t.Metro.prototype.setBPM=function(t,r){var n=60/(t*this.tatums);a=n;this.clock.setRate(n,r+e.audiocontext.currentTime),this.bpm=t},t.Metro.prototype.getBPM=function(t){return this.clock.getRate()/this.tatums*60},t.Metro.prototype._init=function(){this.metroTicks=0},t.Metro.prototype.resetSync=function(t){this.syncedParts=[t]},t.Metro.prototype.pushSync=function(t){this.syncedParts.push(t)},t.Metro.prototype.start=function(t){var e=t||0;this.clock.start(e),this.setBPM(this.bpm)},t.Metro.prototype.stop=function(t){var e=t||0;this.clock._oscillator&&this.clock.stop(e)},t.Metro.prototype.beatLength=function(t){this.tatums=1/t/4}}(r,M);var E;E=function(){"use strict";function e(t){t.currentPart++,t.currentPart>=t.parts.length?(t.scoreStep=0,t.onended()):(t.scoreStep=0,t.parts[t.currentPart-1].stop(),t.parts[t.currentPart].start())}var n=r,i=120;t.prototype.setBPM=function(t,e){i=t;for(var r in n.parts)n.parts[r].setBPM(i,e)},t.Phrase=function(t,e,r){this.phraseStep=0,this.name=t,this.callback=e,this.sequence=r},t.Part=function(e,r){this.length=e||0,this.partStep=0,this.phrases=[],this.looping=!1,this.isPlaying=!1,this.onended=function(){this.stop()},this.tatums=r||.0625,this.metro=new t.Metro,this.metro._init(),this.metro.beatLength(this.tatums),this.metro.setBPM(i),n.parts.push(this),this.callback=function(){}},t.Part.prototype.setBPM=function(t,e){this.metro.setBPM(t,e)},t.Part.prototype.getBPM=function(){return this.metro.getBPM()},t.Part.prototype.start=function(t){if(!this.isPlaying){this.isPlaying=!0,this.metro.resetSync(this);var e=t||0;this.metro.start(e)}},t.Part.prototype.loop=function(t){this.looping=!0,this.onended=function(){this.partStep=0};var e=t||0;this.start(e)},t.Part.prototype.noLoop=function(){this.looping=!1,this.onended=function(){this.stop()}},t.Part.prototype.stop=function(t){this.partStep=0,this.pause(t)},t.Part.prototype.pause=function(t){this.isPlaying=!1;var e=t||0;this.metro.stop(e)},t.Part.prototype.addPhrase=function(e,r,n){var i;if(3===arguments.length)i=new t.Phrase(e,r,n);else{if(!(arguments[0]instanceof t.Phrase))throw"invalid input. addPhrase accepts name, callback, array or a p5.Phrase";i=arguments[0]}this.phrases.push(i),i.sequence.length>this.length&&(this.length=i.sequence.length)},t.Part.prototype.removePhrase=function(t){for(var e in this.phrases)this.phrases[e].name===t&&this.phrases.split(e,1)},t.Part.prototype.getPhrase=function(t){for(var e in this.phrases)if(this.phrases[e].name===t)return this.phrases[e]},t.Part.prototype.replaceSequence=function(t,e){for(var r in this.phrases)this.phrases[r].name===t&&(this.phrases[r].sequence=e)},t.Part.prototype.incrementStep=function(t){this.partStep<this.length-1?(this.callback(t),this.partStep+=1):(this.looping&&this.callback(t),this.onended(),this.partStep=0)},t.Part.prototype.onStep=function(t){this.callback=t},t.Score=function(){this.parts=[],this.currentPart=0;var t=this;for(var r in arguments)this.parts[r]=arguments[r],this.parts[r].nextPart=this.parts[r+1],this.parts[r].onended=function(){t.resetPart(r),e(t)};this.looping=!1},t.Score.prototype.onended=function(){this.looping?this.parts[0].start():this.parts[this.parts.length-1].onended=function(){this.stop(),this.resetParts()},this.currentPart=0},t.Score.prototype.start=function(){this.parts[this.currentPart].start(),this.scoreStep=0},t.Score.prototype.stop=function(){this.parts[this.currentPart].stop(),this.currentPart=0,this.scoreStep=0},t.Score.prototype.pause=function(){this.parts[this.currentPart].stop()},t.Score.prototype.loop=function(){this.looping=!0,this.start()},t.Score.prototype.noLoop=function(){this.looping=!1},t.Score.prototype.resetParts=function(){for(var t in this.parts)this.resetPart(t)},t.Score.prototype.resetPart=function(t){this.parts[t].stop(),this.parts[t].partStep=0;for(var e in this.parts[t].phrases)this.parts[t].phrases[e].phraseStep=0},t.Score.prototype.setBPM=function(t,e){for(var r in this.parts)this.parts[r].setBPM(t,e)}}(r);var C;C=function(){"use strict";function e(t,e){for(var r=t.length+e.length,n=new Float32Array(r),i=0,o=0;r>o;)n[o++]=t[i],n[o++]=e[i],i++;return n}function n(t,e,r){for(var n=r.length,i=0;n>i;i++)t.setUint8(e+i,r.charCodeAt(i))}var i=r,o=i.audiocontext;t.SoundRecorder=function(){this.input=o.createGain(),this.output=o.createGain(),this.recording=!1,this.bufferSize=1024,this._channels=2,this._clear(),this._jsNode=o.createScriptProcessor(this.bufferSize,this._channels,2),this._jsNode.onaudioprocess=this._audioprocess.bind(this),this._callback=function(){},this._jsNode.connect(t.soundOut._silentNode),this.setInput(),i.soundArray.push(this)},t.SoundRecorder.prototype.setInput=function(e){this.input.disconnect(),this.input=null,this.input=o.createGain(),this.input.connect(this._jsNode),this.input.connect(this.output),e?e.connect(this.input):t.soundOut.output.connect(this.input)},t.SoundRecorder.prototype.record=function(t,e,r){this.recording=!0,e&&(this.sampleLimit=Math.round(e*o.sampleRate)),t&&r?this._callback=function(){this.buffer=this._getBuffer(),t.setBuffer(this.buffer),r()}:t&&(this._callback=function(){this.buffer=this._getBuffer(),t.setBuffer(this.buffer)})},t.SoundRecorder.prototype.stop=function(){this.recording=!1,this._callback(),this._clear()},t.SoundRecorder.prototype._clear=function(){this._leftBuffers=[],this._rightBuffers=[],this.recordedSamples=0,this.sampleLimit=null},t.SoundRecorder.prototype._audioprocess=function(t){if(this.recording!==!1&&this.recording===!0)if(this.sampleLimit&&this.recordedSamples>=this.sampleLimit)this.stop();else{var e=t.inputBuffer.getChannelData(0),r=t.inputBuffer.getChannelData(1);this._leftBuffers.push(new Float32Array(e)),this._rightBuffers.push(new Float32Array(r)),this.recordedSamples+=this.bufferSize}},t.SoundRecorder.prototype._getBuffer=function(){var t=[];return t.push(this._mergeBuffers(this._leftBuffers)),t.push(this._mergeBuffers(this._rightBuffers)),t},t.SoundRecorder.prototype._mergeBuffers=function(t){for(var e=new Float32Array(this.recordedSamples),r=0,n=t.length,i=0;n>i;i++){var o=t[i];e.set(o,r),r+=o.length}return e},t.SoundRecorder.prototype.dispose=function(){this._clear(),this._callback=function(){},this.input&&this.input.disconnect(),this.input=null,this._jsNode=null},t.prototype.saveSound=function(r,i){var o=r.buffer.getChannelData(0),a=r.buffer.getChannelData(1),s=e(o,a),h=new ArrayBuffer(44+2*s.length),u=new DataView(h);n(u,0,"RIFF"),u.setUint32(4,44+2*s.length,!0),n(u,8,"WAVE"),n(u,12,"fmt "),u.setUint32(16,16,!0),u.setUint16(20,1,!0),u.setUint16(22,2,!0),u.setUint32(24,44100,!0),u.setUint32(28,176400,!0),u.setUint16(32,4,!0),u.setUint16(34,16,!0),n(u,36,"data"),u.setUint32(40,2*s.length,!0);for(var c=s.length,l=44,p=1,f=0;c>f;f++)u.setInt16(l,32767*s[f]*p,!0),l+=2;t.prototype.writeFile([u],i,"wav")}}(e,r);var A;A=function(){"use strict";t.PeakDetect=function(t,e,r,n){this.framesPerPeak=n||20,this.framesSinceLastPeak=0,this.decayRate=.95,this.threshold=r||.35,this.cutoff=0,this.cutoffMult=1.5,this.energy=0,this.penergy=0,this.currentValue=0,this.isDetected=!1,this.f1=t||40,this.f2=e||2e4,this._onPeak=function(){}},t.PeakDetect.prototype.update=function(t){var e=this.energy=t.getEnergy(this.f1,this.f2)/255;e>this.cutoff&&e>this.threshold&&e-this.penergy>0?(this._onPeak(),this.isDetected=!0,this.cutoff=e*this.cutoffMult,this.framesSinceLastPeak=0):(this.isDetected=!1,this.framesSinceLastPeak<=this.framesPerPeak?this.framesSinceLastPeak++:(this.cutoff*=this.decayRate,this.cutoff=Math.max(this.cutoff,this.threshold))),this.currentValue=e,this.penergy=e},t.PeakDetect.prototype.onPeak=function(t,e){var r=this;r._onPeak=function(){t(r.energy,e)}}}(r);var R;R=function(){"use strict";var e=r;t.Gain=function(){this.ac=e.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.input.gain.value=.5,this.input.connect(this.output)},t.Gain.prototype.setInput=function(t){t.connect(this.input)},t.Gain.prototype.connect=function(e){var r=e||t.soundOut.input;this.output.connect(r.input?r.input:r)},t.Gain.prototype.disconnect=function(){this.output.disconnect()},t.Gain.prototype.amp=function(t,r,n){var r=r||0,n=n||0,i=e.audiocontext.currentTime,o=this.output.gain.value;this.output.gain.cancelScheduledValues(i),this.output.gain.linearRampToValueAtTime(o,i+n),this.output.gain.linearRampToValueAtTime(t,i+n+r)}}(r,e);var P;P=function(){"use strict";var t=e;return t}(e,r,n,i,o,a,s,m,g,y,v,_,x,b,w,S,T,E,C,A,R)}),function(t,e){"function"==typeof define&&define.amd?define("nprogress",e):"object"==typeof exports?module.exports=e():t.NProgress=e()}(this,function(){function t(t,e,r){return e>t?e:t>r?r:t}function e(t){return 100*(-1+t)}function r(t,r,n){var i;return i="translate3d"===u.positionUsing?{transform:"translate3d("+e(t)+"%,0,0)"}:"translate"===u.positionUsing?{transform:"translate("+e(t)+"%,0)"}:{"margin-left":e(t)+"%"},i.transition="all "+r+"ms "+n,i}function n(t,e){var r="string"==typeof t?t:a(t);return r.indexOf(" "+e+" ")>=0}function i(t,e){var r=a(t),i=r+e;n(r,e)||(t.className=i.substring(1))}function o(t,e){var r,i=a(t);n(t,e)&&(r=i.replace(" "+e+" "," "),t.className=r.substring(1,r.length-1))}function a(t){return(" "+(t.className||"")+" ").replace(/\s+/gi," ")}function s(t){t&&t.parentNode&&t.parentNode.removeChild(t)}var h={};h.version="0.2.0";var u=h.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};h.configure=function(t){var e,r;for(e in t)r=t[e],void 0!==r&&t.hasOwnProperty(e)&&(u[e]=r);return this},h.status=null,h.set=function(e){var n=h.isStarted();e=t(e,u.minimum,1),h.status=1===e?null:e;var i=h.render(!n),o=i.querySelector(u.barSelector),a=u.speed,s=u.easing;return i.offsetWidth,c(function(t){""===u.positionUsing&&(u.positionUsing=h.getPositioningCSS()),l(o,r(e,a,s)),1===e?(l(i,{transition:"none",opacity:1}),i.offsetWidth,setTimeout(function(){l(i,{transition:"all "+a+"ms linear",opacity:0}),setTimeout(function(){h.remove(),t()},a)},a)):setTimeout(t,a)}),this},h.isStarted=function(){return"number"==typeof h.status},h.start=function(){h.status||h.set(0);var t=function(){setTimeout(function(){h.status&&(h.trickle(),t())},u.trickleSpeed)};return u.trickle&&t(),this},h.done=function(t){return t||h.status?h.inc(.3+.5*Math.random()).set(1):this},h.inc=function(e){var r=h.status;return r?("number"!=typeof e&&(e=(1-r)*t(Math.random()*r,.1,.95)),r=t(r+e,0,.994),h.set(r)):h.start()},h.trickle=function(){return h.inc(Math.random()*u.trickleRate)},function(){var t=0,e=0;h.promise=function(r){return r&&"resolved"!==r.state()?(0===e&&h.start(),t++,e++,r.always(function(){e--,0===e?(t=0,h.done()):h.set((t-e)/t)}),this):this}}(),h.render=function(t){if(h.isRendered())return document.getElementById("nprogress");i(document.documentElement,"nprogress-busy");var r=document.createElement("div");r.id="nprogress",r.innerHTML=u.template;var n,o=r.querySelector(u.barSelector),a=t?"-100":e(h.status||0),c=document.querySelector(u.parent);return l(o,{transition:"all 0 linear",transform:"translate3d("+a+"%,0,0)"}),u.showSpinner||(n=r.querySelector(u.spinnerSelector),n&&s(n)),c!=document.body&&i(c,"nprogress-custom-parent"),c.appendChild(r),r},h.remove=function(){o(document.documentElement,"nprogress-busy"),o(document.querySelector(u.parent),"nprogress-custom-parent");var t=document.getElementById("nprogress");t&&s(t)},h.isRendered=function(){return!!document.getElementById("nprogress")},h.getPositioningCSS=function(){var t=document.body.style,e="WebkitTransform"in t?"Webkit":"MozTransform"in t?"Moz":"msTransform"in t?"ms":"OTransform"in t?"O":"";return e+"Perspective"in t?"translate3d":e+"Transform"in t?"translate":"margin"};var c=function(){function t(){var r=e.shift();r&&r(t)}var e=[];return function(r){e.push(r),1==e.length&&t()}}(),l=function(){function t(t){return t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,e){return e.toUpperCase()})}function e(t){var e=document.body.style;if(t in e)return t;for(var r,n=i.length,o=t.charAt(0).toUpperCase()+t.slice(1);n--;)if(r=i[n]+o,r in e)return r;return t}function r(r){return r=t(r),o[r]||(o[r]=e(r))}function n(t,e,n){e=r(e),t.style[e]=n}var i=["Webkit","O","Moz","ms"],o={};return function(t,e){var r,i,o=arguments;if(2==o.length)for(r in e)i=e[r],void 0!==i&&e.hasOwnProperty(r)&&n(t,r,i);else n(t,o[1],o[2])}}();return h}),function(t){define("dat-gui",[],function(){return function(){var e=e||{};return e.gui=e.gui||{},e.utils=e.utils||{},e.controllers=e.controllers||{},e.dom=e.dom||{},e.color=e.color||{},e.utils.css=function(){return{load:function(t,e){e=e||document;var r=e.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=t,e.getElementsByTagName("head")[0].appendChild(r)},inject:function(t,e){e=e||document;var r=document.createElement("style");r.type="text/css",r.innerHTML=t,e.getElementsByTagName("head")[0].appendChild(r)}}}(),e.utils.common=function(){var t=Array.prototype.forEach,e=Array.prototype.slice;return{BREAK:{},extend:function(t){return this.each(e.call(arguments,1),function(e){for(var r in e)this.isUndefined(e[r])||(t[r]=e[r])},this),t},defaults:function(t){return this.each(e.call(arguments,1),function(e){for(var r in e)this.isUndefined(t[r])&&(t[r]=e[r])},this),t},compose:function(){var t=e.call(arguments);return function(){for(var r=e.call(arguments),n=t.length-1;n>=0;n--)r=[t[n].apply(this,r)];return r[0]}},each:function(e,r,n){if(e)if(t&&e.forEach&&e.forEach===t)e.forEach(r,n);else if(e.length===e.length+0){for(var i=0,o=e.length;o>i;i++)if(i in e&&r.call(n,e[i],i)===this.BREAK)return}else for(var i in e)if(r.call(n,e[i],i)===this.BREAK)return},defer:function(t){setTimeout(t,0)},toArray:function(t){return t.toArray?t.toArray():e.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){return t!==t},isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return t===!1||t===!0},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}}}(),e.controllers.Controller=function(t){var e=function(t,e){this.initialValue=t[e],this.domElement=document.createElement("div"),this.object=t,this.property=e,this.__onChange=void 0,this.__onFinishChange=void 0};return t.extend(e.prototype,{onChange:function(t){return this.__onChange=t,this},onFinishChange:function(t){return this.__onFinishChange=t,this},setValue:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),e}(e.utils.common),e.dom.dom=function(t){function e(e){if("0"===e||t.isUndefined(e))return 0;var r=e.match(i);return t.isNull(r)?0:parseFloat(r[1])}var r={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},n={};t.each(r,function(e,r){t.each(e,function(t){n[t]=r})});var i=/(\d+(\.\d+)?)px/,o={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(e,r,n){t.isUndefined(r)&&(r=!0),t.isUndefined(n)&&(n=!0),e.style.position="absolute",r&&(e.style.left=0,e.style.right=0),n&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,r,i,o){i=i||{};var a=n[r];if(!a)throw new Error("Event type "+r+" not supported.");var s=document.createEvent(a);switch(a){case"MouseEvents":var h=i.x||i.clientX||0,u=i.y||i.clientY||0;s.initMouseEvent(r,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,h,u,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=s.initKeyboardEvent||s.initKeyEvent;t.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(r,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:s.initEvent(r,i.bubbles||!1,i.cancelable||!0)}t.defaults(s,o),e.dispatchEvent(s)},bind:function(t,e,r,n){return n=n||!1,t.addEventListener?t.addEventListener(e,r,n):t.attachEvent&&t.attachEvent("on"+e,r),o},unbind:function(t,e,r,n){return n=n||!1,t.removeEventListener?t.removeEventListener(e,r,n):t.detachEvent&&t.detachEvent("on"+e,r),o},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var r=t.className.split(/ +/);-1==r.indexOf(e)&&(r.push(e),t.className=r.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return o},removeClass:function(t,e){if(e)if(void 0===t.className);else if(t.className===e)t.removeAttribute("class");else{var r=t.className.split(/ +/),n=r.indexOf(e);-1!=n&&(r.splice(n,1),t.className=r.join(" "))}else t.className=void 0;return o},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var r=getComputedStyle(t);return e(r["border-left-width"])+e(r["border-right-width"])+e(r["padding-left"])+e(r["padding-right"])+e(r.width)},getHeight:function(t){var r=getComputedStyle(t);return e(r["border-top-width"])+e(r["border-bottom-width"])+e(r["padding-top"])+e(r["padding-bottom"])+e(r.height)},getOffset:function(t){var e={left:0,top:0};if(t.offsetParent)do e.left+=t.offsetLeft,e.top+=t.offsetTop;while(t=t.offsetParent);return e},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}};return o}(e.utils.common),e.controllers.OptionController=function(t,e,r){var n=function(t,i,o){n.superclass.call(this,t,i);var a=this;if(this.__select=document.createElement("select"),r.isArray(o)){var s={};r.each(o,function(t){s[t]=t}),o=s}r.each(o,function(t,e){var r=document.createElement("option");r.innerHTML=e,r.setAttribute("value",t),a.__select.appendChild(r)}),this.updateDisplay(),e.bind(this.__select,"change",function(){var t=this.options[this.selectedIndex].value;a.setValue(t)}),this.domElement.appendChild(this.__select)};return n.superclass=t,r.extend(n.prototype,t.prototype,{setValue:function(t){var e=n.superclass.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e},updateDisplay:function(){return this.__select.value=this.getValue(),n.superclass.prototype.updateDisplay.call(this)}}),n}(e.controllers.Controller,e.dom.dom,e.utils.common),e.controllers.NumberController=function(t,e){function r(t){return t=t.toString(),t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var n=function(t,i,o){n.superclass.call(this,t,i),o=o||{},this.__min=o.min,this.__max=o.max,this.__step=o.step,e.isUndefined(this.__step)?0==this.initialValue?this.__impliedStep=1:this.__impliedStep=Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__impliedStep=this.__step,this.__precision=r(this.__impliedStep)};return n.superclass=t,e.extend(n.prototype,t.prototype,{setValue:function(t){return void 0!==this.__min&&t<this.__min?t=this.__min:void 0!==this.__max&&t>this.__max&&(t=this.__max),void 0!==this.__step&&t%this.__step!=0&&(t=Math.round(t/this.__step)*this.__step),n.superclass.prototype.setValue.call(this,t)},min:function(t){return this.__min=t,this},max:function(t){return this.__max=t,this},step:function(t){return this.__step=t,this.__impliedStep=t,this.__precision=r(t),this}}),n}(e.controllers.Controller,e.utils.common),e.controllers.NumberControllerBox=function(t,e,r){function n(t,e){var r=Math.pow(10,e);return Math.round(t*r)/r}var i=function(t,n,o){function a(){var t=parseFloat(p.__input.value);r.isNaN(t)||p.setValue(t)}function s(){a(),p.__onFinishChange&&p.__onFinishChange.call(p,p.getValue())}function h(t){e.bind(window,"mousemove",u),e.bind(window,"mouseup",c),l=t.clientY}function u(t){var e=l-t.clientY;p.setValue(p.getValue()+e*p.__impliedStep),l=t.clientY}function c(){e.unbind(window,"mousemove",u),e.unbind(window,"mouseup",c)}this.__truncationSuspended=!1,i.superclass.call(this,t,n,o);var l,p=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"change",a),e.bind(this.__input,"blur",s),e.bind(this.__input,"mousedown",h),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&(p.__truncationSuspended=!0,this.blur(),p.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return i.superclass=t,r.extend(i.prototype,t.prototype,{updateDisplay:function(){return this.__input.value=this.__truncationSuspended?this.getValue():n(this.getValue(),this.__precision),i.superclass.prototype.updateDisplay.call(this)}}),i}(e.controllers.NumberController,e.dom.dom,e.utils.common),e.controllers.NumberControllerSlider=function(t,e,r,n,i){function o(t,e,r,n,i){return n+(i-n)*((t-e)/(r-e))}var a=function(t,r,n,i,s){function h(t){e.bind(window,"mousemove",u),e.bind(window,"mouseup",c),u(t)}function u(t){t.preventDefault();var r=e.getOffset(l.__background),n=e.getWidth(l.__background);return l.setValue(o(t.clientX,r.left,r.left+n,l.__min,l.__max)),!1}function c(){e.unbind(window,"mousemove",u),e.unbind(window,"mouseup",c),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}a.superclass.call(this,t,r,{min:n,max:i,step:s});var l=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),e.bind(this.__background,"mousedown",h),e.addClass(this.__background,"slider"),e.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return a.superclass=t,a.useDefaultStyles=function(){r.inject(i)},n.extend(a.prototype,t.prototype,{updateDisplay:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",a.superclass.prototype.updateDisplay.call(this)}}),a}(e.controllers.NumberController,e.dom.dom,e.utils.css,e.utils.common,"/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\n.slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}"),
e.controllers.FunctionController=function(t,e,r){var n=function(t,r,i){n.superclass.call(this,t,r);var o=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===i?"Fire":i,e.bind(this.__button,"click",function(t){return t.preventDefault(),o.fire(),!1}),e.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return n.superclass=t,r.extend(n.prototype,t.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}),n}(e.controllers.Controller,e.dom.dom,e.utils.common),e.controllers.BooleanController=function(t,e,r){var n=function(t,r){function i(){o.setValue(!o.__prev)}n.superclass.call(this,t,r);var o=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),e.bind(this.__checkbox,"change",i,!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return n.superclass=t,r.extend(n.prototype,t.prototype,{setValue:function(t){var e=n.superclass.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e},updateDisplay:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,n.superclass.prototype.updateDisplay.call(this)}}),n}(e.controllers.Controller,e.dom.dom,e.utils.common),e.color.toString=function(t){return function(e){if(1==e.a||t.isUndefined(e.a)){for(var r=e.hex.toString(16);r.length<6;)r="0"+r;return"#"+r}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}(e.utils.common),e.color.interpret=function(t,e){var r,n,i=function(){n=!1;var t=arguments.length>1?e.toArray(arguments):arguments[0];return e.each(o,function(i){return i.litmus(t)?(e.each(i.conversions,function(i,o){return r=i.read(t),n===!1&&r!==!1?(n=r,r.conversionName=o,r.conversion=i,e.BREAK):void 0}),e.BREAK):void 0}),n},o=[{litmus:e.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:t},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:t},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:t},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:t}}},{litmus:e.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:e.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:e.isObject,conversions:{RGBA_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)&&e.isNumber(t.a)?{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)?{space:"RGB",r:t.r,g:t.g,b:t.b}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)&&e.isNumber(t.a)?{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)?{space:"HSV",h:t.h,s:t.s,v:t.v}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}];return i}(e.color.toString,e.utils.common),e.GUI=e.gui.GUI=function(t,e,r,n,i,o,a,s,h,u,c,l,p,f,d){function m(t,e,r,o){if(void 0===e[r])throw new Error("Object "+e+' has no property "'+r+'"');var a;if(o.color)a=new c(e,r);else{var s=[e,r].concat(o.factoryArgs);a=n.apply(t,s)}o.before instanceof i&&(o.before=o.before.__li),v(t,a),f.addClass(a.domElement,"c");var h=document.createElement("span");f.addClass(h,"property-name"),h.innerHTML=a.property;var u=document.createElement("div");u.appendChild(h),u.appendChild(a.domElement);var l=g(t,u,o.before);return f.addClass(l,U.CLASS_CONTROLLER_ROW),f.addClass(l,typeof a.getValue()),y(t,l,a),t.__controllers.push(a),a}function g(t,e,r){var n=document.createElement("li");return e&&n.appendChild(e),r?t.__ul.insertBefore(n,params.before):t.__ul.appendChild(n),t.onResize(),n}function y(t,e,r){if(r.__li=e,r.__gui=t,d.extend(r,{options:function(e){return arguments.length>1?(r.remove(),m(t,r.object,r.property,{before:r.__li.nextElementSibling,factoryArgs:[d.toArray(arguments)]})):d.isArray(e)||d.isObject(e)?(r.remove(),m(t,r.object,r.property,{before:r.__li.nextElementSibling,factoryArgs:[e]})):void 0},name:function(t){return r.__li.firstElementChild.firstElementChild.innerHTML=t,r},listen:function(){return r.__gui.listen(r),r},remove:function(){return r.__gui.remove(r),r}}),r instanceof h){var n=new s(r.object,r.property,{min:r.__min,max:r.__max,step:r.__step});d.each(["updateDisplay","onChange","onFinishChange"],function(t){var e=r[t],i=n[t];r[t]=n[t]=function(){var t=Array.prototype.slice.call(arguments);return e.apply(r,t),i.apply(n,t)}}),f.addClass(e,"has-slider"),r.domElement.insertBefore(n.domElement,r.domElement.firstElementChild)}else if(r instanceof s){var i=function(e){return d.isNumber(r.__min)&&d.isNumber(r.__max)?(r.remove(),m(t,r.object,r.property,{before:r.__li.nextElementSibling,factoryArgs:[r.__min,r.__max,r.__step]})):e};r.min=d.compose(i,r.min),r.max=d.compose(i,r.max)}else r instanceof o?(f.bind(e,"click",function(){f.fakeEvent(r.__checkbox,"click")}),f.bind(r.__checkbox,"click",function(t){t.stopPropagation()})):r instanceof a?(f.bind(e,"click",function(){f.fakeEvent(r.__button,"click")}),f.bind(e,"mouseover",function(){f.addClass(r.__button,"hover")}),f.bind(e,"mouseout",function(){f.removeClass(r.__button,"hover")})):r instanceof c&&(f.addClass(e,"color"),r.updateDisplay=d.compose(function(t){return e.style.borderLeftColor=r.__color.toString(),t},r.updateDisplay),r.updateDisplay());r.setValue=d.compose(function(e){return t.getRoot().__preset_select&&r.isModified()&&E(t.getRoot(),!0),e},r.setValue)}function v(t,e){var r=t.getRoot(),n=r.__rememberedObjects.indexOf(e.object);if(-1!=n){var i=r.__rememberedObjectIndecesToControllers[n];if(void 0===i&&(i={},r.__rememberedObjectIndecesToControllers[n]=i),i[e.property]=e,r.load&&r.load.remembered){var o,a=r.load.remembered;if(a[t.preset])o=a[t.preset];else{if(!a[D])return;o=a[D]}if(o[n]&&void 0!==o[n][e.property]){var s=o[n][e.property];e.initialValue=s,e.setValue(s)}}}}function _(t,e){return document.location.href+"."+e}function x(t){function e(){u.style.display=t.useLocalStorage?"block":"none"}var r=t.__save_row=document.createElement("li");f.addClass(t.domElement,"has-save"),t.__ul.insertBefore(r,t.__ul.firstChild),f.addClass(r,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",f.addClass(n,"button gears");var i=document.createElement("span");i.innerHTML="Save",f.addClass(i,"button"),f.addClass(i,"save");var o=document.createElement("span");o.innerHTML="New",f.addClass(o,"button"),f.addClass(o,"save-as");var a=document.createElement("span");a.innerHTML="Revert",f.addClass(a,"button"),f.addClass(a,"revert");var s=t.__preset_select=document.createElement("select");if(t.load&&t.load.remembered?d.each(t.load.remembered,function(e,r){M(t,r,r==t.preset)}):M(t,D,!1),f.bind(s,"change",function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value}),r.appendChild(s),r.appendChild(n),r.appendChild(i),r.appendChild(o),r.appendChild(a),k){var h=document.getElementById("dg-save-locally"),u=document.getElementById("dg-local-explain");h.style.display="block";var c=document.getElementById("dg-local-storage");"true"===localStorage.getItem(_(t,"isLocal"))&&c.setAttribute("checked","checked"),e(),f.bind(c,"change",function(){t.useLocalStorage=!t.useLocalStorage,e()})}var l=document.getElementById("dg-new-constructor");f.bind(l,"keydown",function(t){!t.metaKey||67!==t.which&&67!=t.keyCode||A.hide()}),f.bind(n,"click",function(){l.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),A.show(),l.focus(),l.select()}),f.bind(i,"click",function(){t.save()}),f.bind(o,"click",function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)}),f.bind(a,"click",function(){t.revert()})}function b(t){function e(e){return e.preventDefault(),i=e.clientX,f.addClass(t.__closeButton,U.CLASS_DRAG),f.bind(window,"mousemove",r),f.bind(window,"mouseup",n),!1}function r(e){return e.preventDefault(),t.width+=i-e.clientX,t.onResize(),i=e.clientX,!1}function n(){f.removeClass(t.__closeButton,U.CLASS_DRAG),f.unbind(window,"mousemove",r),f.unbind(window,"mouseup",n)}t.__resize_handle=document.createElement("div"),d.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var i;f.bind(t.__resize_handle,"mousedown",e),f.bind(t.__closeButton,"mousedown",e),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function w(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function S(t,e){var r={};return d.each(t.__rememberedObjects,function(n,i){var o={},a=t.__rememberedObjectIndecesToControllers[i];d.each(a,function(t,r){o[r]=e?t.initialValue:t.getValue()}),r[i]=o}),r}function M(t,e,r){var n=document.createElement("option");n.innerHTML=e,n.value=e,t.__preset_select.appendChild(n),r&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function T(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value==t.preset&&(t.__preset_select.selectedIndex=e)}function E(t,e){var r=t.__preset_select[t.__preset_select.selectedIndex];e?r.innerHTML=r.value+"*":r.innerHTML=r.value}function C(t){0!=t.length&&l(function(){C(t)}),d.each(t,function(t){t.updateDisplay()})}t.inject(r);var A,R,P="dg",L=72,O=20,D="Default",k=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}(),F=!0,N=!1,I=[],U=function(t){function e(){var t=r.getRoot();t.width+=1,d.defer(function(){t.width-=1})}var r=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),f.addClass(this.domElement,P),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],t=t||{},t=d.defaults(t,{autoPlace:!0,width:U.DEFAULT_WIDTH}),t=d.defaults(t,{resizable:t.autoPlace,hideable:t.autoPlace}),d.isUndefined(t.load)?t.load={preset:D}:t.preset&&(t.load.preset=t.preset),d.isUndefined(t.parent)&&t.hideable&&I.push(this),t.resizable=d.isUndefined(t.parent)&&t.resizable,t.autoPlace&&d.isUndefined(t.scrollable)&&(t.scrollable=!0);var n,i=k&&"true"===localStorage.getItem(_(this,"isLocal"));if(Object.defineProperties(this,{parent:{get:function(){return t.parent}},scrollable:{get:function(){return t.scrollable}},autoPlace:{get:function(){return t.autoPlace}},preset:{get:function(){return r.parent?r.getRoot().preset:t.load.preset},set:function(e){r.parent?r.getRoot().preset=e:t.load.preset=e,T(this),r.revert()}},width:{get:function(){return t.width},set:function(e){t.width=e,w(r,e)}},name:{get:function(){return t.name},set:function(e){t.name=e,a&&(a.innerHTML=t.name)}},closed:{get:function(){return t.closed},set:function(e){t.closed=e,t.closed?f.addClass(r.__ul,U.CLASS_CLOSED):f.removeClass(r.__ul,U.CLASS_CLOSED),this.onResize(),r.__closeButton&&(r.__closeButton.innerHTML=e?U.TEXT_OPEN:U.TEXT_CLOSED)}},load:{get:function(){return t.load}},useLocalStorage:{get:function(){return i},set:function(t){k&&(i=t,t?f.bind(window,"unload",n):f.unbind(window,"unload",n),localStorage.setItem(_(r,"isLocal"),t))}}}),d.isUndefined(t.parent)){if(t.closed=!1,f.addClass(this.domElement,U.CLASS_MAIN),f.makeSelectable(this.domElement,!1),k&&i){r.useLocalStorage=!0;var o=localStorage.getItem(_(this,"gui"));o&&(t.load=JSON.parse(o))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=U.TEXT_CLOSED,f.addClass(this.__closeButton,U.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),f.bind(this.__closeButton,"click",function(){r.closed=!r.closed})}else{void 0===t.closed&&(t.closed=!0);var a=document.createTextNode(t.name);f.addClass(a,"controller-name");var s=g(r,a),h=function(t){return t.preventDefault(),r.closed=!r.closed,!1};f.addClass(this.__ul,U.CLASS_CLOSED),f.addClass(s,"title"),f.bind(s,"click",h),t.closed||(this.closed=!1)}t.autoPlace&&(d.isUndefined(t.parent)&&(F&&(R=document.createElement("div"),f.addClass(R,P),f.addClass(R,U.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(R),F=!1),R.appendChild(this.domElement),f.addClass(this.domElement,U.CLASS_AUTO_PLACE)),this.parent||w(r,t.width)),f.bind(window,"resize",function(){r.onResize()}),f.bind(this.__ul,"webkitTransitionEnd",function(){r.onResize()}),f.bind(this.__ul,"transitionend",function(){r.onResize()}),f.bind(this.__ul,"oTransitionEnd",function(){r.onResize()}),this.onResize(),t.resizable&&b(this),n=function(){k&&"true"===localStorage.getItem(_(r,"isLocal"))&&localStorage.setItem(_(r,"gui"),JSON.stringify(r.getSaveObject()))},this.saveToLocalStorageIfPossible=n;r.getRoot();t.parent||e()};return U.toggleHide=function(){N=!N,d.each(I,function(t){t.domElement.style.zIndex=N?-999:999,t.domElement.style.opacity=N?0:1})},U.CLASS_AUTO_PLACE="a",U.CLASS_AUTO_PLACE_CONTAINER="ac",U.CLASS_MAIN="main",U.CLASS_CONTROLLER_ROW="cr",U.CLASS_TOO_TALL="taller-than-window",U.CLASS_CLOSED="closed",U.CLASS_CLOSE_BUTTON="close-button",U.CLASS_DRAG="drag",U.DEFAULT_WIDTH=245,U.TEXT_CLOSED="Close Controls",U.TEXT_OPEN="Open Controls",f.bind(window,"keydown",function(t){"text"===document.activeElement.type||t.which!==L&&t.keyCode!=L||U.toggleHide()},!1),d.extend(U.prototype,{add:function(t,e){return m(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return m(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.splice(this.__controllers.indexOf(t),1);var e=this;d.defer(function(){e.onResize()})},destroy:function(){this.autoPlace&&R.removeChild(this.domElement)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var r=new U(e);this.__folders[t]=r;var n=g(this,r.domElement);return f.addClass(n,"folder"),r},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=f.getOffset(t.__ul).top,r=0;d.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(r+=f.getHeight(e))}),window.innerHeight-e-O<r?(f.addClass(t.domElement,U.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-O+"px"):(f.removeClass(t.domElement,U.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&d.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},remember:function(){if(d.isUndefined(A)&&(A=new p,A.domElement.innerHTML=e),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;d.each(Array.prototype.slice.call(arguments),function(e){0==t.__rememberedObjects.length&&x(t),-1==t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&w(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=S(this)),t.folders={},d.each(this.__folders,function(e,r){t.folders[r]=e.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=S(this),E(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[D]=S(this,!0)),this.load.remembered[t]=S(this),this.preset=t,M(this,t,!0),this.saveToLocalStorageIfPossible()},revert:function(t){d.each(this.__controllers,function(e){this.getRoot().load.remembered?v(t||this.getRoot(),e):e.setValue(e.initialValue)},this),d.each(this.__folders,function(t){t.revert(t)}),t||E(this.getRoot(),!1)},listen:function(t){var e=0==this.__listening.length;this.__listening.push(t),e&&C(this.__listening)}}),U}(e.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg {\n  /** Clear list styles */\n  /* Auto-place container */\n  /* Auto-placed GUI's */\n  /* Line items that don't contain folders. */\n  /** Folder names */\n  /** Hides closed items */\n  /** Controller row */\n  /** Name-half (left) */\n  /** Controller-half (right) */\n  /** Controller placement */\n  /** Shorter number boxes when slider is present. */\n  /** Ensure the entire boolean and function row shows a hand */ }\n  .dg ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    width: 100%;\n    clear: both; }\n  .dg.ac {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 0;\n    z-index: 0; }\n  .dg:not(.ac) .main {\n    /** Exclude mains in ac so that we don't hide close button */\n    overflow: hidden; }\n  .dg.main {\n    -webkit-transition: opacity 0.1s linear;\n    -o-transition: opacity 0.1s linear;\n    -moz-transition: opacity 0.1s linear;\n    transition: opacity 0.1s linear; }\n    .dg.main.taller-than-window {\n      overflow-y: auto; }\n      .dg.main.taller-than-window .close-button {\n        opacity: 1;\n        /* TODO, these are style notes */\n        margin-top: -1px;\n        border-top: 1px solid #2c2c2c; }\n    .dg.main ul.closed .close-button {\n      opacity: 1 !important; }\n    .dg.main:hover .close-button,\n    .dg.main .close-button.drag {\n      opacity: 1; }\n    .dg.main .close-button {\n      /*opacity: 0;*/\n      -webkit-transition: opacity 0.1s linear;\n      -o-transition: opacity 0.1s linear;\n      -moz-transition: opacity 0.1s linear;\n      transition: opacity 0.1s linear;\n      border: 0;\n      position: absolute;\n      line-height: 19px;\n      height: 20px;\n      /* TODO, these are style notes */\n      cursor: pointer;\n      text-align: center;\n      background-color: #000; }\n      .dg.main .close-button:hover {\n        background-color: #111; }\n  .dg.a {\n    float: right;\n    margin-right: 15px;\n    overflow-x: hidden; }\n    .dg.a.has-save > ul {\n      margin-top: 27px; }\n      .dg.a.has-save > ul.closed {\n        margin-top: 0; }\n    .dg.a .save-row {\n      position: fixed;\n      top: 0;\n      z-index: 1002; }\n  .dg li {\n    -webkit-transition: height 0.1s ease-out;\n    -o-transition: height 0.1s ease-out;\n    -moz-transition: height 0.1s ease-out;\n    transition: height 0.1s ease-out; }\n  .dg li:not(.folder) {\n    cursor: auto;\n    height: 27px;\n    line-height: 27px;\n    overflow: hidden;\n    padding: 0 4px 0 5px; }\n  .dg li.folder {\n    padding: 0;\n    border-left: 4px solid rgba(0, 0, 0, 0); }\n  .dg li.title {\n    cursor: pointer;\n    margin-left: -4px; }\n  .dg .closed li:not(.title),\n  .dg .closed ul li,\n  .dg .closed ul li > * {\n    height: 0;\n    overflow: hidden;\n    border: 0; }\n  .dg .cr {\n    clear: both;\n    padding-left: 3px;\n    height: 27px; }\n  .dg .property-name {\n    cursor: default;\n    float: left;\n    clear: left;\n    width: 40%;\n    overflow: hidden;\n    text-overflow: ellipsis; }\n  .dg .c {\n    float: left;\n    width: 60%; }\n  .dg .c input[type=text] {\n    border: 0;\n    margin-top: 4px;\n    padding: 3px;\n    width: 100%;\n    float: right; }\n  .dg .has-slider input[type=text] {\n    width: 30%;\n    /*display: none;*/\n    margin-left: 0; }\n  .dg .slider {\n    float: left;\n    width: 66%;\n    margin-left: -5px;\n    margin-right: 0;\n    height: 19px;\n    margin-top: 4px; }\n  .dg .slider-fg {\n    height: 100%; }\n  .dg .c input[type=checkbox] {\n    margin-top: 9px; }\n  .dg .c select {\n    margin-top: 5px; }\n  .dg .cr.function,\n  .dg .cr.function .property-name,\n  .dg .cr.function *,\n  .dg .cr.boolean,\n  .dg .cr.boolean * {\n    cursor: pointer; }\n  .dg .selector {\n    display: none;\n    position: absolute;\n    margin-left: -9px;\n    margin-top: 23px;\n    z-index: 10; }\n  .dg .c:hover .selector,\n  .dg .selector.drag {\n    display: block; }\n  .dg li.save-row {\n    padding: 0; }\n    .dg li.save-row .button {\n      display: inline-block;\n      padding: 0px 6px; }\n  .dg.dialogue {\n    background-color: #222;\n    width: 460px;\n    padding: 15px;\n    font-size: 13px;\n    line-height: 15px; }\n\n/* TODO Separate style and structure */\n#dg-new-constructor {\n  padding: 10px;\n  color: #222;\n  font-family: Monaco, monospace;\n  font-size: 10px;\n  border: 0;\n  resize: none;\n  box-shadow: inset 1px 1px 1px #888;\n  word-wrap: break-word;\n  margin: 12px 0;\n  display: block;\n  width: 440px;\n  overflow-y: scroll;\n  height: 100px;\n  position: relative; }\n\n#dg-local-explain {\n  display: none;\n  font-size: 11px;\n  line-height: 17px;\n  border-radius: 3px;\n  background-color: #333;\n  padding: 8px;\n  margin-top: 10px; }\n  #dg-local-explain code {\n    font-size: 10px; }\n\n#dat-gui-save-locally {\n  display: none; }\n\n/** Main type */\n.dg {\n  color: #eee;\n  font: 11px 'Lucida Grande', sans-serif;\n  text-shadow: 0 -1px 0 #111;\n  /** Auto place */\n  /* Controller row, <li> */\n  /** Controllers */ }\n  .dg.main {\n    /** Scrollbar */ }\n    .dg.main::-webkit-scrollbar {\n      width: 5px;\n      background: #1a1a1a; }\n    .dg.main::-webkit-scrollbar-corner {\n      height: 0;\n      display: none; }\n    .dg.main::-webkit-scrollbar-thumb {\n      border-radius: 5px;\n      background: #676767; }\n  .dg li:not(.folder) {\n    background: #1a1a1a;\n    border-bottom: 1px solid #2c2c2c; }\n  .dg li.save-row {\n    line-height: 25px;\n    background: #dad5cb;\n    border: 0; }\n    .dg li.save-row select {\n      margin-left: 5px;\n      width: 108px; }\n    .dg li.save-row .button {\n      margin-left: 5px;\n      margin-top: 1px;\n      border-radius: 2px;\n      font-size: 9px;\n      line-height: 7px;\n      padding: 4px 4px 5px 4px;\n      background: #c5bdad;\n      color: #fff;\n      text-shadow: 0 1px 0 #b0a58f;\n      box-shadow: 0 -1px 0 #b0a58f;\n      cursor: pointer; }\n      .dg li.save-row .button.gears {\n        background: #c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;\n        height: 7px;\n        width: 8px; }\n      .dg li.save-row .button:hover {\n        background-color: #bab19e;\n        box-shadow: 0 -1px 0 #b0a58f; }\n  .dg li.folder {\n    border-bottom: 0; }\n  .dg li.title {\n    padding-left: 16px;\n    background: black url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;\n    cursor: pointer;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2); }\n  .dg .closed li.title {\n    background-image: url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==); }\n  .dg .cr.boolean {\n    border-left: 3px solid #806787; }\n  .dg .cr.function {\n    border-left: 3px solid #e61d5f; }\n  .dg .cr.number {\n    border-left: 3px solid #2fa1d6; }\n    .dg .cr.number input[type=text] {\n      color: #2fa1d6; }\n  .dg .cr.string {\n    border-left: 3px solid #1ed36f; }\n    .dg .cr.string input[type=text] {\n      color: #1ed36f; }\n  .dg .cr.function:hover, .dg .cr.boolean:hover {\n    background: #111; }\n  .dg .c input[type=text] {\n    background: #303030;\n    outline: none; }\n    .dg .c input[type=text]:hover {\n      background: #3c3c3c; }\n    .dg .c input[type=text]:focus {\n      background: #494949;\n      color: #fff; }\n  .dg .c .slider {\n    background: #303030;\n    cursor: ew-resize; }\n  .dg .c .slider-fg {\n    background: #2fa1d6; }\n  .dg .c .slider:hover {\n    background: #3c3c3c; }\n    .dg .c .slider:hover .slider-fg {\n      background: #44abda; }\n",e.controllers.factory=function(t,e,r,n,i,o,a){return function(s,h){var u=s[h];return a.isArray(arguments[2])||a.isObject(arguments[2])?new t(s,h,arguments[2]):a.isNumber(u)?a.isNumber(arguments[2])&&a.isNumber(arguments[3])?new r(s,h,arguments[2],arguments[3]):new e(s,h,{min:arguments[2],max:arguments[3]}):a.isString(u)?new n(s,h):a.isFunction(u)?new i(s,h,""):a.isBoolean(u)?new o(s,h):void 0}}(e.controllers.OptionController,e.controllers.NumberControllerBox,e.controllers.NumberControllerSlider,e.controllers.StringController=function(t,e,r){var n=function(t,r){function i(){a.setValue(a.__input.value)}function o(){a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}n.superclass.call(this,t,r);var a=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"keyup",i),e.bind(this.__input,"change",i),e.bind(this.__input,"blur",o),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return n.superclass=t,r.extend(n.prototype,t.prototype,{updateDisplay:function(){return e.isActive(this.__input)||(this.__input.value=this.getValue()),n.superclass.prototype.updateDisplay.call(this)}}),n}(e.controllers.Controller,e.dom.dom,e.utils.common),e.controllers.FunctionController,e.controllers.BooleanController,e.utils.common),e.controllers.Controller,e.controllers.BooleanController,e.controllers.FunctionController,e.controllers.NumberControllerBox,e.controllers.NumberControllerSlider,e.controllers.OptionController,e.controllers.ColorController=function(t,e,r,n,i){function o(t,e,r,n){t.style.background="",i.each(h,function(i){t.style.cssText+="background: "+i+"linear-gradient("+e+", "+r+" 0%, "+n+" 100%); "})}function a(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var s=function(t,h){function u(t){f(t),e.bind(window,"mousemove",f),e.bind(window,"mouseup",c)}function c(){e.unbind(window,"mousemove",f),e.unbind(window,"mouseup",c)}function l(){var t=n(this.value);t!==!1?(m.__color.__state=t,m.setValue(m.__color.toOriginal())):this.value=m.__color.toString()}function p(){e.unbind(window,"mousemove",d),e.unbind(window,"mouseup",p)}function f(t){t.preventDefault();var r=e.getWidth(m.__saturation_field),n=e.getOffset(m.__saturation_field),i=(t.clientX-n.left+document.body.scrollLeft)/r,o=1-(t.clientY-n.top+document.body.scrollTop)/r;return o>1?o=1:0>o&&(o=0),i>1?i=1:0>i&&(i=0),m.__color.v=o,m.__color.s=i,m.setValue(m.__color.toOriginal()),!1}function d(t){t.preventDefault();var r=e.getHeight(m.__hue_field),n=e.getOffset(m.__hue_field),i=1-(t.clientY-n.top+document.body.scrollTop)/r;return i>1?i=1:0>i&&(i=0),m.__color.h=360*i,m.setValue(m.__color.toOriginal()),!1}s.superclass.call(this,t,h),this.__color=new r(this.getValue()),this.__temp=new r(0);var m=this;this.domElement=document.createElement("div"),e.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",e.bind(this.__input,"keydown",function(t){13===t.keyCode&&l.call(this)}),e.bind(this.__input,"blur",l),e.bind(this.__selector,"mousedown",function(t){e.addClass(this,"drag").bind(window,"mouseup",function(t){e.removeClass(m.__selector,"drag")})});var g=document.createElement("div");i.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),i.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),i.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),i.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),i.extend(g.style,{width:"100%",height:"100%",background:"none"}),o(g,"top","rgba(0,0,0,0)","#000"),i.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),a(this.__hue_field),i.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),e.bind(this.__saturation_field,"mousedown",u),e.bind(this.__field_knob,"mousedown",u),e.bind(this.__hue_field,"mousedown",function(t){d(t),e.bind(window,"mousemove",d),e.bind(window,"mouseup",p)}),this.__saturation_field.appendChild(g),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};s.superclass=t,
i.extend(s.prototype,t.prototype,{updateDisplay:function(){var t=n(this.getValue());if(t!==!1){var e=!1;i.each(r.COMPONENTS,function(r){return i.isUndefined(t[r])||i.isUndefined(this.__color.__state[r])||t[r]===this.__color.__state[r]?void 0:(e=!0,{})},this),e&&i.extend(this.__color.__state,t)}i.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var a=this.__color.v<.5||this.__color.s>.5?255:0,s=255-a;i.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+a+","+a+","+a+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,o(this.__saturation_field,"left","#fff",this.__temp.toString()),i.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+a+","+a+","+a+")",textShadow:this.__input_textShadow+"rgba("+s+","+s+","+s+",.7)"})}});var h=["-moz-","-o-","-webkit-","-ms-",""];return s}(e.controllers.Controller,e.dom.dom,e.color.Color=function(t,e,r,n){function i(t,e,r){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(a(this,e,r),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(a(this,e,r),this.__state.space="RGB"),this.__state[e]=t}})}function o(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(s(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(s(this),this.__state.space="HSV"),this.__state[e]=t}})}function a(t,r,i){if("HEX"===t.__state.space)t.__state[r]=e.component_from_hex(t.__state.hex,i);else{if("HSV"!==t.__state.space)throw"Corrupted color state";n.extend(t.__state,e.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}}function s(t){var r=e.rgb_to_hsv(t.r,t.g,t.b);n.extend(t.__state,{s:r.s,v:r.v}),n.isNaN(r.h)?n.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=r.h}var h=function(){if(this.__state=t.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return h.COMPONENTS=["r","g","b","h","s","v","hex","a"],n.extend(h.prototype,{toString:function(){return r(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),i(h.prototype,"r",2),i(h.prototype,"g",1),i(h.prototype,"b",0),o(h.prototype,"h"),o(h.prototype,"s"),o(h.prototype,"v"),Object.defineProperty(h.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(h.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=e.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),h}(e.color.interpret,e.color.math=function(){var t;return{hsv_to_rgb:function(t,e,r){var n=Math.floor(t/60)%6,i=t/60-Math.floor(t/60),o=r*(1-e),a=r*(1-i*e),s=r*(1-(1-i)*e),h=[[r,s,o],[a,r,o],[o,r,s],[o,a,r],[s,o,r],[r,o,a]][n];return{r:255*h[0],g:255*h[1],b:255*h[2]}},rgb_to_hsv:function(t,e,r){var n,i,o=Math.min(t,e,r),a=Math.max(t,e,r),s=a-o;return 0==a?{h:NaN,s:0,v:0}:(i=s/a,n=t==a?(e-r)/s:e==a?2+(r-t)/s:4+(t-e)/s,n/=6,0>n&&(n+=1),{h:360*n,s:i,v:a/255})},rgb_to_hex:function(t,e,r){var n=this.hex_with_component(0,2,t);return n=this.hex_with_component(n,1,e),n=this.hex_with_component(n,0,r)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(e,r,n){return n<<(t=8*r)|e&~(255<<t)}}}(),e.color.toString,e.utils.common),e.color.interpret,e.utils.common),e.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)}}(),e.dom.CenteredDiv=function(t,e){var r=function(){this.backgroundElement=document.createElement("div"),e.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),t.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),e.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var r=this;t.bind(this.backgroundElement,"click",function(){r.hide()})};return r.prototype.show=function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),e.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})},r.prototype.hide=function(){var e=this,r=function(){e.domElement.style.display="none",e.backgroundElement.style.display="none",t.unbind(e.domElement,"webkitTransitionEnd",r),t.unbind(e.domElement,"transitionend",r),t.unbind(e.domElement,"oTransitionEnd",r)};t.bind(this.domElement,"webkitTransitionEnd",r),t.bind(this.domElement,"transitionend",r),t.bind(this.domElement,"oTransitionEnd",r),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},r.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-t.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-t.getHeight(this.domElement)/2+"px"},r}(e.dom.dom,e.utils.common),e.dom.dom,e.utils.common),t.dat=e}.apply(t,arguments)})}(this),define("timer",["exports","nprogress"],function(t,e){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(t,e,r,n){o(),a["default"].configure({minimum:0,showSpinner:!1,trickle:!1,easing:"linear",speed:1e3*t*60}),a["default"].start(),a["default"].set(1),s=setInterval(i(t,e,r,n),1e3*t*60),h=setInterval(r,1e3*e*60)}function i(t,e,r,i){return function(){o(),i(),n(t,e,r,i)}}function o(){clearInterval(s),clearInterval(h),a["default"].remove()}t.__esModule=!0,t.start=n,t.stop=o;var a=r(e),s=void 0,h=void 0}),define("conf",["exports","module","nprogress","dat-gui","timer","modctrl","mods","input","lodash"],function(t,e,r,n,i,o,a,s,h){"use strict";function u(t){return t&&t.__esModule?t:{"default":t}}function c(){d.timer.remaining-=d.timer.tick}function l(){o.next(),d.timer.remaining=d.timer.duration}function p(t){t?(d.timer.remaining=d.timer.duration,i.start(d.timer.duration,d.timer.tick,c,l)):(i.stop(),d.timer.remaining=d.timer.duration)}var f=(u(r),u(s)),d={mods:o.names(),server:localStorage.ws_url||"localhost:1337",timer:{enabled:!1,duration:1,remaining:1,tick:1/60},kinect_tilt:10,kinect:{res:{width:640,height:480}}},m=new n.GUI,g=m.addFolder("Kimotion global settings");g.add(d,"server").name("Server").onChange(function(t){localStorage.ws_url=t}),g.add(d,"mods",d.mods).name("Mods").onChange(o.set),p(d.timer.enabled),g.add(d.timer,"enabled",d.timer.enabled).name("Cycle mods").onChange(p),g.add(d.timer,"duration",.1,10).name("Mins per mod").onChange(function(t){d.timer.enbled&&i.start(t,d.timer.tick,c,o.next)}),g.add(d,"kinect_tilt",0,30).name("Kinect Tilt").onChange(f["default"].send_message),g.open();var y=m.addFolder("Mod settings");y.open(),d.gui=y,d.timer.enabled&&m.close(),e.exports=d}),define("recording",["exports","module","conf"],function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(){function t(){return s}function e(){console.log("Attempted to send message to recording, ignored.")}function r(){s=new Uint16Array(h.subarray(i,i+a)),i+=a,i%=h.length}function n(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(e){if(200!==this.status)throw new Error("non-200 response code on recording GET for "+t);console.log("successfully fetched recording "+t),i=0,h=new Uint16Array(this.response)},e.onerror=function(){throw new Error("failed to load recording "+t)},e.send()}console.log("Using recording data source");var i=0,a=o["default"].kinect.res.width*o["default"].kinect.res.height,s=new Uint16Array(a),h=new Uint16Array(s.length);setInterval(r,1e3/30),n("https://mail.clayto.net/kimotion-recordings/short-handtracking.bin");var u={read:t,send_message:e};return u}e.exports=i;var o=n(r)}),define("input",["exports","module","recording"],function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}var i=n(r),o=i["default"]();e.exports=o}),define("gfx",["exports","module","threejs","threejs_orbit_controls","p5","p5.sound","input","conf","lodash"],function(t,e,r,n,i,o,a,s,h){"use strict";function u(t){return t&&t.__esModule?t:{"default":t}}function c(t,e){if(h.invoke(document.querySelectorAll("canvas"),"remove"),!h.contains(y,e))throw new Error('Invalid type for gfx.set().  Must be "2d" or "3d"');if(v=e,"2d"===v){delete this.gl;var r=function(t){t.setup=function(){t.createCanvas(window.innerWidth,window.innerHeight)},t.draw=h.noop};S=h.noop,this.p5=new d["default"](r,document.body),h.forIn(h.bindAll(this.p5),function(t,e,r){window[e]=t})}else"3d"===v&&(delete this.p5,_=new f["default"].Scene,x=new f["default"].PerspectiveCamera(30,window.innerWidth/window.innerHeight,.1,8e3),x.position.x=0,x.position.y=0,x.position.z=1100,b=new f["default"].WebGLRenderer,b.setClearColor(0,1),b.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(b.domElement),M=new f["default"].OrbitControls(x,b.domElement),S=function(){b.render(_,x)},this.gl={scene:_,camera:x,renderer:b});this.update()}function l(){}function p(){this.depth=m["default"].read(),S()}var f=u(r),d=(u(n),u(i)),m=u(a),g=u(s),y=["2d","3d"],v="2d",_=void 0,x=void 0,b=void 0,w=new Uint16Array(g["default"].kinect.res.width*g["default"].kinect.res.height),S=h.noop,M=void 0,T={conf:g["default"],set:c,reset:l,depth:w,update:p};T.reset(),e.exports=T}),define("modernizr",["exports"],function(t){"use strict";!function(t,e,r){function n(t,e){return typeof t===e}function i(){var t,e,r,i,o,a,s;for(var h in _){if(t=[],e=_[h],e.name&&(t.push(e.name.toLowerCase()),e.options&&e.options.aliases&&e.options.aliases.length))for(r=0;r<e.options.aliases.length;r++)t.push(e.options.aliases[r].toLowerCase());for(i=n(e.fn,"function")?e.fn():e.fn,o=0;o<t.length;o++)a=t[o],s=a.split("."),1===s.length?b[s[0]]=i:(!b[s[0]]||b[s[0]]instanceof Boolean||(b[s[0]]=new Boolean(b[s[0]])),b[s[0]][s[1]]=i),y.push((i?"":"no-")+s.join("-"))}}function o(t){var e=v.className,r=b._config.classPrefix||"";if(w&&(e=e.baseVal),b._config.enableJSClass){var n=new RegExp("(^|\\s)"+r+"no-js(\\s|$)");e=e.replace(n,"$1"+r+"js$2")}b._config.enableClasses&&(e+=" "+r+t.join(" "+r),w?v.className.baseVal=e:v.className=e)}function a(){return"function"!=typeof e.createElement?e.createElement(arguments[0]):w?e.createElementNS.call(e,"http://www.w3.org/2000/svg",arguments[0]):e.createElement.apply(e,arguments)}function s(t){return t.replace(/([a-z])-([a-z])/g,function(t,e,r){return e+r.toUpperCase()}).replace(/^-/,"")}function h(t,e){return!!~(""+t).indexOf(e)}function u(t,e){return function(){return t.apply(e,arguments)}}function c(t,e,r){var i;for(var o in t)if(t[o]in e)return r===!1?t[o]:(i=e[t[o]],n(i,"function")?u(i,r||e):i);return!1}function l(t){return t.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()}).replace(/^ms-/,"-ms-")}function p(){var t=e.body;return t||(t=a(w?"svg":"body"),t.fake=!0),t}function f(t,r,n,i){var o,s,h,u,c="modernizr",l=a("div"),f=p();if(parseInt(n,10))for(;n--;)h=a("div"),h.id=i?i[n]:c+(n+1),l.appendChild(h);return o=a("style"),o.type="text/css",o.id="s"+c,(f.fake?f:l).appendChild(o),f.appendChild(l),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(e.createTextNode(t)),l.id=c,f.fake&&(f.style.background="",f.style.overflow="hidden",u=v.style.overflow,v.style.overflow="hidden",v.appendChild(f)),s=r(l,t),f.fake?(f.parentNode.removeChild(f),v.style.overflow=u,v.offsetHeight):l.parentNode.removeChild(l),!!s}function d(e,n){var i=e.length;if("CSS"in t&&"supports"in t.CSS){for(;i--;)if(t.CSS.supports(l(e[i]),n))return!0;return!1}if("CSSSupportsRule"in t){for(var o=[];i--;)o.push("("+l(e[i])+":"+n+")");return o=o.join(" or "),f("@supports ("+o+") { #modernizr { position: absolute; } }",function(t){return"absolute"==getComputedStyle(t,null).position})}return r}function m(t,e,i,o){function u(){l&&(delete R.style,delete R.modElem)}if(o=n(o,"undefined")?!1:o,!n(i,"undefined")){var c=d(t,i);if(!n(c,"undefined"))return c}for(var l,p,f,m,g,y=["modernizr","tspan"];!R.style;)l=!0,R.modElem=a(y.shift()),R.style=R.modElem.style;for(f=t.length,p=0;f>p;p++)if(m=t[p],g=R.style[m],h(m,"-")&&(m=s(m)),R.style[m]!==r){if(o||n(i,"undefined"))return u(),"pfx"==e?m:!0;try{R.style[m]=i}catch(v){}if(R.style[m]!=g)return u(),"pfx"==e?m:!0}return u(),!1}function g(t,e,r,i,o){var a=t.charAt(0).toUpperCase()+t.slice(1),s=(t+" "+T.join(a+" ")+a).split(" ");return n(e,"string")||n(e,"undefined")?m(s,e,i,o):(s=(t+" "+C.join(a+" ")+a).split(" "),c(s,e,r))}var y=[],v=e.documentElement,_=[],x={_version:"3.0.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(t,e){var r=this;setTimeout(function(){e(r[t])},0)},addTest:function(t,e,r){_.push({name:t,fn:e,options:r})},addAsyncTest:function(t){_.push({name:null,fn:t})}},b=function(){};b.prototype=x,b=new b,b.addTest("typedarrays","ArrayBuffer"in t),b.addTest("queryselector","querySelector"in e&&"querySelectorAll"in e),b.addTest("websockets","WebSocket"in t&&2===t.WebSocket.CLOSING);var w="svg"===v.nodeName.toLowerCase();b.addTest("webgl",function(){var e=a("canvas"),r="probablySupportsContext"in e?"probablySupportsContext":"supportsContext";return r in e?e[r]("webgl")||e[r]("experimental-webgl"):"WebGLRenderingContext"in t});var S=function(t){if("undefined"==typeof XMLHttpRequest)return!1;var e=new XMLHttpRequest;e.open("get","/",!0);try{e.responseType=t}catch(r){return!1}return"response"in e&&e.responseType==t};b.addTest("xhrresponsetypearraybuffer",S("arraybuffer"));var M="Moz O ms Webkit",T=x._config.usePrefixes?M.split(" "):[];x._cssomPrefixes=T;var E=function(e){var n,i=prefixes.length,o=t.CSSRule;if("undefined"==typeof o)return r;if(!e)return!1;if(e=e.replace(/^@/,""),n=e.replace(/-/g,"_").toUpperCase()+"_RULE",n in o)return"@"+e;for(var a=0;i>a;a++){var s=prefixes[a],h=s.toUpperCase()+"_"+n;if(h in o)return"@-"+s.toLowerCase()+"-"+e}return!1};x.atRule=E;var C=x._config.usePrefixes?M.toLowerCase().split(" "):[];x._domPrefixes=C;var A={elem:a("modernizr")};b._q.push(function(){delete A.elem});var R={style:A.elem.style};b._q.unshift(function(){delete R.style}),x.testAllProps=g;var P=x.prefixed=function(t,e,r){return 0===t.indexOf("@")?E(t):(-1!=t.indexOf("-")&&(t=s(t)),e?g(t,e,r):g(t,"pfx"))};b.addTest("requestanimationframe",!!P("requestAnimationFrame",t),{aliases:["raf"]}),i(),o(y),delete x.addTest,delete x.addAsyncTest;for(var L=0;L<b._q.length;L++)b._q[L]();t.Modernizr=b}(window,document)}),define("app",["exports","modctrl","gfx","modernizr","lodash"],function(t,e,r,n,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function a(){var t=location.hash.replace(/^#/,""),r=i.every(i.map(u,function(t){return Modernizr[t]}),function(t){return!!t});r?(e.create(h["default"],t),s()):document.body.classList.add("bad-browser")}function s(){requestAnimationFrame(s),e.update(h["default"]),h["default"].update()}var h=o(r),u=["typedarrays","queryselector","websockets","webgl","xhrresponsetypearraybuffer","requestanimationframe","raf"];a()});
